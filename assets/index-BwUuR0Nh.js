const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-B5BYfRsA.js","assets/webworkerAll-CjWje6IF.js","assets/colorToUniform-BXaCBwVl.js","assets/WebGPURenderer-Wu_Zbl5u.js","assets/SharedSystems-DjFCMArI.js","assets/WebGLRenderer-BgEMUbLs.js"])))=>i.map(i=>d[i]);
var tp=Object.defineProperty;var ep=(i,t,e)=>t in i?tp(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var x=(i,t,e)=>ep(i,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function e(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=e(r);fetch(r.href,n)}})();let Qh=null;function Ft(){return Qh}function sp(i){Qh=i}const ip="modulepreload",rp=function(i){return"/1up_classic/"+i},Bo={},Ar=function(t,e,s){let r=Promise.resolve();if(e&&e.length>0){let a=function(l){return Promise.all(l.map(c=>Promise.resolve(c).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),h=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=a(e.map(l=>{if(l=rp(l),l in Bo)return;Bo[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":ip,c||(f.as="script"),f.crossOrigin="",f.href=l,h&&f.setAttribute("nonce",h),document.head.appendChild(f),c)return new Promise((d,p)=>{f.addEventListener("load",d),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function n(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return r.then(a=>{for(const o of a||[])o.status==="rejected"&&n(o.reason);return t().catch(n)})};var X=(i=>(i.Application="application",i.WebGLPipes="webgl-pipes",i.WebGLPipesAdaptor="webgl-pipes-adaptor",i.WebGLSystem="webgl-system",i.WebGPUPipes="webgpu-pipes",i.WebGPUPipesAdaptor="webgpu-pipes-adaptor",i.WebGPUSystem="webgpu-system",i.CanvasSystem="canvas-system",i.CanvasPipesAdaptor="canvas-pipes-adaptor",i.CanvasPipes="canvas-pipes",i.Asset="asset",i.LoadParser="load-parser",i.ResolveParser="resolve-parser",i.CacheParser="cache-parser",i.DetectionParser="detection-parser",i.MaskEffect="mask-effect",i.BlendMode="blend-mode",i.TextureSource="texture-source",i.Environment="environment",i.ShapeBuilder="shape-builder",i.Batcher="batcher",i))(X||{});const ta=i=>{if(typeof i=="function"||typeof i=="object"&&i.extension){if(!i.extension)throw new Error("Extension class must have an extension object");i={...typeof i.extension!="object"?{type:i.extension}:i.extension,ref:i}}if(typeof i=="object")i={...i};else throw new Error("Invalid extension type");return typeof i.type=="string"&&(i.type=[i.type]),i},er=(i,t)=>ta(i).priority??t,at={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...i){return i.map(ta).forEach(t=>{t.type.forEach(e=>{var s,r;return(r=(s=this._removeHandlers)[e])==null?void 0:r.call(s,t)})}),this},add(...i){return i.map(ta).forEach(t=>{t.type.forEach(e=>{var n,a;const s=this._addHandlers,r=this._queue;s[e]?(a=s[e])==null||a.call(s,t):(r[e]=r[e]||[],(n=r[e])==null||n.push(t))})}),this},handle(i,t,e){var a;const s=this._addHandlers,r=this._removeHandlers;if(s[i]||r[i])throw new Error(`Extension type ${i} already has a handler`);s[i]=t,r[i]=e;const n=this._queue;return n[i]&&((a=n[i])==null||a.forEach(o=>t(o)),delete n[i]),this},handleByMap(i,t){return this.handle(i,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByNamedList(i,t,e=-1){return this.handle(i,s=>{t.findIndex(n=>n.name===s.name)>=0||(t.push({name:s.name,value:s.ref}),t.sort((n,a)=>er(a.value,e)-er(n.value,e)))},s=>{const r=t.findIndex(n=>n.name===s.name);r!==-1&&t.splice(r,1)})},handleByList(i,t,e=-1){return this.handle(i,s=>{t.includes(s.ref)||(t.push(s.ref),t.sort((r,n)=>er(n,e)-er(r,e)))},s=>{const r=t.indexOf(s.ref);r!==-1&&t.splice(r,1)})},mixin(i,...t){for(const e of t)Object.defineProperties(i.prototype,Object.getOwnPropertyDescriptors(e))}},np={extension:{type:X.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await Ar(()=>import("./browserAll-B5BYfRsA.js"),__vite__mapDeps([0,1,2]))}},ap={extension:{type:X.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await Ar(()=>import("./webworkerAll-CjWje6IF.js"),__vite__mapDeps([1,2]))}};class Ct{constructor(t,e,s){this._x=e||0,this._y=s||0,this._observer=t}clone(t){return new Ct(t??this._observer,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this._observer._onUpdate(this)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}function Jh(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var an={exports:{}},Ro;function op(){return Ro||(Ro=1,function(i){var t=Object.prototype.hasOwnProperty,e="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(e=!1));function r(h,l,c){this.fn=h,this.context=l,this.once=c||!1}function n(h,l,c,u,f){if(typeof c!="function")throw new TypeError("The listener must be a function");var d=new r(c,u||h,f),p=e?e+l:l;return h._events[p]?h._events[p].fn?h._events[p]=[h._events[p],d]:h._events[p].push(d):(h._events[p]=d,h._eventsCount++),h}function a(h,l){--h._eventsCount===0?h._events=new s:delete h._events[l]}function o(){this._events=new s,this._eventsCount=0}o.prototype.eventNames=function(){var l=[],c,u;if(this._eventsCount===0)return l;for(u in c=this._events)t.call(c,u)&&l.push(e?u.slice(1):u);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},o.prototype.listeners=function(l){var c=e?e+l:l,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var f=0,d=u.length,p=new Array(d);f<d;f++)p[f]=u[f].fn;return p},o.prototype.listenerCount=function(l){var c=e?e+l:l,u=this._events[c];return u?u.fn?1:u.length:0},o.prototype.emit=function(l,c,u,f,d,p){var m=e?e+l:l;if(!this._events[m])return!1;var g=this._events[m],_=arguments.length,w,b;if(g.fn){switch(g.once&&this.removeListener(l,g.fn,void 0,!0),_){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,c),!0;case 3:return g.fn.call(g.context,c,u),!0;case 4:return g.fn.call(g.context,c,u,f),!0;case 5:return g.fn.call(g.context,c,u,f,d),!0;case 6:return g.fn.call(g.context,c,u,f,d,p),!0}for(b=1,w=new Array(_-1);b<_;b++)w[b-1]=arguments[b];g.fn.apply(g.context,w)}else{var y=g.length,S;for(b=0;b<y;b++)switch(g[b].once&&this.removeListener(l,g[b].fn,void 0,!0),_){case 1:g[b].fn.call(g[b].context);break;case 2:g[b].fn.call(g[b].context,c);break;case 3:g[b].fn.call(g[b].context,c,u);break;case 4:g[b].fn.call(g[b].context,c,u,f);break;default:if(!w)for(S=1,w=new Array(_-1);S<_;S++)w[S-1]=arguments[S];g[b].fn.apply(g[b].context,w)}}return!0},o.prototype.on=function(l,c,u){return n(this,l,c,u,!1)},o.prototype.once=function(l,c,u){return n(this,l,c,u,!0)},o.prototype.removeListener=function(l,c,u,f){var d=e?e+l:l;if(!this._events[d])return this;if(!c)return a(this,d),this;var p=this._events[d];if(p.fn)p.fn===c&&(!f||p.once)&&(!u||p.context===u)&&a(this,d);else{for(var m=0,g=[],_=p.length;m<_;m++)(p[m].fn!==c||f&&!p[m].once||u&&p[m].context!==u)&&g.push(p[m]);g.length?this._events[d]=g.length===1?g[0]:g:a(this,d)}return this},o.prototype.removeAllListeners=function(l){var c;return l?(c=e?e+l:l,this._events[c]&&a(this,c)):(this._events=new s,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=e,o.EventEmitter=o,i.exports=o}(an)),an.exports}var lp=op();const Xt=Jh(lp),hp=Math.PI*2,cp=180/Math.PI,ea=Math.PI/180;class Dt{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new Dt(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return on.x=0,on.y=0,on}}const on=new Dt;class et{constructor(t=1,e=0,s=0,r=1,n=0,a=0){this.array=null,this.a=t,this.b=e,this.c=s,this.d=r,this.tx=n,this.ty=a}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,s,r,n,a){return this.a=t,this.b=e,this.c=s,this.d=r,this.tx=n,this.ty=a,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const s=e||this.array;return t?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(t,e){e=e||new Dt;const s=t.x,r=t.y;return e.x=this.a*s+this.c*r+this.tx,e.y=this.b*s+this.d*r+this.ty,e}applyInverse(t,e){e=e||new Dt;const s=this.a,r=this.b,n=this.c,a=this.d,o=this.tx,h=this.ty,l=1/(s*a+n*-r),c=t.x,u=t.y;return e.x=a*l*c+-n*l*u+(h*n-o*a)*l,e.y=s*l*u+-r*l*c+(-h*s+o*r)*l,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),s=Math.sin(t),r=this.a,n=this.c,a=this.tx;return this.a=r*e-this.b*s,this.b=r*s+this.b*e,this.c=n*e-this.d*s,this.d=n*s+this.d*e,this.tx=a*e-this.ty*s,this.ty=a*s+this.ty*e,this}append(t){const e=this.a,s=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*s+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*s+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*s+t.ty*n+this.ty,this}appendFrom(t,e){const s=t.a,r=t.b,n=t.c,a=t.d,o=t.tx,h=t.ty,l=e.a,c=e.b,u=e.c,f=e.d;return this.a=s*l+r*u,this.b=s*c+r*f,this.c=n*l+a*u,this.d=n*c+a*f,this.tx=o*l+h*u+e.tx,this.ty=o*c+h*f+e.ty,this}setTransform(t,e,s,r,n,a,o,h,l){return this.a=Math.cos(o+l)*n,this.b=Math.sin(o+l)*n,this.c=-Math.sin(o-h)*a,this.d=Math.cos(o-h)*a,this.tx=t-(s*this.a+r*this.c),this.ty=e-(s*this.b+r*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const s=this.a,r=this.c;this.a=s*t.a+this.b*t.c,this.b=s*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,s=this.b,r=this.c,n=this.d,a=t.pivot,o=-Math.atan2(-r,n),h=Math.atan2(s,e),l=Math.abs(o+h);return l<1e-5||Math.abs(hp-l)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=h),t.scale.x=Math.sqrt(e*e+s*s),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx+(a.x*e+a.y*r),t.position.y=this.ty+(a.x*s+a.y*n),t}invert(){const t=this.a,e=this.b,s=this.c,r=this.d,n=this.tx,a=t*r-e*s;return this.a=r/a,this.b=-e/a,this.c=-s/a,this.d=t/a,this.tx=(s*this.ty-r*n)/a,this.ty=-(t*this.ty-e*n)/a,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new et;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return dp.identity()}static get shared(){return up.identity()}}const up=new et,dp=new et,es=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ss=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],is=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],rs=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],sa=[],tc=[],sr=Math.sign;function fp(){for(let i=0;i<16;i++){const t=[];sa.push(t);for(let e=0;e<16;e++){const s=sr(es[i]*es[e]+is[i]*ss[e]),r=sr(ss[i]*es[e]+rs[i]*ss[e]),n=sr(es[i]*is[e]+is[i]*rs[e]),a=sr(ss[i]*is[e]+rs[i]*rs[e]);for(let o=0;o<16;o++)if(es[o]===s&&ss[o]===r&&is[o]===n&&rs[o]===a){t.push(o);break}}}for(let i=0;i<16;i++){const t=new et;t.set(es[i],ss[i],is[i],rs[i],0,0),tc.push(t)}}fp();const xt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:i=>es[i],uY:i=>ss[i],vX:i=>is[i],vY:i=>rs[i],inv:i=>i&8?i&15:-i&7,add:(i,t)=>sa[i][t],sub:(i,t)=>sa[i][xt.inv(t)],rotate180:i=>i^4,isVertical:i=>(i&3)===2,byDirection:(i,t)=>Math.abs(i)*2<=Math.abs(t)?t>=0?xt.S:xt.N:Math.abs(t)*2<=Math.abs(i)?i>0?xt.E:xt.W:t>0?i>0?xt.SE:xt.SW:i>0?xt.NE:xt.NW,matrixAppendRotationInv:(i,t,e=0,s=0)=>{const r=tc[xt.inv(t)];r.tx=e,r.ty=s,i.append(r)}},ir=[new Dt,new Dt,new Dt,new Dt];class pt{constructor(t=0,e=0,s=0,r=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(s),this.height=Number(r)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new pt(0,0,0,0)}clone(){return new pt(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}strokeContains(t,e,s,r=.5){const{width:n,height:a}=this;if(n<=0||a<=0)return!1;const o=this.x,h=this.y,l=s*(1-r),c=s-l,u=o-l,f=o+n+l,d=h-l,p=h+a+l,m=o+c,g=o+n-c,_=h+c,w=h+a-c;return t>=u&&t<=f&&e>=d&&e<=p&&!(t>m&&t<g&&e>_&&e<w)}intersects(t,e){if(!e){const C=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=C)return!1;const P=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>P}const s=this.left,r=this.right,n=this.top,a=this.bottom;if(r<=s||a<=n)return!1;const o=ir[0].set(t.left,t.top),h=ir[1].set(t.left,t.bottom),l=ir[2].set(t.right,t.top),c=ir[3].set(t.right,t.bottom);if(l.x<=o.x||h.y<=o.y)return!1;const u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(o,o),e.apply(h,h),e.apply(l,l),e.apply(c,c),Math.max(o.x,h.x,l.x,c.x)<=s||Math.min(o.x,h.x,l.x,c.x)>=r||Math.max(o.y,h.y,l.y,c.y)<=n||Math.min(o.y,h.y,l.y,c.y)>=a))return!1;const f=u*(h.y-o.y),d=u*(o.x-h.x),p=f*s+d*n,m=f*r+d*n,g=f*s+d*a,_=f*r+d*a;if(Math.max(p,m,g,_)<=f*o.x+d*o.y||Math.min(p,m,g,_)>=f*c.x+d*c.y)return!1;const w=u*(o.y-l.y),b=u*(l.x-o.x),y=w*s+b*n,S=w*r+b*n,v=w*s+b*a,A=w*r+b*a;return!(Math.max(y,S,v,A)<=w*o.x+b*o.y||Math.min(y,S,v,A)>=w*c.x+b*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),s=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(s-e,0),this.y=r,this.height=Math.max(n-r,0),this}ceil(t=1,e=.001){const s=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=s-this.x,this.height=r-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),s=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=s-e,this.y=r,this.height=n-r,this}getBounds(t){return t||(t=new pt),t.copyFrom(this),t}containsRect(t){if(this.width<=0||this.height<=0)return!1;const e=t.x,s=t.y,r=t.x+t.width,n=t.y+t.height;return e>=this.x&&e<this.x+this.width&&s>=this.y&&s<this.y+this.height&&r>=this.x&&r<this.x+this.width&&n>=this.y&&n<this.y+this.height}set(t,e,s,r){return this.x=t,this.y=e,this.width=s,this.height=r,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const ln={default:-1};function Tt(i="default"){return ln[i]===void 0&&(ln[i]=-1),++ln[i]}const Vo={},rt="8.0.0",pp="8.3.4";function q(i,t,e=3){if(Vo[t])return;let s=new Error().stack;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`):(s=s.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${i}`),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`),console.warn(s))),Vo[t]=!0}const ec=()=>{};function Ys(i){return i+=i===0?1:0,--i,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i+1}function Oo(i){return!(i&i-1)&&!!i}function sc(i){const t={};for(const e in i)i[e]!==void 0&&(t[e]=i[e]);return t}const Lo=Object.create(null);function mp(i){const t=Lo[i];return t===void 0&&(Lo[i]=Tt("resource")),t}const ic=class rc extends Xt{constructor(t={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,t={...rc.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){q(rt,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=mp(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};ic.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let Xs=ic;const nc=class ac extends Xt{constructor(t={}){super(),this.options=t,this.uid=Tt("textureSource"),this._resourceType="textureSource",this._resourceId=Tt("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,t={...ac.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new Xs(sc(t)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){var e,s;this.style!==t&&((e=this._style)==null||e.off("change",this._onStyleChange,this),this._style=t,(s=this._style)==null||s.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=Tt("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,s){s||(s=this._resolution),t||(t=this.width),e||(e=this.height);const r=Math.round(t*s),n=Math.round(e*s);return this.width=r/s,this.height=n/s,this._resolution=s,this.pixelWidth===r&&this.pixelHeight===n?!1:(this._refreshPOT(),this.pixelWidth=r,this.pixelHeight=n,this.emit("resize",this),this._resourceId=Tt("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=Oo(this.pixelWidth)&&Oo(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};nc.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let Kt=nc;class Wa extends Kt{constructor(t){const e=t.resource||new Float32Array(t.width*t.height*4);let s=t.format;s||(e instanceof Float32Array?s="rgba32float":e instanceof Int32Array||e instanceof Uint32Array?s="rgba32uint":e instanceof Int16Array||e instanceof Uint16Array?s="rgba16uint":(e instanceof Int8Array,s="bgra8unorm")),super({...t,resource:e,format:s}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}Wa.extension=X.TextureSource;const Do=new et;class gp{constructor(t,e){this.mapCoord=new et,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof e>"u"?this.clampMargin=t.width<10?0:.5:this.clampMargin=e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){var e;this.texture!==t&&((e=this._texture)==null||e.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){e===void 0&&(e=t);const s=this.mapCoord;for(let r=0;r<t.length;r+=2){const n=t[r],a=t[r+1];e[r]=n*s.a+a*s.c+s.tx,e[r+1]=n*s.b+a*s.d+s.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const s=t.orig,r=t.trim;r&&(Do.set(s.width/r.width,0,0,s.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(Do));const n=t.source,a=this.uClampFrame,o=this.clampMargin/n._resolution,h=this.clampOffset/n._resolution;return a[0]=(t.frame.x+o+h)/n.width,a[1]=(t.frame.y+o+h)/n.height,a[2]=(t.frame.x+t.frame.width-o+h)/n.width,a[3]=(t.frame.y+t.frame.height-o+h)/n.height,this.uClampOffset[0]=this.clampOffset/n.pixelWidth,this.uClampOffset[1]=this.clampOffset/n.pixelHeight,this.isSimple=t.frame.width===n.width&&t.frame.height===n.height&&t.rotate===0,!0}}let U=class extends Xt{constructor({source:t,label:e,frame:s,orig:r,trim:n,defaultAnchor:a,defaultBorders:o,rotate:h,dynamic:l}={}){if(super(),this.uid=Tt("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new pt,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=e,this.source=(t==null?void 0:t.source)??new Kt,this.noFrame=!s,s)this.frame.copyFrom(s);else{const{width:c,height:u}=this._source;this.frame.width=c,this.frame.height=u}this.orig=r||this.frame,this.trim=n,this.rotate=h??0,this.defaultAnchor=a,this.defaultBorders=o,this.destroyed=!1,this.dynamic=l||!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new gp(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:e}=this,{width:s,height:r}=this._source,n=e.x/s,a=e.y/r,o=e.width/s,h=e.height/r;let l=this.rotate;if(l){const c=o/2,u=h/2,f=n+c,d=a+u;l=xt.add(l,xt.NW),t.x0=f+c*xt.uX(l),t.y0=d+u*xt.uY(l),l=xt.add(l,2),t.x1=f+c*xt.uX(l),t.y1=d+u*xt.uY(l),l=xt.add(l,2),t.x2=f+c*xt.uX(l),t.y2=d+u*xt.uY(l),l=xt.add(l,2),t.x3=f+c*xt.uX(l),t.y3=d+u*xt.uY(l)}else t.x0=n,t.y0=a,t.x1=n+o,t.y1=a,t.x2=n+o,t.y2=a+h,t.x3=n,t.y3=a+h}destroy(t=!1){this._source&&t&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return q(rt,"Texture.baseTexture is now Texture.source"),this._source}};U.EMPTY=new U({label:"EMPTY",source:new Kt({label:"EMPTY"})});U.EMPTY.destroy=ec;U.WHITE=new U({source:new Wa({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});U.WHITE.destroy=ec;function xp(i,t,e){const{width:s,height:r}=e.orig,n=e.trim;if(n){const a=n.width,o=n.height;i.minX=n.x-t._x*s,i.maxX=i.minX+a,i.minY=n.y-t._y*r,i.maxY=i.minY+o}else i.minX=-t._x*s,i.maxX=i.minX+s,i.minY=-t._y*r,i.maxY=i.minY+r}const Yo=new et;class pe{constructor(t=1/0,e=1/0,s=-1/0,r=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Yo,this.minX=t,this.minY=e,this.maxX=s,this.maxY=r}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new pt);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Yo,this}set(t,e,s,r){this.minX=t,this.minY=e,this.maxX=s,this.maxY=r}addFrame(t,e,s,r,n){n||(n=this.matrix);const a=n.a,o=n.b,h=n.c,l=n.d,c=n.tx,u=n.ty;let f=this.minX,d=this.minY,p=this.maxX,m=this.maxY,g=a*t+h*e+c,_=o*t+l*e+u;g<f&&(f=g),_<d&&(d=_),g>p&&(p=g),_>m&&(m=_),g=a*s+h*e+c,_=o*s+l*e+u,g<f&&(f=g),_<d&&(d=_),g>p&&(p=g),_>m&&(m=_),g=a*t+h*r+c,_=o*t+l*r+u,g<f&&(f=g),_<d&&(d=_),g>p&&(p=g),_>m&&(m=_),g=a*s+h*r+c,_=o*s+l*r+u,g<f&&(f=g),_<d&&(d=_),g>p&&(p=g),_>m&&(m=_),this.minX=f,this.minY=d,this.maxX=p,this.maxY=m}addRect(t,e){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,e)}addBounds(t,e){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,e)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,s=this.minY,r=this.maxX,n=this.maxY,{a,b:o,c:h,d:l,tx:c,ty:u}=t;let f=a*e+h*s+c,d=o*e+l*s+u;this.minX=f,this.minY=d,this.maxX=f,this.maxY=d,f=a*r+h*s+c,d=o*r+l*s+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY,f=a*e+h*n+c,d=o*e+l*n+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY,f=a*r+h*n+c,d=o*r+l*n+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,e,s,r){return this.minX<t&&(this.minX=t),this.maxX>e&&(this.maxX=e),this.minY<s&&(this.minY=s),this.maxY>r&&(this.maxY=r),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new pe(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}set x(t){const e=this.maxX-this.minX;this.minX=t,this.maxX=t+e}get y(){return this.minY}set y(t){const e=this.maxY-this.minY;this.minY=t,this.maxY=t+e}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,s,r){let n=this.minX,a=this.minY,o=this.maxX,h=this.maxY;r||(r=this.matrix);const l=r.a,c=r.b,u=r.c,f=r.d,d=r.tx,p=r.ty;for(let m=e;m<s;m+=2){const g=t[m],_=t[m+1],w=l*g+u*_+d,b=c*g+f*_+p;n=w<n?w:n,a=b<a?b:a,o=w>o?w:o,h=b>h?b:h}this.minX=n,this.minY=a,this.maxX=o,this.maxY=h}containsPoint(t,e){return this.minX<=t&&this.minY<=e&&this.maxX>=t&&this.maxY>=e}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(t){return this.minX=t.minX,this.minY=t.minY,this.maxX=t.maxX,this.maxY=t.maxY,this}}var yp={grad:.9,turn:360,rad:360/(2*Math.PI)},Fe=function(i){return typeof i=="string"?i.length>0:typeof i=="number"},Bt=function(i,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*i)/e+0},se=function(i,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),i>e?e:i>t?i:t},oc=function(i){return(i=isFinite(i)?i%360:0)>0?i:i+360},Xo=function(i){return{r:se(i.r,0,255),g:se(i.g,0,255),b:se(i.b,0,255),a:se(i.a)}},hn=function(i){return{r:Bt(i.r),g:Bt(i.g),b:Bt(i.b),a:Bt(i.a,3)}},bp=/^#([0-9a-f]{3,8})$/i,rr=function(i){var t=i.toString(16);return t.length<2?"0"+t:t},lc=function(i){var t=i.r,e=i.g,s=i.b,r=i.a,n=Math.max(t,e,s),a=n-Math.min(t,e,s),o=a?n===t?(e-s)/a:n===e?2+(s-t)/a:4+(t-e)/a:0;return{h:60*(o<0?o+6:o),s:n?a/n*100:0,v:n/255*100,a:r}},hc=function(i){var t=i.h,e=i.s,s=i.v,r=i.a;t=t/360*6,e/=100,s/=100;var n=Math.floor(t),a=s*(1-e),o=s*(1-(t-n)*e),h=s*(1-(1-t+n)*e),l=n%6;return{r:255*[s,o,a,a,h,s][l],g:255*[h,s,s,o,a,a][l],b:255*[a,a,h,s,s,o][l],a:r}},zo=function(i){return{h:oc(i.h),s:se(i.s,0,100),l:se(i.l,0,100),a:se(i.a)}},No=function(i){return{h:Bt(i.h),s:Bt(i.s),l:Bt(i.l),a:Bt(i.a,3)}},Uo=function(i){return hc((e=(t=i).s,{h:t.h,s:(e*=((s=t.l)<50?s:100-s)/100)>0?2*e/(s+e)*100:0,v:s+e,a:t.a}));var t,e,s},Ci=function(i){return{h:(t=lc(i)).h,s:(r=(200-(e=t.s))*(s=t.v)/100)>0&&r<200?e*s/100/(r<=100?r:200-r)*100:0,l:r/2,a:t.a};var t,e,s,r},_p=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,wp=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,vp=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Sp=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ia={string:[[function(i){var t=bp.exec(i);return t?(i=t[1]).length<=4?{r:parseInt(i[0]+i[0],16),g:parseInt(i[1]+i[1],16),b:parseInt(i[2]+i[2],16),a:i.length===4?Bt(parseInt(i[3]+i[3],16)/255,2):1}:i.length===6||i.length===8?{r:parseInt(i.substr(0,2),16),g:parseInt(i.substr(2,2),16),b:parseInt(i.substr(4,2),16),a:i.length===8?Bt(parseInt(i.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(i){var t=vp.exec(i)||Sp.exec(i);return t?t[2]!==t[4]||t[4]!==t[6]?null:Xo({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(i){var t=_p.exec(i)||wp.exec(i);if(!t)return null;var e,s,r=zo({h:(e=t[1],s=t[2],s===void 0&&(s="deg"),Number(e)*(yp[s]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return Uo(r)},"hsl"]],object:[[function(i){var t=i.r,e=i.g,s=i.b,r=i.a,n=r===void 0?1:r;return Fe(t)&&Fe(e)&&Fe(s)?Xo({r:Number(t),g:Number(e),b:Number(s),a:Number(n)}):null},"rgb"],[function(i){var t=i.h,e=i.s,s=i.l,r=i.a,n=r===void 0?1:r;if(!Fe(t)||!Fe(e)||!Fe(s))return null;var a=zo({h:Number(t),s:Number(e),l:Number(s),a:Number(n)});return Uo(a)},"hsl"],[function(i){var t=i.h,e=i.s,s=i.v,r=i.a,n=r===void 0?1:r;if(!Fe(t)||!Fe(e)||!Fe(s))return null;var a=function(o){return{h:oc(o.h),s:se(o.s,0,100),v:se(o.v,0,100),a:se(o.a)}}({h:Number(t),s:Number(e),v:Number(s),a:Number(n)});return hc(a)},"hsv"]]},Wo=function(i,t){for(var e=0;e<t.length;e++){var s=t[e][0](i);if(s)return[s,t[e][1]]}return[null,void 0]},Ap=function(i){return typeof i=="string"?Wo(i.trim(),ia.string):typeof i=="object"&&i!==null?Wo(i,ia.object):[null,void 0]},cn=function(i,t){var e=Ci(i);return{h:e.h,s:se(e.s+100*t,0,100),l:e.l,a:e.a}},un=function(i){return(299*i.r+587*i.g+114*i.b)/1e3/255},Go=function(i,t){var e=Ci(i);return{h:e.h,s:e.s,l:se(e.l+100*t,0,100),a:e.a}},ra=function(){function i(t){this.parsed=Ap(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return i.prototype.isValid=function(){return this.parsed!==null},i.prototype.brightness=function(){return Bt(un(this.rgba),2)},i.prototype.isDark=function(){return un(this.rgba)<.5},i.prototype.isLight=function(){return un(this.rgba)>=.5},i.prototype.toHex=function(){return t=hn(this.rgba),e=t.r,s=t.g,r=t.b,a=(n=t.a)<1?rr(Bt(255*n)):"","#"+rr(e)+rr(s)+rr(r)+a;var t,e,s,r,n,a},i.prototype.toRgb=function(){return hn(this.rgba)},i.prototype.toRgbString=function(){return t=hn(this.rgba),e=t.r,s=t.g,r=t.b,(n=t.a)<1?"rgba("+e+", "+s+", "+r+", "+n+")":"rgb("+e+", "+s+", "+r+")";var t,e,s,r,n},i.prototype.toHsl=function(){return No(Ci(this.rgba))},i.prototype.toHslString=function(){return t=No(Ci(this.rgba)),e=t.h,s=t.s,r=t.l,(n=t.a)<1?"hsla("+e+", "+s+"%, "+r+"%, "+n+")":"hsl("+e+", "+s+"%, "+r+"%)";var t,e,s,r,n},i.prototype.toHsv=function(){return t=lc(this.rgba),{h:Bt(t.h),s:Bt(t.s),v:Bt(t.v),a:Bt(t.a,3)};var t},i.prototype.invert=function(){return be({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},i.prototype.saturate=function(t){return t===void 0&&(t=.1),be(cn(this.rgba,t))},i.prototype.desaturate=function(t){return t===void 0&&(t=.1),be(cn(this.rgba,-t))},i.prototype.grayscale=function(){return be(cn(this.rgba,-1))},i.prototype.lighten=function(t){return t===void 0&&(t=.1),be(Go(this.rgba,t))},i.prototype.darken=function(t){return t===void 0&&(t=.1),be(Go(this.rgba,-t))},i.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},i.prototype.alpha=function(t){return typeof t=="number"?be({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):Bt(this.rgba.a,3);var e},i.prototype.hue=function(t){var e=Ci(this.rgba);return typeof t=="number"?be({h:t,s:e.s,l:e.l,a:e.a}):Bt(e.h)},i.prototype.isEqual=function(t){return this.toHex()===be(t).toHex()},i}(),be=function(i){return i instanceof ra?i:new ra(i)},Ho=[],Cp=function(i){i.forEach(function(t){Ho.indexOf(t)<0&&(t(ra,ia),Ho.push(t))})};function Tp(i,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(var r in e)s[e[r]]=r;var n={};i.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var o,h,l=s[this.toHex()];if(l)return l;if(a!=null&&a.closest){var c=this.toRgb(),u=1/0,f="black";if(!n.length)for(var d in e)n[d]=new i(e[d]).toRgb();for(var p in e){var m=(o=c,h=n[p],Math.pow(o.r-h.r,2)+Math.pow(o.g-h.g,2)+Math.pow(o.b-h.b,2));m<u&&(u=m,f=p)}return f}},t.string.push([function(a){var o=a.toLowerCase(),h=o==="transparent"?"#0000":e[o];return h?new i(h).toRgb():null},"name"])}Cp([Tp]);const zs=class yi{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof yi)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,t))&&(this._value=this._cloneSource(t),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}_isSourceEqual(t,e){const s=typeof t;if(s!==typeof e)return!1;if(s==="number"||s==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((n,a)=>n===e[a]);if(t!==null&&e!==null){const n=Object.keys(t),a=Object.keys(e);return n.length!==a.length?!1:n.every(o=>t[o]===e[o])}return t===e}toRgba(){const[t,e,s,r]=this._components;return{r:t,g:e,b:s,a:r}}toRgb(){const[t,e,s]=this._components;return{r:t,g:e,b:s}}toRgbaString(){const[t,e,s]=this.toUint8RgbArray();return`rgba(${t},${e},${s},${this.alpha})`}toUint8RgbArray(t){const[e,s,r]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb),t[0]=Math.round(e*255),t[1]=Math.round(s*255),t[2]=Math.round(r*255),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t||(t=this._arrayRgba);const[e,s,r,n]=this._components;return t[0]=e,t[1]=s,t[2]=r,t[3]=n,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb);const[e,s,r]=this._components;return t[0]=e,t[1]=s,t[2]=r,t}toNumber(){return this._int}toBgrNumber(){const[t,e,s]=this.toUint8RgbArray();return(s<<16)+(e<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,s,r,n]=yi._temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=s,this._components[2]*=r,this._components[3]*=n,this._refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let s=this._int>>16&255,r=this._int>>8&255,n=this._int&255;return e&&(s=s*t+.5|0,r=r*t+.5|0,n=n*t+.5|0),(t*255<<24)+(s<<16)+(r<<8)+n}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(t){let e,s,r,n;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const a=t;e=(a>>16&255)/255,s=(a>>8&255)/255,r=(a&255)/255,n=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,s,r,n=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,s,r,n=255]=t,e/=255,s/=255,r/=255,n/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const o=yi.HEX_PATTERN.exec(t);o&&(t=`#${o[2]}`)}const a=be(t);a.isValid()&&({r:e,g:s,b:r,a:n}=a.rgba,e/=255,s/=255,r/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=s,this._components[2]=r,this._components[3]=n,this._refreshInt();else throw new Error(`Unable to convert color ${t}`)}_refreshInt(){this._clamp(this._components);const[t,e,s]=this._components;this._int=(t*255<<16)+(e*255<<8)+(s*255|0)}_clamp(t,e=0,s=1){return typeof t=="number"?Math.min(Math.max(t,e),s):(t.forEach((r,n)=>{t[n]=Math.min(Math.max(r,e),s)}),t)}static isColorLike(t){return typeof t=="number"||typeof t=="string"||t instanceof Number||t instanceof yi||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t.r!==void 0&&t.g!==void 0&&t.b!==void 0||t.r!==void 0&&t.g!==void 0&&t.b!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0&&t.a!==void 0}};zs.shared=new zs;zs._temp=new zs;zs.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let St=zs;const Mp={cullArea:null,cullable:!1,cullableChildren:!0};let Ga=class{constructor(t,e){this._pool=[],this._count=0,this._index=0,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){var s;let e;return this._index>0?e=this._pool[--this._index]:e=new this._classType,(s=e.init)==null||s.call(e,t),e}return(t){var e;(e=t.reset)==null||e.call(t),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}};class Pp{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new Ga(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const s=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[s]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}}const Ce=new Pp,kp={get isCachedAsTexture(){var i;return!!((i=this.renderGroup)!=null&&i.isCachedAsTexture)},cacheAsTexture(i){typeof i=="boolean"&&i===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(i===!0?{}:i))},updateCacheTexture(){var i;(i=this.renderGroup)==null||i.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(i){q("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(i)}};function Ip(i,t,e){const s=i.length;let r;if(t>=s||e===0)return;e=t+e>s?s-t:e;const n=s-e;for(r=t;r<n;++r)i[r]=i[r+e];i.length=n}const Fp={allowChildren:!0,removeChildren(i=0,t){var n;const e=t??this.children.length,s=e-i,r=[];if(s>0&&s<=e){for(let o=e-1;o>=i;o--){const h=this.children[o];h&&(r.push(h),h.parent=null)}Ip(this.children,i,e);const a=this.renderGroup||this.parentRenderGroup;a&&a.removeChildren(r);for(let o=0;o<r.length;++o){const h=r[o];(n=h.parentRenderLayer)==null||n.detach(h),this.emit("childRemoved",h,this,o),r[o].emit("removed",this)}return r.length>0&&this._didViewChangeTick++,r}else if(s===0&&this.children.length===0)return r;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(i){const t=this.getChildAt(i);return this.removeChild(t)},getChildAt(i){if(i<0||i>=this.children.length)throw new Error(`getChildAt: Index (${i}) does not exist.`);return this.children[i]},setChildIndex(i,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(i),this.addChildAt(i,t)},getChildIndex(i){const t=this.children.indexOf(i);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(i,t){this.allowChildren||q(rt,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:e}=this;if(t<0||t>e.length)throw new Error(`${i}addChildAt: The index ${t} supplied is out of bounds ${e.length}`);if(i.parent){const r=i.parent.children.indexOf(i);if(i.parent===this&&r===t)return i;r!==-1&&i.parent.children.splice(r,1)}t===e.length?e.push(i):e.splice(t,0,i),i.parent=this,i.didChange=!0,i._updateFlags=15;const s=this.renderGroup||this.parentRenderGroup;return s&&s.addChild(i),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",i,this,t),i.emit("added",this),i},swapChildren(i,t){if(i===t)return;const e=this.getChildIndex(i),s=this.getChildIndex(t);this.children[e]=t,this.children[s]=i;const r=this.renderGroup||this.parentRenderGroup;r&&(r.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){var i;(i=this.parent)==null||i.removeChild(this)},reparentChild(...i){return i.length===1?this.reparentChildAt(i[0],this.children.length):(i.forEach(t=>this.reparentChildAt(t,this.children.length)),i[0])},reparentChildAt(i,t){if(i.parent===this)return this.setChildIndex(i,t),i;const e=i.worldTransform.clone();i.removeFromParent(),this.addChildAt(i,t);const s=this.worldTransform.clone();return s.invert(),e.prepend(s),i.setFromMatrix(e),i}},Ep={collectRenderables(i,t,e){this.parentRenderLayer&&this.parentRenderLayer!==e||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(i,t,e):this.renderGroup?t.renderPipes.renderGroup.addRenderGroup(this.renderGroup,i):this.collectRenderablesWithEffects(i,t,e))},collectRenderablesSimple(i,t,e){const s=this.children,r=s.length;for(let n=0;n<r;n++)s[n].collectRenderables(i,t,e)},collectRenderablesWithEffects(i,t,e){const{renderPipes:s}=t;for(let r=0;r<this.effects.length;r++){const n=this.effects[r];s[n.pipe].push(n,this,i)}this.collectRenderablesSimple(i,t,e);for(let r=this.effects.length-1;r>=0;r--){const n=this.effects[r];s[n.pipe].pop(n,this,i)}}};class $o{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}class Bp{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this._tests.length;e++){const s=this._tests[e];if(s.test(t))return Ce.get(s.maskClass,t)}return t}returnMaskEffect(t){Ce.return(t)}}const na=new Bp;at.handleByList(X.MaskEffect,na._effectClasses);const Rp={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const i=this.renderGroup||this.parentRenderGroup;i&&(i.structureDidChange=!0)},addEffect(i){this.effects.indexOf(i)===-1&&(this.effects.push(i),this.effects.sort((e,s)=>e.priority-s.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(i){const t=this.effects.indexOf(i);t!==-1&&(this.effects.splice(t,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(i){const t=this._maskEffect;(t==null?void 0:t.mask)!==i&&(t&&(this.removeEffect(t),na.returnMaskEffect(t),this._maskEffect=null),i!=null&&(this._maskEffect=na.getMaskEffect(i),this.addEffect(this._maskEffect)))},get mask(){var i;return(i=this._maskEffect)==null?void 0:i.mask},setMask(i){this._maskOptions={...this._maskOptions,...i},i.mask&&(this.mask=i.mask),this._markStructureAsChanged()},set filters(i){var n;!Array.isArray(i)&&i&&(i=[i]);const t=this._filterEffect||(this._filterEffect=new $o);i=i;const e=(i==null?void 0:i.length)>0,s=((n=t.filters)==null?void 0:n.length)>0,r=e!==s;i=Array.isArray(i)?i.slice(0):i,t.filters=Object.freeze(i),r&&(e?this.addEffect(t):(this.removeEffect(t),t.filters=i??null))},get filters(){var i;return(i=this._filterEffect)==null?void 0:i.filters},set filterArea(i){this._filterEffect||(this._filterEffect=new $o),this._filterEffect.filterArea=i},get filterArea(){var i;return(i=this._filterEffect)==null?void 0:i.filterArea}},Vp={label:null,get name(){return q(rt,"Container.name property has been removed, use Container.label instead"),this.label},set name(i){q(rt,"Container.name property has been removed, use Container.label instead"),this.label=i},getChildByName(i,t=!1){return this.getChildByLabel(i,t)},getChildByLabel(i,t=!1){const e=this.children;for(let s=0;s<e.length;s++){const r=e[s];if(r.label===i||i instanceof RegExp&&i.test(r.label))return r}if(t)for(let s=0;s<e.length;s++){const n=e[s].getChildByLabel(i,!0);if(n)return n}return null},getChildrenByLabel(i,t=!1,e=[]){const s=this.children;for(let r=0;r<s.length;r++){const n=s[r];(n.label===i||i instanceof RegExp&&i.test(n.label))&&e.push(n)}if(t)for(let r=0;r<s.length;r++)s[r].getChildrenByLabel(i,!0,e);return e}},zt=new Ga(et),Ve=new Ga(pe),Op=new et,Lp={getFastGlobalBounds(i,t){t||(t=new pe),t.clear(),this._getGlobalBoundsRecursive(!!i,t,this.parentRenderLayer),t.isValid||t.set(0,0,0,0);const e=this.renderGroup||this.parentRenderGroup;return t.applyMatrix(e.worldTransform),t},_getGlobalBoundsRecursive(i,t,e){let s=t;if(i&&this.parentRenderLayer&&this.parentRenderLayer!==e||this.localDisplayStatus!==7||!this.measurable)return;const r=!!this.effects.length;if((this.renderGroup||r)&&(s=Ve.get().clear()),this.boundsArea)t.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const a=this.bounds;s.addFrame(a.minX,a.minY,a.maxX,a.maxY,this.groupTransform)}const n=this.children;for(let a=0;a<n.length;a++)n[a]._getGlobalBoundsRecursive(i,s,e)}if(r){let n=!1;const a=this.renderGroup||this.parentRenderGroup;for(let o=0;o<this.effects.length;o++)this.effects[o].addBounds&&(n||(n=!0,s.applyMatrix(a.worldTransform)),this.effects[o].addBounds(s,!0));n&&(s.applyMatrix(a.worldTransform.copyTo(Op).invert()),t.addBounds(s,this.relativeGroupTransform)),t.addBounds(s),Ve.return(s)}else this.renderGroup&&(t.addBounds(s,this.relativeGroupTransform),Ve.return(s))}};function cc(i,t,e){e.clear();let s,r;return i.parent?t?s=i.parent.worldTransform:(r=zt.get().identity(),s=Ha(i,r)):s=et.IDENTITY,uc(i,e,s,t),r&&zt.return(r),e.isValid||e.set(0,0,0,0),e}function uc(i,t,e,s){var o,h;if(!i.visible||!i.measurable)return;let r;s?r=i.worldTransform:(i.updateLocalTransform(),r=zt.get(),r.appendFrom(i.localTransform,e));const n=t,a=!!i.effects.length;if(a&&(t=Ve.get().clear()),i.boundsArea)t.addRect(i.boundsArea,r);else{i.bounds&&(t.matrix=r,t.addBounds(i.bounds));for(let l=0;l<i.children.length;l++)uc(i.children[l],t,r,s)}if(a){for(let l=0;l<i.effects.length;l++)(h=(o=i.effects[l]).addBounds)==null||h.call(o,t);n.addBounds(t,et.IDENTITY),Ve.return(t)}s||zt.return(r)}function Ha(i,t){const e=i.parent;return e&&(Ha(e,t),e.updateLocalTransform(),t.append(e.localTransform)),t}function dc(i,t){if(i===16777215||!t)return t;if(t===16777215||!i)return i;const e=i>>16&255,s=i>>8&255,r=i&255,n=t>>16&255,a=t>>8&255,o=t&255,h=e*n/255|0,l=s*a/255|0,c=r*o/255|0;return(h<<16)+(l<<8)+c}const jo=16777215;function qo(i,t){return i===jo?t:t===jo?i:dc(i,t)}function yr(i){return((i&255)<<16)+(i&65280)+(i>>16&255)}const Dp={getGlobalAlpha(i){if(i)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let t=this.alpha,e=this.parent;for(;e;)t*=e.alpha,e=e.parent;return t},getGlobalTransform(i,t){if(t)return i.copyFrom(this.worldTransform);this.updateLocalTransform();const e=Ha(this,zt.get().identity());return i.appendFrom(this.localTransform,e),zt.return(e),i},getGlobalTint(i){if(i)return this.renderGroup?yr(this.renderGroup.worldColor):this.parentRenderGroup?yr(qo(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let t=this.localColor,e=this.parent;for(;e;)t=qo(t,e.localColor),e=e.parent;return yr(t)}};function fc(i,t,e){return t.clear(),e||(e=et.IDENTITY),pc(i,t,e,i,!0),t.isValid||t.set(0,0,0,0),t}function pc(i,t,e,s,r){var h,l;let n;if(r)n=zt.get(),n=e.copyTo(n);else{if(!i.visible||!i.measurable)return;i.updateLocalTransform();const c=i.localTransform;n=zt.get(),n.appendFrom(c,e)}const a=t,o=!!i.effects.length;if(o&&(t=Ve.get().clear()),i.boundsArea)t.addRect(i.boundsArea,n);else{i.renderPipeId&&(t.matrix=n,t.addBounds(i.bounds));const c=i.children;for(let u=0;u<c.length;u++)pc(c[u],t,n,s,!1)}if(o){for(let c=0;c<i.effects.length;c++)(l=(h=i.effects[c]).addLocalBounds)==null||l.call(h,t,s);a.addBounds(t,et.IDENTITY),Ve.return(t)}zt.return(n)}function mc(i,t){const e=i.children;for(let s=0;s<e.length;s++){const r=e[s],n=r.uid,a=(r._didViewChangeTick&65535)<<16|r._didContainerChangeTick&65535,o=t.index;(t.data[o]!==n||t.data[o+1]!==a)&&(t.data[t.index]=n,t.data[t.index+1]=a,t.didChange=!0),t.index=o+2,r.children.length&&mc(r,t)}return t.didChange}const Yp=new et,Xp={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(i,t){const e=Math.sign(this.scale.x)||1;t!==0?this.scale.x=i/t*e:this.scale.x=e},_setHeight(i,t){const e=Math.sign(this.scale.y)||1;t!==0?this.scale.y=i/t*e:this.scale.y=e},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new pe});const i=this._localBoundsCacheData;return i.index=1,i.didChange=!1,i.data[0]!==this._didViewChangeTick&&(i.didChange=!0,i.data[0]=this._didViewChangeTick),mc(this,i),i.didChange&&fc(this,i.localBounds,Yp),i.localBounds},getBounds(i,t){return cc(this,i,t||new pe)}},zp={_onRender:null,set onRender(i){const t=this.renderGroup||this.parentRenderGroup;if(!i){this._onRender&&(t==null||t.removeOnRender(this)),this._onRender=null;return}this._onRender||t==null||t.addOnRender(this),this._onRender=i},get onRender(){return this._onRender}},Np={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(i){this._zIndex!==i&&(this._zIndex=i,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(Up))}};function Up(i,t){return i._zIndex-t._zIndex}const Wp={getGlobalPosition(i=new Dt,t=!1){return this.parent?this.parent.toGlobal(this._position,i,t):(i.x=this._position.x,i.y=this._position.y),i},toGlobal(i,t,e=!1){const s=this.getGlobalTransform(zt.get(),e);return t=s.apply(i,t),zt.return(s),t},toLocal(i,t,e,s){t&&(i=t.toGlobal(i,e,s));const r=this.getGlobalTransform(zt.get(),s);return e=r.applyInverse(i,e),zt.return(r),e}};class gc{constructor(){this.uid=Tt("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let Gp=0;class Hp{constructor(t){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this.textureStyle=new Xs(this.textureOptions)}createTexture(t,e,s){const r=new Kt({...this.textureOptions,width:t,height:e,resolution:1,antialias:s,autoGarbageCollect:!1});return new U({source:r,label:`texturePool_${Gp++}`})}getOptimalTexture(t,e,s=1,r){let n=Math.ceil(t*s-1e-6),a=Math.ceil(e*s-1e-6);n=Ys(n),a=Ys(a);const o=(n<<17)+(a<<1)+(r?1:0);this._texturePool[o]||(this._texturePool[o]=[]);let h=this._texturePool[o].pop();return h||(h=this.createTexture(n,a,r)),h.source._resolution=s,h.source.width=n/s,h.source.height=a/s,h.source.pixelWidth=n,h.source.pixelHeight=a,h.frame.x=0,h.frame.y=0,h.frame.width=t,h.frame.height=e,h.updateUvs(),this._poolKeyHash[h.uid]=o,h}getSameSizeTexture(t,e=!1){const s=t.source;return this.getOptimalTexture(t.width,t.height,s._resolution,e)}returnTexture(t,e=!1){const s=this._poolKeyHash[t.uid];e&&(t.source.style=this.textureStyle),this._texturePool[s].push(t)}clear(t){if(t=t!==!1,t)for(const e in this._texturePool){const s=this._texturePool[e];if(s)for(let r=0;r<s.length;r++)s[r].destroy(!0)}this._texturePool={}}}const Ii=new Hp;class $p{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new et,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new gc,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(t){this.root=t,t._onRender&&this.addOnRender(t),t.didChange=!0;const e=t.children;for(let s=0;s<e.length;s++){const r=e[s];r._updateFlags=15,this.addChild(r)}}enableCacheAsTexture(t={}){this.textureOptions=t,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(Ii.returnTexture(this.texture),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0}reset(){this.renderGroupChildren.length=0;for(const t in this.childrenToUpdate){const e=this.childrenToUpdate[t];e.list.fill(null),e.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){const e=this.renderGroupChildren.indexOf(t);e>-1&&this.renderGroupChildren.splice(e,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t.parentRenderGroup=this,t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t.didChange=!0,this.onChildUpdate(t),t.renderGroup){this.addRenderGroupChild(t.renderGroup);return}t._onRender&&this.addOnRender(t);const e=t.children;for(let s=0;s<e.length;s++)this.addChild(e[s])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&(t.renderGroup||this.removeOnRender(t)),t.parentRenderGroup=null,t.renderGroup){this._removeRenderGroupChild(t.renderGroup);return}const e=t.children;for(let s=0;s<e.length;s++)this.removeChild(e[s])}removeChildren(t){for(let e=0;e<t.length;e++)this.removeChild(t[e])}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeRenderGroupDepth];e||(e=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t),t.didViewUpdate=!1)}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(t){for(let e=0;e<this._onRenderContainers.length;e++)this._onRenderContainers[e]._onRender(t)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(t=[]){const e=this.root.children;for(let s=0;s<e.length;s++)this._getChildren(e[s],t);return t}_getChildren(t,e=[]){if(e.push(t),t.renderGroup)return e;const s=t.children;for(let r=0;r<s.length;r++)this._getChildren(s[r],e);return e}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new et),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new et),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const t=this._parentCacheAsTextureRenderGroup;return t?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new et),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(t.inverseWorldTransform).translate(-t._textureBounds.x,-t._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function jp(i,t,e={}){for(const s in t)!e[s]&&t[s]!==void 0&&(i[s]=t[s])}const dn=new Ct(null),fn=new Ct(null),pn=new Ct(null,1,1),Ko=1,qp=2,mn=4;class ot extends Xt{constructor(t={}){var e,s;super(),this.uid=Tt("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new et,this.relativeGroupTransform=new et,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new Ct(this,0,0),this._scale=pn,this._pivot=fn,this._skew=dn,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],jp(this,t,{children:!0,parent:!0,effects:!0}),(e=t.children)==null||e.forEach(r=>this.addChild(r)),(s=t.parent)==null||s.addChild(this)}static mixin(t){q("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),at.mixin(ot,t)}set _didChangeId(t){this._didViewChangeTick=t>>12&4095,this._didContainerChangeTick=t&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...t){if(this.allowChildren||q(rt,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let r=0;r<t.length;r++)this.addChild(t[r]);return t[0]}const e=t[0],s=this.renderGroup||this.parentRenderGroup;return e.parent===this?(this.children.splice(this.children.indexOf(e),1),this.children.push(e),s&&(s.structureDidChange=!0),e):(e.parent&&e.parent.removeChild(e),this.children.push(e),this.sortableChildren&&(this.sortDirty=!0),e.parent=this,e.didChange=!0,e._updateFlags=15,s&&s.addChild(e),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this),this._didViewChangeTick++,e._zIndex!==0&&e.depthOfChildModified(),e)}removeChild(...t){if(t.length>1){for(let r=0;r<t.length;r++)this.removeChild(t[r]);return t[0]}const e=t[0],s=this.children.indexOf(e);return s>-1&&(this._didViewChangeTick++,this.children.splice(s,1),this.renderGroup?this.renderGroup.removeChild(e):this.parentRenderGroup&&this.parentRenderGroup.removeChild(e),e.parentRenderLayer&&e.parentRenderLayer.detach(e),e.parent=null,this.emit("childRemoved",e,this,s),e.emit("removed",this)),e}_onUpdate(t){t&&t===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(t){!!this.renderGroup!==t&&(t?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),this.renderGroup=Ce.get($p,this),this.groupTransform=et.IDENTITY,t==null||t.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),Ce.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,t==null||t.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new et),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(t){this._position.x=t}get y(){return this._position.y}set y(t){this._position.y=t}get position(){return this._position}set position(t){this._position.copyFrom(t)}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this._skew))}get angle(){return this.rotation*cp}set angle(t){this.rotation=t*ea}get pivot(){return this._pivot===fn&&(this._pivot=new Ct(this,0,0)),this._pivot}set pivot(t){this._pivot===fn&&(this._pivot=new Ct(this,0,0)),typeof t=="number"?this._pivot.set(t):this._pivot.copyFrom(t)}get skew(){return this._skew===dn&&(this._skew=new Ct(this,0,0)),this._skew}set skew(t){this._skew===dn&&(this._skew=new Ct(this,0,0)),this._skew.copyFrom(t)}get scale(){return this._scale===pn&&(this._scale=new Ct(this,1,1)),this._scale}set scale(t){this._scale===pn&&(this._scale=new Ct(this,0,0)),typeof t=="number"?this._scale.set(t):this._scale.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const e=this.getLocalBounds().width;this._setWidth(t,e)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const e=this.getLocalBounds().height;this._setHeight(t,e)}getSize(t){t||(t={});const e=this.getLocalBounds();return t.width=Math.abs(this.scale.x*e.width),t.height=Math.abs(this.scale.y*e.height),t}setSize(t,e){const s=this.getLocalBounds();typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,s.width),e!==void 0&&this._setHeight(e,s.height)}_updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}updateTransform(t){return this.position.set(typeof t.x=="number"?t.x:this.position.x,typeof t.y=="number"?t.y:this.position.y),this.scale.set(typeof t.scaleX=="number"?t.scaleX||1:this.scale.x,typeof t.scaleY=="number"?t.scaleY||1:this.scale.y),this.rotation=typeof t.rotation=="number"?t.rotation:this.rotation,this.skew.set(typeof t.skewX=="number"?t.skewX:this.skew.x,typeof t.skewY=="number"?t.skewY:this.skew.y),this.pivot.set(typeof t.pivotX=="number"?t.pivotX:this.pivot.x,typeof t.pivotY=="number"?t.pivotY:this.pivot.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){const t=this._didContainerChangeTick;if(this._didLocalTransformChangeId===t)return;this._didLocalTransformChangeId=t;const e=this.localTransform,s=this._scale,r=this._pivot,n=this._position,a=s._x,o=s._y,h=r._x,l=r._y;e.a=this._cx*a,e.b=this._sx*a,e.c=this._cy*o,e.d=this._sy*o,e.tx=n._x-(h*e.a+l*e.c),e.ty=n._y-(h*e.b+l*e.d)}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this._updateFlags|=Ko,this._onUpdate())}get alpha(){return this.localAlpha}set tint(t){const s=St.shared.setValue(t??16777215).toBgrNumber();s!==this.localColor&&(this.localColor=s,this._updateFlags|=Ko,this._onUpdate())}get tint(){return yr(this.localColor)}set blendMode(t){this.localBlendMode!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=qp,this.localBlendMode=t,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(t){const e=t?2:0;(this.localDisplayStatus&2)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=mn,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(t){const e=t?0:4;(this.localDisplayStatus&4)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=mn,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(t){const e=t?1:0;(this.localDisplayStatus&1)!==e&&(this._updateFlags|=mn,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(t=!1){var r;if(this.destroyed)return;this.destroyed=!0;let e;if(this.children.length&&(e=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof t=="boolean"?t:t==null?void 0:t.children)&&e)for(let n=0;n<e.length;++n)e[n].destroy(t);(r=this.renderGroup)==null||r.destroy(),this.renderGroup=null}}at.mixin(ot,Fp,Lp,Wp,zp,Xp,Rp,Vp,Np,Mp,kp,Dp,Ep);class $s extends ot{constructor(t){super(t),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this._bounds=new pe(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}containsPoint(t){const e=this.bounds,{x:s,y:r}=t;return s>=e.minX&&s<=e.maxX&&r>=e.minY&&r<=e.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}destroy(t){var e,s;super.destroy(t),this._bounds=null;for(const r in this._gpuData)(s=(e=this._gpuData[r]).destroy)==null||s.call(e);this._gpuData=null}collectRenderablesSimple(t,e,s){const{renderPipes:r}=e;r.blendMode.setBlendMode(this,this.groupBlendMode,t),r[this.renderPipeId].addRenderable(this,t),this.didViewUpdate=!1;const a=this.children,o=a.length;for(let h=0;h<o;h++)a[h].collectRenderables(t,e,s)}}class Zt extends $s{constructor(t=U.EMPTY){t instanceof U&&(t={texture:t});const{texture:e=U.EMPTY,anchor:s,roundPixels:r,width:n,height:a,...o}=t;super({label:"Sprite",...o}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new Ct({_onUpdate:()=>{this.onViewUpdate()}}),s?this.anchor=s:e.defaultAnchor&&(this.anchor=e.defaultAnchor),this.texture=e,this.allowChildren=!1,this.roundPixels=r??!1,n!==void 0&&(this.width=n),a!==void 0&&(this.height=a)}static from(t,e=!1){return t instanceof U?new Zt(t):new Zt(U.from(t,e))}set texture(t){t||(t=U.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return xp(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return q("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const t=this._anchor,e=this._texture,s=this._bounds,{width:r,height:n}=e.orig;s.minX=-t._x*r,s.maxX=s.minX+r,s.minY=-t._y*n,s.maxY=s.minY+n}destroy(t=!1){if(super.destroy(t),typeof t=="boolean"?t:t==null?void 0:t.texture){const s=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(s)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null,this._gpuData=null}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this._setWidth(t,this._texture.orig.width),this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this._setHeight(t,this._texture.orig.height),this._height=t}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this._texture.orig.width,t.height=Math.abs(this.scale.y)*this._texture.orig.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this._texture.orig.width),e!==void 0&&this._setHeight(e,this._texture.orig.height)}}const Kp=new pe;function xc(i,t,e){const s=Kp;i.measurable=!0,cc(i,e,s),t.addBoundsMask(s),i.measurable=!1}let gn=0;const Zo=500;function mt(...i){gn!==Zo&&(gn++,gn===Zo?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...i))}function yc(i,t,e){const s=Ve.get();i.measurable=!0;const r=zt.get().identity(),n=bc(i,e,r);fc(i,s,n),i.measurable=!1,t.addBoundsMask(s),zt.return(r),Ve.return(s)}function bc(i,t,e){return i?(i!==t&&(bc(i.parent,t,e),i.updateLocalTransform(),e.append(i.localTransform)),e):(mt("Mask bounds, renderable is not inside the root container"),e)}class _c{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof Zt),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(t,e){this.inverse||xc(this.mask,t,e)}addLocalBounds(t,e){yc(this.mask,t,e)}containsPoint(t,e){const s=this.mask;return e(s,t)}destroy(){this.reset()}static test(t){return t instanceof Zt}}_c.extension=X.MaskEffect;class wc{constructor(t){this.priority=0,this.pipe="colorMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return typeof t=="number"}}wc.extension=X.MaskEffect;class vc{constructor(t){this.priority=0,this.pipe="stencilMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(t,e){xc(this.mask,t,e)}addLocalBounds(t,e){yc(this.mask,t,e)}containsPoint(t,e){const s=this.mask;return e(s,t)}destroy(){this.reset()}static test(t){return t instanceof ot}}vc.extension=X.MaskEffect;const Zp={createCanvas:(i,t)=>{const e=document.createElement("canvas");return e.width=i,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(i,t)=>fetch(i,t),parseXML:i=>new DOMParser().parseFromString(i,"text/xml")};let Qo=Zp;const ut={get(){return Qo},set(i){Qo=i}};class Sc extends Kt{constructor(t){t.resource||(t.resource=ut.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity,this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,e=this.height,s=this._resolution){const r=super.resize(t,e,s);return r&&this.resizeCanvas(),r}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}Sc.extension=X.TextureSource;class ps extends Kt{constructor(t){super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}ps.extension=X.TextureSource;var Cr=(i=>(i[i.INTERACTION=50]="INTERACTION",i[i.HIGH=25]="HIGH",i[i.NORMAL=0]="NORMAL",i[i.LOW=-25]="LOW",i[i.UTILITY=-50]="UTILITY",i))(Cr||{});class xn{constructor(t,e=null,s=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=e,this.priority=s,this._once=r}match(t,e=null){return this._fn===t&&this._context===e}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const Ac=class $t{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new xn(null,null,1/0),this.deltaMS=1/$t.targetFPMS,this.elapsedMS=1/$t.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,s=Cr.NORMAL){return this._addListener(new xn(t,e,s))}addOnce(t,e,s=Cr.NORMAL){return this._addListener(new xn(t,e,s,!0))}_addListener(t){let e=this._head.next,s=this._head;if(!e)t.connect(s);else{for(;e;){if(t.priority>e.priority){t.connect(s);break}s=e,e=e.next}t.previous||t.connect(s)}return this._startIfPossible(),this}remove(t,e){let s=this._head.next;for(;s;)s.match(t,e)?s=s.destroy():s=s.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*$t.targetFPMS;const s=this._head;let r=s.next;for(;r;)r=r.emit(this);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),s=Math.min(Math.max(0,e)/1e3,$t.targetFPMS);this._maxElapsedMS=1/s}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!$t._shared){const t=$t._shared=new $t;t.autoStart=!0,t._protected=!0}return $t._shared}static get system(){if(!$t._system){const t=$t._system=new $t;t.autoStart=!0,t._protected=!0}return $t._system}};Ac.targetFPMS=.06;let Yt=Ac,yn;async function Cc(){return yn??(yn=(async()=>{var a;const t=document.createElement("canvas").getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const e=await new Promise(o=>{const h=document.createElement("video");h.onloadeddata=()=>o(h),h.onerror=()=>o(null),h.autoplay=!1,h.crossOrigin="anonymous",h.preload="auto",h.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",h.load()});if(!e)return"premultiply-alpha-on-upload";const s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const n=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,n),t.deleteFramebuffer(r),t.deleteTexture(s),(a=t.getExtension("WEBGL_lose_context"))==null||a.loseContext(),n[0]<=n[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),yn}const Jr=class Tc extends Kt{constructor(t){super(t),this.isReady=!1,this.uploadMethodId="video",t={...Tc.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=Yt.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,e=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(e.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await Cc(),this._load=new Promise((s,r)=>{this.isValid?s(this):(this._resolve=s,this._reject=r,e.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${e.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(Yt.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Yt.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Yt.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};Jr.extension=X.TextureSource;Jr.defaultOptions={...Kt.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};Jr.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let br=Jr;const ue=(i,t,e=!1)=>(Array.isArray(i)||(i=[i]),t?i.map(s=>typeof s=="string"||e?t(s):s):i);class Qp{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||mt(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const s=ue(t);let r;for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];if(l.test(e)){r=l.getCacheableAssets(s,e);break}}const n=new Map(Object.entries(r||{}));r||s.forEach(h=>{n.set(h,e)});const a=[...n.keys()],o={cacheKeys:a,keys:s};s.forEach(h=>{this._cacheMap.set(h,o)}),a.forEach(h=>{const l=r?r[h]:e;this._cache.has(h)&&this._cache.get(h)!==l&&mt("[Cache] already has key:",h),this._cache.set(h,n.get(h))})}remove(t){if(!this._cacheMap.has(t)){mt(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(r=>{this._cache.delete(r)}),e.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const ht=new Qp,aa=[];at.handleByList(X.TextureSource,aa);function Mc(i={}){const t=i&&i.resource,e=t?i.resource:i,s=t?i:{resource:i};for(let r=0;r<aa.length;r++){const n=aa[r];if(n.test(e))return new n(s)}throw new Error(`Could not find a source type for resource: ${s.resource}`)}function Jp(i={},t=!1){const e=i&&i.resource,s=e?i.resource:i,r=e?i:{resource:i};if(!t&&ht.has(s))return ht.get(s);const n=new U({source:Mc(r)});return n.on("destroy",()=>{ht.has(s)&&ht.remove(s)}),t||ht.set(s,n),n}function tm(i,t=!1){return typeof i=="string"?ht.get(i):i instanceof Kt?new U({source:i}):Jp(i,t)}U.from=tm;Kt.from=Mc;at.add(_c,wc,vc,br,ps,Sc,Wa);var ge=(i=>(i[i.Low=0]="Low",i[i.Normal=1]="Normal",i[i.High=2]="High",i))(ge||{});function oe(i){if(typeof i!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(i)}`)}function ii(i){return i.split("?")[0].split("#")[0]}function em(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function sm(i,t,e){return i.replace(new RegExp(em(t),"g"),e)}function im(i,t){let e="",s=0,r=-1,n=0,a=-1;for(let o=0;o<=i.length;++o){if(o<i.length)a=i.charCodeAt(o);else{if(a===47)break;a=47}if(a===47){if(!(r===o-1||n===1))if(r!==o-1&&n===2){if(e.length<2||s!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const h=e.lastIndexOf("/");if(h!==e.length-1){h===-1?(e="",s=0):(e=e.slice(0,h),s=e.length-1-e.lastIndexOf("/")),r=o,n=0;continue}}else if(e.length===2||e.length===1){e="",s=0,r=o,n=0;continue}}}else e.length>0?e+=`/${i.slice(r+1,o)}`:e=i.slice(r+1,o),s=o-r-1;r=o,n=0}else a===46&&n!==-1?++n:n=-1}return e}const Mt={toPosix(i){return sm(i,"\\","/")},isUrl(i){return/^https?:/.test(this.toPosix(i))},isDataUrl(i){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(i)},isBlobUrl(i){return i.startsWith("blob:")},hasProtocol(i){return/^[^/:]+:/.test(this.toPosix(i))},getProtocol(i){oe(i),i=this.toPosix(i);const t=/^file:\/\/\//.exec(i);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(i);return e?e[0]:""},toAbsolute(i,t,e){if(oe(i),this.isDataUrl(i)||this.isBlobUrl(i))return i;const s=ii(this.toPosix(t??ut.get().getBaseUrl())),r=ii(this.toPosix(e??this.rootname(s)));return i=this.toPosix(i),i.startsWith("/")?Mt.join(r,i.slice(1)):this.isAbsolute(i)?i:this.join(s,i)},normalize(i){if(oe(i),i.length===0)return".";if(this.isDataUrl(i)||this.isBlobUrl(i))return i;i=this.toPosix(i);let t="";const e=i.startsWith("/");this.hasProtocol(i)&&(t=this.rootname(i),i=i.slice(t.length));const s=i.endsWith("/");return i=im(i),i.length>0&&s&&(i+="/"),e?`/${i}`:t+i},isAbsolute(i){return oe(i),i=this.toPosix(i),this.hasProtocol(i)?!0:i.startsWith("/")},join(...i){if(i.length===0)return".";let t;for(let e=0;e<i.length;++e){const s=i[e];if(oe(s),s.length>0)if(t===void 0)t=s;else{const r=i[e-1]??"";this.joinExtensions.includes(this.extname(r).toLowerCase())?t+=`/../${s}`:t+=`/${s}`}}return t===void 0?".":this.normalize(t)},dirname(i){if(oe(i),i.length===0)return".";i=this.toPosix(i);let t=i.charCodeAt(0);const e=t===47;let s=-1,r=!0;const n=this.getProtocol(i),a=i;i=i.slice(n.length);for(let o=i.length-1;o>=1;--o)if(t=i.charCodeAt(o),t===47){if(!r){s=o;break}}else r=!1;return s===-1?e?"/":this.isUrl(a)?n+i:n:e&&s===1?"//":n+i.slice(0,s)},rootname(i){oe(i),i=this.toPosix(i);let t="";if(i.startsWith("/")?t="/":t=this.getProtocol(i),this.isUrl(i)){const e=i.indexOf("/",t.length);e!==-1?t=i.slice(0,e):t=i,t.endsWith("/")||(t+="/")}return t},basename(i,t){oe(i),t&&oe(t),i=ii(this.toPosix(i));let e=0,s=-1,r=!0,n;if(t!==void 0&&t.length>0&&t.length<=i.length){if(t.length===i.length&&t===i)return"";let a=t.length-1,o=-1;for(n=i.length-1;n>=0;--n){const h=i.charCodeAt(n);if(h===47){if(!r){e=n+1;break}}else o===-1&&(r=!1,o=n+1),a>=0&&(h===t.charCodeAt(a)?--a===-1&&(s=n):(a=-1,s=o))}return e===s?s=o:s===-1&&(s=i.length),i.slice(e,s)}for(n=i.length-1;n>=0;--n)if(i.charCodeAt(n)===47){if(!r){e=n+1;break}}else s===-1&&(r=!1,s=n+1);return s===-1?"":i.slice(e,s)},extname(i){oe(i),i=ii(this.toPosix(i));let t=-1,e=0,s=-1,r=!0,n=0;for(let a=i.length-1;a>=0;--a){const o=i.charCodeAt(a);if(o===47){if(!r){e=a+1;break}continue}s===-1&&(r=!1,s=a+1),o===46?t===-1?t=a:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||s===-1||n===0||n===1&&t===s-1&&t===e+1?"":i.slice(t,s)},parse(i){oe(i);const t={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return t;i=ii(this.toPosix(i));let e=i.charCodeAt(0);const s=this.isAbsolute(i);let r;t.root=this.rootname(i),s||this.hasProtocol(i)?r=1:r=0;let n=-1,a=0,o=-1,h=!0,l=i.length-1,c=0;for(;l>=r;--l){if(e=i.charCodeAt(l),e===47){if(!h){a=l+1;break}continue}o===-1&&(h=!1,o=l+1),e===46?n===-1?n=l:c!==1&&(c=1):n!==-1&&(c=-1)}return n===-1||o===-1||c===0||c===1&&n===o-1&&n===a+1?o!==-1&&(a===0&&s?t.base=t.name=i.slice(1,o):t.base=t.name=i.slice(a,o)):(a===0&&s?(t.name=i.slice(1,n),t.base=i.slice(1,o)):(t.name=i.slice(a,n),t.base=i.slice(a,o)),t.ext=i.slice(n,o)),t.dir=this.dirname(i),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function Pc(i,t,e,s,r){const n=t[e];for(let a=0;a<n.length;a++){const o=n[a];e<t.length-1?Pc(i.replace(s[e],o),t,e+1,s,r):r.push(i.replace(s[e],o))}}function rm(i){const t=/\{(.*?)\}/g,e=i.match(t),s=[];if(e){const r=[];e.forEach(n=>{const a=n.substring(1,n.length-1).split(",");r.push(a)}),Pc(i,r,0,e,s)}else s.push(i);return s}const Tr=i=>!Array.isArray(i);class xs{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(e[s])}`).join("&")}}getAlias(t){const{alias:e,src:s}=t;return ue(e||s,n=>typeof n=="string"?n:Array.isArray(n)?n.map(a=>(a==null?void 0:a.src)??a):n!=null&&n.src?n.src:n,!0)}addManifest(t){this._manifest&&mt("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const s=[];let r=e;Array.isArray(e)||(r=Object.entries(e).map(([n,a])=>typeof a=="string"||Array.isArray(a)?{alias:n,src:a}:{alias:n,...a})),r.forEach(n=>{const a=n.src,o=n.alias;let h;if(typeof o=="string"){const l=this._createBundleAssetId(t,o);s.push(l),h=[o,l]}else{const l=o.map(c=>this._createBundleAssetId(t,c));s.push(...l),h=[...o,...l]}this.add({...n,alias:h,src:a})}),this._bundles[t]=s}add(t){const e=[];Array.isArray(t)?e.push(...t):e.push(t);let s;s=n=>{this.hasKey(n)&&mt(`[Resolver] already has key: ${n} overwriting`)},ue(e).forEach(n=>{const{src:a}=n;let{data:o,format:h,loadParser:l}=n;const c=ue(a).map(d=>typeof d=="string"?rm(d):Array.isArray(d)?d:[d]),u=this.getAlias(n);Array.isArray(u)?u.forEach(s):s(u);const f=[];c.forEach(d=>{d.forEach(p=>{let m={};if(typeof p!="object"){m.src=p;for(let g=0;g<this._parsers.length;g++){const _=this._parsers[g];if(_.test(p)){m=_.parse(p);break}}}else o=p.data??o,h=p.format??h,l=p.loadParser??l,m={...m,...p};if(!u)throw new Error(`[Resolver] alias is undefined for this asset: ${m.src}`);m=this._buildResolvedAsset(m,{aliases:u,data:o,format:h,loadParser:l}),f.push(m)})}),u.forEach(d=>{this._assetMap[d]=f})})}resolveBundle(t){const e=Tr(t);t=ue(t);const s={};return t.forEach(r=>{const n=this._bundles[r];if(n){const a=this.resolve(n),o={};for(const h in a){const l=a[h];o[this._extractAssetIdFromBundle(r,h)]=l}s[r]=o}}),e?s[t[0]]:s}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const s={};for(const r in e)s[r]=e[r].src;return s}return e.src}resolve(t){const e=Tr(t);t=ue(t);const s={};return t.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let n=this._assetMap[r];const a=this._getPreferredOrder(n);a==null||a.priority.forEach(o=>{a.params[o].forEach(h=>{const l=n.filter(c=>c[o]?c[o]===h:!1);l.length&&(n=l)})}),this._resolverHash[r]=n[0]}else this._resolverHash[r]=this._buildResolvedAsset({alias:[r],src:r},{});s[r]=this._resolverHash[r]}),e?s[t[0]]:s}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const s=t[e],r=this._preferredOrder.find(n=>n.params.format.includes(s.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){const{aliases:s,data:r,loadParser:n,format:a}=e;return(this._basePath||this._rootPath)&&(t.src=Mt.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=s??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...r||{},...t.data},t.loadParser=n??t.loadParser,t.format=a??t.format??nm(t.src),t}}xs.RETINA_PREFIX=/@([0-9\.]+)x/;function nm(i){return i.split(".").pop().split("?").shift().split("#").shift()}const Mr=(i,t)=>{const e=t.split("?")[1];return e&&(i+=`?${e}`),i},kc=class bi{constructor(t,e){this.linkedSheets=[];let s=t;(t==null?void 0:t.source)instanceof Kt&&(s={texture:t,data:e});const{texture:r,data:n,cachePrefix:a=""}=s;this.cachePrefix=a,this._texture=r instanceof U?r:null,this.textureSource=r.source,this.textures={},this.animations={},this.data=n;const o=parseFloat(n.meta.scale);o?(this.resolution=o,r.source.resolution=this.resolution):this.resolution=r.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=bi.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const s=bi.BATCH_SIZE;for(;e-t<s&&e<this._frameKeys.length;){const r=this._frameKeys[e],n=this._frames[r],a=n.frame;if(a){let o=null,h=null;const l=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,c=new pt(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);n.rotated?o=new pt(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):o=new pt(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(h=new pt(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[r]=new U({source:this.textureSource,frame:o,orig:c,trim:h,rotate:n.rotated?2:0,defaultAnchor:n.anchor,defaultBorders:n.borders,label:r.toString()})}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let s=0;s<t[e].length;s++){const r=t[e][s];this.animations[e].push(this.textures[r])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*bi.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*bi.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const s in this.textures)this.textures[s].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};kc.BATCH_SIZE=1e3;let Jo=kc;const am=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function Ic(i,t,e){const s={};if(i.forEach(r=>{s[r]=t}),Object.keys(t.textures).forEach(r=>{s[`${t.cachePrefix}${r}`]=t.textures[r]}),!e){const r=Mt.dirname(i[0]);t.linkedSheets.forEach((n,a)=>{const o=Ic([`${r}/${t.data.meta.related_multi_packs[a]}`],n,!0);Object.assign(s,o)})}return s}const om={extension:X.Asset,cache:{test:i=>i instanceof Jo,getCacheableAssets:(i,t)=>Ic(i,t,!1)},resolver:{extension:{type:X.ResolveParser,name:"resolveSpritesheet"},test:i=>{const e=i.split("?")[0].split("."),s=e.pop(),r=e.pop();return s==="json"&&am.includes(r)},parse:i=>{var e;const t=i.split(".");return{resolution:parseFloat(((e=xs.RETINA_PREFIX.exec(i))==null?void 0:e[1])??"1"),format:t[t.length-2],src:i}}},loader:{name:"spritesheetLoader",extension:{type:X.LoadParser,priority:ge.Normal,name:"spritesheetLoader"},async testParse(i,t){return Mt.extname(t.src).toLowerCase()===".json"&&!!i.frames},async parse(i,t,e){var u,f;const{texture:s,imageFilename:r,textureOptions:n,cachePrefix:a}=(t==null?void 0:t.data)??{};let o=Mt.dirname(t.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let h;if(s instanceof U)h=s;else{const d=Mr(o+(r??i.meta.image),t.src);h=(await e.load([{src:d,data:n}]))[d]}const l=new Jo({texture:h.source,data:i,cachePrefix:a});await l.parse();const c=(u=i==null?void 0:i.meta)==null?void 0:u.related_multi_packs;if(Array.isArray(c)){const d=[];for(const m of c){if(typeof m!="string")continue;let g=o+m;(f=t.data)!=null&&f.ignoreMultiPack||(g=Mr(g,t.src),d.push(e.load({src:g,data:{textureOptions:n,ignoreMultiPack:!0}})))}const p=await Promise.all(d);l.linkedSheets=p,p.forEach(m=>{m.linkedSheets=[l].concat(l.linkedSheets.filter(g=>g!==m))})}return l},async unload(i,t,e){await e.unload(i.textureSource._sourceOrigin),i.destroy(!1)}}};at.add(om);var bn=/iPhone/i,tl=/iPod/i,el=/iPad/i,sl=/\biOS-universal(?:.+)Mac\b/i,_n=/\bAndroid(?:.+)Mobile\b/i,il=/Android/i,ws=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,nr=/Silk/i,Ee=/Windows Phone/i,rl=/\bWindows(?:.+)ARM\b/i,nl=/BlackBerry/i,al=/BB10/i,ol=/Opera Mini/i,ll=/\b(CriOS|Chrome)(?:.+)Mobile/i,hl=/Mobile(?:.+)Firefox\b/i,cl=function(i){return typeof i<"u"&&i.platform==="MacIntel"&&typeof i.maxTouchPoints=="number"&&i.maxTouchPoints>1&&typeof MSStream>"u"};function lm(i){return function(t){return t.test(i)}}function ul(i){var t={userAgent:"",platform:"",maxTouchPoints:0};!i&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof i=="string"?t.userAgent=i:i&&i.userAgent&&(t={userAgent:i.userAgent,platform:i.platform,maxTouchPoints:i.maxTouchPoints||0});var e=t.userAgent,s=e.split("[FBAN");typeof s[1]<"u"&&(e=s[0]),s=e.split("Twitter"),typeof s[1]<"u"&&(e=s[0]);var r=lm(e),n={apple:{phone:r(bn)&&!r(Ee),ipod:r(tl),tablet:!r(bn)&&(r(el)||cl(t))&&!r(Ee),universal:r(sl),device:(r(bn)||r(tl)||r(el)||r(sl)||cl(t))&&!r(Ee)},amazon:{phone:r(ws),tablet:!r(ws)&&r(nr),device:r(ws)||r(nr)},android:{phone:!r(Ee)&&r(ws)||!r(Ee)&&r(_n),tablet:!r(Ee)&&!r(ws)&&!r(_n)&&(r(nr)||r(il)),device:!r(Ee)&&(r(ws)||r(nr)||r(_n)||r(il))||r(/\bokhttp\b/i)},windows:{phone:r(Ee),tablet:r(rl),device:r(Ee)||r(rl)},other:{blackberry:r(nl),blackberry10:r(al),opera:r(ol),firefox:r(hl),chrome:r(ll),device:r(nl)||r(al)||r(ol)||r(hl)||r(ll)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}const hm=ul.default??ul,Rs=hm(globalThis.navigator),wn=Object.create(null),dl=Object.create(null);function $a(i,t){let e=dl[i];return e===void 0&&(wn[t]===void 0&&(wn[t]=1),dl[i]=e=wn[t]++),e}let vs;function Fc(){return(!vs||vs!=null&&vs.isContextLost())&&(vs=ut.get().createCanvas().getContext("webgl",{})),vs}let ar;function cm(){if(!ar){ar="mediump";const i=Fc();i&&i.getShaderPrecisionFormat&&(ar=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision?"highp":"mediump")}return ar}function um(i,t,e){return t?i:e?(i=i.replace("out vec4 finalColor;",""),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${i}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${i}
        `}function dm(i,t,e){const s=e?t.maxSupportedFragmentPrecision:t.maxSupportedVertexPrecision;if(i.substring(0,9)!=="precision"){let r=e?t.requestedFragmentPrecision:t.requestedVertexPrecision;return r==="highp"&&s!=="highp"&&(r="mediump"),`precision ${r} float;
${i}`}else if(s!=="highp"&&i.substring(0,15)==="precision highp")return i.replace("precision highp","precision mediump");return i}function fm(i,t){return t?`#version 300 es
${i}`:i}const pm={},mm={};function gm(i,{name:t="pixi-program"},e=!0){t=t.replace(/\s+/g,"-"),t+=e?"-fragment":"-vertex";const s=e?pm:mm;return s[t]?(s[t]++,t+=`-${s[t]}`):s[t]=1,i.indexOf("#define SHADER_NAME")!==-1?i:`${`#define SHADER_NAME ${t}`}
${i}`}function xm(i,t){return t?i.replace("#version 300 es",""):i}const vn={stripVersion:xm,ensurePrecision:dm,addProgramDefines:um,setProgramName:gm,insertVersion:fm},Sn=Object.create(null),Ec=class oa{constructor(t){t={...oa.defaultOptions,...t};const e=t.fragment.indexOf("#version 300 es")!==-1,s={stripVersion:e,ensurePrecision:{requestedFragmentPrecision:t.preferredFragmentPrecision,requestedVertexPrecision:t.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:cm()},setProgramName:{name:t.name},addProgramDefines:e,insertVersion:e};let r=t.fragment,n=t.vertex;Object.keys(vn).forEach(a=>{const o=s[a];r=vn[a](r,o,!0),n=vn[a](n,o,!1)}),this.fragment=r,this.vertex=n,this.transformFeedbackVaryings=t.transformFeedbackVaryings,this._key=$a(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(t){const e=`${t.vertex}:${t.fragment}`;return Sn[e]||(Sn[e]=new oa(t)),Sn[e]}};Ec.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let tn=Ec;const fl={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function ym(i){return fl[i]??fl.float32}const bm={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function _m({source:i,entryPoint:t}){const e={},s=i.indexOf(`fn ${t}`);if(s!==-1){const r=i.indexOf("->",s);if(r!==-1){const n=i.substring(s,r),a=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let o;for(;(o=a.exec(n))!==null;){const h=bm[o[3]]??"float32";e[o[2]]={location:parseInt(o[1],10),format:h,stride:ym(h).stride,offset:0,instance:!1,start:0}}}}return e}function An(i){var u,f;const t=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,e=/@group\((\d+)\)/,s=/@binding\((\d+)\)/,r=/var(<[^>]+>)? (\w+)/,n=/:\s*(\w+)/,a=/struct\s+(\w+)\s*{([^}]+)}/g,o=/(\w+)\s*:\s*([\w\<\>]+)/g,h=/struct\s+(\w+)/,l=(u=i.match(t))==null?void 0:u.map(d=>({group:parseInt(d.match(e)[1],10),binding:parseInt(d.match(s)[1],10),name:d.match(r)[2],isUniform:d.match(r)[1]==="<uniform>",type:d.match(n)[1]}));if(!l)return{groups:[],structs:[]};const c=((f=i.match(a))==null?void 0:f.map(d=>{const p=d.match(h)[1],m=d.match(o).reduce((g,_)=>{const[w,b]=_.split(":");return g[w.trim()]=b.trim(),g},{});return m?{name:p,members:m}:null}).filter(({name:d})=>l.some(p=>p.type===d)))??[];return{groups:l,structs:c}}var _i=(i=>(i[i.VERTEX=1]="VERTEX",i[i.FRAGMENT=2]="FRAGMENT",i[i.COMPUTE=4]="COMPUTE",i))(_i||{});function wm({groups:i}){const t=[];for(let e=0;e<i.length;e++){const s=i[e];t[s.group]||(t[s.group]=[]),s.isUniform?t[s.group].push({binding:s.binding,visibility:_i.VERTEX|_i.FRAGMENT,buffer:{type:"uniform"}}):s.type==="sampler"?t[s.group].push({binding:s.binding,visibility:_i.FRAGMENT,sampler:{type:"filtering"}}):s.type==="texture_2d"&&t[s.group].push({binding:s.binding,visibility:_i.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return t}function vm({groups:i}){const t=[];for(let e=0;e<i.length;e++){const s=i[e];t[s.group]||(t[s.group]={}),t[s.group][s.name]=s.binding}return t}function Sm(i,t){const e=new Set,s=new Set,r=[...i.structs,...t.structs].filter(a=>e.has(a.name)?!1:(e.add(a.name),!0)),n=[...i.groups,...t.groups].filter(a=>{const o=`${a.name}-${a.binding}`;return s.has(o)?!1:(s.add(o),!0)});return{structs:r,groups:n}}const Cn=Object.create(null);class js{constructor(t){var o,h;this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:e,vertex:s,layout:r,gpuLayout:n,name:a}=t;if(this.name=a,this.fragment=e,this.vertex=s,e.source===s.source){const l=An(e.source);this.structsAndGroups=l}else{const l=An(s.source),c=An(e.source);this.structsAndGroups=Sm(l,c)}this.layout=r??vm(this.structsAndGroups),this.gpuLayout=n??wm(this.structsAndGroups),this.autoAssignGlobalUniforms=((o=this.layout[0])==null?void 0:o.globalUniforms)!==void 0,this.autoAssignLocalUniforms=((h=this.layout[1])==null?void 0:h.localUniforms)!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:t,fragment:e}=this,s=t.source+e.source+t.entryPoint+e.entryPoint;this._layoutKey=$a(s,"program")}get attributeData(){return this._attributeData??(this._attributeData=_m(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(t){const e=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:${t.vertex.entryPoint}`;return Cn[e]||(Cn[e]=new js(t)),Cn[e]}}const Bc=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],Am=Bc.reduce((i,t)=>(i[t]=!0,i),{});function Cm(i,t){switch(i){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*t);case"vec3<f32>":return new Float32Array(3*t);case"vec4<f32>":return new Float32Array(4*t);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Rc=class Vc{constructor(t,e){this._touched=0,this.uid=Tt("uniform"),this._resourceType="uniformGroup",this._resourceId=Tt("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,e={...Vc.defaultOptions,...e},this.uniformStructures=t;const s={};for(const r in t){const n=t[r];if(n.name=r,n.size=n.size??1,!Am[n.type])throw new Error(`Uniform type ${n.type} is not supported. Supported uniform types are: ${Bc.join(", ")}`);n.value??(n.value=Cm(n.type,n.size)),s[r]=n.value}this.uniforms=s,this._dirtyId=1,this.ubo=e.ubo,this.isStatic=e.isStatic,this._signature=$a(Object.keys(s).map(r=>`${r}-${t[r].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};Rc.defaultOptions={ubo:!1,isStatic:!1};let Oc=Rc;class _r{constructor(t){this.resources=Object.create(null),this._dirty=!0;let e=0;for(const s in t){const r=t[s];this.setResource(r,e++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const t=[];let e=0;for(const s in this.resources)t[e++]=this.resources[s]._resourceId;this._key=t.join("|")}setResource(t,e){var r,n;const s=this.resources[e];t!==s&&(s&&((r=t.off)==null||r.call(t,"change",this.onResourceChange,this)),(n=t.on)==null||n.call(t,"change",this.onResourceChange,this),this.resources[e]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t){const e=this.resources;for(const s in e)e[s]._touched=t}destroy(){var e;const t=this.resources;for(const s in t){const r=t[s];(e=r.off)==null||e.call(r,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(t){if(this._dirty=!0,t.destroyed){const e=this.resources;for(const s in e)e[s]===t&&(e[s]=null)}else this._updateKey()}}var Fi=(i=>(i[i.WEBGL=1]="WEBGL",i[i.WEBGPU=2]="WEBGPU",i[i.BOTH=3]="BOTH",i))(Fi||{});class $i extends Xt{constructor(t){super(),this.uid=Tt("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:e,glProgram:s,groups:r,resources:n,compatibleRenderers:a,groupMap:o}=t;this.gpuProgram=e,this.glProgram=s,a===void 0&&(a=0,e&&(a|=Fi.WEBGPU),s&&(a|=Fi.WEBGL)),this.compatibleRenderers=a;const h={};if(!n&&!r&&(n={}),n&&r)throw new Error("[Shader] Cannot have both resources and groups");if(!e&&r&&!o)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!e&&r&&o)for(const l in o)for(const c in o[l]){const u=o[l][c];h[u]={group:l,binding:c,name:u}}else if(e&&r&&!o){const l=e.structsAndGroups.groups;o={},l.forEach(c=>{o[c.group]=o[c.group]||{},o[c.group][c.binding]=c.name,h[c.name]=c})}else if(n){r={},o={},e&&e.structsAndGroups.groups.forEach(u=>{o[u.group]=o[u.group]||{},o[u.group][u.binding]=u.name,h[u.name]=u});let l=0;for(const c in n)h[c]||(r[99]||(r[99]=new _r,this._ownedBindGroups.push(r[99])),h[c]={group:99,binding:l,name:c},o[99]=o[99]||{},o[99][l]=c,l++);for(const c in n){const u=c;let f=n[c];!f.source&&!f._resourceType&&(f=new Oc(f));const d=h[u];d&&(r[d.group]||(r[d.group]=new _r,this._ownedBindGroups.push(r[d.group])),r[d.group].setResource(f,d.binding))}}this.groups=r,this._uniformBindMap=o,this.resources=this._buildResourceAccessor(r,h)}addResource(t,e,s){var r,n;(r=this._uniformBindMap)[e]||(r[e]={}),(n=this._uniformBindMap[e])[s]||(n[s]=t),this.groups[e]||(this.groups[e]=new _r,this._ownedBindGroups.push(this.groups[e]))}_buildResourceAccessor(t,e){const s={};for(const r in e){const n=e[r];Object.defineProperty(s,n.name,{get(){return t[n.group].getResource(n.binding)},set(a){t[n.group].setResource(a,n.binding)}})}return s}destroy(t=!1){var e,s;this.emit("destroy",this),t&&((e=this.gpuProgram)==null||e.destroy(),(s=this.glProgram)==null||s.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(r=>{r.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(t){const{gpu:e,gl:s,...r}=t;let n,a;return e&&(n=js.from(e)),s&&(a=tn.from(s)),new $i({gpuProgram:n,glProgram:a,...r})}}const Tm={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},Tn=0,Mn=1,Pn=2,kn=3,In=4,Fn=5,la=class Lc{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Tn)}set blend(t){!!(this.data&1<<Tn)!==t&&(this.data^=1<<Tn)}get offsets(){return!!(this.data&1<<Mn)}set offsets(t){!!(this.data&1<<Mn)!==t&&(this.data^=1<<Mn)}set cullMode(t){if(t==="none"){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=t==="front"}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<Pn)}set culling(t){!!(this.data&1<<Pn)!==t&&(this.data^=1<<Pn)}get depthTest(){return!!(this.data&1<<kn)}set depthTest(t){!!(this.data&1<<kn)!==t&&(this.data^=1<<kn)}get depthMask(){return!!(this.data&1<<Fn)}set depthMask(t){!!(this.data&1<<Fn)!==t&&(this.data^=1<<Fn)}get clockwiseFrontFace(){return!!(this.data&1<<In)}set clockwiseFrontFace(t){!!(this.data&1<<In)!==t&&(this.data^=1<<In)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!=="none",this._blendMode=t,this._blendModeId=Tm[t]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new Lc;return t.depthTest=!1,t.blend=!0,t}};la.default2d=la.for2d();let Mm=la;const Dc=class ha extends $i{constructor(t){t={...ha.defaultOptions,...t},super(t),this.enabled=!0,this._state=Mm.for2d(),this.blendMode=t.blendMode,this.padding=t.padding,typeof t.antialias=="boolean"?this.antialias=t.antialias?"on":"off":this.antialias=t.antialias,this.resolution=t.resolution,this.blendRequired=t.blendRequired,this.clipToViewport=t.clipToViewport,this.addResource("uTexture",0,1)}apply(t,e,s,r){t.applyFilter(this,e,s,r)}get blendMode(){return this._state.blendMode}set blendMode(t){this._state.blendMode=t}static from(t){const{gpu:e,gl:s,...r}=t;let n,a;return e&&(n=js.from(e)),s&&(a=tn.from(s)),new ha({gpuProgram:n,glProgram:a,...r})}};Dc.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1,clipToViewport:!0};let Yc=Dc;const ca=[];at.handleByNamedList(X.Environment,ca);async function Pm(i){if(!i)for(let t=0;t<ca.length;t++){const e=ca[t];if(e.value.test()){await e.value.load();return}}}let ri;function km(){if(typeof ri=="boolean")return ri;try{ri=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{ri=!1}return ri}function pl(i,t,e=2){const s=t&&t.length,r=s?t[0]*e:i.length;let n=Xc(i,0,r,e,!0);const a=[];if(!n||n.next===n.prev)return a;let o,h,l;if(s&&(n=Rm(i,t,n,e)),i.length>80*e){o=1/0,h=1/0;let c=-1/0,u=-1/0;for(let f=e;f<r;f+=e){const d=i[f],p=i[f+1];d<o&&(o=d),p<h&&(h=p),d>c&&(c=d),p>u&&(u=p)}l=Math.max(c-o,u-h),l=l!==0?32767/l:0}return Ei(n,a,e,o,h,l,0),a}function Xc(i,t,e,s,r){let n;if(r===Gm(i,t,e,s)>0)for(let a=t;a<e;a+=s)n=ml(a/s|0,i[a],i[a+1],n);else for(let a=e-s;a>=t;a-=s)n=ml(a/s|0,i[a],i[a+1],n);return n&&Ns(n,n.next)&&(Ri(n),n=n.next),n}function ms(i,t){if(!i)return i;t||(t=i);let e=i,s;do if(s=!1,!e.steiner&&(Ns(e,e.next)||bt(e.prev,e,e.next)===0)){if(Ri(e),e=t=e.prev,e===e.next)break;s=!0}else e=e.next;while(s||e!==t);return t}function Ei(i,t,e,s,r,n,a){if(!i)return;!a&&n&&Ym(i,s,r,n);let o=i;for(;i.prev!==i.next;){const h=i.prev,l=i.next;if(n?Fm(i,s,r,n):Im(i)){t.push(h.i,i.i,l.i),Ri(i),i=l.next,o=l.next;continue}if(i=l,i===o){a?a===1?(i=Em(ms(i),t),Ei(i,t,e,s,r,n,2)):a===2&&Bm(i,t,e,s,r,n):Ei(ms(i),t,e,s,r,n,1);break}}}function Im(i){const t=i.prev,e=i,s=i.next;if(bt(t,e,s)>=0)return!1;const r=t.x,n=e.x,a=s.x,o=t.y,h=e.y,l=s.y,c=Math.min(r,n,a),u=Math.min(o,h,l),f=Math.max(r,n,a),d=Math.max(o,h,l);let p=s.next;for(;p!==t;){if(p.x>=c&&p.x<=f&&p.y>=u&&p.y<=d&&wi(r,o,n,h,a,l,p.x,p.y)&&bt(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Fm(i,t,e,s){const r=i.prev,n=i,a=i.next;if(bt(r,n,a)>=0)return!1;const o=r.x,h=n.x,l=a.x,c=r.y,u=n.y,f=a.y,d=Math.min(o,h,l),p=Math.min(c,u,f),m=Math.max(o,h,l),g=Math.max(c,u,f),_=ua(d,p,t,e,s),w=ua(m,g,t,e,s);let b=i.prevZ,y=i.nextZ;for(;b&&b.z>=_&&y&&y.z<=w;){if(b.x>=d&&b.x<=m&&b.y>=p&&b.y<=g&&b!==r&&b!==a&&wi(o,c,h,u,l,f,b.x,b.y)&&bt(b.prev,b,b.next)>=0||(b=b.prevZ,y.x>=d&&y.x<=m&&y.y>=p&&y.y<=g&&y!==r&&y!==a&&wi(o,c,h,u,l,f,y.x,y.y)&&bt(y.prev,y,y.next)>=0))return!1;y=y.nextZ}for(;b&&b.z>=_;){if(b.x>=d&&b.x<=m&&b.y>=p&&b.y<=g&&b!==r&&b!==a&&wi(o,c,h,u,l,f,b.x,b.y)&&bt(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;y&&y.z<=w;){if(y.x>=d&&y.x<=m&&y.y>=p&&y.y<=g&&y!==r&&y!==a&&wi(o,c,h,u,l,f,y.x,y.y)&&bt(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function Em(i,t){let e=i;do{const s=e.prev,r=e.next.next;!Ns(s,r)&&Nc(s,e,e.next,r)&&Bi(s,r)&&Bi(r,s)&&(t.push(s.i,e.i,r.i),Ri(e),Ri(e.next),e=i=r),e=e.next}while(e!==i);return ms(e)}function Bm(i,t,e,s,r,n){let a=i;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&Nm(a,o)){let h=Uc(a,o);a=ms(a,a.next),h=ms(h,h.next),Ei(a,t,e,s,r,n,0),Ei(h,t,e,s,r,n,0);return}o=o.next}a=a.next}while(a!==i)}function Rm(i,t,e,s){const r=[];for(let n=0,a=t.length;n<a;n++){const o=t[n]*s,h=n<a-1?t[n+1]*s:i.length,l=Xc(i,o,h,s,!1);l===l.next&&(l.steiner=!0),r.push(zm(l))}r.sort(Vm);for(let n=0;n<r.length;n++)e=Om(r[n],e);return e}function Vm(i,t){let e=i.x-t.x;if(e===0&&(e=i.y-t.y,e===0)){const s=(i.next.y-i.y)/(i.next.x-i.x),r=(t.next.y-t.y)/(t.next.x-t.x);e=s-r}return e}function Om(i,t){const e=Lm(i,t);if(!e)return t;const s=Uc(e,i);return ms(s,s.next),ms(e,e.next)}function Lm(i,t){let e=t;const s=i.x,r=i.y;let n=-1/0,a;if(Ns(i,e))return e;do{if(Ns(i,e.next))return e.next;if(r<=e.y&&r>=e.next.y&&e.next.y!==e.y){const u=e.x+(r-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(u<=s&&u>n&&(n=u,a=e.x<e.next.x?e:e.next,u===s))return a}e=e.next}while(e!==t);if(!a)return null;const o=a,h=a.x,l=a.y;let c=1/0;e=a;do{if(s>=e.x&&e.x>=h&&s!==e.x&&zc(r<l?s:n,r,h,l,r<l?n:s,r,e.x,e.y)){const u=Math.abs(r-e.y)/(s-e.x);Bi(e,i)&&(u<c||u===c&&(e.x>a.x||e.x===a.x&&Dm(a,e)))&&(a=e,c=u)}e=e.next}while(e!==o);return a}function Dm(i,t){return bt(i.prev,i,t.prev)<0&&bt(t.next,i,i.next)<0}function Ym(i,t,e,s){let r=i;do r.z===0&&(r.z=ua(r.x,r.y,t,e,s)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,Xm(r)}function Xm(i){let t,e=1;do{let s=i,r;i=null;let n=null;for(t=0;s;){t++;let a=s,o=0;for(let l=0;l<e&&(o++,a=a.nextZ,!!a);l++);let h=e;for(;o>0||h>0&&a;)o!==0&&(h===0||!a||s.z<=a.z)?(r=s,s=s.nextZ,o--):(r=a,a=a.nextZ,h--),n?n.nextZ=r:i=r,r.prevZ=n,n=r;s=a}n.nextZ=null,e*=2}while(t>1);return i}function ua(i,t,e,s,r){return i=(i-e)*r|0,t=(t-s)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,i|t<<1}function zm(i){let t=i,e=i;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==i);return e}function zc(i,t,e,s,r,n,a,o){return(r-a)*(t-o)>=(i-a)*(n-o)&&(i-a)*(s-o)>=(e-a)*(t-o)&&(e-a)*(n-o)>=(r-a)*(s-o)}function wi(i,t,e,s,r,n,a,o){return!(i===a&&t===o)&&zc(i,t,e,s,r,n,a,o)}function Nm(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!Um(i,t)&&(Bi(i,t)&&Bi(t,i)&&Wm(i,t)&&(bt(i.prev,i,t.prev)||bt(i,t.prev,t))||Ns(i,t)&&bt(i.prev,i,i.next)>0&&bt(t.prev,t,t.next)>0)}function bt(i,t,e){return(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y)}function Ns(i,t){return i.x===t.x&&i.y===t.y}function Nc(i,t,e,s){const r=lr(bt(i,t,e)),n=lr(bt(i,t,s)),a=lr(bt(e,s,i)),o=lr(bt(e,s,t));return!!(r!==n&&a!==o||r===0&&or(i,e,t)||n===0&&or(i,s,t)||a===0&&or(e,i,s)||o===0&&or(e,t,s))}function or(i,t,e){return t.x<=Math.max(i.x,e.x)&&t.x>=Math.min(i.x,e.x)&&t.y<=Math.max(i.y,e.y)&&t.y>=Math.min(i.y,e.y)}function lr(i){return i>0?1:i<0?-1:0}function Um(i,t){let e=i;do{if(e.i!==i.i&&e.next.i!==i.i&&e.i!==t.i&&e.next.i!==t.i&&Nc(e,e.next,i,t))return!0;e=e.next}while(e!==i);return!1}function Bi(i,t){return bt(i.prev,i,i.next)<0?bt(i,t,i.next)>=0&&bt(i,i.prev,t)>=0:bt(i,t,i.prev)<0||bt(i,i.next,t)<0}function Wm(i,t){let e=i,s=!1;const r=(i.x+t.x)/2,n=(i.y+t.y)/2;do e.y>n!=e.next.y>n&&e.next.y!==e.y&&r<(e.next.x-e.x)*(n-e.y)/(e.next.y-e.y)+e.x&&(s=!s),e=e.next;while(e!==i);return s}function Uc(i,t){const e=da(i.i,i.x,i.y),s=da(t.i,t.x,t.y),r=i.next,n=t.prev;return i.next=t,t.prev=i,e.next=r,r.prev=e,s.next=e,e.prev=s,n.next=s,s.prev=n,s}function ml(i,t,e,s){const r=da(i,t,e);return s?(r.next=s.next,r.prev=s,s.next.prev=r,s.next=r):(r.prev=r,r.next=r),r}function Ri(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function da(i,t,e){return{i,x:t,y:e,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Gm(i,t,e,s){let r=0;for(let n=t,a=e-s;n<e;n+=s)r+=(i[a]-i[n])*(i[n+1]+i[a+1]),a=n;return r}const Hm=pl.default||pl;var Wc=(i=>(i[i.NONE=0]="NONE",i[i.COLOR=16384]="COLOR",i[i.STENCIL=1024]="STENCIL",i[i.DEPTH=256]="DEPTH",i[i.COLOR_DEPTH=16640]="COLOR_DEPTH",i[i.COLOR_STENCIL=17408]="COLOR_STENCIL",i[i.DEPTH_STENCIL=1280]="DEPTH_STENCIL",i[i.ALL=17664]="ALL",i))(Wc||{});class $m{constructor(t){this.items=[],this._name=t}emit(t,e,s,r,n,a,o,h){const{name:l,items:c}=this;for(let u=0,f=c.length;u<f;u++)c[u][l](t,e,s,r,n,a,o,h);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&this.items.splice(e,1),this}contains(t){return this.items.indexOf(t)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const jm=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],Gc=class Hc extends Xt{constructor(t){super(),this.uid=Tt("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name,this.config=t;const e=[...jm,...this.config.runners??[]];this._addRunners(...e),this._unsafeEvalCheck()}async init(t={}){const e=t.skipExtensionImports===!0?!0:t.manageImports===!1;await Pm(e),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const s in this._systemsHash)t={...this._systemsHash[s].constructor.defaultOptions,...t};t={...Hc.defaultOptions,...t},this._roundPixels=t.roundPixels?1:0;for(let s=0;s<this.runners.init.items.length;s++)await this.runners.init.items[s].init(t);this._initOptions=t}render(t,e){let s=t;if(s instanceof ot&&(s={container:s},e&&(q(rt,"passing a second argument is deprecated, please use render options instead"),s.target=e.renderTexture)),s.target||(s.target=this.view.renderTarget),s.target===this.view.renderTarget&&(this._lastObjectRendered=s.container,s.clearColor??(s.clearColor=this.background.colorRgba),s.clear??(s.clear=this.background.clearBeforeRender)),s.clearColor){const r=Array.isArray(s.clearColor)&&s.clearColor.length===4;s.clearColor=r?s.clearColor:St.shared.setValue(s.clearColor).toArray()}s.transform||(s.container.updateLocalTransform(),s.transform=s.container.localTransform),s.container.enableRenderGroup(),this.runners.prerender.emit(s),this.runners.renderStart.emit(s),this.runners.render.emit(s),this.runners.renderEnd.emit(s),this.runners.postrender.emit(s)}resize(t,e,s){const r=this.view.resolution;this.view.resize(t,e,s),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),s!==void 0&&s!==r&&this.runners.resolutionChange.emit(s)}clear(t={}){const e=this;t.target||(t.target=e.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=Wc.ALL);const{clear:s,clearColor:r,target:n}=t;St.shared.setValue(r??this.background.colorRgba),e.renderTarget.clear(n,s,St.shared.toArray())}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach(e=>{this.runners[e]=new $m(e)})}_addSystems(t){let e;for(e in t){const s=t[e];this._addSystem(s.value,s.name)}}_addSystem(t,e){const s=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=s,this._systemsHash[e]=s;for(const r in this.runners)this.runners[r].add(s);return this}_addPipes(t,e){const s=e.reduce((r,n)=>(r[n.name]=n.value,r),{});t.forEach(r=>{const n=r.value,a=r.name,o=s[a];this.renderPipes[a]=new n(this,o?new o:null)})}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!km())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};Gc.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let $c=Gc,hr;function qm(i){return hr!==void 0||(hr=(()=>{var e;const t={stencil:!0,failIfMajorPerformanceCaveat:i??$c.defaultOptions.failIfMajorPerformanceCaveat};try{if(!ut.get().getWebGLRenderingContext())return!1;let r=ut.get().createCanvas().getContext("webgl",t);const n=!!((e=r==null?void 0:r.getContextAttributes())!=null&&e.stencil);if(r){const a=r.getExtension("WEBGL_lose_context");a&&a.loseContext()}return r=null,n}catch{return!1}})()),hr}let cr;async function Km(i={}){return cr!==void 0||(cr=await(async()=>{const t=ut.get().getNavigator().gpu;if(!t)return!1;try{return await(await t.requestAdapter(i)).requestDevice(),!0}catch{return!1}})()),cr}const gl=["webgl","webgpu","canvas"];async function Zm(i){let t=[];i.preference?(t.push(i.preference),gl.forEach(n=>{n!==i.preference&&t.push(n)})):t=gl.slice();let e,s={};for(let n=0;n<t.length;n++){const a=t[n];if(a==="webgpu"&&await Km()){const{WebGPURenderer:o}=await Ar(async()=>{const{WebGPURenderer:h}=await import("./WebGPURenderer-Wu_Zbl5u.js");return{WebGPURenderer:h}},__vite__mapDeps([3,2,4]));e=o,s={...i,...i.webgpu};break}else if(a==="webgl"&&qm(i.failIfMajorPerformanceCaveat??$c.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:o}=await Ar(async()=>{const{WebGLRenderer:h}=await import("./WebGLRenderer-BgEMUbLs.js");return{WebGLRenderer:h}},__vite__mapDeps([5,2,4]));e=o,s={...i,...i.webgl};break}else if(a==="canvas")throw s={...i},new Error("CanvasRenderer is not yet implemented")}if(delete s.webgpu,delete s.webgl,!e)throw new Error("No available renderer for the current environment");const r=new e;return await r.init(s),r}const jc="8.10.1";class qc{static init(){var t;(t=globalThis.__PIXI_APP_INIT__)==null||t.call(globalThis,this,jc)}static destroy(){}}qc.extension=X.Application;class Qm{constructor(t){this._renderer=t}init(){var t;(t=globalThis.__PIXI_RENDERER_INIT__)==null||t.call(globalThis,this._renderer,jc)}destroy(){this._renderer=null}}Qm.extension={type:[X.WebGLSystem,X.WebGPUSystem],name:"initHook",priority:-10};const Kc=class fa{constructor(...t){this.stage=new ot,t[0]!==void 0&&q(rt,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.renderer=await Zm(t),fa._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return q(rt,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,e=!1){const s=fa._plugins.slice(0);s.reverse(),s.forEach(r=>{r.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};Kc._plugins=[];let Zc=Kc;at.handleByList(X.Application,Zc._plugins);at.add(qc);class ja{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this._cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this._cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this._cancelResize();let e,s;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,s=globalThis.innerHeight;else{const{clientWidth:r,clientHeight:n}=this._resizeTo;e=r,s=n}this.renderer.resize(e,s),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this._cancelResize(),this._cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}ja.extension=X.Application;class Qc{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,Cr.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Yt.shared:new Yt,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}Qc.extension=X.Application;class Jc extends Xt{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return q(rt,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return q(rt,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return q(rt,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return q(rt,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return q(rt,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(t=!1){var e;this.emit("destroy",this),this.removeAllListeners();for(const s in this.chars)(e=this.chars[s].texture)==null||e.destroy();this.chars=null,t&&(this.pages.forEach(s=>s.texture.destroy(!0)),this.pages=null)}}const Jm=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function Pr(i){const t=typeof i.fontSize=="number"?`${i.fontSize}px`:i.fontSize;let e=i.fontFamily;Array.isArray(i.fontFamily)||(e=i.fontFamily.split(","));for(let s=e.length-1;s>=0;s--){let r=e[s].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!Jm.includes(r)&&(r=`"${r}"`),e[s]=r}return`${i.fontStyle} ${i.fontVariant} ${i.fontWeight} ${t} ${e.join(",")}`}const En={willReadFrequently:!0},ke=class N{static get experimentalLetterSpacingSupported(){let t=N._experimentalLetterSpacingSupported;if(t===void 0){const e=ut.get().getCanvasRenderingContext2D().prototype;t=N._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,s,r,n,a,o,h,l){this.text=t,this.style=e,this.width=s,this.height=r,this.lines=n,this.lineWidths=a,this.lineHeight=o,this.maxLineWidth=h,this.fontProperties=l}static measureText(t=" ",e,s=N._canvas,r=e.wordWrap){var _;const n=Pr(e),a=N.measureFont(n);a.fontSize===0&&(a.fontSize=e.fontSize,a.ascent=e.fontSize);const o=N.__context;o.font=n;const l=(r?N._wordWrap(t,e,s):t).split(/(?:\r\n|\r|\n)/),c=new Array(l.length);let u=0;for(let w=0;w<l.length;w++){const b=N._measureText(l[w],e.letterSpacing,o);c[w]=b,u=Math.max(u,b)}const f=((_=e._stroke)==null?void 0:_.width)||0;let d=u+f;e.dropShadow&&(d+=e.dropShadow.distance);const p=e.lineHeight||a.fontSize;let m=Math.max(p,a.fontSize+f)+(l.length-1)*(p+e.leading);return e.dropShadow&&(m+=e.dropShadow.distance),new N(t,e,d,m,l,c,p+e.leading,u,a)}static _measureText(t,e,s){let r=!1;N.experimentalLetterSpacingSupported&&(N.experimentalLetterSpacing?(s.letterSpacing=`${e}px`,s.textLetterSpacing=`${e}px`,r=!0):(s.letterSpacing="0px",s.textLetterSpacing="0px"));const n=s.measureText(t);let a=n.width;const o=-n.actualBoundingBoxLeft;let l=n.actualBoundingBoxRight-o;if(a>0)if(r)a-=e,l-=e;else{const c=(N.graphemeSegmenter(t).length-1)*e;a+=c,l+=c}return Math.max(a,l)}static _wordWrap(t,e,s=N._canvas){const r=s.getContext("2d",En);let n=0,a="",o="";const h=Object.create(null),{letterSpacing:l,whiteSpace:c}=e,u=N._collapseSpaces(c),f=N._collapseNewlines(c);let d=!u;const p=e.wordWrapWidth+l,m=N._tokenize(t);for(let g=0;g<m.length;g++){let _=m[g];if(N._isNewline(_)){if(!f){o+=N._addLine(a),d=!u,a="",n=0;continue}_=" "}if(u){const b=N.isBreakingSpace(_),y=N.isBreakingSpace(a[a.length-1]);if(b&&y)continue}const w=N._getFromCache(_,l,h,r);if(w>p)if(a!==""&&(o+=N._addLine(a),a="",n=0),N.canBreakWords(_,e.breakWords)){const b=N.wordWrapSplit(_);for(let y=0;y<b.length;y++){let S=b[y],v=S,A=1;for(;b[y+A];){const T=b[y+A];if(!N.canBreakChars(v,T,_,y,e.breakWords))S+=T;else break;v=T,A++}y+=A-1;const C=N._getFromCache(S,l,h,r);C+n>p&&(o+=N._addLine(a),d=!1,a="",n=0),a+=S,n+=C}}else{a.length>0&&(o+=N._addLine(a),a="",n=0);const b=g===m.length-1;o+=N._addLine(_,!b),d=!1,a="",n=0}else w+n>p&&(d=!1,o+=N._addLine(a),a="",n=0),(a.length>0||!N.isBreakingSpace(_)||d)&&(a+=_,n+=w)}return o+=N._addLine(a,!1),o}static _addLine(t,e=!0){return t=N._trimRight(t),t=e?`${t}
`:t,t}static _getFromCache(t,e,s,r){let n=s[t];return typeof n!="number"&&(n=N._measureText(t,e,r)+e,s[t]=n),n}static _collapseSpaces(t){return t==="normal"||t==="pre-line"}static _collapseNewlines(t){return t==="normal"}static _trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const s=t[e];if(!N.isBreakingSpace(s))break;t=t.slice(0,-1)}return t}static _isNewline(t){return typeof t!="string"?!1:N._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:N._breakingSpaces.includes(t.charCodeAt(0))}static _tokenize(t){const e=[];let s="";if(typeof t!="string")return e;for(let r=0;r<t.length;r++){const n=t[r],a=t[r+1];if(N.isBreakingSpace(n,a)||N._isNewline(n)){s!==""&&(e.push(s),s=""),e.push(n);continue}s+=n}return s!==""&&e.push(s),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,s,r,n){return!0}static wordWrapSplit(t){return N.graphemeSegmenter(t)}static measureFont(t){if(N._fonts[t])return N._fonts[t];const e=N._context;e.font=t;const s=e.measureText(N.METRICS_STRING+N.BASELINE_SYMBOL),r={ascent:s.actualBoundingBoxAscent,descent:s.actualBoundingBoxDescent,fontSize:s.actualBoundingBoxAscent+s.actualBoundingBoxDescent};return N._fonts[t]=r,r}static clearMetrics(t=""){t?delete N._fonts[t]:N._fonts={}}static get _canvas(){if(!N.__canvas){let t;try{const e=new OffscreenCanvas(0,0),s=e.getContext("2d",En);if(s!=null&&s.measureText)return N.__canvas=e,e;t=ut.get().createCanvas()}catch{t=ut.get().createCanvas()}t.width=t.height=10,N.__canvas=t}return N.__canvas}static get _context(){return N.__context||(N.__context=N._canvas.getContext("2d",En)),N.__context}};ke.METRICS_STRING="|ÉqÅ";ke.BASELINE_SYMBOL="M";ke.BASELINE_MULTIPLIER=1.4;ke.HEIGHT_MULTIPLIER=2;ke.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const i=new Intl.Segmenter;return t=>{const e=i.segment(t),s=[];let r=0;for(const n of e)s[r++]=n.segment;return s}}return i=>[...i]})();ke.experimentalLetterSpacing=!1;ke._fonts={};ke._newlines=[10,13];ke._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let Se=ke;const xl=[{offset:0,color:"white"},{offset:1,color:"black"}],qa=class pa{constructor(...t){this.uid=Tt("fillGradient"),this.type="linear",this.colorStops=[];let e=tg(t);e={...e.type==="radial"?pa.defaultRadialOptions:pa.defaultLinearOptions,...sc(e)},this._textureSize=e.textureSize,this._wrapMode=e.wrapMode,e.type==="radial"?(this.center=e.center,this.outerCenter=e.outerCenter??this.center,this.innerRadius=e.innerRadius,this.outerRadius=e.outerRadius,this.scale=e.scale,this.rotation=e.rotation):(this.start=e.start,this.end=e.end),this.textureSpace=e.textureSpace,this.type=e.type,e.colorStops.forEach(r=>{this.addColorStop(r.offset,r.color)})}addColorStop(t,e){return this.colorStops.push({offset:t,color:St.shared.setValue(e).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:t,y:e}=this.start,{x:s,y:r}=this.end,n=s-t,a=r-e;const o=n<0||a<0;if(this._wrapMode==="clamp-to-edge"){if(n<0){const g=t;t=s,s=g,n*=-1}if(a<0){const g=e;e=r,r=g,a*=-1}}const h=this.colorStops.length?this.colorStops:xl,l=this._textureSize,{canvas:c,context:u}=bl(l,1),f=o?u.createLinearGradient(this._textureSize,0,0,0):u.createLinearGradient(0,0,this._textureSize,0);yl(f,h),u.fillStyle=f,u.fillRect(0,0,l,1),this.texture=new U({source:new ps({resource:c,addressMode:this._wrapMode})});const d=Math.sqrt(n*n+a*a),p=Math.atan2(a,n),m=new et;m.scale(d/l,1),m.rotate(p),m.translate(t,e),this.textureSpace==="local"&&m.scale(l,l),this.transform=m}buildGradient(){this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:xl,e=this._textureSize,{canvas:s,context:r}=bl(e,e),{x:n,y:a}=this.center,{x:o,y:h}=this.outerCenter,l=this.innerRadius,c=this.outerRadius,u=o-c,f=h-c,d=e/(c*2),p=(n-u)*d,m=(a-f)*d,g=r.createRadialGradient(p,m,l*d,(o-u)*d,(h-f)*d,c*d);yl(g,t),r.fillStyle=t[t.length-1].color,r.fillRect(0,0,e,e),r.fillStyle=g,r.translate(p,m),r.rotate(this.rotation),r.scale(1,this.scale),r.translate(-p,-m),r.fillRect(0,0,e,e),this.texture=new U({source:new ps({resource:s,addressMode:this._wrapMode})});const _=new et;_.scale(1/d,1/d),_.translate(u,f),this.textureSpace==="local"&&_.scale(e,e),this.transform=_}get styleKey(){return this.uid}destroy(){var t;(t=this.texture)==null||t.destroy(!0),this.texture=null}};qa.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};qa.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let Ye=qa;function yl(i,t){for(let e=0;e<t.length;e++){const s=t[e];i.addColorStop(s.offset,s.color)}}function bl(i,t){const e=ut.get().createCanvas(i,t),s=e.getContext("2d");return{canvas:e,context:s}}function tg(i){let t=i[0]??{};return(typeof t=="number"||i[1])&&(q("8.5.2","use options object instead"),t={type:"linear",start:{x:i[0],y:i[1]},end:{x:i[2],y:i[3]},textureSpace:i[4],textureSize:i[5]??Ye.defaultLinearOptions.textureSize}),t}const _l={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class en{constructor(t,e){this.uid=Tt("fillPattern"),this.transform=new et,this._styleKey=null,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=_l[e].addressModeU,t.source.style.addressModeV=_l[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var Bn,wl;function eg(){if(wl)return Bn;wl=1,Bn=e;var i={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},t=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function e(n){var a=[];return n.replace(t,function(o,h,l){var c=h.toLowerCase();for(l=r(l),c=="m"&&l.length>2&&(a.push([h].concat(l.splice(0,2))),c="l",h=h=="m"?"l":"L");;){if(l.length==i[c])return l.unshift(h),a.push(l);if(l.length<i[c])throw new Error("malformed path data");a.push([h].concat(l.splice(0,i[c])))}}),a}var s=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function r(n){var a=n.match(s);return a?a.map(Number):[]}return Bn}var sg=eg();const ig=Jh(sg);function rg(i,t){const e=ig(i),s=[];let r=null,n=0,a=0;for(let o=0;o<e.length;o++){const h=e[o],l=h[0],c=h;switch(l){case"M":n=c[1],a=c[2],t.moveTo(n,a);break;case"m":n+=c[1],a+=c[2],t.moveTo(n,a);break;case"H":n=c[1],t.lineTo(n,a);break;case"h":n+=c[1],t.lineTo(n,a);break;case"V":a=c[1],t.lineTo(n,a);break;case"v":a+=c[1],t.lineTo(n,a);break;case"L":n=c[1],a=c[2],t.lineTo(n,a);break;case"l":n+=c[1],a+=c[2],t.lineTo(n,a);break;case"C":n=c[5],a=c[6],t.bezierCurveTo(c[1],c[2],c[3],c[4],n,a);break;case"c":t.bezierCurveTo(n+c[1],a+c[2],n+c[3],a+c[4],n+c[5],a+c[6]),n+=c[5],a+=c[6];break;case"S":n=c[3],a=c[4],t.bezierCurveToShort(c[1],c[2],n,a);break;case"s":t.bezierCurveToShort(n+c[1],a+c[2],n+c[3],a+c[4]),n+=c[3],a+=c[4];break;case"Q":n=c[3],a=c[4],t.quadraticCurveTo(c[1],c[2],n,a);break;case"q":t.quadraticCurveTo(n+c[1],a+c[2],n+c[3],a+c[4]),n+=c[3],a+=c[4];break;case"T":n=c[1],a=c[2],t.quadraticCurveToShort(n,a);break;case"t":n+=c[1],a+=c[2],t.quadraticCurveToShort(n,a);break;case"A":n=c[6],a=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],n,a);break;case"a":n+=c[6],a+=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],n,a);break;case"Z":case"z":t.closePath(),s.length>0&&(r=s.pop(),r?(n=r.startX,a=r.startY):(n=0,a=0)),r=null;break;default:mt(`Unknown SVG path command: ${l}`)}l!=="Z"&&l!=="z"&&r===null&&(r={startX:n,startY:a},s.push(r))}return t}class Ka{constructor(t=0,e=0,s=0){this.type="circle",this.x=t,this.y=e,this.radius=s}clone(){return new Ka(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const s=this.radius*this.radius;let r=this.x-t,n=this.y-e;return r*=r,n*=n,r+n<=s}strokeContains(t,e,s,r=.5){if(this.radius===0)return!1;const n=this.x-t,a=this.y-e,o=this.radius,h=(1-r)*s,l=Math.sqrt(n*n+a*a);return l<=o+h&&l>o-(s-h)}getBounds(t){return t||(t=new pt),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Za{constructor(t=0,e=0,s=0,r=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=s,this.halfHeight=r}clone(){return new Za(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let s=(t-this.x)/this.halfWidth,r=(e-this.y)/this.halfHeight;return s*=s,r*=r,s+r<=1}strokeContains(t,e,s,r=.5){const{halfWidth:n,halfHeight:a}=this;if(n<=0||a<=0)return!1;const o=s*(1-r),h=s-o,l=n-h,c=a-h,u=n+o,f=a+o,d=t-this.x,p=e-this.y,m=d*d/(l*l)+p*p/(c*c),g=d*d/(u*u)+p*p/(f*f);return m>1&&g<=1}getBounds(t){return t||(t=new pt),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function ng(i,t,e,s,r,n){const a=i-e,o=t-s,h=r-e,l=n-s,c=a*h+o*l,u=h*h+l*l;let f=-1;u!==0&&(f=c/u);let d,p;f<0?(d=e,p=s):f>1?(d=r,p=n):(d=e+f*h,p=s+f*l);const m=i-d,g=t-p;return m*m+g*g}let ag,og;class Ti{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const s=[];for(let r=0,n=e.length;r<n;r++)s.push(e[r].x,e[r].y);e=s}this.points=e,this.closePath=!0}isClockwise(){let t=0;const e=this.points,s=e.length;for(let r=0;r<s;r+=2){const n=e[r],a=e[r+1],o=e[(r+2)%s],h=e[(r+3)%s];t+=(o-n)*(h+a)}return t<0}containsPolygon(t){const e=this.getBounds(ag),s=t.getBounds(og);if(!e.containsRect(s))return!1;const r=t.points;for(let n=0;n<r.length;n+=2){const a=r[n],o=r[n+1];if(!this.contains(a,o))return!1}return!0}clone(){const t=this.points.slice(),e=new Ti(t);return e.closePath=this.closePath,e}contains(t,e){let s=!1;const r=this.points.length/2;for(let n=0,a=r-1;n<r;a=n++){const o=this.points[n*2],h=this.points[n*2+1],l=this.points[a*2],c=this.points[a*2+1];h>e!=c>e&&t<(l-o)*((e-h)/(c-h))+o&&(s=!s)}return s}strokeContains(t,e,s,r=.5){const n=s*s,a=n*(1-r),o=n-a,{points:h}=this,l=h.length-(this.closePath?0:2);for(let c=0;c<l;c+=2){const u=h[c],f=h[c+1],d=h[(c+2)%h.length],p=h[(c+3)%h.length],m=ng(t,e,u,f,d,p),g=Math.sign((d-u)*(e-f)-(p-f)*(t-u));if(m<=(g<0?o:a))return!0}return!1}getBounds(t){t||(t=new pt);const e=this.points;let s=1/0,r=-1/0,n=1/0,a=-1/0;for(let o=0,h=e.length;o<h;o+=2){const l=e[o],c=e[o+1];s=l<s?l:s,r=l>r?l:r,n=c<n?c:n,a=c>a?c:a}return t.x=s,t.width=r-s,t.y=n,t.height=a-n,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const ur=(i,t,e,s,r,n,a)=>{const o=i-e,h=t-s,l=Math.sqrt(o*o+h*h);return l>=r-n&&l<=r+a};class Qa{constructor(t=0,e=0,s=0,r=0,n=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=s,this.height=r,this.radius=n}getBounds(t){return t||(t=new pt),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new Qa(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+s&&e<=this.y+this.height-s||t>=this.x+s&&t<=this.x+this.width-s)return!0;let r=t-(this.x+s),n=e-(this.y+s);const a=s*s;if(r*r+n*n<=a||(r=t-(this.x+this.width-s),r*r+n*n<=a)||(n=e-(this.y+this.height-s),r*r+n*n<=a)||(r=t-(this.x+s),r*r+n*n<=a))return!0}return!1}strokeContains(t,e,s,r=.5){const{x:n,y:a,width:o,height:h,radius:l}=this,c=s*(1-r),u=s-c,f=n+l,d=a+l,p=o-l*2,m=h-l*2,g=n+o,_=a+h;return(t>=n-c&&t<=n+u||t>=g-u&&t<=g+c)&&e>=d&&e<=d+m||(e>=a-c&&e<=a+u||e>=_-u&&e<=_+c)&&t>=f&&t<=f+p?!0:t<f&&e<d&&ur(t,e,f,d,l,u,c)||t>g-l&&e<d&&ur(t,e,g-l,d,l,u,c)||t>g-l&&e>_-l&&ur(t,e,g-l,_-l,l,u,c)||t<f&&e>_-l&&ur(t,e,f,_-l,l,u,c)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const tu={};function lg(i,t,e){let s=2166136261;for(let r=0;r<t;r++)s^=i[r].uid,s=Math.imul(s,16777619),s>>>=0;return tu[s]||hg(i,t,s,e)}function hg(i,t,e,s){const r={};let n=0;for(let o=0;o<s;o++){const h=o<t?i[o]:U.EMPTY.source;r[n++]=h.source,r[n++]=h.style}const a=new _r(r);return tu[e]=a,a}class vl{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}function ma(i,t){const e=i.byteLength/8|0,s=new Float64Array(i,0,e);new Float64Array(t,0,e).set(s);const n=i.byteLength-e*8;if(n>0){const a=new Uint8Array(i,e*8,n);new Uint8Array(t,e*8,n).set(a)}}const cg={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var ug=(i=>(i[i.DISABLED=0]="DISABLED",i[i.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",i[i.MASK_ACTIVE=2]="MASK_ACTIVE",i[i.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",i[i.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",i[i.NONE=5]="NONE",i))(ug||{});function Sl(i,t){return t.alphaMode==="no-premultiply-alpha"&&cg[i]||i}const dg=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function fg(i){let t="";for(let e=0;e<i;++e)e>0&&(t+=`
else `),e<i-1&&(t+=`if(test == ${e}.0){}`);return t}function pg(i,t){if(i===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);try{for(;;){const s=dg.replace(/%forloop%/gi,fg(i));if(t.shaderSource(e,s),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))i=i/2|0;else break}}finally{t.deleteShader(e)}return i}let Ss=null;function mg(){var t;if(Ss)return Ss;const i=Fc();return Ss=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),Ss=pg(Ss,i),(t=i.getExtension("WEBGL_lose_context"))==null||t.loseContext(),Ss}class gg{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const e=this.textures[t];this.textures[t]=null,this.ids[e.uid]=null}this.count=0}}class xg{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new gg,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const eu=[];let ga=0;function Al(){return ga>0?eu[--ga]:new xg}function Cl(i){eu[ga++]=i}let ni=0;const su=class iu{constructor(t){this.uid=Tt("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],t={...iu.defaultOptions,...t},t.maxTextures||(q("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),t.maxTextures=mg());const{maxTextures:e,attributesInitialSize:s,indicesInitialSize:r}=t;this.attributeBuffer=new vl(s*4),this.indexBuffer=new Uint16Array(r),this.maxTextures=e}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)Cl(this.batches[t]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t._indexStart=this.indexSize,t._attributeStart=this.attributeSize,t._batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,e){const s=t._batch.textures.ids[e._source.uid];return!s&&s!==0?!1:(t._textureId=s,t.texture=e,!0)}updateElement(t){this.dirty=!0;const e=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId):this.packAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId)}break(t){const e=this._elements;if(!e[this.elementStart])return;let s=Al(),r=s.textures;r.clear();const n=e[this.elementStart];let a=Sl(n.blendMode,n.texture._source),o=n.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const h=this.attributeBuffer.float32View,l=this.attributeBuffer.uint32View,c=this.indexBuffer;let u=this._batchIndexSize,f=this._batchIndexStart,d="startBatch";const p=this.maxTextures;for(let m=this.elementStart;m<this.elementSize;++m){const g=e[m];e[m]=null;const w=g.texture._source,b=Sl(g.blendMode,w),y=a!==b||o!==g.topology;if(w._batchTick===ni&&!y){g._textureId=w._textureBindLocation,u+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,h,l,g._attributeStart,g._textureId),this.packQuadIndex(c,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,h,l,g._attributeStart,g._textureId),this.packIndex(g,c,g._indexStart,g._attributeStart/this.vertexSize)),g._batch=s;continue}w._batchTick=ni,(r.count>=p||y)&&(this._finishBatch(s,f,u-f,r,a,o,t,d),d="renderBatch",f=u,a=b,o=g.topology,s=Al(),r=s.textures,r.clear(),++ni),g._textureId=w._textureBindLocation=r.count,r.ids[w.uid]=r.count,r.textures[r.count++]=w,g._batch=s,u+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,h,l,g._attributeStart,g._textureId),this.packQuadIndex(c,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,h,l,g._attributeStart,g._textureId),this.packIndex(g,c,g._indexStart,g._attributeStart/this.vertexSize))}r.count>0&&(this._finishBatch(s,f,u-f,r,a,o,t,d),f=u,++ni),this.elementStart=this.elementSize,this._batchIndexStart=f,this._batchIndexSize=u}_finishBatch(t,e,s,r,n,a,o,h){t.gpuBindGroup=null,t.bindGroup=null,t.action=h,t.batcher=this,t.textures=r,t.blendMode=n,t.topology=a,t.start=e,t.size=s,++ni,this.batches[this.batchIndex++]=t,o.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){t*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(t*4)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const e=Math.max(t,this.attributeBuffer.size*2),s=new vl(e);ma(this.attributeBuffer.rawBinaryData,s.rawBinaryData),this.attributeBuffer=s}_resizeIndexBuffer(t){const e=this.indexBuffer;let s=Math.max(t,e.length*1.5);s+=s%2;const r=s>65535?new Uint32Array(s):new Uint16Array(s);if(r.BYTES_PER_ELEMENT!==e.BYTES_PER_ELEMENT)for(let n=0;n<e.length;n++)r[n]=e[n];else ma(e.buffer,r.buffer);this.indexBuffer=r}packQuadIndex(t,e,s){t[e]=s+0,t[e+1]=s+1,t[e+2]=s+2,t[e+3]=s+0,t[e+4]=s+2,t[e+5]=s+3}packIndex(t,e,s,r){const n=t.indices,a=t.indexSize,o=t.indexOffset,h=t.attributeOffset;for(let l=0;l<a;l++)e[s++]=r+n[l+o]-h}destroy(){for(let t=0;t<this.batches.length;t++)Cl(this.batches[t]);this.batches=null;for(let t=0;t<this._elements.length;t++)this._elements[t]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};su.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let ru=su;var ft=(i=>(i[i.MAP_READ=1]="MAP_READ",i[i.MAP_WRITE=2]="MAP_WRITE",i[i.COPY_SRC=4]="COPY_SRC",i[i.COPY_DST=8]="COPY_DST",i[i.INDEX=16]="INDEX",i[i.VERTEX=32]="VERTEX",i[i.UNIFORM=64]="UNIFORM",i[i.STORAGE=128]="STORAGE",i[i.INDIRECT=256]="INDIRECT",i[i.QUERY_RESOLVE=512]="QUERY_RESOLVE",i[i.STATIC=1024]="STATIC",i))(ft||{});class Te extends Xt{constructor(t){let{data:e,size:s}=t;const{usage:r,label:n,shrinkToFit:a}=t;super(),this.uid=Tt("buffer"),this._resourceType="buffer",this._resourceId=Tt("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,e instanceof Array&&(e=new Float32Array(e)),this._data=e,s??(s=e==null?void 0:e.byteLength);const o=!!e;this.descriptor={size:s,usage:r,mappedAtCreation:o,label:n},this.shrinkToFit=a??!0}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&ft.STATIC)}set static(t){t?this.descriptor.usage|=ft.STATIC:this.descriptor.usage&=~ft.STATIC}setDataWithSize(t,e,s){if(this._updateID++,this._updateSize=e*t.BYTES_PER_ELEMENT,this._data===t){s&&this.emit("update",this);return}const r=this._data;if(this._data=t,this._dataInt32=null,!r||r.length!==t.length){!this.shrinkToFit&&r&&t.byteLength<r.byteLength?s&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=Tt("resource"),this.emit("change",this));return}s&&this.emit("update",this)}update(t){this._updateSize=t??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function nu(i,t){if(!(i instanceof Te)){let e=t?ft.INDEX:ft.VERTEX;i instanceof Array&&(t?(i=new Uint32Array(i),e=ft.INDEX|ft.COPY_DST):(i=new Float32Array(i),e=ft.VERTEX|ft.COPY_DST)),i=new Te({data:i,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:e})}return i}function yg(i,t,e){const s=i.getAttribute(t);if(!s)return e.minX=0,e.minY=0,e.maxX=0,e.maxY=0,e;const r=s.buffer.data;let n=1/0,a=1/0,o=-1/0,h=-1/0;const l=r.BYTES_PER_ELEMENT,c=(s.offset||0)/l,u=(s.stride||2*4)/l;for(let f=c;f<r.length;f+=u){const d=r[f],p=r[f+1];d>o&&(o=d),p>h&&(h=p),d<n&&(n=d),p<a&&(a=p)}return e.minX=n,e.minY=a,e.maxX=o,e.maxY=h,e}function bg(i){return(i instanceof Te||Array.isArray(i)||i.BYTES_PER_ELEMENT)&&(i={buffer:i}),i.buffer=nu(i.buffer,!1),i}class Ja extends Xt{constructor(t={}){super(),this.uid=Tt("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new pe,this._boundsDirty=!0;const{attributes:e,indexBuffer:s,topology:r}=t;if(this.buffers=[],this.attributes={},e)for(const n in e)this.addAttribute(n,e[n]);this.instanceCount=t.instanceCount??1,s&&this.addIndex(s),this.topology=r||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const e=this.attributes[t];return e.buffer.data.length/(e.stride/4||e.size)}return 0}addAttribute(t,e){const s=bg(e);this.buffers.indexOf(s.buffer)===-1&&(this.buffers.push(s.buffer),s.buffer.on("update",this.onBufferUpdate,this),s.buffer.on("change",this.onBufferUpdate,this)),this.attributes[t]=s}addIndex(t){this.indexBuffer=nu(t,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,yg(this,"aPosition",this._bounds)):this._bounds}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(e=>e.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const _g=new Float32Array(1),wg=new Uint32Array(1);class vg extends Ja{constructor(){const e=new Te({data:_g,label:"attribute-batch-buffer",usage:ft.VERTEX|ft.COPY_DST,shrinkToFit:!1}),s=new Te({data:wg,label:"index-batch-buffer",usage:ft.INDEX|ft.COPY_DST,shrinkToFit:!1}),r=6*4;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:r,offset:0},aUV:{buffer:e,format:"float32x2",stride:r,offset:2*4},aColor:{buffer:e,format:"unorm8x4",stride:r,offset:4*4},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:r,offset:5*4}},indexBuffer:s})}}function Tl(i,t,e){if(i)for(const s in i){const r=s.toLocaleLowerCase(),n=t[r];if(n){let a=i[s];s==="header"&&(a=a.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),e&&n.push(`//----${e}----//`),n.push(a)}else mt(`${s} placement hook does not exist in shader`)}}const Sg=/\{\{(.*?)\}\}/g;function Ml(i){var s;const t={};return(((s=i.match(Sg))==null?void 0:s.map(r=>r.replace(/[{()}]/g,"")))??[]).forEach(r=>{t[r]=[]}),t}function Pl(i,t){let e;const s=/@in\s+([^;]+);/g;for(;(e=s.exec(i))!==null;)t.push(e[1])}function kl(i,t,e=!1){const s=[];Pl(t,s),i.forEach(o=>{o.header&&Pl(o.header,s)});const r=s;e&&r.sort();const n=r.map((o,h)=>`       @location(${h}) ${o},`).join(`
`);let a=t.replace(/@in\s+[^;]+;\s*/g,"");return a=a.replace("{{in}}",`
${n}
`),a}function Il(i,t){let e;const s=/@out\s+([^;]+);/g;for(;(e=s.exec(i))!==null;)t.push(e[1])}function Ag(i){const e=/\b(\w+)\s*:/g.exec(i);return e?e[1]:""}function Cg(i){const t=/@.*?\s+/g;return i.replace(t,"")}function Tg(i,t){const e=[];Il(t,e),i.forEach(h=>{h.header&&Il(h.header,e)});let s=0;const r=e.sort().map(h=>h.indexOf("builtin")>-1?h:`@location(${s++}) ${h}`).join(`,
`),n=e.sort().map(h=>`       var ${Cg(h)};`).join(`
`),a=`return VSOutput(
            ${e.sort().map(h=>` ${Ag(h)}`).join(`,
`)});`;let o=t.replace(/@out\s+[^;]+;\s*/g,"");return o=o.replace("{{struct}}",`
${r}
`),o=o.replace("{{start}}",`
${n}
`),o=o.replace("{{return}}",`
${a}
`),o}function Fl(i,t){let e=i;for(const s in t){const r=t[s];r.join(`
`).length?e=e.replace(`{{${s}}}`,`//-----${s} START-----//
${r.join(`
`)}
//----${s} FINISH----//`):e=e.replace(`{{${s}}}`,"")}return e}const qe=Object.create(null),Rn=new Map;let Mg=0;function Pg({template:i,bits:t}){const e=au(i,t);if(qe[e])return qe[e];const{vertex:s,fragment:r}=Ig(i,t);return qe[e]=ou(s,r,t),qe[e]}function kg({template:i,bits:t}){const e=au(i,t);return qe[e]||(qe[e]=ou(i.vertex,i.fragment,t)),qe[e]}function Ig(i,t){const e=t.map(a=>a.vertex).filter(a=>!!a),s=t.map(a=>a.fragment).filter(a=>!!a);let r=kl(e,i.vertex,!0);r=Tg(e,r);const n=kl(s,i.fragment,!0);return{vertex:r,fragment:n}}function au(i,t){return t.map(e=>(Rn.has(e)||Rn.set(e,Mg++),Rn.get(e))).sort((e,s)=>e-s).join("-")+i.vertex+i.fragment}function ou(i,t,e){const s=Ml(i),r=Ml(t);return e.forEach(n=>{Tl(n.vertex,s,n.name),Tl(n.fragment,r,n.name)}),{vertex:Fl(i,s),fragment:Fl(t,r)}}const Fg=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,Eg=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,Bg=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,Rg=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,Vg={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},Og={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function lu({bits:i,name:t}){const e=Pg({template:{fragment:Eg,vertex:Fg},bits:[Vg,...i]});return js.from({name:t,vertex:{source:e.vertex,entryPoint:"main"},fragment:{source:e.fragment,entryPoint:"main"}})}function hu({bits:i,name:t}){return new tn({name:t,...kg({template:{vertex:Bg,fragment:Rg},bits:[Og,...i]})})}const cu={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},uu={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},Vn={};function Lg(i){const t=[];if(i===1)t.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),t.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let e=0;for(let s=0;s<i;s++)t.push(`@group(1) @binding(${e++}) var textureSource${s+1}: texture_2d<f32>;`),t.push(`@group(1) @binding(${e++}) var textureSampler${s+1}: sampler;`)}return t.join(`
`)}function Dg(i){const t=[];if(i===1)t.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{t.push("switch vTextureId {");for(let e=0;e<i;e++)e===i-1?t.push("  default:{"):t.push(`  case ${e}:{`),t.push(`      outColor = textureSampleGrad(textureSource${e+1}, textureSampler${e+1}, vUV, uvDx, uvDy);`),t.push("      break;}");t.push("}")}return t.join(`
`)}function du(i){return Vn[i]||(Vn[i]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${Lg(i)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${Dg(i)}
            `}}),Vn[i]}const On={};function Yg(i){const t=[];for(let e=0;e<i;e++)e>0&&t.push("else"),e<i-1&&t.push(`if(vTextureId < ${e}.5)`),t.push("{"),t.push(`	outColor = texture(uTextures[${e}], vUV);`),t.push("}");return t.join(`
`)}function fu(i){return On[i]||(On[i]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${i}];

            `,main:`

                ${Yg(i)}
            `}}),On[i]}const pu={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},mu={name:"round-pixels-bit",vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},El={};function gu(i){let t=El[i];if(t)return t;const e=new Int32Array(i);for(let s=0;s<i;s++)e[s]=s;return t=El[i]=new Oc({uTextures:{value:e,type:"i32",size:i}},{isStatic:!0}),t}class Xg extends $i{constructor(t){const e=hu({name:"batch",bits:[uu,fu(t),mu]}),s=lu({name:"batch",bits:[cu,du(t),pu]});super({glProgram:e,gpuProgram:s,resources:{batchSamplers:gu(t)}})}}let Ln=null;const xu=class yu extends ru{constructor(t){super(t),this.geometry=new vg,this.name=yu.extension.name,this.vertexSize=6,Ln??(Ln=new Xg(t.maxTextures)),this.shader=Ln}packAttributes(t,e,s,r,n){const a=n<<16|t.roundPixels&65535,o=t.transform,h=o.a,l=o.b,c=o.c,u=o.d,f=o.tx,d=o.ty,{positions:p,uvs:m}=t,g=t.color,_=t.attributeOffset,w=_+t.attributeSize;for(let b=_;b<w;b++){const y=b*2,S=p[y],v=p[y+1];e[r++]=h*S+c*v+f,e[r++]=u*v+l*S+d,e[r++]=m[y],e[r++]=m[y+1],s[r++]=g,s[r++]=a}}packQuadAttributes(t,e,s,r,n){const a=t.texture,o=t.transform,h=o.a,l=o.b,c=o.c,u=o.d,f=o.tx,d=o.ty,p=t.bounds,m=p.maxX,g=p.minX,_=p.maxY,w=p.minY,b=a.uvs,y=t.color,S=n<<16|t.roundPixels&65535;e[r+0]=h*g+c*w+f,e[r+1]=u*w+l*g+d,e[r+2]=b.x0,e[r+3]=b.y0,s[r+4]=y,s[r+5]=S,e[r+6]=h*m+c*w+f,e[r+7]=u*w+l*m+d,e[r+8]=b.x1,e[r+9]=b.y1,s[r+10]=y,s[r+11]=S,e[r+12]=h*m+c*_+f,e[r+13]=u*_+l*m+d,e[r+14]=b.x2,e[r+15]=b.y2,s[r+16]=y,s[r+17]=S,e[r+18]=h*g+c*_+f,e[r+19]=u*_+l*g+d,e[r+20]=b.x3,e[r+21]=b.y3,s[r+22]=y,s[r+23]=S}};xu.extension={type:[X.Batcher],name:"default"};let zg=xu;function Ng(i,t,e,s,r,n,a,o=null){let h=0;e*=t,r*=n;const l=o.a,c=o.b,u=o.c,f=o.d,d=o.tx,p=o.ty;for(;h<a;){const m=i[e],g=i[e+1];s[r]=l*m+u*g+d,s[r+1]=c*m+f*g+p,r+=n,e+=t,h++}}function Ug(i,t,e,s){let r=0;for(t*=e;r<s;)i[t]=0,i[t+1]=0,t+=e,r++}function bu(i,t,e,s,r){const n=t.a,a=t.b,o=t.c,h=t.d,l=t.tx,c=t.ty;e||(e=0),s||(s=2),r||(r=i.length/s-e);let u=e*s;for(let f=0;f<r;f++){const d=i[u],p=i[u+1];i[u]=n*d+o*p+l,i[u+1]=a*d+h*p+c,u+=s}}const Wg=new et;class _u{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,e=t>>16|t&65280|(t&255)<<16,s=this.renderable;return s?dc(e,s.groupColor)+(this.alpha*s.groupAlpha*255<<24):e+(this.alpha*255<<24)}get transform(){var t;return((t=this.renderable)==null?void 0:t.groupTransform)||Wg}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}}const Vi={extension:{type:X.ShapeBuilder,name:"circle"},build(i,t){let e,s,r,n,a,o;if(i.type==="circle"){const y=i;if(a=o=y.radius,a<=0)return!1;e=y.x,s=y.y,r=n=0}else if(i.type==="ellipse"){const y=i;if(a=y.halfWidth,o=y.halfHeight,a<=0||o<=0)return!1;e=y.x,s=y.y,r=n=0}else{const y=i,S=y.width/2,v=y.height/2;e=y.x+S,s=y.y+v,a=o=Math.max(0,Math.min(y.radius,Math.min(S,v))),r=S-a,n=v-o}if(r<0||n<0)return!1;const h=Math.ceil(2.3*Math.sqrt(a+o)),l=h*8+(r?4:0)+(n?4:0);if(l===0)return!1;if(h===0)return t[0]=t[6]=e+r,t[1]=t[3]=s+n,t[2]=t[4]=e-r,t[5]=t[7]=s-n,!0;let c=0,u=h*4+(r?2:0)+2,f=u,d=l,p=r+a,m=n,g=e+p,_=e-p,w=s+m;if(t[c++]=g,t[c++]=w,t[--u]=w,t[--u]=_,n){const y=s-m;t[f++]=_,t[f++]=y,t[--d]=y,t[--d]=g}for(let y=1;y<h;y++){const S=Math.PI/2*(y/h),v=r+Math.cos(S)*a,A=n+Math.sin(S)*o,C=e+v,T=e-v,P=s+A,M=s-A;t[c++]=C,t[c++]=P,t[--u]=P,t[--u]=T,t[f++]=T,t[f++]=M,t[--d]=M,t[--d]=C}p=r,m=n+o,g=e+p,_=e-p,w=s+m;const b=s-m;return t[c++]=g,t[c++]=w,t[--d]=b,t[--d]=g,r&&(t[c++]=_,t[c++]=w,t[--d]=b,t[--d]=_),!0},triangulate(i,t,e,s,r,n){if(i.length===0)return;let a=0,o=0;for(let c=0;c<i.length;c+=2)a+=i[c],o+=i[c+1];a/=i.length/2,o/=i.length/2;let h=s;t[h*e]=a,t[h*e+1]=o;const l=h++;for(let c=0;c<i.length;c+=2)t[h*e]=i[c],t[h*e+1]=i[c+1],c>0&&(r[n++]=h,r[n++]=l,r[n++]=h-1),h++;r[n++]=l+1,r[n++]=l,r[n++]=h-1}},Gg={...Vi,extension:{...Vi.extension,name:"ellipse"}},Hg={...Vi,extension:{...Vi.extension,name:"roundedRectangle"}},wu=1e-4,Bl=1e-4;function $g(i){const t=i.length;if(t<6)return 1;let e=0;for(let s=0,r=i[t-2],n=i[t-1];s<t;s+=2){const a=i[s],o=i[s+1];e+=(a-r)*(o+n),r=a,n=o}return e<0?-1:1}function Rl(i,t,e,s,r,n,a,o){const h=i-e*r,l=t-s*r,c=i+e*n,u=t+s*n;let f,d;a?(f=s,d=-e):(f=-s,d=e);const p=h+f,m=l+d,g=c+f,_=u+d;return o.push(p,m),o.push(g,_),2}function Je(i,t,e,s,r,n,a,o){const h=e-i,l=s-t;let c=Math.atan2(h,l),u=Math.atan2(r-i,n-t);o&&c<u?c+=Math.PI*2:!o&&c>u&&(u+=Math.PI*2);let f=c;const d=u-c,p=Math.abs(d),m=Math.sqrt(h*h+l*l),g=(15*p*Math.sqrt(m)/Math.PI>>0)+1,_=d/g;if(f+=_,o){a.push(i,t),a.push(e,s);for(let w=1,b=f;w<g;w++,b+=_)a.push(i,t),a.push(i+Math.sin(b)*m,t+Math.cos(b)*m);a.push(i,t),a.push(r,n)}else{a.push(e,s),a.push(i,t);for(let w=1,b=f;w<g;w++,b+=_)a.push(i+Math.sin(b)*m,t+Math.cos(b)*m),a.push(i,t);a.push(r,n),a.push(i,t)}return g*2}function jg(i,t,e,s,r,n){const a=wu;if(i.length===0)return;const o=t;let h=o.alignment;if(t.alignment!==.5){let L=$g(i);h=(h-.5)*L+.5}const l=new Dt(i[0],i[1]),c=new Dt(i[i.length-2],i[i.length-1]),u=s,f=Math.abs(l.x-c.x)<a&&Math.abs(l.y-c.y)<a;if(u){i=i.slice(),f&&(i.pop(),i.pop(),c.set(i[i.length-2],i[i.length-1]));const L=(l.x+c.x)*.5,H=(c.y+l.y)*.5;i.unshift(L,H),i.push(L,H)}const d=r,p=i.length/2;let m=i.length;const g=d.length/2,_=o.width/2,w=_*_,b=o.miterLimit*o.miterLimit;let y=i[0],S=i[1],v=i[2],A=i[3],C=0,T=0,P=-(S-A),M=y-v,B=0,F=0,I=Math.sqrt(P*P+M*M);P/=I,M/=I,P*=_,M*=_;const E=h,R=(1-E)*2,O=E*2;u||(o.cap==="round"?m+=Je(y-P*(R-O)*.5,S-M*(R-O)*.5,y-P*R,S-M*R,y+P*O,S+M*O,d,!0)+2:o.cap==="square"&&(m+=Rl(y,S,P,M,R,O,!0,d))),d.push(y-P*R,S-M*R),d.push(y+P*O,S+M*O);for(let L=1;L<p-1;++L){y=i[(L-1)*2],S=i[(L-1)*2+1],v=i[L*2],A=i[L*2+1],C=i[(L+1)*2],T=i[(L+1)*2+1],P=-(S-A),M=y-v,I=Math.sqrt(P*P+M*M),P/=I,M/=I,P*=_,M*=_,B=-(A-T),F=v-C,I=Math.sqrt(B*B+F*F),B/=I,F/=I,B*=_,F*=_;const H=v-y,Z=S-A,J=v-C,z=T-A,$=H*J+Z*z,G=Z*J-z*H,gt=G<0;if(Math.abs(G)<.001*Math.abs($)){d.push(v-P*R,A-M*R),d.push(v+P*O,A+M*O),$>=0&&(o.join==="round"?m+=Je(v,A,v-P*R,A-M*R,v-B*R,A-F*R,d,!1)+4:m+=2,d.push(v-B*O,A-F*O),d.push(v+B*R,A+F*R));continue}const _t=(-P+y)*(-M+A)-(-P+v)*(-M+S),nt=(-B+C)*(-F+A)-(-B+v)*(-F+T),lt=(H*nt-J*_t)/G,At=(z*_t-Z*nt)/G,Qt=(lt-v)*(lt-v)+(At-A)*(At-A),Ht=v+(lt-v)*R,ye=A+(At-A)*R,Jt=v-(lt-v)*O,ae=A-(At-A)*O,Qi=Math.min(H*H+Z*Z,J*J+z*z),ei=gt?R:O,bs=Qi+ei*ei*w;Qt<=bs?o.join==="bevel"||Qt/w>b?(gt?(d.push(Ht,ye),d.push(v+P*O,A+M*O),d.push(Ht,ye),d.push(v+B*O,A+F*O)):(d.push(v-P*R,A-M*R),d.push(Jt,ae),d.push(v-B*R,A-F*R),d.push(Jt,ae)),m+=2):o.join==="round"?gt?(d.push(Ht,ye),d.push(v+P*O,A+M*O),m+=Je(v,A,v+P*O,A+M*O,v+B*O,A+F*O,d,!0)+4,d.push(Ht,ye),d.push(v+B*O,A+F*O)):(d.push(v-P*R,A-M*R),d.push(Jt,ae),m+=Je(v,A,v-P*R,A-M*R,v-B*R,A-F*R,d,!1)+4,d.push(v-B*R,A-F*R),d.push(Jt,ae)):(d.push(Ht,ye),d.push(Jt,ae)):(d.push(v-P*R,A-M*R),d.push(v+P*O,A+M*O),o.join==="round"?gt?m+=Je(v,A,v+P*O,A+M*O,v+B*O,A+F*O,d,!0)+2:m+=Je(v,A,v-P*R,A-M*R,v-B*R,A-F*R,d,!1)+2:o.join==="miter"&&Qt/w<=b&&(gt?(d.push(Jt,ae),d.push(Jt,ae)):(d.push(Ht,ye),d.push(Ht,ye)),m+=2),d.push(v-B*R,A-F*R),d.push(v+B*O,A+F*O),m+=2)}y=i[(p-2)*2],S=i[(p-2)*2+1],v=i[(p-1)*2],A=i[(p-1)*2+1],P=-(S-A),M=y-v,I=Math.sqrt(P*P+M*M),P/=I,M/=I,P*=_,M*=_,d.push(v-P*R,A-M*R),d.push(v+P*O,A+M*O),u||(o.cap==="round"?m+=Je(v-P*(R-O)*.5,A-M*(R-O)*.5,v-P*R,A-M*R,v+P*O,A+M*O,d,!1)+2:o.cap==="square"&&(m+=Rl(v,A,P,M,R,O,!1,d)));const W=Bl*Bl;for(let L=g;L<m+g-2;++L)y=d[L*2],S=d[L*2+1],v=d[(L+1)*2],A=d[(L+1)*2+1],C=d[(L+2)*2],T=d[(L+2)*2+1],!(Math.abs(y*(A-T)+v*(T-S)+C*(S-A))<W)&&n.push(L,L+1,L+2)}function qg(i,t,e,s){const r=wu;if(i.length===0)return;const n=i[0],a=i[1],o=i[i.length-2],h=i[i.length-1],l=t||Math.abs(n-o)<r&&Math.abs(a-h)<r,c=e,u=i.length/2,f=c.length/2;for(let d=0;d<u;d++)c.push(i[d*2]),c.push(i[d*2+1]);for(let d=0;d<u-1;d++)s.push(f+d,f+d+1);l&&s.push(f+u-1,f)}function vu(i,t,e,s,r,n,a){const o=Hm(i,t,2);if(!o)return;for(let l=0;l<o.length;l+=3)n[a++]=o[l]+r,n[a++]=o[l+1]+r,n[a++]=o[l+2]+r;let h=r*s;for(let l=0;l<i.length;l+=2)e[h]=i[l],e[h+1]=i[l+1],h+=s}const Kg=[],Zg={extension:{type:X.ShapeBuilder,name:"polygon"},build(i,t){for(let e=0;e<i.points.length;e++)t[e]=i.points[e];return!0},triangulate(i,t,e,s,r,n){vu(i,Kg,t,e,s,r,n)}},Qg={extension:{type:X.ShapeBuilder,name:"rectangle"},build(i,t){const e=i,s=e.x,r=e.y,n=e.width,a=e.height;return n>0&&a>0?(t[0]=s,t[1]=r,t[2]=s+n,t[3]=r,t[4]=s+n,t[5]=r+a,t[6]=s,t[7]=r+a,!0):!1},triangulate(i,t,e,s,r,n){let a=0;s*=e,t[s+a]=i[0],t[s+a+1]=i[1],a+=e,t[s+a]=i[2],t[s+a+1]=i[3],a+=e,t[s+a]=i[6],t[s+a+1]=i[7],a+=e,t[s+a]=i[4],t[s+a+1]=i[5],a+=e;const o=s/e;r[n++]=o,r[n++]=o+1,r[n++]=o+2,r[n++]=o+1,r[n++]=o+3,r[n++]=o+2}},Jg={extension:{type:X.ShapeBuilder,name:"triangle"},build(i,t){return t[0]=i.x,t[1]=i.y,t[2]=i.x2,t[3]=i.y2,t[4]=i.x3,t[5]=i.y3,!0},triangulate(i,t,e,s,r,n){let a=0;s*=e,t[s+a]=i[0],t[s+a+1]=i[1],a+=e,t[s+a]=i[2],t[s+a+1]=i[3],a+=e,t[s+a]=i[4],t[s+a+1]=i[5];const o=s/e;r[n++]=o,r[n++]=o+1,r[n++]=o+2}},t0=new et,e0=new pt;function s0(i,t,e,s){const r=t.matrix?i.copyFrom(t.matrix).invert():i.identity();if(t.textureSpace==="local"){const a=e.getBounds(e0);t.width&&a.pad(t.width);const{x:o,y:h}=a,l=1/a.width,c=1/a.height,u=-o*l,f=-h*c,d=r.a,p=r.b,m=r.c,g=r.d;r.a*=l,r.b*=l,r.c*=c,r.d*=c,r.tx=u*d+f*m+r.tx,r.ty=u*p+f*g+r.ty}else r.translate(t.texture.frame.x,t.texture.frame.y),r.scale(1/t.texture.source.width,1/t.texture.source.height);const n=t.texture.source.style;return!(t.fill instanceof Ye)&&n.addressMode==="clamp-to-edge"&&(n.addressMode="repeat",n.update()),s&&r.append(t0.copyFrom(s).invert()),r}const sn={};at.handleByMap(X.ShapeBuilder,sn);at.add(Qg,Zg,Jg,Vi,Gg,Hg);const i0=new pt,r0=new et;function n0(i,t){const{geometryData:e,batches:s}=t;s.length=0,e.indices.length=0,e.vertices.length=0,e.uvs.length=0;for(let r=0;r<i.instructions.length;r++){const n=i.instructions[r];if(n.action==="texture")a0(n.data,s,e);else if(n.action==="fill"||n.action==="stroke"){const a=n.action==="stroke",o=n.data.path.shapePath,h=n.data.style,l=n.data.hole;a&&l&&Vl(l.shapePath,h,!0,s,e),l&&(o.shapePrimitives[o.shapePrimitives.length-1].holes=l.shapePath.shapePrimitives),Vl(o,h,a,s,e)}}}function a0(i,t,e){const s=[],r=sn.rectangle,n=i0;n.x=i.dx,n.y=i.dy,n.width=i.dw,n.height=i.dh;const a=i.transform;if(!r.build(n,s))return;const{vertices:o,uvs:h,indices:l}=e,c=l.length,u=o.length/2;a&&bu(s,a),r.triangulate(s,o,2,u,l,c);const f=i.image,d=f.uvs;h.push(d.x0,d.y0,d.x1,d.y1,d.x3,d.y3,d.x2,d.y2);const p=Ce.get(_u);p.indexOffset=c,p.indexSize=l.length-c,p.attributeOffset=u,p.attributeSize=o.length/2-u,p.baseColor=i.style,p.alpha=i.alpha,p.texture=f,p.geometryData=e,t.push(p)}function Vl(i,t,e,s,r){const{vertices:n,uvs:a,indices:o}=r;i.shapePrimitives.forEach(({shape:h,transform:l,holes:c})=>{const u=[],f=sn[h.type];if(!f.build(h,u))return;const d=o.length,p=n.length/2;let m="triangle-list";if(l&&bu(u,l),e){const b=h.closePath??!0,y=t;y.pixelLine?(qg(u,b,n,o),m="line-list"):jg(u,y,!1,b,n,o)}else if(c){const b=[],y=u.slice();o0(c).forEach(v=>{b.push(y.length/2),y.push(...v)}),vu(y,b,n,2,p,o,d)}else f.triangulate(u,n,2,p,o,d);const g=a.length/2,_=t.texture;if(_!==U.WHITE){const b=s0(r0,t,h,l);Ng(n,2,p,a,g,2,n.length/2-p,b)}else Ug(a,g,2,n.length/2-p);const w=Ce.get(_u);w.indexOffset=d,w.indexSize=o.length-d,w.attributeOffset=p,w.attributeSize=n.length/2-p,w.baseColor=t.color,w.alpha=t.alpha,w.texture=_,w.geometryData=r,w.topology=m,s.push(w)})}function o0(i){const t=[];for(let e=0;e<i.length;e++){const s=i[e].shape,r=[];sn[s.type].build(s,r)&&t.push(r)}return t}class l0{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class h0{constructor(){this.instructions=new gc}init(t){this.batcher=new zg({maxTextures:t}),this.instructions.reset()}get geometry(){return q(pp,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const to=class xa{constructor(t){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._renderer=t,t.renderableGC.addManagedHash(this,"_gpuContextHash"),t.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(t){xa.defaultOptions.bezierSmoothness=(t==null?void 0:t.bezierSmoothness)??xa.defaultOptions.bezierSmoothness}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let e=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){e?this._cleanGraphicsContextData(t):e=this._initContext(t),n0(t,e);const s=t.batchMode;t.customShader||s==="no-batch"?e.isBatchable=!1:s==="auto"?e.isBatchable=e.geometryData.vertices.length<400:e.isBatchable=!0,t.dirty=!1}return e}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_initContextRenderData(t){const e=Ce.get(h0,{maxTextures:this._renderer.limits.maxBatchableTextures}),{batches:s,geometryData:r}=this._gpuContextHash[t.uid],n=r.vertices.length,a=r.indices.length;for(let c=0;c<s.length;c++)s[c].applyTransform=!1;const o=e.batcher;o.ensureAttributeBuffer(n),o.ensureIndexBuffer(a),o.begin();for(let c=0;c<s.length;c++){const u=s[c];o.add(u)}o.finish(e.instructions);const h=o.geometry;h.indexBuffer.setDataWithSize(o.indexBuffer,o.indexSize,!0),h.buffers[0].setDataWithSize(o.attributeBuffer.float32View,o.attributeSize,!0);const l=o.batches;for(let c=0;c<l.length;c++){const u=l[c];u.bindGroup=lg(u.textures.textures,u.textures.count,this._renderer.limits.maxBatchableTextures)}return this._graphicsDataContextHash[t.uid]=e,e}_initContext(t){const e=new l0;return e.context=t,this._gpuContextHash[t.uid]=e,t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const e=this._gpuContextHash[t.uid];e.isBatchable||this._graphicsDataContextHash[t.uid]&&(Ce.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),e.batches&&e.batches.forEach(s=>{Ce.return(s)})}destroy(){for(const t in this._gpuContextHash)this._gpuContextHash[t]&&this.onGraphicsContextDestroy(this._gpuContextHash[t].context)}};to.extension={type:[X.WebGLSystem,X.WebGPUSystem,X.CanvasSystem],name:"graphicsContext"};to.defaultOptions={bezierSmoothness:.5};let Su=to;const c0=8,dr=11920929e-14,u0=1;function Au(i,t,e,s,r,n,a,o,h,l){const u=Math.min(.99,Math.max(0,l??Su.defaultOptions.bezierSmoothness));let f=(u0-u)/1;return f*=f,d0(t,e,s,r,n,a,o,h,i,f),i}function d0(i,t,e,s,r,n,a,o,h,l){ya(i,t,e,s,r,n,a,o,h,l,0),h.push(a,o)}function ya(i,t,e,s,r,n,a,o,h,l,c){if(c>c0)return;const u=(i+e)/2,f=(t+s)/2,d=(e+r)/2,p=(s+n)/2,m=(r+a)/2,g=(n+o)/2,_=(u+d)/2,w=(f+p)/2,b=(d+m)/2,y=(p+g)/2,S=(_+b)/2,v=(w+y)/2;if(c>0){let A=a-i,C=o-t;const T=Math.abs((e-a)*C-(s-o)*A),P=Math.abs((r-a)*C-(n-o)*A);if(T>dr&&P>dr){if((T+P)*(T+P)<=l*(A*A+C*C)){h.push(S,v);return}}else if(T>dr){if(T*T<=l*(A*A+C*C)){h.push(S,v);return}}else if(P>dr){if(P*P<=l*(A*A+C*C)){h.push(S,v);return}}else if(A=S-(i+a)/2,C=v-(t+o)/2,A*A+C*C<=l){h.push(S,v);return}}ya(i,t,u,f,_,w,S,v,h,l,c+1),ya(S,v,b,y,m,g,a,o,h,l,c+1)}const f0=8,p0=11920929e-14,m0=1;function g0(i,t,e,s,r,n,a,o){const l=Math.min(.99,Math.max(0,o??Su.defaultOptions.bezierSmoothness));let c=(m0-l)/1;return c*=c,x0(t,e,s,r,n,a,i,c),i}function x0(i,t,e,s,r,n,a,o){ba(a,i,t,e,s,r,n,o,0),a.push(r,n)}function ba(i,t,e,s,r,n,a,o,h){if(h>f0)return;const l=(t+s)/2,c=(e+r)/2,u=(s+n)/2,f=(r+a)/2,d=(l+u)/2,p=(c+f)/2;let m=n-t,g=a-e;const _=Math.abs((s-n)*g-(r-a)*m);if(_>p0){if(_*_<=o*(m*m+g*g)){i.push(d,p);return}}else if(m=d-(t+n)/2,g=p-(e+a)/2,m*m+g*g<=o){i.push(d,p);return}ba(i,t,e,l,c,d,p,o,h+1),ba(i,d,p,u,f,n,a,o,h+1)}function Cu(i,t,e,s,r,n,a,o){let h=Math.abs(r-n);(!a&&r>n||a&&n>r)&&(h=2*Math.PI-h),o||(o=Math.max(6,Math.floor(6*Math.pow(s,1/3)*(h/Math.PI)))),o=Math.max(o,3);let l=h/o,c=r;l*=a?-1:1;for(let u=0;u<o+1;u++){const f=Math.cos(c),d=Math.sin(c),p=t+f*s,m=e+d*s;i.push(p,m),c+=l}}function y0(i,t,e,s,r,n){const a=i[i.length-2],h=i[i.length-1]-e,l=a-t,c=r-e,u=s-t,f=Math.abs(h*u-l*c);if(f<1e-8||n===0){(i[i.length-2]!==t||i[i.length-1]!==e)&&i.push(t,e);return}const d=h*h+l*l,p=c*c+u*u,m=h*c+l*u,g=n*Math.sqrt(d)/f,_=n*Math.sqrt(p)/f,w=g*m/d,b=_*m/p,y=g*u+_*l,S=g*c+_*h,v=l*(_+w),A=h*(_+w),C=u*(g+b),T=c*(g+b),P=Math.atan2(A-S,v-y),M=Math.atan2(T-S,C-y);Cu(i,y+t,S+e,n,P,M,l*c>u*h)}const Mi=Math.PI*2,Dn={centerX:0,centerY:0,ang1:0,ang2:0},Yn=({x:i,y:t},e,s,r,n,a,o,h)=>{i*=e,t*=s;const l=r*i-n*t,c=n*i+r*t;return h.x=l+a,h.y=c+o,h};function b0(i,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),s=t===1.5707963267948966?.551915024494:e,r=Math.cos(i),n=Math.sin(i),a=Math.cos(i+t),o=Math.sin(i+t);return[{x:r-n*s,y:n+r*s},{x:a+o*s,y:o-a*s},{x:a,y:o}]}const Ol=(i,t,e,s)=>{const r=i*s-t*e<0?-1:1;let n=i*e+t*s;return n>1&&(n=1),n<-1&&(n=-1),r*Math.acos(n)},_0=(i,t,e,s,r,n,a,o,h,l,c,u,f)=>{const d=Math.pow(r,2),p=Math.pow(n,2),m=Math.pow(c,2),g=Math.pow(u,2);let _=d*p-d*g-p*m;_<0&&(_=0),_/=d*g+p*m,_=Math.sqrt(_)*(a===o?-1:1);const w=_*r/n*u,b=_*-n/r*c,y=l*w-h*b+(i+e)/2,S=h*w+l*b+(t+s)/2,v=(c-w)/r,A=(u-b)/n,C=(-c-w)/r,T=(-u-b)/n,P=Ol(1,0,v,A);let M=Ol(v,A,C,T);o===0&&M>0&&(M-=Mi),o===1&&M<0&&(M+=Mi),f.centerX=y,f.centerY=S,f.ang1=P,f.ang2=M};function w0(i,t,e,s,r,n,a,o=0,h=0,l=0){if(n===0||a===0)return;const c=Math.sin(o*Mi/360),u=Math.cos(o*Mi/360),f=u*(t-s)/2+c*(e-r)/2,d=-c*(t-s)/2+u*(e-r)/2;if(f===0&&d===0)return;n=Math.abs(n),a=Math.abs(a);const p=Math.pow(f,2)/Math.pow(n,2)+Math.pow(d,2)/Math.pow(a,2);p>1&&(n*=Math.sqrt(p),a*=Math.sqrt(p)),_0(t,e,s,r,n,a,h,l,c,u,f,d,Dn);let{ang1:m,ang2:g}=Dn;const{centerX:_,centerY:w}=Dn;let b=Math.abs(g)/(Mi/4);Math.abs(1-b)<1e-7&&(b=1);const y=Math.max(Math.ceil(b),1);g/=y;let S=i[i.length-2],v=i[i.length-1];const A={x:0,y:0};for(let C=0;C<y;C++){const T=b0(m,g),{x:P,y:M}=Yn(T[0],n,a,u,c,_,w,A),{x:B,y:F}=Yn(T[1],n,a,u,c,_,w,A),{x:I,y:E}=Yn(T[2],n,a,u,c,_,w,A);Au(i,S,v,P,M,B,F,I,E),S=I,v=E,m+=g}}function v0(i,t,e){const s=(a,o)=>{const h=o.x-a.x,l=o.y-a.y,c=Math.sqrt(h*h+l*l),u=h/c,f=l/c;return{len:c,nx:u,ny:f}},r=(a,o)=>{a===0?i.moveTo(o.x,o.y):i.lineTo(o.x,o.y)};let n=t[t.length-1];for(let a=0;a<t.length;a++){const o=t[a%t.length],h=o.radius??e;if(h<=0){r(a,o),n=o;continue}const l=t[(a+1)%t.length],c=s(o,n),u=s(o,l);if(c.len<1e-4||u.len<1e-4){r(a,o),n=o;continue}let f=Math.asin(c.nx*u.ny-c.ny*u.nx),d=1,p=!1;c.nx*u.nx-c.ny*-u.ny<0?f<0?f=Math.PI+f:(f=Math.PI-f,d=-1,p=!0):f>0&&(d=-1,p=!0);const m=f/2;let g,_=Math.abs(Math.cos(m)*h/Math.sin(m));_>Math.min(c.len/2,u.len/2)?(_=Math.min(c.len/2,u.len/2),g=Math.abs(_*Math.sin(m)/Math.cos(m))):g=h;const w=o.x+u.nx*_+-u.ny*g*d,b=o.y+u.ny*_+u.nx*g*d,y=Math.atan2(c.ny,c.nx)+Math.PI/2*d,S=Math.atan2(u.ny,u.nx)-Math.PI/2*d;a===0&&i.moveTo(w+Math.cos(y)*g,b+Math.sin(y)*g),i.arc(w,b,g,y,S,p),n=o}}function S0(i,t,e,s){const r=(o,h)=>Math.sqrt((o.x-h.x)**2+(o.y-h.y)**2),n=(o,h,l)=>({x:o.x+(h.x-o.x)*l,y:o.y+(h.y-o.y)*l}),a=t.length;for(let o=0;o<a;o++){const h=t[(o+1)%a],l=h.radius??e;if(l<=0){o===0?i.moveTo(h.x,h.y):i.lineTo(h.x,h.y);continue}const c=t[o],u=t[(o+2)%a],f=r(c,h);let d;if(f<1e-4)d=h;else{const g=Math.min(f/2,l);d=n(h,c,g/f)}const p=r(u,h);let m;if(p<1e-4)m=h;else{const g=Math.min(p/2,l);m=n(h,u,g/p)}o===0?i.moveTo(d.x,d.y):i.lineTo(d.x,d.y),i.quadraticCurveTo(h.x,h.y,m.x,m.y,s)}}const A0=new pt;class C0{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new pe,this._graphicsPath2D=t,this.signed=t.checkForHoles}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const s=this._currentPoly.points,r=s[s.length-2],n=s[s.length-1];return(r!==t||n!==e)&&s.push(t,e),this}arc(t,e,s,r,n,a){this._ensurePoly(!1);const o=this._currentPoly.points;return Cu(o,t,e,s,r,n,a),this}arcTo(t,e,s,r,n){this._ensurePoly();const a=this._currentPoly.points;return y0(a,t,e,s,r,n),this}arcToSvg(t,e,s,r,n,a,o){const h=this._currentPoly.points;return w0(h,this._currentPoly.lastX,this._currentPoly.lastY,a,o,t,e,s,r,n),this}bezierCurveTo(t,e,s,r,n,a,o){this._ensurePoly();const h=this._currentPoly;return Au(this._currentPoly.points,h.lastX,h.lastY,t,e,s,r,n,a,o),this}quadraticCurveTo(t,e,s,r,n){this._ensurePoly();const a=this._currentPoly;return g0(this._currentPoly.points,a.lastX,a.lastY,t,e,s,r,n),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));const s=this.shapePrimitives,r=s.length;for(let n=0;n<t.instructions.length;n++){const a=t.instructions[n];this[a.action](...a.data)}if(t.checkForHoles&&s.length-r>1){let n=null;for(let a=r;a<s.length;a++){const o=s[a];if(o.shape.type==="polygon"){const h=o.shape,l=n==null?void 0:n.shape;l&&l.containsPolygon(h)?(n.holes||(n.holes=[]),n.holes.push(o),s.copyWithin(a,a+1),s.length--,a--):n=o}}}return this}finish(t=!1){this.endPoly(t)}rect(t,e,s,r,n){return this.drawShape(new pt(t,e,s,r),n),this}circle(t,e,s,r){return this.drawShape(new Ka(t,e,s),r),this}poly(t,e,s){const r=new Ti(t);return r.closePath=e,this.drawShape(r,s),this}regularPoly(t,e,s,r,n=0,a){r=Math.max(r|0,3);const o=-1*Math.PI/2+n,h=Math.PI*2/r,l=[];for(let c=0;c<r;c++){const u=o-c*h;l.push(t+s*Math.cos(u),e+s*Math.sin(u))}return this.poly(l,!0,a),this}roundPoly(t,e,s,r,n,a=0,o){if(r=Math.max(r|0,3),n<=0)return this.regularPoly(t,e,s,r,a);const h=s*Math.sin(Math.PI/r)-.001;n=Math.min(n,h);const l=-1*Math.PI/2+a,c=Math.PI*2/r,u=(r-2)*Math.PI/r/2;for(let f=0;f<r;f++){const d=f*c+l,p=t+s*Math.cos(d),m=e+s*Math.sin(d),g=d+Math.PI+u,_=d-Math.PI-u,w=p+n*Math.cos(g),b=m+n*Math.sin(g),y=p+n*Math.cos(_),S=m+n*Math.sin(_);f===0?this.moveTo(w,b):this.lineTo(w,b),this.quadraticCurveTo(p,m,y,S,o)}return this.closePath()}roundShape(t,e,s=!1,r){return t.length<3?this:(s?S0(this,t,e,r):v0(this,t,e),this.closePath())}filletRect(t,e,s,r,n){if(n===0)return this.rect(t,e,s,r);const a=Math.min(s,r)/2,o=Math.min(a,Math.max(-a,n)),h=t+s,l=e+r,c=o<0?-o:0,u=Math.abs(o);return this.moveTo(t,e+u).arcTo(t+c,e+c,t+u,e,u).lineTo(h-u,e).arcTo(h-c,e+c,h,e+u,u).lineTo(h,l-u).arcTo(h-c,l-c,t+s-u,l,u).lineTo(t+u,l).arcTo(t+c,l-c,t,l-u,u).closePath()}chamferRect(t,e,s,r,n,a){if(n<=0)return this.rect(t,e,s,r);const o=Math.min(n,Math.min(s,r)/2),h=t+s,l=e+r,c=[t+o,e,h-o,e,h,e+o,h,l-o,h-o,l,t+o,l,t,l-o,t,e+o];for(let u=c.length-1;u>=2;u-=2)c[u]===c[u-2]&&c[u-1]===c[u-3]&&c.splice(u-1,2);return this.poly(c,!0,a)}ellipse(t,e,s,r,n){return this.drawShape(new Za(t,e,s,r),n),this}roundRect(t,e,s,r,n,a){return this.drawShape(new Qa(t,e,s,r,n),a),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let s=this._currentPoly;return s&&this.endPoly(),s=new Ti,s.points.push(t,e),this._currentPoly=s,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new Ti,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let s=e.shape.x,r=e.shape.y;if(e.transform&&!e.transform.isIdentity()){const n=e.transform,a=s;s=n.a*s+n.c*r+n.tx,r=n.b*a+n.d*r+n.ty}this._currentPoly.points.push(s,r)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const s=t.instructions[e];this[s.action](...s.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let s=0;s<e.length;s++){const r=e[s],n=r.shape.getBounds(A0);r.transform?t.addRect(n,r.transform):t.addRect(n)}return t}}class Us{constructor(t,e=!1){this.instructions=[],this.uid=Tt("graphicsPath"),this._dirty=!0,this.checkForHoles=e,typeof t=="string"?rg(t,this):this.instructions=(t==null?void 0:t.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new C0(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,s,r,n){const a=this.instructions[this.instructions.length-1],o=this.getLastPoint(Dt.shared);let h=0,l=0;if(!a||a.action!=="bezierCurveTo")h=o.x,l=o.y;else{h=a.data[2],l=a.data[3];const c=o.x,u=o.y;h=c+(c-h),l=u+(u-l)}return this.instructions.push({action:"bezierCurveTo",data:[h,l,t,e,s,r,n]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,s){const r=this.instructions[this.instructions.length-1],n=this.getLastPoint(Dt.shared);let a=0,o=0;if(!r||r.action!=="quadraticCurveTo")a=n.x,o=n.y;else{a=r.data[0],o=r.data[1];const h=n.x,l=n.y;a=h+(h-a),o=l+(l-o)}return this.instructions.push({action:"quadraticCurveTo",data:[a,o,t,e,s]}),this._dirty=!0,this}rect(t,e,s,r,n){return this.instructions.push({action:"rect",data:[t,e,s,r,n]}),this._dirty=!0,this}circle(t,e,s,r){return this.instructions.push({action:"circle",data:[t,e,s,r]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,s,r,n,a,o){n||(n=r/2);const h=-1*Math.PI/2+a,l=s*2,c=Math.PI*2/l,u=[];for(let f=0;f<l;f++){const d=f%2?n:r,p=f*c+h;u.push(t+d*Math.cos(p),e+d*Math.sin(p))}return this.poly(u,!0,o),this}clone(t=!1){const e=new Us;if(e.checkForHoles=this.checkForHoles,!t)e.instructions=this.instructions.slice();else for(let s=0;s<this.instructions.length;s++){const r=this.instructions[s];e.instructions.push({action:r.action,data:r.data.slice()})}return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,s=t.b,r=t.c,n=t.d,a=t.tx,o=t.ty;let h=0,l=0,c=0,u=0,f=0,d=0,p=0,m=0;for(let g=0;g<this.instructions.length;g++){const _=this.instructions[g],w=_.data;switch(_.action){case"moveTo":case"lineTo":h=w[0],l=w[1],w[0]=e*h+r*l+a,w[1]=s*h+n*l+o;break;case"bezierCurveTo":c=w[0],u=w[1],f=w[2],d=w[3],h=w[4],l=w[5],w[0]=e*c+r*u+a,w[1]=s*c+n*u+o,w[2]=e*f+r*d+a,w[3]=s*f+n*d+o,w[4]=e*h+r*l+a,w[5]=s*h+n*l+o;break;case"quadraticCurveTo":c=w[0],u=w[1],h=w[2],l=w[3],w[0]=e*c+r*u+a,w[1]=s*c+n*u+o,w[2]=e*h+r*l+a,w[3]=s*h+n*l+o;break;case"arcToSvg":h=w[5],l=w[6],p=w[0],m=w[1],w[0]=e*p+r*m,w[1]=s*p+n*m,w[5]=e*h+r*l+a,w[6]=s*h+n*l+o;break;case"circle":w[4]=ai(w[3],t);break;case"rect":w[4]=ai(w[4],t);break;case"ellipse":w[8]=ai(w[8],t);break;case"roundRect":w[5]=ai(w[5],t);break;case"addPath":w[0].transform(t);break;case"poly":w[2]=ai(w[2],t);break;default:mt("unknown transform action",_.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,s=this.instructions[e];if(!s)return t.x=0,t.y=0,t;for(;s.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;s=this.instructions[e]}switch(s.action){case"moveTo":case"lineTo":t.x=s.data[0],t.y=s.data[1];break;case"quadraticCurveTo":t.x=s.data[2],t.y=s.data[3];break;case"bezierCurveTo":t.x=s.data[4],t.y=s.data[5];break;case"arc":case"arcToSvg":t.x=s.data[5],t.y=s.data[6];break;case"addPath":s.data[0].getLastPoint(t);break}return t}}function ai(i,t){return i?i.prepend(t):t.clone()}function wt(i,t,e){const s=i.getAttribute(t);return s?Number(s):e}function T0(i,t){const e=i.querySelectorAll("defs");for(let s=0;s<e.length;s++){const r=e[s];for(let n=0;n<r.children.length;n++){const a=r.children[n];switch(a.nodeName.toLowerCase()){case"lineargradient":t.defs[a.id]=M0(a);break;case"radialgradient":t.defs[a.id]=P0();break}}}}function M0(i){const t=wt(i,"x1",0),e=wt(i,"y1",0),s=wt(i,"x2",1),r=wt(i,"y2",0),n=i.getAttribute("gradientUnits")||"objectBoundingBox",a=new Ye(t,e,s,r,n==="objectBoundingBox"?"local":"global");for(let o=0;o<i.children.length;o++){const h=i.children[o],l=wt(h,"offset",0),c=St.shared.setValue(h.getAttribute("stop-color")).toNumber();a.addColorStop(l,c)}return a}function P0(i){return mt("[SVG Parser] Radial gradients are not yet supported"),new Ye(0,0,1,0)}function Ll(i){const t=i.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return t?t[1]:""}const Dl={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function Tu(i,t){const e=i.getAttribute("style"),s={},r={},n={strokeStyle:s,fillStyle:r,useFill:!1,useStroke:!1};for(const a in Dl){const o=i.getAttribute(a);o&&Yl(t,n,a,o.trim())}if(e){const a=e.split(";");for(let o=0;o<a.length;o++){const h=a[o].trim(),[l,c]=h.split(":");Dl[l]&&Yl(t,n,l,c.trim())}}return{strokeStyle:n.useStroke?s:null,fillStyle:n.useFill?r:null,useFill:n.useFill,useStroke:n.useStroke}}function Yl(i,t,e,s){switch(e){case"stroke":if(s!=="none"){if(s.startsWith("url(")){const r=Ll(s);t.strokeStyle.fill=i.defs[r]}else t.strokeStyle.color=St.shared.setValue(s).toNumber();t.useStroke=!0}break;case"stroke-width":t.strokeStyle.width=Number(s);break;case"fill":if(s!=="none"){if(s.startsWith("url(")){const r=Ll(s);t.fillStyle.fill=i.defs[r]}else t.fillStyle.color=St.shared.setValue(s).toNumber();t.useFill=!0}break;case"fill-opacity":t.fillStyle.alpha=Number(s);break;case"stroke-opacity":t.strokeStyle.alpha=Number(s);break;case"opacity":t.fillStyle.alpha=Number(s),t.strokeStyle.alpha=Number(s);break}}function k0(i,t){if(typeof i=="string"){const a=document.createElement("div");a.innerHTML=i.trim(),i=a.querySelector("svg")}const e={context:t,defs:{},path:new Us};T0(i,e);const s=i.children,{fillStyle:r,strokeStyle:n}=Tu(i,e);for(let a=0;a<s.length;a++){const o=s[a];o.nodeName.toLowerCase()!=="defs"&&Mu(o,e,r,n)}return t}function Mu(i,t,e,s){const r=i.children,{fillStyle:n,strokeStyle:a}=Tu(i,t);n&&e?e={...e,...n}:n&&(e=n),a&&s?s={...s,...a}:a&&(s=a);const o=!e&&!s;o&&(e={color:0});let h,l,c,u,f,d,p,m,g,_,w,b,y,S,v,A,C;switch(i.nodeName.toLowerCase()){case"path":S=i.getAttribute("d"),i.getAttribute("fill-rule")==="evenodd"&&mt("SVG Evenodd fill rule not supported, your svg may render incorrectly"),v=new Us(S,!0),t.context.path(v),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"circle":p=wt(i,"cx",0),m=wt(i,"cy",0),g=wt(i,"r",0),t.context.ellipse(p,m,g,g),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"rect":h=wt(i,"x",0),l=wt(i,"y",0),A=wt(i,"width",0),C=wt(i,"height",0),_=wt(i,"rx",0),w=wt(i,"ry",0),_||w?t.context.roundRect(h,l,A,C,_||w):t.context.rect(h,l,A,C),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"ellipse":p=wt(i,"cx",0),m=wt(i,"cy",0),_=wt(i,"rx",0),w=wt(i,"ry",0),t.context.beginPath(),t.context.ellipse(p,m,_,w),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"line":c=wt(i,"x1",0),u=wt(i,"y1",0),f=wt(i,"x2",0),d=wt(i,"y2",0),t.context.beginPath(),t.context.moveTo(c,u),t.context.lineTo(f,d),s&&t.context.stroke(s);break;case"polygon":y=i.getAttribute("points"),b=y.match(/\d+/g).map(T=>parseInt(T,10)),t.context.poly(b,!0),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"polyline":y=i.getAttribute("points"),b=y.match(/\d+/g).map(T=>parseInt(T,10)),t.context.poly(b,!1),s&&t.context.stroke(s);break;case"g":case"svg":break;default:{mt(`[SVG parser] <${i.nodeName}> elements unsupported`);break}}o&&(e=null);for(let T=0;T<r.length;T++)Mu(r[T],t,e,s)}function I0(i){return St.isColorLike(i)}function Xl(i){return i instanceof en}function zl(i){return i instanceof Ye}function F0(i){return i instanceof U}function E0(i,t,e){const s=St.shared.setValue(t??0);return i.color=s.toNumber(),i.alpha=s.alpha===1?e.alpha:s.alpha,i.texture=U.WHITE,{...e,...i}}function B0(i,t,e){return i.texture=t,{...e,...i}}function Nl(i,t,e){return i.fill=t,i.color=16777215,i.texture=t.texture,i.matrix=t.transform,{...e,...i}}function Ul(i,t,e){return t.buildGradient(),i.fill=t,i.color=16777215,i.texture=t.texture,i.matrix=t.transform,i.textureSpace=t.textureSpace,{...e,...i}}function R0(i,t){const e={...t,...i},s=St.shared.setValue(e.color);return e.alpha*=s.alpha,e.color=s.toNumber(),e}function as(i,t){if(i==null)return null;const e={},s=i;return I0(i)?E0(e,i,t):F0(i)?B0(e,i,t):Xl(i)?Nl(e,i,t):zl(i)?Ul(e,i,t):s.fill&&Xl(s.fill)?Nl(s,s.fill,t):s.fill&&zl(s.fill)?Ul(s,s.fill,t):R0(s,t)}function kr(i,t){const{width:e,alignment:s,miterLimit:r,cap:n,join:a,pixelLine:o,...h}=t,l=as(i,h);return l?{width:e,alignment:s,miterLimit:r,cap:n,join:a,pixelLine:o,...l}:null}const V0=new Dt,Wl=new et,eo=class _e extends Xt{constructor(){super(...arguments),this.uid=Tt("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new Us,this._transform=new et,this._fillStyle={..._e.defaultFillStyle},this._strokeStyle={..._e.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new pe,this._boundsDirty=!0}clone(){const t=new _e;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=as(t,_e.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=kr(t,_e.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=as(t,_e.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=as(t,_e.defaultStrokeStyle),this}texture(t,e,s,r,n,a){return this.instructions.push({action:"texture",data:{image:t,dx:s||0,dy:r||0,dw:n||t.frame.width,dh:a||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?St.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new Us,this}fill(t,e){let s;const r=this.instructions[this.instructions.length-1];return this._tick===0&&r&&r.action==="stroke"?s=r.data.path:s=this._activePath.clone(),s?(t!=null&&(e!==void 0&&typeof t=="number"&&(q(rt,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:e}),this._fillStyle=as(t,_e.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:s}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(Dt.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;const s=this.instructions[this.instructions.length-1];return this._tick===0&&s&&s.action==="fill"?e=s.data.path:e=this._activePath.clone(),e?(t!=null&&(this._strokeStyle=kr(t,_e.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],s=this._activePath.clone();if(e&&(e.action==="stroke"||e.action==="fill"))if(e.data.hole)e.data.hole.addPath(s);else{e.data.hole=s;break}}return this._initNextPathLocation(),this}arc(t,e,s,r,n,a){this._tick++;const o=this._transform;return this._activePath.arc(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,s,r,n,a),this}arcTo(t,e,s,r,n){this._tick++;const a=this._transform;return this._activePath.arcTo(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,a.a*s+a.c*r+a.tx,a.b*s+a.d*r+a.ty,n),this}arcToSvg(t,e,s,r,n,a,o){this._tick++;const h=this._transform;return this._activePath.arcToSvg(t,e,s,r,n,h.a*a+h.c*o+h.tx,h.b*a+h.d*o+h.ty),this}bezierCurveTo(t,e,s,r,n,a,o){this._tick++;const h=this._transform;return this._activePath.bezierCurveTo(h.a*t+h.c*e+h.tx,h.b*t+h.d*e+h.ty,h.a*s+h.c*r+h.tx,h.b*s+h.d*r+h.ty,h.a*n+h.c*a+h.tx,h.b*n+h.d*a+h.ty,o),this}closePath(){var t;return this._tick++,(t=this._activePath)==null||t.closePath(),this}ellipse(t,e,s,r){return this._tick++,this._activePath.ellipse(t,e,s,r,this._transform.clone()),this}circle(t,e,s){return this._tick++,this._activePath.circle(t,e,s,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const s=this._transform;return this._activePath.lineTo(s.a*t+s.c*e+s.tx,s.b*t+s.d*e+s.ty),this}moveTo(t,e){this._tick++;const s=this._transform,r=this._activePath.instructions,n=s.a*t+s.c*e+s.tx,a=s.b*t+s.d*e+s.ty;return r.length===1&&r[0].action==="moveTo"?(r[0].data[0]=n,r[0].data[1]=a,this):(this._activePath.moveTo(n,a),this)}quadraticCurveTo(t,e,s,r,n){this._tick++;const a=this._transform;return this._activePath.quadraticCurveTo(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,a.a*s+a.c*r+a.tx,a.b*s+a.d*r+a.ty,n),this}rect(t,e,s,r){return this._tick++,this._activePath.rect(t,e,s,r,this._transform.clone()),this}roundRect(t,e,s,r,n){return this._tick++,this._activePath.roundRect(t,e,s,r,n,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,s,r,n=0,a){return this._tick++,this._activePath.regularPoly(t,e,s,r,n,a),this}roundPoly(t,e,s,r,n,a){return this._tick++,this._activePath.roundPoly(t,e,s,r,n,a),this}roundShape(t,e,s,r){return this._tick++,this._activePath.roundShape(t,e,s,r),this}filletRect(t,e,s,r,n){return this._tick++,this._activePath.filletRect(t,e,s,r,n),this}chamferRect(t,e,s,r,n,a){return this._tick++,this._activePath.chamferRect(t,e,s,r,n,a),this}star(t,e,s,r,n=0,a=0){return this._tick++,this._activePath.star(t,e,s,r,n,a,this._transform.clone()),this}svg(t){return this._tick++,k0(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,s,r,n,a){return t instanceof et?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,s,r,n,a),this)}transform(t,e,s,r,n,a){return t instanceof et?(this._transform.append(t),this):(Wl.set(t,e,s,r,n,a),this._transform.append(Wl),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const s=this.instructions[e],r=s.action;if(r==="fill"){const n=s.data;t.addBounds(n.path.bounds)}else if(r==="texture"){const n=s.data;t.addFrame(n.dx,n.dy,n.dx+n.dw,n.dy+n.dh,n.transform)}if(r==="stroke"){const n=s.data,a=n.style.alignment,o=n.style.width*(1-a),h=n.path.bounds;t.addFrame(h.minX-o,h.minY-o,h.maxX+o,h.maxY+o)}}return t}containsPoint(t){var r;if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let s=!1;for(let n=0;n<e.length;n++){const a=e[n],o=a.data,h=o.path;if(!a.action||!h)continue;const l=o.style,c=h.shapePath.shapePrimitives;for(let u=0;u<c.length;u++){const f=c[u].shape;if(!l||!f)continue;const d=c[u].transform,p=d?d.applyInverse(t,V0):t;if(a.action==="fill")s=f.contains(p.x,p.y);else{const g=l;s=f.strokeContains(p.x,p.y,g.width,g.alignment)}const m=o.hole;if(m){const g=(r=m.shapePath)==null?void 0:r.shapePrimitives;if(g)for(let _=0;_<g.length;_++)g[_].shape.contains(p.x,p.y)&&(s=!1)}if(s)return!0}}return s}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const s=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(s),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(s)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};eo.defaultFillStyle={color:16777215,alpha:1,texture:U.WHITE,matrix:null,fill:null,textureSpace:"local"};eo.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:U.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let ee=eo;const Gl=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function O0(i){const t=[];let e=0;for(let s=0;s<Gl.length;s++){const r=`_${Gl[s]}`;t[e++]=i[r]}return e=Pu(i._fill,t,e),e=D0(i._stroke,t,e),e=Y0(i.dropShadow,t,e),e=L0(i.filters,t,e),t.join("-")}function L0(i,t,e){if(!i)return e;for(const s of i)t[e++]=s.uid;return e}function Pu(i,t,e){var s;return i&&(t[e++]=i.color,t[e++]=i.alpha,t[e++]=(s=i.fill)==null?void 0:s.styleKey),e}function D0(i,t,e){return i&&(e=Pu(i,t,e),t[e++]=i.width,t[e++]=i.alignment,t[e++]=i.cap,t[e++]=i.join,t[e++]=i.miterLimit),e}function Y0(i,t,e){return i&&(t[e++]=i.alpha,t[e++]=i.angle,t[e++]=i.blur,t[e++]=i.distance,t[e++]=St.shared.setValue(i.color).toNumber()),e}const so=class Ms extends Xt{constructor(t={}){super(),X0(t);const e={...Ms.defaultTextStyle,...t};for(const s in e){const r=s;this[r]=e[s]}this.update()}get align(){return this._align}set align(t){this._align=t,this.update()}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords=t,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(t){t!==null&&typeof t=="object"?this._dropShadow=this._createProxy({...Ms.defaultDropShadow,...t}):this._dropShadow=t?this._createProxy({...Ms.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t,this.update()}get fontSize(){return this._fontSize}set fontSize(t){typeof t=="string"?this._fontSize=parseInt(t,10):this._fontSize=t,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t,this.update()}get leading(){return this._leading}set leading(t){this._leading=t,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing=t,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t,this.update()}get padding(){return this._padding}set padding(t){this._padding=t,this.update()}get filters(){return this._filters}set filters(t){this._filters=t,this.update()}get trim(){return this._trim}set trim(t){this._trim=t,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace=t,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap=t,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth=t,this.update()}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._isFillStyle(t)&&(this._originalFill=this._createProxy({...ee.defaultFillStyle,...t},()=>{this._fill=as({...this._originalFill},ee.defaultFillStyle)})),this._fill=as(t===0?"black":t,ee.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._isFillStyle(t)&&(this._originalStroke=this._createProxy({...ee.defaultStrokeStyle,...t},()=>{this._stroke=kr({...this._originalStroke},ee.defaultStrokeStyle)})),this._stroke=kr(t,ee.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=O0(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const t=Ms.defaultTextStyle;for(const e in t)this[e]=t[e]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new Ms({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0})}_getFinalPadding(){let t=0;if(this._filters)for(let e=0;e<this._filters.length;e++)t+=this._filters[e].padding;return Math.max(this._padding,t)}destroy(t=!1){var s,r,n,a;if(this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const o=typeof t=="boolean"?t:t==null?void 0:t.textureSource;(s=this._fill)!=null&&s.texture&&this._fill.texture.destroy(o),(r=this._originalFill)!=null&&r.texture&&this._originalFill.texture.destroy(o),(n=this._stroke)!=null&&n.texture&&this._stroke.texture.destroy(o),(a=this._originalStroke)!=null&&a.texture&&this._originalStroke.texture.destroy(o)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(t,e){return new Proxy(t,{set:(s,r,n)=>(s[r]=n,e==null||e(r,n),this.update(),!0)})}_isFillStyle(t){return(t??null)!==null&&!(St.isColorLike(t)||t instanceof Ye||t instanceof en)}};so.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};so.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Ws=so;function X0(i){const t=i;if(typeof t.dropShadow=="boolean"&&t.dropShadow){const e=Ws.defaultDropShadow;i.dropShadow={alpha:t.dropShadowAlpha??e.alpha,angle:t.dropShadowAngle??e.angle,blur:t.dropShadowBlur??e.blur,color:t.dropShadowColor??e.color,distance:t.dropShadowDistance??e.distance}}if(t.strokeThickness!==void 0){q(rt,"strokeThickness is now a part of stroke");const e=t.stroke;let s={};if(St.isColorLike(e))s.color=e;else if(e instanceof Ye||e instanceof en)s.fill=e;else if(Object.hasOwnProperty.call(e,"color")||Object.hasOwnProperty.call(e,"fill"))s=e;else throw new Error("Invalid stroke value.");i.stroke={...s,width:t.strokeThickness}}if(Array.isArray(t.fillGradientStops)){q(rt,"gradient fill is now a fill pattern: `new FillGradient(...)`");let e;i.fontSize==null?i.fontSize=Ws.defaultTextStyle.fontSize:typeof i.fontSize=="string"?e=parseInt(i.fontSize,10):e=i.fontSize;const s=new Ye({start:{x:0,y:0},end:{x:0,y:(e||0)*1.7}}),r=t.fillGradientStops.map(n=>St.shared.setValue(n).toNumber());r.forEach((n,a)=>{const o=a/(r.length-1);s.addColorStop(o,n)}),i.fill={fill:s}}}class z0{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,e){const s=ut.get().createCanvas();s.width=t,s.height=e;const r=s.getContext("2d");return{canvas:s,context:r}}getOptimalCanvasAndContext(t,e,s=1){t=Math.ceil(t*s-1e-6),e=Math.ceil(e*s-1e-6),t=Ys(t),e=Ys(e);const r=(t<<17)+(e<<1);this._canvasPool[r]||(this._canvasPool[r]=[]);let n=this._canvasPool[r].pop();return n||(n=this._createCanvasAndContext(t,e)),n}returnCanvasAndContext(t){const e=t.canvas,{width:s,height:r}=e,n=(s<<17)+(r<<1);t.context.clearRect(0,0,s,r),this._canvasPool[n].push(t)}clear(){this._canvasPool={}}}const Ir=new z0,Hl=1e5;function Fr(i,t,e,s=0){if(i.texture===U.WHITE&&!i.fill)return St.shared.setValue(i.color).setAlpha(i.alpha??1).toHexa();if(i.fill){if(i.fill instanceof en){const r=i.fill,n=t.createPattern(r.texture.source.resource,"repeat"),a=r.transform.copyTo(et.shared);return a.scale(r.texture.frame.width,r.texture.frame.height),n.setTransform(a),n}else if(i.fill instanceof Ye){const r=i.fill,n=r.type==="linear",a=r.textureSpace==="local";let o=1,h=1;a&&e&&(o=e.width+s,h=e.height+s);let l,c=!1;if(n){const{start:u,end:f}=r;l=t.createLinearGradient(u.x*o,u.y*h,f.x*o,f.y*h),c=Math.abs(f.x-u.x)<Math.abs((f.y-u.y)*.1)}else{const{center:u,innerRadius:f,outerCenter:d,outerRadius:p}=r;l=t.createRadialGradient(u.x*o,u.y*h,f*o,d.x*o,d.y*h,p*o)}if(c&&a&&e){const u=e.lineHeight/h;for(let f=0;f<e.lines.length;f++){const d=(f*e.lineHeight+s/2)/h;r.colorStops.forEach(p=>{const m=d+p.offset*u;l.addColorStop(Math.floor(m*Hl)/Hl,St.shared.setValue(p.color).toHex())})}}else r.colorStops.forEach(u=>{l.addColorStop(u.offset,St.shared.setValue(u.color).toHex())});return l}}else{const r=t.createPattern(i.texture.source.resource,"repeat"),n=i.matrix.copyTo(et.shared);return n.scale(i.texture.frame.width,i.texture.frame.height),r.setTransform(n),r}return mt("FillStyle not recognised",i),"red"}const ku=class Iu extends Jc{constructor(t){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentMaxCharHeight=0,this._currentPageIndex=-1,this._skipKerning=!1;const e={...Iu.defaultOptions,...t};this._textureSize=e.textureSize,this._mipmap=e.mipmap;const s=e.style.clone();e.overrideFill&&(s._fill.color=16777215,s._fill.alpha=1,s._fill.texture=U.WHITE,s._fill.fill=null),this.applyFillAsTint=e.overrideFill;const r=s.fontSize;s.fontSize=this.baseMeasurementFontSize;const n=Pr(s);e.overrideSize?s._stroke&&(s._stroke.width*=this.baseRenderedFontSize/r):s.fontSize=this.baseRenderedFontSize=r,this._style=s,this._skipKerning=e.skipKerning??!1,this.resolution=e.resolution??1,this._padding=e.padding??4,e.textureStyle&&(this._textureStyle=e.textureStyle instanceof Xs?e.textureStyle:new Xs(e.textureStyle)),this.fontMetrics=Se.measureFont(n),this.lineHeight=s.lineHeight||this.fontMetrics.fontSize||s.fontSize}ensureCharacters(t){var g,_;const e=Se.graphemeSegmenter(t).filter(w=>!this._currentChars.includes(w)).filter((w,b,y)=>y.indexOf(w)===b);if(!e.length)return;this._currentChars=[...this._currentChars,...e];let s;this._currentPageIndex===-1?s=this._nextPage():s=this.pages[this._currentPageIndex];let{canvas:r,context:n}=s.canvasAndContext,a=s.texture.source;const o=this._style;let h=this._currentX,l=this._currentY,c=this._currentMaxCharHeight;const u=this.baseRenderedFontSize/this.baseMeasurementFontSize,f=this._padding*u;let d=!1;const p=r.width/this.resolution,m=r.height/this.resolution;for(let w=0;w<e.length;w++){const b=e[w],y=Se.measureText(b,o,r,!1);y.lineHeight=y.height;const S=y.width*u,v=Math.ceil((o.fontStyle==="italic"?2:1)*S),A=y.height*u,C=v+f*2,T=A+f*2;if(d=!1,b!==`
`&&b!=="\r"&&b!=="	"&&b!==" "&&(d=!0,c=Math.ceil(Math.max(T,c))),h+C>p&&(l+=c,c=T,h=0,l+c>m)){a.update();const M=this._nextPage();r=M.canvasAndContext.canvas,n=M.canvasAndContext.context,a=M.texture.source,h=0,l=0,c=0}const P=S/u-(((g=o.dropShadow)==null?void 0:g.distance)??0)-(((_=o._stroke)==null?void 0:_.width)??0);if(this.chars[b]={id:b.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:P,kerning:{}},d){this._drawGlyph(n,y,h+f,l+f,u,o);const M=a.width*u,B=a.height*u,F=new pt(h/M*a.width,l/B*a.height,C/M*a.width,T/B*a.height);this.chars[b].texture=new U({source:a,frame:F}),h+=Math.ceil(C)}}a.update(),this._currentX=h,this._currentY=l,this._currentMaxCharHeight=c,this._skipKerning&&this._applyKerning(e,n)}get pageTextures(){return q(rt,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(t,e){const s=this._measureCache;for(let r=0;r<t.length;r++){const n=t[r];for(let a=0;a<this._currentChars.length;a++){const o=this._currentChars[a];let h=s[n];h||(h=s[n]=e.measureText(n).width);let l=s[o];l||(l=s[o]=e.measureText(o).width);let c=e.measureText(n+o).width,u=c-(h+l);u&&(this.chars[n].kerning[o]=u),c=e.measureText(n+o).width,u=c-(h+l),u&&(this.chars[o].kerning[n]=u)}}}_nextPage(){this._currentPageIndex++;const t=this.resolution,e=Ir.getOptimalCanvasAndContext(this._textureSize,this._textureSize,t);this._setupContext(e.context,this._style,t);const s=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),r=new U({source:new ps({resource:e.canvas,resolution:s,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})});this._textureStyle&&(r.source.style=this._textureStyle);const n={canvasAndContext:e,texture:r};return this.pages[this._currentPageIndex]=n,n}_setupContext(t,e,s){e.fontSize=this.baseRenderedFontSize,t.scale(s,s),t.font=Pr(e),e.fontSize=this.baseMeasurementFontSize,t.textBaseline=e.textBaseline;const r=e._stroke,n=(r==null?void 0:r.width)??0;if(r&&(t.lineWidth=n,t.lineJoin=r.join,t.miterLimit=r.miterLimit,t.strokeStyle=Fr(r,t)),e._fill&&(t.fillStyle=Fr(e._fill,t)),e.dropShadow){const a=e.dropShadow,o=St.shared.setValue(a.color).toArray(),h=a.blur*s,l=a.distance*s;t.shadowColor=`rgba(${o[0]*255},${o[1]*255},${o[2]*255},${a.alpha})`,t.shadowBlur=h,t.shadowOffsetX=Math.cos(a.angle)*l,t.shadowOffsetY=Math.sin(a.angle)*l}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}_drawGlyph(t,e,s,r,n,a){const o=e.text,h=e.fontProperties,l=a._stroke,c=((l==null?void 0:l.width)??0)*n,u=s+c/2,f=r-c/2,d=h.descent*n,p=e.lineHeight*n;a.stroke&&c&&t.strokeText(o,u,f+p-d),a._fill&&t.fillText(o,u,f+p-d)}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{canvasAndContext:e,texture:s}=this.pages[t];Ir.returnCanvasAndContext(e),s.destroy(!0)}this.pages=null}};ku.defaultOptions={textureSize:512,style:new Ws,mipmap:!0};let $l=ku;function N0(i,t,e,s){const r={width:0,height:0,offsetY:0,scale:t.fontSize/e.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};r.offsetY=e.baseLineOffset;let n=r.lines[0],a=null,o=!0;const h={width:0,start:0,index:0,positions:[],chars:[]},l=p=>{const m=n.width;for(let g=0;g<h.index;g++){const _=p.positions[g];n.chars.push(p.chars[g]),n.charPositions.push(_+m)}n.width+=p.width,o=!1,h.width=0,h.index=0,h.chars.length=0},c=()=>{let p=n.chars.length-1;if(s){let m=n.chars[p];for(;m===" ";)n.width-=e.chars[m].xAdvance,m=n.chars[--p]}r.width=Math.max(r.width,n.width),n={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},o=!0,r.lines.push(n),r.height+=e.lineHeight},u=e.baseMeasurementFontSize/t.fontSize,f=t.letterSpacing*u,d=t.wordWrapWidth*u;for(let p=0;p<i.length+1;p++){let m;const g=p===i.length;g||(m=i[p]);const _=e.chars[m]||e.chars[" "];if(/(?:\s)/.test(m)||m==="\r"||m===`
`||g){if(!o&&t.wordWrap&&n.width+h.width-f>d?(c(),l(h),g||n.charPositions.push(0)):(h.start=n.width,l(h),g||n.charPositions.push(0)),m==="\r"||m===`
`)n.width!==0&&c();else if(!g){const S=_.xAdvance+(_.kerning[a]||0)+f;n.width+=S,n.spaceWidth=S,n.spacesIndex.push(n.charPositions.length),n.chars.push(m)}}else{const y=_.kerning[a]||0,S=_.xAdvance+y+f;h.positions[h.index++]=h.width+y,h.chars.push(m),h.width+=S}a=m}return c(),t.align==="center"?U0(r):t.align==="right"?W0(r):t.align==="justify"&&G0(r),r}function U0(i){for(let t=0;t<i.lines.length;t++){const e=i.lines[t],s=i.width/2-e.width/2;for(let r=0;r<e.charPositions.length;r++)e.charPositions[r]+=s}}function W0(i){for(let t=0;t<i.lines.length;t++){const e=i.lines[t],s=i.width-e.width;for(let r=0;r<e.charPositions.length;r++)e.charPositions[r]+=s}}function G0(i){const t=i.width;for(let e=0;e<i.lines.length;e++){const s=i.lines[e];let r=0,n=s.spacesIndex[r++],a=0;const o=s.spacesIndex.length,l=(t-s.width)/o;for(let c=0;c<s.charPositions.length;c++)c===n&&(n=s.spacesIndex[r++],a+=l),s.charPositions[c]+=a}}function H0(i){if(i==="")return[];typeof i=="string"&&(i=[i]);const t=[];for(let e=0,s=i.length;e<s;e++){const r=i[e];if(Array.isArray(r)){if(r.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);if(r[0].length===0||r[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const n=r[0].charCodeAt(0),a=r[1].charCodeAt(0);if(a<n)throw new Error("[BitmapFont]: Invalid character range.");for(let o=n,h=a;o<=h;o++)t.push(String.fromCharCode(o))}else t.push(...Array.from(r))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}let fr=0;class $0{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1,textureStyle:null}}getFont(t,e){var a;let s=`${e.fontFamily}-bitmap`,r=!0;if(e._fill.fill&&!e._stroke)s+=e._fill.fill.styleKey,r=!1;else if(e._stroke||e.dropShadow){let o=e.styleKey;o=o.substring(0,o.lastIndexOf("-")),s=`${o}-bitmap`,r=!1}if(!ht.has(s)){const o=new $l({style:e,overrideFill:r,overrideSize:!0,...this.defaultOptions});fr++,fr>50&&mt("BitmapText",`You have dynamically created ${fr} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),o.once("destroy",()=>{fr--,ht.remove(s)}),ht.set(s,o)}const n=ht.get(s);return(a=n.ensureCharacters)==null||a.call(n,t),n}getLayout(t,e,s=!0){const r=this.getFont(t,e),n=Se.graphemeSegmenter(t);return N0(n,e,r,s)}measureText(t,e,s=!0){return this.getLayout(t,e,s)}install(...t){var l,c,u,f;let e=t[0];typeof e=="string"&&(e={name:e,style:t[1],chars:(l=t[2])==null?void 0:l.chars,resolution:(c=t[2])==null?void 0:c.resolution,padding:(u=t[2])==null?void 0:u.padding,skipKerning:(f=t[2])==null?void 0:f.skipKerning},q(rt,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const s=e==null?void 0:e.name;if(!s)throw new Error("[BitmapFontManager] Property `name` is required.");e={...this.defaultOptions,...e};const r=e.style,n=r instanceof Ws?r:new Ws(r),a=n._fill.fill!==null&&n._fill.fill!==void 0,o=new $l({style:n,overrideFill:a,skipKerning:e.skipKerning,padding:e.padding,resolution:e.resolution,overrideSize:!1,textureStyle:e.textureStyle}),h=H0(e.chars);return o.ensureCharacters(h.join("")),ht.set(`${s}-bitmap`,o),o.once("destroy",()=>ht.remove(`${s}-bitmap`)),o}uninstall(t){const e=`${t}-bitmap`,s=ht.get(e);s&&s.destroy()}}const jl=new $0;class Fu extends Jc{constructor(t,e){super();const{textures:s,data:r}=t;Object.keys(r.pages).forEach(n=>{const a=r.pages[parseInt(n,10)],o=s[a.id];this.pages.push({texture:o})}),Object.keys(r.chars).forEach(n=>{const a=r.chars[n],{frame:o,source:h}=s[a.page],l=new pt(a.x+o.x,a.y+o.y,a.width,a.height),c=new U({source:h,frame:l});this.chars[n]={id:n.codePointAt(0),xOffset:a.xOffset,yOffset:a.yOffset,xAdvance:a.xAdvance,kerning:a.kerning??{},texture:c}}),this.baseRenderedFontSize=r.fontSize,this.baseMeasurementFontSize=r.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:r.fontSize},this.baseLineOffset=r.baseLineOffset,this.lineHeight=r.lineHeight,this.fontFamily=r.fontFamily,this.distanceField=r.distanceField??{type:"none",range:0},this.url=e}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{texture:e}=this.pages[t];e.destroy(!0)}this.pages=null}static install(t){jl.install(t)}static uninstall(t){jl.uninstall(t)}}const Xn={test(i){return typeof i=="string"&&i.startsWith("info face=")},parse(i){const t=i.match(/^[a-z]+\s+.+$/gm),e={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const u in t){const f=t[u].match(/^[a-z]+/gm)[0],d=t[u].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),p={};for(const m in d){const g=d[m].split("="),_=g[0],w=g[1].replace(/"/gm,""),b=parseFloat(w),y=isNaN(b)?w:b;p[_]=y}e[f].push(p)}const s={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[r]=e.info,[n]=e.common,[a]=e.distanceField??[];a&&(s.distanceField={range:parseInt(a.distanceRange,10),type:a.fieldType}),s.fontSize=parseInt(r.size,10),s.fontFamily=r.face,s.lineHeight=parseInt(n.lineHeight,10);const o=e.page;for(let u=0;u<o.length;u++)s.pages.push({id:parseInt(o[u].id,10)||0,file:o[u].file});const h={};s.baseLineOffset=s.lineHeight-parseInt(n.base,10);const l=e.char;for(let u=0;u<l.length;u++){const f=l[u],d=parseInt(f.id,10);let p=f.letter??f.char??String.fromCharCode(d);p==="space"&&(p=" "),h[d]=p,s.chars[p]={id:d,page:parseInt(f.page,10)||0,x:parseInt(f.x,10),y:parseInt(f.y,10),width:parseInt(f.width,10),height:parseInt(f.height,10),xOffset:parseInt(f.xoffset,10),yOffset:parseInt(f.yoffset,10),xAdvance:parseInt(f.xadvance,10),kerning:{}}}const c=e.kerning||[];for(let u=0;u<c.length;u++){const f=parseInt(c[u].first,10),d=parseInt(c[u].second,10),p=parseInt(c[u].amount,10);s.chars[h[d]].kerning[h[f]]=p}return s}},ql={test(i){const t=i;return typeof t!="string"&&"getElementsByTagName"in t&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(i){const t={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},e=i.getElementsByTagName("info")[0],s=i.getElementsByTagName("common")[0],r=i.getElementsByTagName("distanceField")[0];r&&(t.distanceField={type:r.getAttribute("fieldType"),range:parseInt(r.getAttribute("distanceRange"),10)});const n=i.getElementsByTagName("page"),a=i.getElementsByTagName("char"),o=i.getElementsByTagName("kerning");t.fontSize=parseInt(e.getAttribute("size"),10),t.fontFamily=e.getAttribute("face"),t.lineHeight=parseInt(s.getAttribute("lineHeight"),10);for(let l=0;l<n.length;l++)t.pages.push({id:parseInt(n[l].getAttribute("id"),10)||0,file:n[l].getAttribute("file")});const h={};t.baseLineOffset=t.lineHeight-parseInt(s.getAttribute("base"),10);for(let l=0;l<a.length;l++){const c=a[l],u=parseInt(c.getAttribute("id"),10);let f=c.getAttribute("letter")??c.getAttribute("char")??String.fromCharCode(u);f==="space"&&(f=" "),h[u]=f,t.chars[f]={id:u,page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xOffset:parseInt(c.getAttribute("xoffset"),10),yOffset:parseInt(c.getAttribute("yoffset"),10),xAdvance:parseInt(c.getAttribute("xadvance"),10),kerning:{}}}for(let l=0;l<o.length;l++){const c=parseInt(o[l].getAttribute("first"),10),u=parseInt(o[l].getAttribute("second"),10),f=parseInt(o[l].getAttribute("amount"),10);t.chars[h[u]].kerning[h[c]]=f}return t}},Kl={test(i){return typeof i=="string"&&i.includes("<font>")?ql.test(ut.get().parseXML(i)):!1},parse(i){return ql.parse(ut.get().parseXML(i))}},j0=[".xml",".fnt"],q0={extension:{type:X.CacheParser,name:"cacheBitmapFont"},test:i=>i instanceof Fu,getCacheableAssets(i,t){const e={};return i.forEach(s=>{e[s]=t,e[`${s}-bitmap`]=t}),e[`${t.fontFamily}-bitmap`]=t,e}},K0={extension:{type:X.LoadParser,priority:ge.Normal},name:"loadBitmapFont",test(i){return j0.includes(Mt.extname(i).toLowerCase())},async testParse(i){return Xn.test(i)||Kl.test(i)},async parse(i,t,e){const s=Xn.test(i)?Xn.parse(i):Kl.parse(i),{src:r}=t,{pages:n}=s,a=[],o=s.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let u=0;u<n.length;++u){const f=n[u].file;let d=Mt.join(Mt.dirname(r),f);d=Mr(d,r),a.push({src:d,data:o})}const h=await e.load(a),l=a.map(u=>h[u.src]);return new Fu({data:s,textures:l},r)},async load(i,t){return await(await ut.get().fetch(i)).text()},async unload(i,t,e){await Promise.all(i.pages.map(s=>e.unload(s.texture.source._sourceOrigin))),i.destroy()}};class Z0{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<e;s++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}const Q0={extension:{type:X.CacheParser,name:"cacheTextureArray"},test:i=>Array.isArray(i)&&i.every(t=>t instanceof U),getCacheableAssets:(i,t)=>{const e={};return i.forEach(s=>{t.forEach((r,n)=>{e[s+(n===0?"":n+1)]=r})}),e}};async function Eu(i){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=i});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(i)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const J0={extension:{type:X.DetectionParser,priority:1},test:async()=>Eu("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async i=>[...i,"avif"],remove:async i=>i.filter(t=>t!=="avif")},Zl=["png","jpg","jpeg"],tx={extension:{type:X.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async i=>[...i,...Zl],remove:async i=>i.filter(t=>!Zl.includes(t))},ex="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function io(i){return ex?!1:document.createElement("video").canPlayType(i)!==""}const sx={extension:{type:X.DetectionParser,priority:0},test:async()=>io("video/mp4"),add:async i=>[...i,"mp4","m4v"],remove:async i=>i.filter(t=>t!=="mp4"&&t!=="m4v")},ix={extension:{type:X.DetectionParser,priority:0},test:async()=>io("video/ogg"),add:async i=>[...i,"ogv"],remove:async i=>i.filter(t=>t!=="ogv")},rx={extension:{type:X.DetectionParser,priority:0},test:async()=>io("video/webm"),add:async i=>[...i,"webm"],remove:async i=>i.filter(t=>t!=="webm")},nx={extension:{type:X.DetectionParser,priority:0},test:async()=>Eu("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async i=>[...i,"webp"],remove:async i=>i.filter(t=>t!=="webp")};class ax{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,s)=>(this._parsersValidated=!1,t[e]=s,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const s={promise:null,parser:null};return s.promise=(async()=>{var a,o;let r=null,n=null;if(e.loadParser&&(n=this._parserHash[e.loadParser],n||mt(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!n){for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];if(l.load&&((a=l.test)!=null&&a.call(l,t,e,this))){n=l;break}}if(!n)return mt(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await n.load(t,e,this),s.parser=n;for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];l.parse&&l.parse&&await((o=l.testParse)==null?void 0:o.call(l,r,e,this))&&(r=await l.parse(r,e,this)||r,s.parser=l)}return r})(),s}async load(t,e){this._parsersValidated||this._validateParsers();let s=0;const r={},n=Tr(t),a=ue(t,l=>({alias:[l],src:l,data:{}})),o=a.length,h=a.map(async l=>{const c=Mt.toAbsolute(l.src);if(!r[l.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,l)),r[l.src]=await this.promiseCache[c].promise,e&&e(++s/o)}catch(u){throw delete this.promiseCache[c],delete r[l.src],new Error(`[Loader.load] Failed to load ${c}.
${u}`)}});return await Promise.all(h),n?r[a[0].src]:r}async unload(t){const s=ue(t,r=>({alias:[r],src:r})).map(async r=>{var o,h;const n=Mt.toAbsolute(r.src),a=this.promiseCache[n];if(a){const l=await a.promise;delete this.promiseCache[n],await((h=(o=a.parser)==null?void 0:o.unload)==null?void 0:h.call(o,l,r,this))}});await Promise.all(s)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(e.name?t[e.name]&&mt(`[Assets] loadParser name conflict "${e.name}"`):mt("[Assets] loadParser should have a name"),{...t,[e.name]:e}),{})}}function qs(i,t){if(Array.isArray(t)){for(const e of t)if(i.startsWith(`data:${e}`))return!0;return!1}return i.startsWith(`data:${t}`)}function ne(i,t){const e=i.split("?")[0],s=Mt.extname(e).toLowerCase();return Array.isArray(t)?t.includes(s):s===t}const ox=".json",lx="application/json",hx={extension:{type:X.LoadParser,priority:ge.Low},name:"loadJson",test(i){return qs(i,lx)||ne(i,ox)},async load(i){return await(await ut.get().fetch(i)).json()}},cx=".txt",ux="text/plain",dx={name:"loadTxt",extension:{type:X.LoadParser,priority:ge.Low,name:"loadTxt"},test(i){return qs(i,ux)||ne(i,cx)},async load(i){return await(await ut.get().fetch(i)).text()}},fx=["normal","bold","100","200","300","400","500","600","700","800","900"],px=[".ttf",".otf",".woff",".woff2"],mx=["font/ttf","font/otf","font/woff","font/woff2"],gx=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function xx(i){const t=Mt.extname(i),r=Mt.basename(i,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1));let n=r.length>0;for(const o of r)if(!o.match(gx)){n=!1;break}let a=r.join(" ");return n||(a=`"${a.replace(/[\\"]/g,"\\$&")}"`),a}const yx=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function bx(i){return yx.test(i)?i:encodeURI(i)}const _x={extension:{type:X.LoadParser,priority:ge.Low},name:"loadWebFont",test(i){return qs(i,mx)||ne(i,px)},async load(i,t){var s,r,n;const e=ut.get().getFontFaceSet();if(e){const a=[],o=((s=t.data)==null?void 0:s.family)??xx(i),h=((n=(r=t.data)==null?void 0:r.weights)==null?void 0:n.filter(c=>fx.includes(c)))??["normal"],l=t.data??{};for(let c=0;c<h.length;c++){const u=h[c],f=new FontFace(o,`url(${bx(i)})`,{...l,weight:u});await f.load(),e.add(f),a.push(f)}return ht.set(`${o}-and-url`,{url:i,fontFaces:a}),a.length===1?a[0]:a}return mt("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(i){(Array.isArray(i)?i:[i]).forEach(t=>{ht.remove(`${t.family}-and-url`),ut.get().getFontFaceSet().delete(t)})}};function ro(i,t=1){var s;const e=(s=xs.RETINA_PREFIX)==null?void 0:s.exec(i);return e?parseFloat(e[1]):t}function no(i,t,e){i.label=e,i._sourceOrigin=e;const s=new U({source:i,label:e}),r=()=>{delete t.promiseCache[e],ht.has(e)&&ht.remove(e)};return s.source.once("destroy",()=>{t.promiseCache[e]&&(mt("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),r())}),s.once("destroy",()=>{i.destroyed||(mt("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),r())}),s}const wx=".svg",vx="image/svg+xml",Sx={extension:{type:X.LoadParser,priority:ge.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(i){return qs(i,vx)||ne(i,wx)},async load(i,t,e){var s;return((s=t.data)==null?void 0:s.parseAsGraphicsContext)??this.config.parseAsGraphicsContext?Cx(i):Ax(i,t,e,this.config.crossOrigin)},unload(i){i.destroy(!0)}};async function Ax(i,t,e,s){var g,_,w;const n=await(await ut.get().fetch(i)).blob(),a=URL.createObjectURL(n),o=new Image;o.src=a,o.crossOrigin=s,await o.decode(),URL.revokeObjectURL(a);const h=document.createElement("canvas"),l=h.getContext("2d"),c=((g=t.data)==null?void 0:g.resolution)||ro(i),u=((_=t.data)==null?void 0:_.width)??o.width,f=((w=t.data)==null?void 0:w.height)??o.height;h.width=u*c,h.height=f*c,l.drawImage(o,0,0,u*c,f*c);const{parseAsGraphicsContext:d,...p}=t.data??{},m=new ps({resource:h,alphaMode:"premultiply-alpha-on-upload",resolution:c,...p});return no(m,e,i)}async function Cx(i){const e=await(await ut.get().fetch(i)).text(),s=new ee;return s.svg(e),s}const Tx=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let Vs=null,_a=class{constructor(){Vs||(Vs=URL.createObjectURL(new Blob([Tx],{type:"application/javascript"}))),this.worker=new Worker(Vs)}};_a.revokeObjectURL=function(){Vs&&(URL.revokeObjectURL(Vs),Vs=null)};const Mx=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let Os=null;class Bu{constructor(){Os||(Os=URL.createObjectURL(new Blob([Mx],{type:"application/javascript"}))),this.worker=new Worker(Os)}}Bu.revokeObjectURL=function(){Os&&(URL.revokeObjectURL(Os),Os=null)};let Ql=0,zn;class Px{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new _a;e.addEventListener("message",s=>{e.terminate(),_a.revokeObjectURL(),t(s.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t,e){var s;return this._run("loadImageBitmap",[t,(s=e==null?void 0:e.data)==null?void 0:s.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){zn===void 0&&(zn=navigator.hardwareConcurrency||4);let t=this._workerPool.pop();return!t&&this._createdWorkers<zn&&(this._createdWorkers++,t=new Bu().worker,t.addEventListener("message",e=>{this._complete(e.data),this._returnWorker(e.target),this._next()})),t}_returnWorker(t){this._workerPool.push(t)}_complete(t){t.error!==void 0?this._resolveHash[t.uuid].reject(t.error):this._resolveHash[t.uuid].resolve(t.data),this._resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const s=new Promise((r,n)=>{this._queue.push({id:t,arguments:e,resolve:r,reject:n})});return this._next(),s}_next(){if(!this._queue.length)return;const t=this._getWorker();if(!t)return;const e=this._queue.pop(),s=e.id;this._resolveHash[Ql]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:Ql++,id:s})}}const Jl=new Px,kx=[".jpeg",".jpg",".png",".webp",".avif"],Ix=["image/jpeg","image/png","image/webp","image/avif"];async function Fx(i,t){var r;const e=await ut.get().fetch(i);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${i}: ${e.status} ${e.statusText}`);const s=await e.blob();return((r=t==null?void 0:t.data)==null?void 0:r.alphaMode)==="premultiplied-alpha"?createImageBitmap(s,{premultiplyAlpha:"none"}):createImageBitmap(s)}const Ru={name:"loadTextures",extension:{type:X.LoadParser,priority:ge.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(i){return qs(i,Ix)||ne(i,kx)},async load(i,t,e){var n;let s=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Jl.isImageBitmapSupported()?s=await Jl.loadImageBitmap(i,t):s=await Fx(i,t):s=await new Promise((a,o)=>{s=new Image,s.crossOrigin=this.config.crossOrigin,s.src=i,s.complete?a(s):(s.onload=()=>{a(s)},s.onerror=o)});const r=new ps({resource:s,alphaMode:"premultiply-alpha-on-upload",resolution:((n=t.data)==null?void 0:n.resolution)||ro(i),...t.data});return no(r,e,i)},unload(i){i.destroy(!0)}},Vu=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],Ex=Vu.map(i=>`video/${i.substring(1)}`);function Bx(i,t,e){e===void 0&&!t.startsWith("data:")?i.crossOrigin=Vx(t):e!==!1&&(i.crossOrigin=typeof e=="string"?e:"anonymous")}function Rx(i){return new Promise((t,e)=>{i.addEventListener("canplaythrough",s),i.addEventListener("error",r),i.load();function s(){n(),t()}function r(a){n(),e(a)}function n(){i.removeEventListener("canplaythrough",s),i.removeEventListener("error",r)}})}function Vx(i,t=globalThis.location){if(i.startsWith("data:"))return"";t||(t=globalThis.location);const e=new URL(i,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}const Ox={name:"loadVideo",extension:{type:X.LoadParser,name:"loadVideo"},test(i){const t=qs(i,Ex),e=ne(i,Vu);return t||e},async load(i,t,e){var h,l;const s={...br.defaultOptions,resolution:((h=t.data)==null?void 0:h.resolution)||ro(i),alphaMode:((l=t.data)==null?void 0:l.alphaMode)||await Cc(),...t.data},r=document.createElement("video"),n={preload:s.autoLoad!==!1?"auto":void 0,"webkit-playsinline":s.playsinline!==!1?"":void 0,playsinline:s.playsinline!==!1?"":void 0,muted:s.muted===!0?"":void 0,loop:s.loop===!0?"":void 0,autoplay:s.autoPlay!==!1?"":void 0};Object.keys(n).forEach(c=>{const u=n[c];u!==void 0&&r.setAttribute(c,u)}),s.muted===!0&&(r.muted=!0),Bx(r,i,s.crossorigin);const a=document.createElement("source");let o;if(i.startsWith("data:"))o=i.slice(5,i.indexOf(";"));else if(!i.startsWith("blob:")){const c=i.split("?")[0].slice(i.lastIndexOf(".")+1).toLowerCase();o=br.MIME_TYPES[c]||`video/${c}`}return a.src=i,o&&(a.type=o),new Promise(c=>{const u=async()=>{const f=new br({...s,resource:r});r.removeEventListener("canplay",u),t.data.preload&&await Rx(r),c(no(f,e,i))};s.preload&&!s.autoPlay&&r.load(),r.addEventListener("canplay",u),r.appendChild(a)})},unload(i){i.destroy(!0)}},Ou={extension:{type:X.ResolveParser,name:"resolveTexture"},test:Ru.test,parse:i=>{var t;return{resolution:parseFloat(((t=xs.RETINA_PREFIX.exec(i))==null?void 0:t[1])??"1"),format:i.split(".").pop(),src:i}}},Lx={extension:{type:X.ResolveParser,priority:-2,name:"resolveJson"},test:i=>xs.RETINA_PREFIX.test(i)&&i.endsWith(".json"),parse:Ou.parse};class Dx{constructor(){this._detections=[],this._initialized=!1,this.resolver=new xs,this.loader=new ax,this.cache=ht,this._backgroundLoader=new Z0(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var n,a;if(this._initialized){mt("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let o=t.manifest;typeof o=="string"&&(o=await this.load(o)),this.resolver.addManifest(o)}const e=((n=t.texturePreference)==null?void 0:n.resolution)??1,s=typeof e=="number"?[e]:e,r=await this._detectFormats({preferredFormats:(a=t.texturePreference)==null?void 0:a.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:r,resolution:s}}),t.preferences&&this.setPreferences(t.preferences)}add(t){this.resolver.add(t)}async load(t,e){this._initialized||await this.init();const s=Tr(t),r=ue(t).map(o=>{if(typeof o!="string"){const h=this.resolver.getAlias(o);return h.some(l=>!this.resolver.hasKey(l))&&this.add(o),Array.isArray(h)?h[0]:h}return this.resolver.hasKey(o)||this.add({alias:o,src:o}),o}),n=this.resolver.resolve(r),a=await this._mapLoadToResolve(n,e);return s?a[r[0]]:a}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let s=!1;typeof t=="string"&&(s=!0,t=[t]);const r=this.resolver.resolveBundle(t),n={},a=Object.keys(r);let o=0,h=0;const l=()=>{e==null||e(++o/h)},c=a.map(u=>{const f=r[u];return h+=Object.keys(f).length,this._mapLoadToResolve(f,l).then(d=>{n[u]=d})});return await Promise.all(c),s?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(s=>{this._backgroundLoader.add(Object.values(s))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return ht.get(t);const e={};for(let s=0;s<t.length;s++)e[s]=ht.get(t[s]);return e}async _mapLoadToResolve(t,e){const s=[...new Set(Object.values(t))];this._backgroundLoader.active=!1;const r=await this.loader.load(s,e);this._backgroundLoader.active=!0;const n={};return s.forEach(a=>{const o=r[a.src],h=[a.src];a.alias&&h.push(...a.alias),h.forEach(l=>{n[l]=o}),ht.set(h,o)}),n}async unload(t){this._initialized||await this.init();const e=ue(t).map(r=>typeof r!="string"?r.src:r),s=this.resolver.resolve(e);await this._unloadFromResolved(s)}async unloadBundle(t){this._initialized||await this.init(),t=ue(t);const e=this.resolver.resolveBundle(t),s=Object.keys(e).map(r=>this._unloadFromResolved(e[r]));await Promise.all(s)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(s=>{ht.remove(s.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const s of t.detections)t.skipDetections||await s.test()?e=await s.add(e):t.skipDetections||(e=await s.remove(e));return e=e.filter((s,r)=>e.indexOf(s)===r),e}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(s=>s in t).forEach(s=>{e.config[s]=t[s]})})}}const Ae=new Dx;at.handleByList(X.LoadParser,Ae.loader.parsers).handleByList(X.ResolveParser,Ae.resolver.parsers).handleByList(X.CacheParser,Ae.cache.parsers).handleByList(X.DetectionParser,Ae.detections);at.add(Q0,tx,J0,nx,sx,ix,rx,hx,dx,_x,Sx,Ru,Ox,K0,q0,Ou,Lx);const th={loader:X.LoadParser,resolver:X.ResolveParser,cache:X.CacheParser,detection:X.DetectionParser};at.handle(X.Asset,i=>{const t=i.ref;Object.entries(th).filter(([e])=>!!t[e]).forEach(([e,s])=>at.add(Object.assign(t[e],{extension:t[e].extension??s})))},i=>{const t=i.ref;Object.keys(th).filter(e=>!!t[e]).forEach(e=>at.remove(t[e]))});const Lu={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Yx=["in vec2 vBlurTexCoords[%size%];","uniform sampler2D uTexture;","out vec4 finalColor;","void main(void)","{","    finalColor = vec4(0.0);","    %blur%","}"].join(`
`);function Xx(i){const t=Lu[i],e=t.length;let s=Yx,r="";const n="finalColor += texture(uTexture, vBlurTexCoords[%index%]) * %value%;";let a;for(let o=0;o<i;o++){let h=n.replace("%index%",o.toString());a=o,o>=e&&(a=i-o-1),h=h.replace("%value%",t[a].toString()),r+=h,r+=`
`}return s=s.replace("%blur%",r),s=s.replace("%size%",i.toString()),s}const zx=`
    in vec2 aPosition;

    uniform float uStrength;

    out vec2 vBlurTexCoords[%size%];

    uniform vec4 uInputSize;
    uniform vec4 uOutputFrame;
    uniform vec4 uOutputTexture;

    vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;

    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

    vec2 filterTextureCoord( void )
    {
        return aPosition * (uOutputFrame.zw * uInputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        float pixelStrength = uInputSize.%dimension% * uStrength;

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function Nx(i,t){const e=Math.ceil(i/2);let s=zx,r="",n;t?n="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * pixelStrength, 0.0);":n="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * pixelStrength);";for(let a=0;a<i;a++){let o=n.replace("%index%",a.toString());o=o.replace("%sampleIndex%",`${a-(e-1)}.0`),r+=o,r+=`
`}return s=s.replace("%blur%",r),s=s.replace("%size%",i.toString()),s=s.replace("%dimension%",t?"z":"w"),s}function Ux(i,t){const e=Nx(t,i),s=Xx(t);return tn.from({vertex:e,fragment:s,name:`blur-${i?"horizontal":"vertical"}-pass-filter`})}var Wx=`

struct GlobalFilterUniforms {
  uInputSize:vec4<f32>,
  uInputPixel:vec4<f32>,
  uInputClamp:vec4<f32>,
  uOutputFrame:vec4<f32>,
  uGlobalFrame:vec4<f32>,
  uOutputTexture:vec4<f32>,
};

struct BlurUniforms {
  uStrength:f32,
};

@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(0) @binding(1) var uTexture: texture_2d<f32>;
@group(0) @binding(2) var uSampler : sampler;

@group(1) @binding(0) var<uniform> blurUniforms : BlurUniforms;


struct VSOutput {
    @builtin(position) position: vec4<f32>,
    %blur-struct%
  };

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;

    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;
    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;

    return vec4(position, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  
}

fn getSize() -> vec2<f32>
{
  return gfu.uGlobalFrame.zw;
}


@vertex
fn mainVertex(
  @location(0) aPosition : vec2<f32>, 
) -> VSOutput {

  let filteredCord = filterTextureCoord(aPosition);

  let pixelStrength = gfu.uInputSize.%dimension% * blurUniforms.uStrength;

  return VSOutput(
   filterVertexPosition(aPosition),
    %blur-vertex-out%
  );
}

@fragment
fn mainFragment(
  @builtin(position) position: vec4<f32>,
  %blur-fragment-in%
) -> @location(0) vec4<f32> {

    var   finalColor = vec4(0.0);

    %blur-sampling%

    return finalColor;
}`;function Gx(i,t){const e=Lu[t],s=e.length,r=[],n=[],a=[];for(let u=0;u<t;u++){r[u]=`@location(${u}) offset${u}: vec2<f32>,`,i?n[u]=`filteredCord + vec2(${u-s+1} * pixelStrength, 0.0),`:n[u]=`filteredCord + vec2(0.0, ${u-s+1} * pixelStrength),`;const f=u<s?u:t-u-1,d=e[f].toString();a[u]=`finalColor += textureSample(uTexture, uSampler, offset${u}) * ${d};`}const o=r.join(`
`),h=n.join(`
`),l=a.join(`
`),c=Wx.replace("%blur-struct%",o).replace("%blur-vertex-out%",h).replace("%blur-fragment-in%",o).replace("%blur-sampling%",l).replace("%dimension%",i?"z":"w");return js.from({vertex:{source:c,entryPoint:"mainVertex"},fragment:{source:c,entryPoint:"mainFragment"}})}const Du=class Yu extends Yc{constructor(t){t={...Yu.defaultOptions,...t};const e=Ux(t.horizontal,t.kernelSize),s=Gx(t.horizontal,t.kernelSize);super({glProgram:e,gpuProgram:s,resources:{blurUniforms:{uStrength:{value:0,type:"f32"}}},...t}),this.horizontal=t.horizontal,this._quality=0,this.quality=t.quality,this.blur=t.strength,this._uniforms=this.resources.blurUniforms.uniforms}apply(t,e,s,r){if(this._uniforms.uStrength=this.strength/this.passes,this.passes===1)t.applyFilter(this,e,s,r);else{const n=Ii.getSameSizeTexture(e);let a=e,o=n;this._state.blend=!1;const h=t.renderer.type===Fi.WEBGPU;for(let l=0;l<this.passes-1;l++){t.applyFilter(this,a,o,l===0?!0:h);const c=o;o=a,a=c}this._state.blend=!0,t.applyFilter(this,a,s,r),Ii.returnTexture(n)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}};Du.defaultOptions={strength:8,quality:4,kernelSize:5};let Nn=Du;class ao extends Yc{constructor(...t){let e=t[0]??{};typeof e=="number"&&(q(rt,"BlurFilter constructor params are now options object. See params: { strength, quality, resolution, kernelSize }"),e={strength:e},t[1]!==void 0&&(e.quality=t[1]),t[2]!==void 0&&(e.resolution=t[2]||"inherit"),t[3]!==void 0&&(e.kernelSize=t[3])),e={...Nn.defaultOptions,...e};const{strength:s,strengthX:r,strengthY:n,quality:a,...o}=e;super({...o,compatibleRenderers:Fi.BOTH,resources:{}}),this._repeatEdgePixels=!1,this.blurXFilter=new Nn({horizontal:!0,...e}),this.blurYFilter=new Nn({horizontal:!1,...e}),this.quality=a,this.strengthX=r??s,this.strengthY=n??s,this.repeatEdgePixels=!1}apply(t,e,s,r){const n=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(n&&a){const o=Ii.getSameSizeTexture(e);this.blurXFilter.blendMode="normal",this.blurXFilter.apply(t,e,o,!0),this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(t,o,s,r),Ii.returnTexture(o)}else a?(this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(t,e,s,r)):(this.blurXFilter.blendMode=this.blendMode,this.blurXFilter.apply(t,e,s,r))}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.blur),Math.abs(this.blurYFilter.blur))*2}get strength(){if(this.strengthX!==this.strengthY)throw new Error("BlurFilter's strengthX and strengthY are different");return this.strengthX}set strength(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get strengthX(){return this.blurXFilter.blur}set strengthX(t){this.blurXFilter.blur=t,this.updatePadding()}get strengthY(){return this.blurYFilter.blur}set strengthY(t){this.blurYFilter.blur=t,this.updatePadding()}get blur(){return q("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength}set blur(t){q("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength=t}get blurX(){return q("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX}set blurX(t){q("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX=t}get blurY(){return q("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY}set blurY(t){q("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}ao.defaultOptions={strength:8,quality:4,kernelSize:5};class Oe extends $s{constructor(t){t instanceof ee&&(t={context:t});const{context:e,roundPixels:s,...r}=t||{};super({label:"Graphics",...r}),this.renderPipeId="graphics",e?this._context=e:this._context=this._ownedContext=new ee,this._context.on("update",this.onViewUpdate,this),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=s??!1}set context(t){t!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=t,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):(t===!0||(t==null?void 0:t.context)===!0)&&this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new Oe(this._context.clone()):(this._ownedContext=null,new Oe(this._context))}lineStyle(t,e,s){q(rt,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const r={};return t&&(r.width=t),e&&(r.color=e),s&&(r.alpha=s),this.context.strokeStyle=r,this}beginFill(t,e){q(rt,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const s={};return t!==void 0&&(s.color=t),e!==void 0&&(s.alpha=e),this.context.fillStyle=s,this}endFill(){q(rt,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return(t.width!==ee.defaultStrokeStyle.width||t.color!==ee.defaultStrokeStyle.color||t.alpha!==ee.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...t){return q(rt,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return q(rt,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return q(rt,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return q(rt,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return q(rt,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return q(rt,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}const Xu=class zu extends Ja{constructor(...t){let e=t[0]??{};e instanceof Float32Array&&(q(rt,"use new MeshGeometry({ positions, uvs, indices }) instead"),e={positions:e,uvs:t[1],indices:t[2]}),e={...zu.defaultOptions,...e};const s=e.positions||new Float32Array([0,0,1,0,1,1,0,1]);let r=e.uvs;r||(e.positions?r=new Float32Array(s.length):r=new Float32Array([0,0,1,0,1,1,0,1]));const n=e.indices||new Uint32Array([0,1,2,0,2,3]),a=e.shrinkBuffersToFit,o=new Te({data:s,label:"attribute-mesh-positions",shrinkToFit:a,usage:ft.VERTEX|ft.COPY_DST}),h=new Te({data:r,label:"attribute-mesh-uvs",shrinkToFit:a,usage:ft.VERTEX|ft.COPY_DST}),l=new Te({data:n,label:"index-mesh-buffer",shrinkToFit:a,usage:ft.INDEX|ft.COPY_DST});super({attributes:{aPosition:{buffer:o,format:"float32x2",stride:2*4,offset:0},aUV:{buffer:h,format:"float32x2",stride:2*4,offset:0}},indexBuffer:l,topology:e.topology}),this.batchMode="auto"}get positions(){return this.attributes.aPosition.buffer.data}set positions(t){this.attributes.aPosition.buffer.data=t}get uvs(){return this.attributes.aUV.buffer.data}set uvs(t){this.attributes.aUV.buffer.data=t}get indices(){return this.indexBuffer.data}set indices(t){this.indexBuffer.data=t}};Xu.defaultOptions={topology:"triangle-list",shrinkBuffersToFit:!1};let Hx=Xu;class $x{constructor({matrix:t,observer:e}={}){this.dirty=!0,this._matrix=t??new et,this.observer=e,this.position=new Ct(this,0,0),this.scale=new Ct(this,1,1),this.pivot=new Ct(this,0,0),this.skew=new Ct(this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1}get matrix(){const t=this._matrix;return this.dirty&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this.dirty=!1),t}_onUpdate(t){var e;this.dirty=!0,t===this.skew&&this.updateSkew(),(e=this.observer)==null||e._onUpdate(this)}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this.dirty=!0}toString(){return`[pixi.js/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}setFromMatrix(t){t.decompose(this),this.dirty=!0}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this.skew))}}const Nu=class wr extends $s{constructor(...t){let e=t[0]||{};e instanceof U&&(e={texture:e}),t.length>1&&(q(rt,"use new TilingSprite({ texture, width:100, height:100 }) instead"),e.width=t[1],e.height=t[2]),e={...wr.defaultOptions,...e};const{texture:s,anchor:r,tilePosition:n,tileScale:a,tileRotation:o,width:h,height:l,applyAnchorToTexture:c,roundPixels:u,...f}=e??{};super({label:"TilingSprite",...f}),this.renderPipeId="tilingSprite",this.batched=!0,this.allowChildren=!1,this._anchor=new Ct({_onUpdate:()=>{this.onViewUpdate()}}),this.applyAnchorToTexture=c,this.texture=s,this._width=h??s.width,this._height=l??s.height,this._tileTransform=new $x({observer:{_onUpdate:()=>this.onViewUpdate()}}),r&&(this.anchor=r),this.tilePosition=n,this.tileScale=a,this.tileRotation=o,this.roundPixels=u??!1}static from(t,e={}){return typeof t=="string"?new wr({texture:ht.get(t),...e}):new wr({texture:t,...e})}get uvRespectAnchor(){return mt("uvRespectAnchor is deprecated, please use applyAnchorToTexture instead"),this.applyAnchorToTexture}set uvRespectAnchor(t){mt("uvRespectAnchor is deprecated, please use applyAnchorToTexture instead"),this.applyAnchorToTexture=t}get clampMargin(){return this._texture.textureMatrix.clampMargin}set clampMargin(t){this._texture.textureMatrix.clampMargin=t}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get tilePosition(){return this._tileTransform.position}set tilePosition(t){this._tileTransform.position.copyFrom(t)}get tileScale(){return this._tileTransform.scale}set tileScale(t){typeof t=="number"?this._tileTransform.scale.set(t):this._tileTransform.scale.copyFrom(t)}set tileRotation(t){this._tileTransform.rotation=t}get tileRotation(){return this._tileTransform.rotation}get tileTransform(){return this._tileTransform}set texture(t){t||(t=U.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this.onViewUpdate())}get texture(){return this._texture}set width(t){this._width=t,this.onViewUpdate()}get width(){return this._width}set height(t){this._height=t,this.onViewUpdate()}get height(){return this._height}setSize(t,e){typeof t=="object"&&(e=t.height??t.width,t=t.width),this._width=t,this._height=e??t,this.onViewUpdate()}getSize(t){return t||(t={}),t.width=this._width,t.height=this._height,t}updateBounds(){const t=this._bounds,e=this._anchor,s=this._width,r=this._height;t.minX=-e._x*s,t.maxX=t.minX+s,t.minY=-e._y*r,t.maxY=t.minY+r}containsPoint(t){const e=this._width,s=this._height,r=-e*this._anchor._x;let n=0;return t.x>=r&&t.x<=r+e&&(n=-s*this._anchor._y,t.y>=n&&t.y<=n+s)}destroy(t=!1){if(super.destroy(t),this._anchor=null,this._tileTransform=null,this._bounds=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const s=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(s)}this._texture=null}};Nu.defaultOptions={texture:U.EMPTY,anchor:{x:0,y:0},tilePosition:{x:0,y:0},tileScale:{x:1,y:1},tileRotation:0,applyAnchorToTexture:!1};let jx=Nu;class qx extends $s{constructor(t,e){const{text:s,resolution:r,style:n,anchor:a,width:o,height:h,roundPixels:l,...c}=t;super({...c}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=e,this.text=s??"",this.style=n,this.resolution=r??null,this.allowChildren=!1,this._anchor=new Ct({_onUpdate:()=>{this.onViewUpdate()}}),a&&(this.anchor=a),this.roundPixels=l??!1,o!==void 0&&(this.width=o),h!==void 0&&(this.height=h)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}set text(t){t=t.toString(),this._text!==t&&(this._text=t,this.onViewUpdate())}get text(){return this._text}set resolution(t){this._autoResolution=t===null,this._resolution=t,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(t){var e;t||(t={}),(e=this._style)==null||e.off("update",this.onViewUpdate,this),t instanceof this._styleClass?this._style=t:this._style=new this._styleClass(t),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(t){this._setWidth(t,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(t){this._setHeight(t,this.bounds.height)}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this.bounds.width,t.height=Math.abs(this.scale.y)*this.bounds.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this.bounds.width),e!==void 0&&this._setHeight(e,this.bounds.height)}containsPoint(t){const e=this.bounds.width,s=this.bounds.height,r=-e*this.anchor.x;let n=0;return t.x>=r&&t.x<=r+e&&(n=-s*this.anchor.y,t.y>=n&&t.y<=n+s)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}destroy(t=!1){super.destroy(t),this.owner=null,this._bounds=null,this._anchor=null,(typeof t=="boolean"?t:t!=null&&t.style)&&this._style.destroy(t),this._style=null,this._text=null}}function Kx(i,t){let e=i[0]??{};return(typeof e=="string"||i[1])&&(q(rt,`use new ${t}({ text: "hi!", style }) instead`),e={text:e,style:i[1]}),e}let ts=null,Re=null;function Zx(i,t){ts||(ts=ut.get().createCanvas(256,128),Re=ts.getContext("2d",{willReadFrequently:!0}),Re.globalCompositeOperation="copy",Re.globalAlpha=1),(ts.width<i||ts.height<t)&&(ts.width=Ys(i),ts.height=Ys(t))}function eh(i,t,e){for(let s=0,r=4*e*t;s<t;++s,r+=4)if(i[r+3]!==0)return!1;return!0}function sh(i,t,e,s,r){const n=4*t;for(let a=s,o=s*n+4*e;a<=r;++a,o+=n)if(i[o+3]!==0)return!1;return!0}function Qx(...i){let t=i[0];t.canvas||(t={canvas:i[0],resolution:i[1]});const{canvas:e}=t,s=Math.min(t.resolution??1,1),r=t.width??e.width,n=t.height??e.height;let a=t.output;if(Zx(r,n),!Re)throw new TypeError("Failed to get canvas 2D context");Re.drawImage(e,0,0,r,n,0,0,r*s,n*s);const h=Re.getImageData(0,0,r,n).data;let l=0,c=0,u=r-1,f=n-1;for(;c<n&&eh(h,r,c);)++c;if(c===n)return pt.EMPTY;for(;eh(h,r,f);)--f;for(;sh(h,r,l,c,f);)++l;for(;sh(h,r,u,c,f);)--u;return++u,++f,Re.globalCompositeOperation="source-over",Re.strokeRect(l,c,u-l,f-c),Re.globalCompositeOperation="copy",a??(a=new pt),a.set(l/s,c/s,(u-l)/s,(f-c)/s),a}const ih=new pt;class Jx{getCanvasAndContext(t){const{text:e,style:s,resolution:r=1}=t,n=s._getFinalPadding(),a=Se.measureText(e||" ",s),o=Math.ceil(Math.ceil(Math.max(1,a.width)+n*2)*r),h=Math.ceil(Math.ceil(Math.max(1,a.height)+n*2)*r),l=Ir.getOptimalCanvasAndContext(o,h);this._renderTextToCanvas(e,s,n,r,l);const c=s.trim?Qx({canvas:l.canvas,width:o,height:h,resolution:1,output:ih}):ih.set(0,0,o,h);return{canvasAndContext:l,frame:c}}returnCanvasAndContext(t){Ir.returnCanvasAndContext(t)}_renderTextToCanvas(t,e,s,r,n){var b,y,S,v;const{canvas:a,context:o}=n,h=Pr(e),l=Se.measureText(t||" ",e),c=l.lines,u=l.lineHeight,f=l.lineWidths,d=l.maxLineWidth,p=l.fontProperties,m=a.height;if(o.resetTransform(),o.scale(r,r),o.textBaseline=e.textBaseline,(b=e._stroke)!=null&&b.width){const A=e._stroke;o.lineWidth=A.width,o.miterLimit=A.miterLimit,o.lineJoin=A.join,o.lineCap=A.cap}o.font=h;let g,_;const w=e.dropShadow?2:1;for(let A=0;A<w;++A){const C=e.dropShadow&&A===0,T=C?Math.ceil(Math.max(1,m)+s*2):0,P=T*r;if(C){o.fillStyle="black",o.strokeStyle="black";const F=e.dropShadow,I=F.color,E=F.alpha;o.shadowColor=St.shared.setValue(I).setAlpha(E).toRgbaString();const R=F.blur*r,O=F.distance*r;o.shadowBlur=R,o.shadowOffsetX=Math.cos(F.angle)*O,o.shadowOffsetY=Math.sin(F.angle)*O+P}else{if(o.fillStyle=e._fill?Fr(e._fill,o,l):null,(y=e._stroke)!=null&&y.width){const F=e._stroke.width*e._stroke.alignment;o.strokeStyle=Fr(e._stroke,o,l,F)}o.shadowColor="black"}let M=(u-p.fontSize)/2;u-p.fontSize<0&&(M=0);const B=((S=e._stroke)==null?void 0:S.width)??0;for(let F=0;F<c.length;F++)g=B/2,_=B/2+F*u+p.ascent+M,e.align==="right"?g+=d-f[F]:e.align==="center"&&(g+=(d-f[F])/2),(v=e._stroke)!=null&&v.width&&this._drawLetterSpacing(c[F],e,n,g+s,_+s-T,!0),e._fill!==void 0&&this._drawLetterSpacing(c[F],e,n,g+s,_+s-T)}}_drawLetterSpacing(t,e,s,r,n,a=!1){const{context:o}=s,h=e.letterSpacing;let l=!1;if(Se.experimentalLetterSpacingSupported&&(Se.experimentalLetterSpacing?(o.letterSpacing=`${h}px`,o.textLetterSpacing=`${h}px`,l=!0):(o.letterSpacing="0px",o.textLetterSpacing="0px")),h===0||l){a?o.strokeText(t,r,n):o.fillText(t,r,n);return}let c=r;const u=Se.graphemeSegmenter(t);let f=o.measureText(t).width,d=0;for(let p=0;p<u.length;++p){const m=u[p];a?o.strokeText(m,c,n):o.fillText(m,c,n);let g="";for(let _=p+1;_<u.length;++_)g+=u[_];d=o.measureText(g).width,c+=f-d+h,f=d}}}const rh=new Jx;class Er extends qx{constructor(...t){const e=Kx(t,"Text");super(e,Ws),this.renderPipeId="text",e.textureStyle&&(this.textureStyle=e.textureStyle instanceof Xs?e.textureStyle:new Xs(e.textureStyle))}updateBounds(){const t=this._bounds,e=this._anchor;let s=0,r=0;if(this._style.trim){const{frame:n,canvasAndContext:a}=rh.getCanvasAndContext({text:this.text,style:this._style,resolution:1});rh.returnCanvasAndContext(a),s=n.width,r=n.height}else{const n=Se.measureText(this._text,this._style);s=n.width,r=n.height}t.minX=-e._x*s,t.maxX=t.minX+s,t.minY=-e._y*r,t.maxY=t.minY+r}}function ty(i,t,e){q("8.7.0","Please use container.collectRenderables instead.");const s=e.renderPipes?e:e.batch.renderer;return i.collectRenderables(t,s,null)}const Uu=class Wu extends Hx{constructor(...t){super({});let e=t[0]??{};typeof e=="number"&&(q(rt,"PlaneGeometry constructor changed please use { width, height, verticesX, verticesY } instead"),e={width:e,height:t[1],verticesX:t[2],verticesY:t[3]}),this.build(e)}build(t){t={...Wu.defaultOptions,...t},this.verticesX=this.verticesX??t.verticesX,this.verticesY=this.verticesY??t.verticesY,this.width=this.width??t.width,this.height=this.height??t.height;const e=this.verticesX*this.verticesY,s=[],r=[],n=[],a=this.verticesX-1,o=this.verticesY-1,h=this.width/a,l=this.height/o;for(let u=0;u<e;u++){const f=u%this.verticesX,d=u/this.verticesX|0;s.push(f*h,d*l),r.push(f/a,d/o)}const c=a*o;for(let u=0;u<c;u++){const f=u%a,d=u/a|0,p=d*this.verticesX+f,m=d*this.verticesX+f+1,g=(d+1)*this.verticesX+f,_=(d+1)*this.verticesX+f+1;n.push(p,m,g,m,_,g)}this.buffers[0].data=new Float32Array(s),this.buffers[1].data=new Float32Array(r),this.indexBuffer.data=new Uint32Array(n),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}};Uu.defaultOptions={width:100,height:100,verticesX:10,verticesY:10};let ey=Uu;const Gu=class Hu extends ey{constructor(t={}){t={...Hu.defaultOptions,...t},super({width:t.width,height:t.height,verticesX:4,verticesY:4}),this.update(t)}update(t){var e,s;this.width=t.width??this.width,this.height=t.height??this.height,this._originalWidth=t.originalWidth??this._originalWidth,this._originalHeight=t.originalHeight??this._originalHeight,this._leftWidth=t.leftWidth??this._leftWidth,this._rightWidth=t.rightWidth??this._rightWidth,this._topHeight=t.topHeight??this._topHeight,this._bottomHeight=t.bottomHeight??this._bottomHeight,this._anchorX=(e=t.anchor)==null?void 0:e.x,this._anchorY=(s=t.anchor)==null?void 0:s.y,this.updateUvs(),this.updatePositions()}updatePositions(){const t=this.positions,{width:e,height:s,_leftWidth:r,_rightWidth:n,_topHeight:a,_bottomHeight:o,_anchorX:h,_anchorY:l}=this,c=r+n,u=e>c?1:e/c,f=a+o,d=s>f?1:s/f,p=Math.min(u,d),m=h*e,g=l*s;t[0]=t[8]=t[16]=t[24]=-m,t[2]=t[10]=t[18]=t[26]=r*p-m,t[4]=t[12]=t[20]=t[28]=e-n*p-m,t[6]=t[14]=t[22]=t[30]=e-m,t[1]=t[3]=t[5]=t[7]=-g,t[9]=t[11]=t[13]=t[15]=a*p-g,t[17]=t[19]=t[21]=t[23]=s-o*p-g,t[25]=t[27]=t[29]=t[31]=s-g,this.getBuffer("aPosition").update()}updateUvs(){const t=this.uvs;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1;const e=1/this._originalWidth,s=1/this._originalHeight;t[2]=t[10]=t[18]=t[26]=e*this._leftWidth,t[9]=t[11]=t[13]=t[15]=s*this._topHeight,t[4]=t[12]=t[20]=t[28]=1-e*this._rightWidth,t[17]=t[19]=t[21]=t[23]=1-s*this._bottomHeight,this.getBuffer("aUV").update()}};Gu.defaultOptions={width:100,height:100,leftWidth:10,topHeight:10,rightWidth:10,bottomHeight:10,originalWidth:100,originalHeight:100};let As=Gu;const $u=class ju extends $s{constructor(t){var f,d,p,m;t instanceof U&&(t={texture:t});const{width:e,height:s,anchor:r,leftWidth:n,rightWidth:a,topHeight:o,bottomHeight:h,texture:l,roundPixels:c,...u}=t;super({label:"NineSliceSprite",...u}),this.renderPipeId="nineSliceSprite",this.batched=!0,this._leftWidth=n??((f=l==null?void 0:l.defaultBorders)==null?void 0:f.left)??As.defaultOptions.leftWidth,this._topHeight=o??((d=l==null?void 0:l.defaultBorders)==null?void 0:d.top)??As.defaultOptions.topHeight,this._rightWidth=a??((p=l==null?void 0:l.defaultBorders)==null?void 0:p.right)??As.defaultOptions.rightWidth,this._bottomHeight=h??((m=l==null?void 0:l.defaultBorders)==null?void 0:m.bottom)??As.defaultOptions.bottomHeight,this._width=e??l.width??As.defaultOptions.width,this._height=s??l.height??As.defaultOptions.height,this.allowChildren=!1,this.texture=l??ju.defaultOptions.texture,this.roundPixels=c??!1,this._anchor=new Ct({_onUpdate:()=>{this.onViewUpdate()}}),r?this.anchor=r:this.texture.defaultAnchor&&(this.anchor=this.texture.defaultAnchor)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return this._width}set width(t){this._width=t,this.onViewUpdate()}get height(){return this._height}set height(t){this._height=t,this.onViewUpdate()}setSize(t,e){typeof t=="object"&&(e=t.height??t.width,t=t.width),this._width=t,this._height=e??t,this.onViewUpdate()}getSize(t){return t||(t={}),t.width=this._width,t.height=this._height,t}get leftWidth(){return this._leftWidth}set leftWidth(t){this._leftWidth=t,this.onViewUpdate()}get topHeight(){return this._topHeight}set topHeight(t){this._topHeight=t,this.onViewUpdate()}get rightWidth(){return this._rightWidth}set rightWidth(t){this._rightWidth=t,this.onViewUpdate()}get bottomHeight(){return this._bottomHeight}set bottomHeight(t){this._bottomHeight=t,this.onViewUpdate()}get texture(){return this._texture}set texture(t){t||(t=U.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this.onViewUpdate())}get originalWidth(){return this._texture.width}get originalHeight(){return this._texture.height}destroy(t){if(super.destroy(t),typeof t=="boolean"?t:t==null?void 0:t.texture){const s=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(s)}this._texture=null}updateBounds(){const t=this._bounds,e=this._anchor,s=this._width,r=this._height;t.minX=-e._x*s,t.maxX=t.minX+s,t.minY=-e._y*r,t.maxY=t.minY+r}};$u.defaultOptions={texture:U.EMPTY};let Ke=$u;at.add(np,ap);var Un={},oi={},nh;function ji(){if(nh)return oi;nh=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.Collector=void 0;let i=class{constructor(e){this.emit=(...s)=>{e.emitCollecting(this,s)}}};return oi.Collector=i,oi}var li={},ah;function sy(){if(ah)return li;ah=1,Object.defineProperty(li,"__esModule",{value:!0}),li.CollectorArray=void 0;const i=ji();let t=class extends i.Collector{constructor(){super(...arguments),this.result=[]}handleResult(s){return this.result.push(s),!0}getResult(){return this.result}reset(){this.result.length=0}};return li.CollectorArray=t,li}var hi={},oh;function iy(){if(oh)return hi;oh=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.CollectorLast=void 0;const i=ji();let t=class extends i.Collector{handleResult(s){return this.result=s,!0}getResult(){return this.result}reset(){delete this.result}};return hi.CollectorLast=t,hi}var ci={},lh;function ry(){if(lh)return ci;lh=1,Object.defineProperty(ci,"__esModule",{value:!0}),ci.CollectorUntil0=void 0;const i=ji();let t=class extends i.Collector{constructor(){super(...arguments),this.result=!1}handleResult(s){return this.result=s,this.result}getResult(){return this.result}reset(){this.result=!1}};return ci.CollectorUntil0=t,ci}var ui={},hh;function ny(){if(hh)return ui;hh=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.CollectorWhile0=void 0;const i=ji();let t=class extends i.Collector{constructor(){super(...arguments),this.result=!1}handleResult(s){return this.result=s,!this.result}getResult(){return this.result}reset(){this.result=!1}};return ui.CollectorWhile0=t,ui}var di={},fi={},ch;function ay(){if(ch)return fi;ch=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.SignalConnectionImpl=void 0;class i{constructor(e,s){this.link=e,this.parentCleanup=s}disconnect(){return this.link!==null?(this.link.unlink(),this.link=null,this.parentCleanup(),this.parentCleanup=null,!0):!1}set enabled(e){this.link&&this.link.setEnabled(e)}get enabled(){return this.link!==null&&this.link.isEnabled()}}return fi.SignalConnectionImpl=i,fi}var pi={},uh;function oy(){if(uh)return pi;uh=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.SignalLink=void 0;let i=class qu{constructor(e=null,s=null,r=0){this.enabled=!0,this.newLink=!1,this.callback=null,this.prev=e??this,this.next=s??this,this.order=r}isEnabled(){return this.enabled&&!this.newLink}setEnabled(e){this.enabled=e}unlink(){this.callback=null,this.next.prev=this.prev,this.prev.next=this.next}insert(e,s){let r=this.prev;for(;r!==this&&!(r.order<=s);)r=r.prev;const n=new qu(r,r.next,s);return n.callback=e,r.next=n,n.next.prev=n,n}};return pi.SignalLink=i,pi}var dh;function ly(){if(dh)return di;dh=1,Object.defineProperty(di,"__esModule",{value:!0}),di.Signal=void 0;const i=ay(),t=oy();let e=class{constructor(){this.head=new t.SignalLink,this.hasNewLinks=!1,this.emitDepth=0,this.connectionsCount=0}getConnectionsCount(){return this.connectionsCount}hasConnections(){return this.connectionsCount>0}connect(r,n=0){this.connectionsCount++;const a=this.head.insert(r,n);return this.emitDepth>0&&(this.hasNewLinks=!0,a.newLink=!0),new i.SignalConnectionImpl(a,()=>this.decrementConnectionCount())}decrementConnectionCount(){this.connectionsCount--}disconnect(r){for(let n=this.head.next;n!==this.head;n=n.next)if(n.callback===r)return this.decrementConnectionCount(),n.unlink(),!0;return!1}disconnectAll(){for(;this.head.next!==this.head;)this.head.next.unlink();this.connectionsCount=0}emit(...r){this.emitDepth++;for(let n=this.head.next;n!==this.head;n=n.next)n.isEnabled()&&n.callback&&n.callback.apply(null,r);this.emitDepth--,this.unsetNewLink()}emitCollecting(r,n){this.emitDepth++;for(let a=this.head.next;a!==this.head;a=a.next)if(a.isEnabled()&&a.callback){const o=a.callback.apply(null,n);if(!r.handleResult(o))break}this.emitDepth--,this.unsetNewLink()}unsetNewLink(){if(this.hasNewLinks&&this.emitDepth===0){for(let r=this.head.next;r!==this.head;r=r.next)r.newLink=!1;this.hasNewLinks=!1}}};return di.Signal=e,di}var mi={},fh;function hy(){if(fh)return mi;fh=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.SignalConnections=void 0;let i=class{constructor(){this.list=[]}add(e){this.list.push(e)}disconnectAll(){for(const e of this.list)e.disconnect();this.list=[]}getCount(){return this.list.length}isEmpty(){return this.list.length===0}};return mi.SignalConnections=i,mi}var ph;function cy(){return ph||(ph=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.SignalConnections=i.Signal=i.CollectorWhile0=i.CollectorUntil0=i.CollectorLast=i.CollectorArray=i.Collector=void 0;var t=ji();Object.defineProperty(i,"Collector",{enumerable:!0,get:function(){return t.Collector}});var e=sy();Object.defineProperty(i,"CollectorArray",{enumerable:!0,get:function(){return e.CollectorArray}});var s=iy();Object.defineProperty(i,"CollectorLast",{enumerable:!0,get:function(){return s.CollectorLast}});var r=ry();Object.defineProperty(i,"CollectorUntil0",{enumerable:!0,get:function(){return r.CollectorUntil0}});var n=ny();Object.defineProperty(i,"CollectorWhile0",{enumerable:!0,get:function(){return n.CollectorWhile0}});var a=ly();Object.defineProperty(i,"Signal",{enumerable:!0,get:function(){return a.Signal}});var o=hy();Object.defineProperty(i,"SignalConnections",{enumerable:!0,get:function(){return o.SignalConnections}})}(Un)),Un}var He=cy(),uy=Object.defineProperty,dy=(i,t,e)=>t in i?uy(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Ne=(i,t,e)=>dy(i,typeof t!="symbol"?t+"":t,e);class fy{constructor(){Ne(this,"_isMouseIn"),Ne(this,"_isDown"),Ne(this,"onDown"),Ne(this,"onUp"),Ne(this,"onUpOut"),Ne(this,"onOut"),Ne(this,"onPress"),Ne(this,"onHover"),this.onPress=new He.Signal,this.onDown=new He.Signal,this.onUp=new He.Signal,this.onHover=new He.Signal,this.onOut=new He.Signal,this.onUpOut=new He.Signal}connectEvents(t){Rs.any?(t.on("pointerdown",this.processDown,this),t.on("pointerup",this.processUp,this),t.on("pointerupoutside",this.processUpOut,this),t.on("pointerout",this.processOut,this),t.on("pointertap",this.processPress,this),t.on("pointerover",this.processOver,this)):(t.on("mousedown",this.processDown,this),t.on("mouseup",this.processUp,this),t.on("mouseupoutside",this.processUpOut,this),t.on("mouseout",this.processOut,this),t.on("click",this.processPress,this),t.on("mouseover",this.processOver,this))}disconnectEvents(t){Rs.any?(t.off("pointerdown",this.processDown,this),t.off("pointerup",this.processUp,this),t.off("pointerupoutside",this.processUpOut,this),t.off("pointerout",this.processOut,this),t.off("pointertap",this.processPress,this),t.off("pointerover",this.processOver,this)):(t.off("mousedown",this.processDown,this),t.off("mouseup",this.processUp,this),t.off("mouseupoutside",this.processUpOut,this),t.off("mouseout",this.processOut,this),t.off("click",this.processPress,this),t.off("mouseover",this.processOver,this))}processDown(t){this._isDown=!0,this.onDown.emit(this,t),this.down(t)}processUp(t){this._isDown&&(this.onUp.emit(this,t),this.up(t)),this._isDown=!1}processUpOut(t){this._isDown&&(this.onUp.emit(this,t),this.onUpOut.emit(this,t),this.up(t),this.upOut(t)),this._isDown=!1}processOut(t){this._isMouseIn&&(this._isMouseIn=!1,this.onOut.emit(this,t),this.out(t))}processPress(t){this._isDown=!1,this.onPress.emit(this,t),this.press(t)}processOver(t){Rs.any||(this._isMouseIn=!0,this.onHover.emit(this,t),this.hover(t))}down(t){}up(t){}upOut(t){}out(t){}press(t){}hover(t){}get isDown(){return this._isDown}}var py=Object.defineProperty,my=(i,t,e)=>t in i?py(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,We=(i,t,e)=>my(i,typeof t!="symbol"?t+"":t,e);let gy=class extends fy{constructor(t){super(),We(this,"_view"),t&&(this.view=t,this.enabled=!0)}set view(t){!!this._view&&this.disconnectEvents(this._view),this._view=t,this.connectEvents(this._view)}get view(){return this._view}set enabled(t){if(!this.view){console.error("Button view is not set. Please set it before enabling the button.");return}this.view.eventMode=t?"static":"auto",this.view.cursor=t?"pointer":"default",!t&&this.isDown&&this.processUp()}get enabled(){return this.view.eventMode==="static"}};class xy extends ot{constructor(t){super(),We(this,"button"),We(this,"onDown"),We(this,"onUp"),We(this,"onUpOut"),We(this,"onOut"),We(this,"onPress"),We(this,"onHover"),this.button=new gy(this),this.button.enabled=!0,t&&this.addChild(t),this.onPress=this.button.onPress,this.onDown=this.button.onDown,this.onUp=this.button.onUp,this.onHover=this.button.onHover,this.onOut=this.button.onOut,this.onUpOut=this.button.onUpOut}set enabled(t){this.button.enabled=t}get enabled(){return this.button.enabled}}function Ls(i){return typeof i=="string"?Zt.from(i):i instanceof U?new Zt(i):i}var yy=Object.defineProperty,by=(i,t,e)=>t in i?yy(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,gi=(i,t,e)=>by(i,typeof t!="symbol"?t+"":t,e);class _y extends ot{constructor(t){super(),gi(this,"_progress",0),gi(this,"options"),gi(this,"bgCircle",new Oe),gi(this,"fillCircle",new Oe),gi(this,"innerView",new ot),this.options=t,this.addChild(this.innerView),this.innerView.addChild(this.bgCircle,this.fillCircle),this.addBackground(),t.value&&(this.progress=t.value)}addBackground(){const{backgroundColor:t,lineWidth:e,radius:s,backgroundAlpha:r}=this.options;let n=1;r>0&&(n=r),t===void 0&&(n=1e-6),this.bgCircle.circle(0,0,s).stroke({width:e,color:t,alpha:n})}set progress(t){t>100&&(t=100),t<0&&(t=0),this._progress=t;const{lineWidth:e,radius:s,fillColor:r,fillAlpha:n,cap:a}=this.options;if(t===0&&n===0){this.fillCircle.clear();return}const o=0,h=360/100*t;this.fillCircle.clear().arc(0,0,s,(-90+o)*ea,(-90+o+h)*ea).stroke({width:e,color:r,cap:a,alpha:n})}get progress(){return this._progress}}var wy=Object.defineProperty,vy=(i,t,e)=>t in i?wy(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Ue=(i,t,e)=>vy(i,typeof t!="symbol"?t+"":t,e);class Sy extends ot{constructor(t){super(),Ue(this,"bg"),Ue(this,"fill"),Ue(this,"fillMask"),Ue(this,"progressStart",0),Ue(this,"_progress",0),Ue(this,"options"),Ue(this,"innerView"),Ue(this,"_view"),this.options=t,this.innerView=new ot,this.addChild(this.innerView),t!=null&&t.bg&&(t!=null&&t.fill)&&this.init(t)}init({bg:t,fill:e,fillPaddings:s,progress:r}){this.setBackground(t),this.setFill(e,s),this.progress=r}setBackground(t){var e;this.bg&&this.bg.destroy(),(e=this.options)!=null&&e.nineSliceSprite&&(typeof t=="string"?this.bg=new Ke({texture:U.from(t),leftWidth:this.options.nineSliceSprite.bg[0],topHeight:this.options.nineSliceSprite.bg[1],rightWidth:this.options.nineSliceSprite.bg[2],bottomHeight:this.options.nineSliceSprite.bg[3]}):t instanceof U?this.bg=new Ke({texture:t,leftWidth:this.options.nineSliceSprite.bg[0],topHeight:this.options.nineSliceSprite.bg[1],rightWidth:this.options.nineSliceSprite.bg[2],bottomHeight:this.options.nineSliceSprite.bg[3]}):console.warn(`NineSliceSprite can not be used with views set as Container.
                    Pass the texture or texture name as instead of the Container extended instance.`)),this.bg||(this.bg=Ls(t)),this.innerView.addChildAt(this.bg,0)}setFill(t,e){var c;if(this.fill&&this.fill.destroy(),this.bg instanceof Zt&&t===this.bg){console.warn("Can not use same Sprite instance for bg and fill.");return}(c=this.options)!=null&&c.nineSliceSprite?typeof t=="string"||t instanceof U?this.fill=new Ke({texture:typeof t=="string"?U.from(t):t,leftWidth:this.options.nineSliceSprite.fill[0],topHeight:this.options.nineSliceSprite.fill[1],rightWidth:this.options.nineSliceSprite.fill[2],bottomHeight:this.options.nineSliceSprite.fill[3]}):(console.warn(`NineSliceSprite can not be used with views set as Container.
                    Pass the texture or texture name as instead of the Container extended instance.`),this.fill=Ls(t)):this.fill=Ls(t),this.innerView.addChildAt(this.fill,1);const s=(e==null?void 0:e.left)??0,r=(e==null?void 0:e.top)??0;this.fill.x=s,this.fill.y=r,this.fillMask&&(this.fill.mask=null,this.fillMask.destroy());const n=this.fill.width/2,a=this.fill.width/2,o=this.fill.height/2,h=this.fill.height/2;let l=U.WHITE;this.fill instanceof Zt&&this.fill.texture&&(l=this.fill.texture),this.fillMask=new Ke({texture:l,leftWidth:n,topHeight:o,rightWidth:a,bottomHeight:h}),this.fillMask.position.copyFrom(this.fill),this.addChild(this.fillMask),this.fill.mask=this.fillMask}validate(t){return t=Math.round(t),t<0?0:t>100?100:t}set progress(t){this._progress=this.validate(t),this.fill&&this.fillMask&&(this.fill.mask=null,this.fillMask.width=this.fill.width/100*(this._progress-this.progressStart),this.fillMask.x=this.progressStart/100*this.fill.width+this.fill.x,this.fillMask.height=this.fill.height,this.fill.mask=this.fillMask)}get progress(){return this._progress}set width(t){var e,s,r;if((e=this.options)!=null&&e.nineSliceSprite){if(this.bg&&(this.bg.width=t),this.fill){const n=((s=this.options.fillPaddings)==null?void 0:s.left)??0,a=((r=this.options.fillPaddings)==null?void 0:r.right)??0;this.fill.width=t-n-a,this.fillMask.width=t-n-a}this.progress=this._progress}else super.width=t}get width(){return super.width}set height(t){var e,s,r;if((e=this.options)!=null&&e.nineSliceSprite){if(this.bg&&(this.bg.height=t),this.fill){const n=((s=this.options.fillPaddings)==null?void 0:s.top)??0,a=((r=this.options.fillPaddings)==null?void 0:r.bottom)??0;this.fill.height=t-n-a,this.fillMask.height=t-n-a}this.progress=this._progress}else super.height=t}get height(){return super.height}setSize(t,e){var s,r,n,a,o;if((s=this.options)!=null&&s.nineSliceSprite){if(this.bg&&this.bg.setSize(t,e),this.fill){typeof t=="object"?(e=t.height??t.width,t=t.width):e=e??t;const h=((r=this.options.fillPaddings)==null?void 0:r.top)??0,l=((n=this.options.fillPaddings)==null?void 0:n.bottom)??0,c=((a=this.options.fillPaddings)==null?void 0:a.left)??0,u=((o=this.options.fillPaddings)==null?void 0:o.right)??0;this.fill.setSize(t-c-u,e-h-l),this.fillMask.setSize(t-c-u,e-h-l)}this.progress=this._progress}else super.setSize(t,e)}}var Ay=Object.defineProperty,Cy=(i,t,e)=>t in i?Ay(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Ut=(i,t,e)=>Cy(i,typeof t!="symbol"?t+"":t,e);class Ty extends Sy{constructor(t){super(t),Ut(this,"_slider1"),Ut(this,"_slider2"),Ut(this,"value1Text"),Ut(this,"value2Text"),Ut(this,"_value1"),Ut(this,"_value2"),Ut(this,"dragging",0),Ut(this,"_min",0),Ut(this,"_max",100),Ut(this,"_step",1),Ut(this,"startX"),Ut(this,"startUpdateValue1"),Ut(this,"startUpdateValue2"),Ut(this,"settings"),this.settings=t,this.slider1=t.slider1,this.slider2=t.slider2,this.min=t.min??0,this.max=t.max??100}init(t){super.init(t),this.fill&&(this.fill.eventMode="none")}set slider1(t){if(t&&(this._slider1&&(this.slider1.removeAllListeners(),this.slider1.destroy()),this._slider1=this.createSlider(t),this.settings.showValue&&!this.value1Text)){const e=this.settings.valueTextClass??Er;this.value1Text=new e({text:"",style:this.settings.valueTextStyle||{fill:16777215}}),this.value1Text.anchor.set(.5),this.addChild(this.value1Text)}}get slider1(){return this._slider1}set slider2(t){if(t&&(this._slider2&&(this.slider2.removeAllListeners(),this.slider2.destroy()),this._slider2=this.createSlider(t),this.settings.showValue&&!this.value2Text)){const e=this.settings.valueTextClass??Er;this.value2Text=new e({text:"",style:this.settings.valueTextStyle||{fill:16777215}}),this.value2Text.anchor.set(.5),this.addChild(this.value2Text)}}get slider2(){return this._slider2}setBackground(t){this.bg&&this.bg.removeAllListeners(),super.setBackground(t),this.activateBG()}activateBG(){this.bg.eventMode="static",this.bg.on("pointerdown",this.startUpdate,this).on("globalpointermove",this.update,this).on("pointerup",this.endUpdate,this).on("pointerupoutside",this.endUpdate,this)}createSlider(t){var n,a;const e=Ls(t),s=o=>{this.bg&&(o.currentTarget=this.bg),this.startUpdate(o)};e.eventMode="static",e.on("pointerdown",s).on("pointerup",this.endUpdate,this).on("pointerupoutside",this.endUpdate,this),e.x=e.width/2;const r=new ot;return r.addChild(e),e instanceof Zt&&e.anchor.set(.5),r.y=(n=this.bg)!=null&&n.height?((a=this.bg)==null?void 0:a.height)/2:0,this.addChild(r),r}startUpdate(t){this.dragging=1;const e=t.currentTarget;this.startX=e.parent.worldTransform.applyInverse(t.global).x,this.startUpdateValue1=this._value1,this.startUpdateValue2=this._value2,this.update(t)}endUpdate(){this.dragging&&(this.dragging=0,(this.startX||this.startUpdateValue1!==this._value1||this.startUpdateValue2!==this._value2)&&this.change(),this.startUpdateValue1=null,this.startUpdateValue2=null)}onClick(){this.change()}update(t){const e=t.currentTarget,{x:s}=e.parent.worldTransform.applyInverse(t.global);s!==this.startX&&(this.startX=null)}change(){}set max(t){this._max=t}get max(){return this._max}set min(t){this._min=t}get min(){return this._min}set step(t){this._step=t}get step(){return this._step}}/*!
 * tweedle.js - v2.1.0
 * Compiled Wed, 05 Apr 2023 15:21:25 UTC
 *
 * tweedle.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 * 
 * Copyright 2019-2021, Milton Candelero <miltoncandelero@gmail.com>, All Rights Reserved
 */let vi;typeof self>"u"&&typeof process<"u"&&process.hrtime?vi=function(){const i=process.hrtime();return i[0]*1e3+i[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?vi=self.performance.now.bind(self.performance):Date.now!==void 0?vi=Date.now:vi=function(){return new Date().getTime()};class ce{constructor(){ce.prototype.__init.call(this),ce.prototype.__init2.call(this),ce.prototype.__init3.call(this),ce.prototype.__init4.call(this)}__init(){this._tweens={}}static get shared(){return ce._shared||(ce._shared=new ce),ce._shared}__init2(){this._paused=!1}isPaused(){return this._paused}pause(){this._paused=!0}resume(){this._paused=!1}__init3(){this._lastUpdateTime=void 0}__init4(){this.now=vi}getAll(){return Object.keys(this._tweens).map(t=>this._tweens[t])}removeAll(){this._tweens={}}add(t){this._tweens[t.getId()]=t}remove(t){delete this._tweens[t.getId()]}update(t,e=!1){if(t==null&&(this._lastUpdateTime==null?(this._lastUpdateTime=this.now(),t=0):t=this.now()-this._lastUpdateTime),this._lastUpdateTime=this.now(),this._paused)return!1;const s=Object.keys(this._tweens);if(s.length==0)return!1;for(let r=0;r<s.length;r++){const n=this._tweens[s[r]];n&&n.update(t,!0)==!1&&!e&&delete this._tweens[s[r]]}return!0}}const My={Linear:{None(i){return i}}},Ku={Geom:{Linear(i,t){const e=i.length-1,s=e*t,r=Math.floor(s),n=Ku.Utils.Linear;return t<0?n(i[0],i[1],s):t>1?n(i[e],i[e-1],e-s):n(i[r],i[r+1>e?e:r+1],s-r)}},Utils:{Linear(i,t,e){return(t-i)*e+i}}};let Zu=class Qu{static __initStatic(){this._nextId=0}static nextId(){return Qu._nextId++}};Zu.__initStatic();const pr={safetyCheckFunction:i=>!0,easingFunction:My.Linear.None,yoyoEasingFunction:void 0,interpolationFunction:Ku.Geom.Linear};class ct{__init(){this._isPaused=!1}__init2(){this._valuesStart={}}__init3(){this._valuesEnd={}}__init4(){this._valuesStartRepeat={}}__init5(){this._duration=0}__init6(){this._repeatCount=0}__init7(){this._repeat=0}__init8(){this._yoyo=!1}__init9(){this._isPlaying=!1}get _reversed(){return this.yoyo&&this._repeatCount%2!==0}__init10(){this._delayTime=0}__init11(){this._startTime=0}__init12(){this._elapsedTime=0}__init13(){this._timescale=1}__init14(){this._safetyCheckFunction=pr.safetyCheckFunction}__init15(){this._easingFunction=pr.easingFunction}__init16(){this._yoyoEasingFunction=pr.yoyoEasingFunction}__init17(){this._interpolationFunction=pr.interpolationFunction}__init18(){this._chainedTweens=[]}__init19(){this._onStartCallbackFired=!1}__init20(){this._onAfterDelayCallbackFired=!1}__init21(){this._id=Zu.nextId()}__init22(){this._isChainStopped=!1}get _group(){return this._groupRef?this._groupRef:ce.shared}set _group(t){this._groupRef=t}constructor(t,e){ct.prototype.__init.call(this),ct.prototype.__init2.call(this),ct.prototype.__init3.call(this),ct.prototype.__init4.call(this),ct.prototype.__init5.call(this),ct.prototype.__init6.call(this),ct.prototype.__init7.call(this),ct.prototype.__init8.call(this),ct.prototype.__init9.call(this),ct.prototype.__init10.call(this),ct.prototype.__init11.call(this),ct.prototype.__init12.call(this),ct.prototype.__init13.call(this),ct.prototype.__init14.call(this),ct.prototype.__init15.call(this),ct.prototype.__init16.call(this),ct.prototype.__init17.call(this),ct.prototype.__init18.call(this),ct.prototype.__init19.call(this),ct.prototype.__init20.call(this),ct.prototype.__init21.call(this),ct.prototype.__init22.call(this),this._object=t,this._group=e}getId(){return this._id}getGroup(){return this._group}getTimescale(){return this._timescale}isPlaying(){return this._isPlaying}isPaused(){return this._isPaused}from(t){try{JSON.stringify(t)}catch{throw new Error("The object you provided to the from() method has a circular reference!")}return this._setupProperties(t,this._valuesStart,t,this._valuesStartRepeat,!0),this}to(t,e){try{this._valuesEnd=JSON.parse(JSON.stringify(t))}catch{return console.warn("The object you provided to the to() method has a circular reference!. It can't be cloned. Falling back to dynamic targeting"),this.dynamicTo(t,e)}return e!==void 0&&(this._duration=e),this}dynamicTo(t,e){return this._valuesEnd=t,e!==void 0&&(this._duration=e),this}duration(t){return this._duration=t,this}start(t){return this._isPlaying?this:(t!=null&&(this._delayTime=t),this._group.add(this),this._reversed&&(this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat))),this._repeatCount=0,this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onAfterDelayCallbackFired=!1,this._isChainStopped=!1,this._startTime=-this._delayTime,this._elapsedTime=0,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,!1),this)}restart(t){return this.reset(),this.start(t)}reset(){return this._isPlaying&&this.stop(),this._valuesStart={},this._valuesStartRepeat={},this}rewind(){this._isPlaying&&this.stop(),this._reversed&&this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd);const t=this._easingFunction(0);return this._updateProperties(this._object,this._valuesStart,this._valuesEnd,t),this}_setupProperties(t,e,s,r,n){for(const a in s){const o=t[a],h=Array.isArray(o),l=!Number.isNaN(Number(o)),c=h?"array":typeof o,u=c=="object",f=typeof s[a]=="object",d=!h&&Array.isArray(s[a]);c=="undefined"||c=="function"||s[a]==null||!h&&!l&&!u||((u||h||f)&&o&&!d?(typeof e[a]>"u"&&(e[a]=h?[]:{}),typeof r[a]>"u"&&(r[a]=h?[]:{}),this._setupProperties(o,e[a],s[a],r[a],n)):((typeof e[a]>"u"||n)&&(e[a]=o),(typeof r[a]>"u"||n)&&(d?r[a]=s[a].slice().reverse()[0]:r[a]=e[a]||0)))}}stop(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object,this),this):this}end(t=!1){let e=[];if(t||(e=this._chainedTweens,this._chainedTweens=[]),this.resume(),this.update(1/0),!t){this._chainedTweens=e;for(let s=0,r=this._chainedTweens.length;s<r;s++)this._chainedTweens[s].start()}return this}skip(t,e=!1){return this.resume(),this.update(t*this._duration-(e?this._elapsedTime:0)),this}pause(){return this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._group.remove(this),this)}resume(){return!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._group.add(this),this)}stopChainedTweens(){for(let t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this}startChainedTweens(t=!1){t&&this.stop();for(let e=0,s=this._chainedTweens.length;e<s;e++)this._chainedTweens[e].start();return this}group(t){return this._group=t,this}delay(t){return this._delayTime=t,this}timescale(t){return this._timescale=t,this}repeat(t=1/0){return this._repeat=t,this}repeatDelay(t){return this._repeatDelayTime=t,this}yoyo(t=!0){return this._yoyo=t,this}easing(t){return this._easingFunction=t,this}safetyCheck(t){return this._safetyCheckFunction=t,this}yoyoEasing(t){return this._yoyoEasingFunction=t,this}interpolation(t){return this._interpolationFunction=t,this}chain(...t){return this._chainedTweens=t,this}onStart(t){return this._onStartCallback=t,this}onAfterDelay(t){return this._onAfterDelayCallback=t,this}onUpdate(t){return this._onUpdateCallback=t,this}onRepeat(t){return this._onRepeatCallback=t,this}onComplete(t){return this._onCompleteCallback=t,this}onStop(t){return this._onStopCallback=t,this}update(t,e=!1){const s=this._internalUpdate(t);return!s&&!e&&this._group.remove(this),s}_internalUpdate(t){if(!this._safetyCheckFunction(this._object)||this._isPaused)return!1;t*=this._timescale;let e;this._elapsedTime+=t;const s=this._duration,r=this._startTime+this._elapsedTime;if(r>s&&!this._isPlaying)return!1;this.isPlaying||this.start(),this._onStartCallbackFired==!1&&(this._onStartCallback&&this._onStartCallback(this._object,this),this._onStartCallbackFired=!0),this._onAfterDelayCallbackFired==!1&&r>=0&&(this._onAfterDelayCallback&&this._onAfterDelayCallback(this._object,this),this._onAfterDelayCallbackFired=!0),e=r/this._duration,this._duration==0&&(r>=0?e=1:e=0),e=Math.min(1,e),e=Math.max(0,e);let n=Number.isFinite(r)?r%this._duration:r;Number.isNaN(n)&&(n=0);const a=Math.floor(r/this._duration);let o;if(this._reversed&&this._yoyoEasingFunction?o=this._yoyoEasingFunction(e):o=this._easingFunction(e),this._updateProperties(this._object,this._valuesStart,this._valuesEnd,o),this._onUpdateCallback&&(e!=1||this._repeat-this._repeatCount<=0)&&this._onUpdateCallback(this._object,e,this),e==1){if(this._repeat-this._repeatCount>0){const h=this._repeatCount;if(this._repeatCount=Math.min(this._repeat+1,this._repeatCount+a),this._onUpdateCallback&&(this._repeat-this._repeatCount<0||n<=0)&&this._onUpdateCallback(this._object,e,this),this._yoyo?this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd):this._moveForwardStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat)),this._repeatDelayTime!==void 0?this._startTime=-this._repeatDelayTime:this._startTime=0,this._onRepeatCallback){let l=1;Number.isFinite(a)?l=this._repeatCount-h:Number.isFinite(this._repeat)&&(l=this._repeat-h);for(let c=0;c<l;c++)this._onRepeatCallback(this._object,h+1+c,this)}if(this._elapsedTime=0,this._repeat-this._repeatCount>=0)return n>0&&Number.isFinite(this._repeat)&&this._internalUpdate(n),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object,this);for(let h=0,l=this._chainedTweens.length;h<l;h++)this._chainedTweens[h].start(),n>0&&this._chainedTweens[h].update(n);return this._isPlaying=!1,!1}return!0}_updateProperties(t,e,s,r){for(const n in s){if(e[n]==null)continue;const a=e[n];let o=s[n];const h=Array.isArray(t[n]),l=Array.isArray(o);!h&&l?this._reversed?t[n]=this._interpolationFunction(o.concat([a]),r):t[n]=this._interpolationFunction([a].concat(o),r):typeof o=="object"&&o?this._updateProperties(t[n],a,o,r):(o=this._handleRelativeValue(a,o),typeof o=="number"&&(typeof a=="number"||typeof a=="string")&&(t[n]=Number(a)+(o-Number(a))*r,typeof a=="string"&&(t[n]=String(t[n]))))}}_handleRelativeValue(t,e){return typeof e!="string"?e:e.charAt(0)=="+"||e.charAt(0)=="-"?t+Number(e):Number(e)}_swapEndStartRepeatValues(t,e){for(const s in t){const r=!Array.isArray(t[s])&&Array.isArray(e[s]);if(typeof t[s]=="object")this._swapEndStartRepeatValues(t[s],e[s]);else{const n=t[s];if(typeof e[s]=="string")t[s]=Number(t[s])+Number(e[s]),e[s]=n;else if(r){const a=e[s].slice().reverse();t[s]=a[0],e[s]=a}else t[s]=e[s],e[s]=n}}}_moveForwardStartRepeatValues(t,e){for(const s in t)typeof e[s]=="object"?this._moveForwardStartRepeatValues(t[s],e[s]):typeof e[s]=="string"&&(t[s]=Number(t[s])+Number(e[s]))}}function mh(i,t,e=0,s=!0){let r=t.scale.x,n=t.scale.y;if(!i)throw new Error("Parent is not defined");const a=i.width-e*2,o=i.height-e*2,h=a-Math.round(t.width),l=o-Math.round(t.height);if(h<0&&(r=a/(t.width/r)),l<0&&(n=o/(t.height/n)),r<=0||n<=0){t.scale.set(0);return}if(s||t.scale.x===t.scale.y){const c=Math.min(r,n);t.scale.set(c,c)}else{const c=t.scale.x/t.scale.y;h<l?t.scale.set(r,r/c):t.scale.set(n*c,n)}}function Py(i){return typeof i=="string"||typeof i=="number"?new Er({text:String(i)}):i}var ky=Object.defineProperty,Iy=(i,t,e)=>t in i?ky(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Vt=(i,t,e)=>Iy(i,typeof t!="symbol"?t+"":t,e);class wa extends xy{constructor(t){super(),Vt(this,"animations"),Vt(this,"originalInnerViewState"),Vt(this,"defaultDuration",100),Vt(this,"options"),Vt(this,"_padding"),Vt(this,"_offset"),Vt(this,"_textOffset"),Vt(this,"iconOffset"),Vt(this,"innerView",new ot),Vt(this,"_views",{}),Vt(this,"state"),Vt(this,"anchor"),Vt(this,"_defaultTextScale",{x:1,y:1}),Vt(this,"_defaultIconScale",{x:1,y:1}),Vt(this,"_defaultTextAnchor",{x:.5,y:.5}),Vt(this,"_defaultIconAnchor",{x:.5,y:.5}),this.options=t??{};const{defaultView:e,hoverView:s,pressedView:r,disabledView:n,text:a,padding:o,offset:h,textOffset:l,iconOffset:c,defaultTextScale:u,defaultIconScale:f,defaultTextAnchor:d,defaultIconAnchor:p,scale:m,anchor:g,anchorX:_,anchorY:w,icon:b,animations:y}=t??{};this.addChild(this.innerView),this.anchor=new Ct({_onUpdate:()=>this.updateAnchor()}),this.anchor.set(_??g??0,w??g??0),this.padding=o??0,this.offset=h,this.textOffset=l,this.iconOffset=c,this.defaultTextScale=u,this.defaultIconScale=f,this.defaultTextAnchor=d,this.defaultIconAnchor=p,this.scale.set(m??1),y&&(this.animations=y,Yt.shared.add(()=>ce.shared.update())),this.setState("default"),this.defaultView=e,this.hoverView=s,this.pressedView=r,this.disabledView=n,this.text=a,this.iconView=b,this.initStateControl()}set text(t){if(!t||t===0){this.removeView("textView");return}if(!this._views.textView){this.createTextView(t);return}this._views.textView.text=t.toString()}get text(){var t;return(t=this._views.textView)==null?void 0:t.text}set enabled(t){this.button.enabled=t,this.setState(t?"default":"disabled")}get enabled(){return this.button.enabled}setState(t,e=!1){if(!e&&this.state===t)return;const s=this.getStateView(this.state);s&&(s.visible=!1),this.state=t;const r=this.getStateView(t);r&&(this.setOffset(r,t,this.offset),r.visible=!0),this.updateAnchor(),this.playAnimations(t)}createTextView(t){var e;if(this._views.textView=Py(t),((e=this.options)==null?void 0:e.defaultTextScale)===void 0){const{x:s,y:r}=this._views.textView.scale;this._defaultTextScale={x:s,y:r}}this.innerView.addChild(this._views.textView),this.adjustTextView(this.state)}setOffset(t,e,s){const r=s?s[e]:{x:0,y:0},n=s==null?void 0:s.default;r?(t.x+=r.x??0,t.y+=r.y??0):n?(t.x+=n.x??0,t.y+=n.y??0):(s.x||s.y)&&(t.x+=s.x??0,t.y+=s.y??0)}getStateView(t){if(this._views)switch(t){case"hover":return this._views.hoverView??this._views.defaultView??void 0;case"pressed":return this._views.pressedView??this._views.hoverView??this._views.defaultView??void 0;case"disabled":return this._views.disabledView??this._views.defaultView??void 0;case"default":return this._views.defaultView??void 0;default:return}}adjustTextView(t){if(!this.text)return;const e=this.getStateView(this.state),{x:s,y:r}=this._defaultTextAnchor;if(e){if(this.options.ignoreRefitting||this._views.textView.scale.set(this._defaultTextScale.x,this._defaultTextScale.y),this.contentFittingMode==="default"&&mh(e,this._views.textView,this.padding,!1),this.contentFittingMode==="fill"){this._views.textView.scale.set(1);const n=e.width-this.padding*2,a=e.height-this.padding*2,o=n/this._views.textView.width,h=a/this._views.textView.height,l=Math.min(o,h);this._views.textView.scale.set(l*this._defaultTextScale.x,l*this._defaultTextScale.y)}this._views.textView.x=e.x+e.width/2,this._views.textView.y=e.y+e.height/2}this._views.textView.anchor.set(s,r),this.setOffset(this._views.textView,t,this.textOffset)}adjustIconView(t){if(!this._views.iconView)return;const e=this.getStateView(t);if(!e)return;if(this.options.ignoreRefitting||this._views.iconView.scale.set(this._defaultIconScale.x,this._defaultIconScale.y),this.contentFittingMode==="default"&&mh(e,this._views.iconView,this.padding,!1),this.contentFittingMode==="fill"){this._views.iconView.scale.set(1);const n=e.width-this.padding*2,a=e.height-this.padding*2,o=n/this._views.iconView.width,h=a/this._views.iconView.height,l=Math.min(o,h);this._views.iconView.scale.set(l*this._defaultIconScale.x,l*this._defaultIconScale.y)}const{x:s,y:r}=this._defaultIconAnchor;"anchor"in this._views.iconView?this._views.iconView.anchor.set(s,r):this._views.iconView.pivot.set(s*(this._views.iconView.width/this._views.iconView.scale.x),r*(this._views.iconView.height/this._views.iconView.scale.y)),this._views.iconView.x=e.x+e.width/2,this._views.iconView.y=e.y+e.height/2,this.setOffset(this._views.iconView,t,this.iconOffset)}updateAnchor(){if(!this._views)return;const t=this.anchor.x??0,e=this.anchor.y??0;if([this._views.defaultView,this._views.hoverView,this._views.pressedView,this._views.disabledView].forEach(r=>{var n;r&&((n=r.anchor)==null||n.set(0),r.x=-r.width*t,r.y=-r.height*e)}),this._views.defaultView){const{x:r,y:n,width:a,height:o}=this._views.defaultView;this.hitArea=new pt(r,n,a,o)}this.adjustIconView(this.state),this.adjustTextView(this.state)}set contentFittingMode(t){this.options.contentFittingMode=t}get contentFittingMode(){return this.options.contentFittingMode??"default"}set defaultView(t){this.updateView("defaultView",t),this._views.disabledView&&this.state!=="default"&&(this._views.disabledView.visible=!1)}get defaultView(){return this._views.defaultView}set hoverView(t){this.updateView("hoverView",t),this._views.hoverView&&this.state!=="hover"&&(this._views.hoverView.visible=!1)}get hoverView(){return this._views.hoverView}set pressedView(t){this.updateView("pressedView",t),this._views.pressedView&&this.state!=="pressed"&&(this._views.pressedView.visible=!1)}get pressedView(){return this._views.pressedView}set disabledView(t){this.updateView("disabledView",t),this._views.disabledView&&this.state!=="disabled"&&(this._views.disabledView.visible=!1)}get disabledView(){return this._views.disabledView}updateView(t,e){var s;e!==void 0&&(this.removeView(t),e!==null&&((s=this.options)!=null&&s.nineSliceSprite&&(typeof e=="string"?this._views[t]=new Ke({texture:U.from(e),leftWidth:this.options.nineSliceSprite[0],topHeight:this.options.nineSliceSprite[1],rightWidth:this.options.nineSliceSprite[2],bottomHeight:this.options.nineSliceSprite[3]}):e instanceof U?this._views[t]=new Ke({texture:e,leftWidth:this.options.nineSliceSprite[0],topHeight:this.options.nineSliceSprite[1],rightWidth:this.options.nineSliceSprite[2],bottomHeight:this.options.nineSliceSprite[3]}):console.warn("NineSliceSprite can not be used with views set as Container. Pass the texture or texture name as instead of the Container extended instance.")),this._views[t]||(this._views[t]=Ls(e)),this.setOffset(this._views[t],this.state,this.offset),this._views[t].parent||this.innerView.addChild(this._views[t]),this.updateAnchor(),this._views.iconView&&this.innerView.addChild(this._views.iconView),this._views.textView&&this.innerView.addChild(this._views.textView),this.setState(this.state,!0)))}removeView(t){this._views[t]&&(this.innerView.removeChild(this._views[t]),this._views[t]=null)}set textView(t){t!==void 0&&(this.removeView("textView"),t!==null&&this.createTextView(t))}get textView(){return this._views.textView}set iconView(t){var e;if(t!==void 0&&(this.removeView("iconView"),t!==null)){if(this._views.iconView=Ls(t),((e=this.options)==null?void 0:e.defaultIconScale)===void 0){const{x:s,y:r}=this._views.iconView.scale;this._defaultIconScale={x:s,y:r}}this._views.iconView.parent||this.innerView.addChild(this._views.iconView),this.setState(this.state,!0)}}get iconView(){return this._views.iconView}playAnimations(t){var s;if(!this.animations)return;if(t==="default"&&!this.originalInnerViewState){this.originalInnerViewState={x:this.innerView.x,y:this.innerView.y,width:this.innerView.width,height:this.innerView.height,scale:{x:this.innerView.scale.x,y:this.innerView.scale.y}};const r=(s=this.animations)==null?void 0:s.default;if(r){this.innerView.x=r.props.x??this.originalInnerViewState.x,this.innerView.y=r.props.y??this.originalInnerViewState.y,this.innerView.width=r.props.width??this.originalInnerViewState.width,this.innerView.height=r.props.height??this.originalInnerViewState.height,this.innerView.scale.x=r.props.scale.x??this.originalInnerViewState.scale.x,this.innerView.scale.y=r.props.scale.y??this.originalInnerViewState.scale.y;return}}const e=this.animations[t]??this.animations.default;if(e){const r=e;this.defaultDuration=r.duration,new ct(this.innerView).to(r.props,r.duration).start();return}new ct(this.innerView).to(this.originalInnerViewState,this.defaultDuration).start()}initStateControl(){this.onDown.connect(()=>{this.setState("pressed")}),this.onUp.connect(()=>{Rs.any?this.setState("default"):this.setState("hover")}),this.onUpOut.connect(()=>{this.setState("default")}),this.onOut.connect(()=>{this.button.isDown||this.setState("default")}),this.onPress.connect(()=>{Rs.any?this.setState("default"):this.setState("hover")}),this.onHover.connect(()=>{this.button.isDown||(Rs.any?this.setState("default"):this.setState("hover"))})}set padding(t){this._padding=t,this.adjustTextView(this.state),this.adjustIconView(this.state)}get padding(){return this._padding}set offset(t){this._offset=t,this.updateAnchor()}get offset(){return this._offset}set textOffset(t){this._textOffset=t,this.adjustTextView(this.state)}get textOffset(){return this._textOffset}set defaultTextScale(t){if(t===void 0)return;this.options.defaultTextScale=t;const e=typeof t=="number";this._defaultTextScale.x=e?t:t.x??1,this._defaultTextScale.y=e?t:t.y??1,this.adjustTextView(this.state)}get defaultTextScale(){return this.defaultTextScale}set defaultIconScale(t){if(t===void 0)return;this.options.defaultIconScale=t;const e=typeof t=="number";this._defaultIconScale.x=e?t:t.x??1,this._defaultIconScale.y=e?t:t.y??1,this.adjustIconView(this.state)}get defaultIconScale(){return this.defaultIconScale}set defaultTextAnchor(t){if(t===void 0)return;this.options.defaultTextAnchor=t;const e=typeof t=="number";this._defaultTextAnchor.x=e?t:t.x??1,this._defaultTextAnchor.y=e?t:t.y??1,this.adjustTextView(this.state)}get defaultTextAnchor(){return this.defaultTextAnchor}set defaultIconAnchor(t){if(t===void 0)return;this.options.defaultIconAnchor=t;const e=typeof t=="number";this._defaultIconAnchor.x=e?t:t.x??1,this._defaultIconAnchor.y=e?t:t.y??1,this.adjustIconView(this.state)}get defaultIconAnchor(){return this.defaultIconAnchor}set width(t){var e;(e=this.options)!=null&&e.nineSliceSprite?(this._views.defaultView&&(this._views.defaultView.width=t),this._views.hoverView&&(this._views.hoverView.width=t),this._views.pressedView&&(this._views.pressedView.width=t),this._views.disabledView&&(this._views.disabledView.width=t),this.adjustTextView(this.state),this.adjustIconView(this.state),this.updateAnchor()):super.width=t}get width(){return super.width}set height(t){var e;(e=this.options)!=null&&e.nineSliceSprite?(this._views.defaultView&&(this._views.defaultView.height=t),this._views.hoverView&&(this._views.hoverView.height=t),this._views.pressedView&&(this._views.pressedView.height=t),this._views.disabledView&&(this._views.disabledView.height=t),this.adjustTextView(this.state),this.adjustIconView(this.state),this.updateAnchor()):super.height=t}get height(){return super.height}setSize(t,e){var s;(s=this.options)!=null&&s.nineSliceSprite?(this._views.defaultView&&this._views.defaultView.setSize(t,e),this._views.hoverView&&this._views.hoverView.setSize(t,e),this._views.pressedView&&this._views.pressedView.setSize(t,e),this._views.disabledView&&this._views.disabledView.setSize(t,e),this.adjustTextView(this.state),this.adjustIconView(this.state),this.updateAnchor()):super.setSize(t,e)}}var Fy=Object.defineProperty,Ey=(i,t,e)=>t in i?Fy(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,xi=(i,t,e)=>Ey(i,typeof t!="symbol"?t+"":t,e);class By extends ot{constructor(t){var e;super(),xi(this,"options"),xi(this,"view"),xi(this,"_type"),xi(this,"_maxWidth"),xi(this,"children",[]),t&&(t.maxWidth&&(this._maxWidth=t.maxWidth),this.init(t)),(e=t==null?void 0:t.items)==null||e.forEach(s=>this.addChild(s)),this.on("added",()=>this.arrangeChildren()),this.on("childAdded",()=>this.arrangeChildren())}init(t){this.options=t,t!=null&&t.type&&(this.type=t.type),t!=null&&t.children&&t.children.forEach(e=>this.addChild(e))}set type(t){this._type=t,this.arrangeChildren()}get type(){return this._type}set elementsMargin(t){if(!this.options)throw new Error("List has not been initiated!");this.options.elementsMargin=t,this.arrangeChildren()}get elementsMargin(){var t;return((t=this.options)==null?void 0:t.elementsMargin)??0}set padding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.padding=t,this.options.vertPadding=t,this.options.horPadding=t,this.options.leftPadding=t,this.options.rightPadding=t,this.options.topPadding=t,this.options.bottomPadding=t,this.arrangeChildren()}get padding(){var t;return((t=this.options)==null?void 0:t.padding)??0}set vertPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.vertPadding=t,this.options.topPadding=t,this.options.bottomPadding=t,this.arrangeChildren()}get vertPadding(){var t;return((t=this.options)==null?void 0:t.vertPadding)??this.padding??0}set horPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.horPadding=t,this.options.leftPadding=t,this.options.rightPadding=t,this.arrangeChildren()}get horPadding(){var t;return((t=this.options)==null?void 0:t.horPadding)??this.padding??0}set leftPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.leftPadding=t,this.arrangeChildren()}get leftPadding(){var t;return((t=this.options)==null?void 0:t.leftPadding)??this.horPadding}set rightPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.rightPadding=t,this.arrangeChildren()}get rightPadding(){var t;return((t=this.options)==null?void 0:t.rightPadding)??this.horPadding}set topPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.topPadding=t,this.arrangeChildren()}get topPadding(){var t;return((t=this.options)==null?void 0:t.topPadding)??this.vertPadding}set bottomPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.bottomPadding=t,this.arrangeChildren()}get bottomPadding(){var t;return((t=this.options)==null?void 0:t.bottomPadding)??this.vertPadding}arrangeChildren(){var a,o;let t=0,e=this.leftPadding,s=this.topPadding;const r=((a=this.options)==null?void 0:a.elementsMargin)??0;let n=this.maxWidth??((o=this.parent)==null?void 0:o.width);this.rightPadding&&(n-=this.rightPadding),this.children.forEach((h,l)=>{switch(this.type){case"vertical":h.y=s,h.x=e,s+=r+h.height;break;case"horizontal":h.x=e,h.y=s,e+=r+h.width;break;case"bidirectional":default:h.x=e,h.y=s,h.x+h.width>n&&l>0&&(s+=r+t,e=this.leftPadding,h.x=e,h.y=s,t=0),t=Math.max(t,h.height),e+=r+h.width;break}})}removeItem(t){const e=this.children[t];e&&(this.removeChild(e),this.arrangeChildren())}set maxWidth(t){this._maxWidth=t,this.arrangeChildren()}get maxWidth(){return this._maxWidth}}var Ry=Object.defineProperty,Vy=(i,t,e)=>t in i?Ry(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Wn=(i,t,e)=>Vy(i,typeof t!="symbol"?t+"":t,e);class Oy extends Ty{constructor(t){super({slider1:t.slider,value1:t.value,...t}),Wn(this,"sliderOptions"),Wn(this,"onUpdate",new He.Signal),Wn(this,"onChange",new He.Signal),this.sliderOptions=t,this.step=t.step||1,this.value=t.value??this.min,this.updateSlider()}get value(){return this._value1}set value(t){var e;t!==this._value1&&(t<this.min&&(t=this.min),t>this.max&&(t=this.max),this._value1=t,this.updateSlider(),(e=this.onUpdate)==null||e.emit(this.value))}set max(t){super.max=t,this.updateSlider()}get max(){return super.max}set min(t){super.min=t,this.updateSlider()}get min(){return super.min}set step(t){super.step=t,this.updateSlider()}get step(){return super.step}set slider(t){this.slider1=t,this.updateSlider()}update(t){var a;if(super.update(t),!this.dragging)return;const e=t.currentTarget,{x:s}=e.parent.worldTransform.applyInverse(t.global),r=s/(((a=this.bg)==null?void 0:a.width)||1),n=this.min+r*(this.max-this.min);this.value=Math.round(n/this.step)*this.step}change(){var t;(t=this.onChange)==null||t.emit(this.value)}updateSlider(){var t,e,s,r,n;if(this.progress=((this.value??this.min)-this.min)/(this.max-this.min)*100,this._slider1.x=((t=this.bg)==null?void 0:t.width)/100*this.progress-this._slider1.width/2,this._slider1.y=((e=this.bg)==null?void 0:e.height)/2,(s=this.sliderOptions)!=null&&s.showValue){this.value1Text.text=`${Math.round(this.value)}`;const a=this._slider1.x+this._slider1.width/2,o=this._slider1.y;this.value1Text.x=a+(((r=this.sliderOptions.valueTextOffset)==null?void 0:r.x)??0),this.value1Text.y=o+(((n=this.sliderOptions.valueTextOffset)==null?void 0:n.y)??0)}}set width(t){super.width=t,this.updateSlider()}get width(){return super.width}set height(t){super.height=t,this.updateSlider()}get height(){return super.height}setSize(t,e){super.setSize(t,e),this.updateSlider()}}function oo(i){return typeof i=="object"&&!Array.isArray(i)}function Ly(i,t,e){if(i instanceof EventTarget)return[i];if(typeof i=="string"){let s=document;const r=(e==null?void 0:e[i])??s.querySelectorAll(i);return r?Array.from(r):[]}return Array.from(i)}function Ju(i,t,e,s){return typeof i=="string"&&oo(t)?Ly(i,e,s):i instanceof NodeList?Array.from(i):Array.isArray(i)?i:[i]}function Dy(i,t,e){return i*(t+1)}function gh(i,t,e,s){return typeof t=="number"?t:t.startsWith("-")||t.startsWith("+")?Math.max(0,i+parseFloat(t)):t==="<"?e:t.startsWith("<")?Math.max(0,e+parseFloat(t.slice(1))):s.get(t)??i}const qi=(i,t,e)=>i+(t-i)*e,Yy=(i,t,e)=>{const s=t-i;return((e-i)%s+s)%s+i},td=i=>Array.isArray(i)&&typeof i[0]!="number";function ed(i,t){return td(i)?i[Yy(0,i.length,t)]:i}function Xy(i,t){i.indexOf(t)===-1&&i.push(t)}function sd(i,t){const e=i.indexOf(t);e>-1&&i.splice(e,1)}function zy(i,t,e){for(let s=0;s<i.length;s++){const r=i[s];r.at>t&&r.at<e&&(sd(i,r),s--)}}function Ny(i,t,e,s,r,n){zy(i,r,n);for(let a=0;a<t.length;a++)i.push({value:t[a],at:qi(r,n,s[a]),easing:ed(e,a)})}function Uy(i,t){for(let e=0;e<i.length;e++)i[e]=i[e]/(t+1)}function Wy(i,t){return i.at===t.at?i.value===null?1:t.value===null?-1:0:i.at-t.at}const Nt=i=>!!(i&&i.getVelocity),lo=(i,t,e)=>{const s=t-i;return s===0?1:(e-i)/s};function id(i,t){const e=i[i.length-1];for(let s=1;s<=t;s++){const r=lo(0,t,s);i.push(qi(e,1,r))}}function rd(i){const t=[0];return id(t,i.length-1),t}function ho(i){return typeof i=="function"&&"applyToOptions"in i}const Br=2e4;function co(i){let t=0;const e=50;let s=i.next(t);for(;!s.done&&t<Br;)t+=e,s=i.next(t);return t>=Br?1/0:t}const Me=i=>i*1e3,Le=i=>i/1e3;function nd(i,t=100,e){const s=e({...i,keyframes:[0,t]}),r=Math.min(co(s),Br);return{type:"keyframes",ease:n=>s.next(r*n).value/t,duration:Le(r)}}let uo=()=>{};const Gy="easeInOut";function Hy(i,{defaultTransition:t={},...e}={},s,r){const n=t.duration||.3,a=new Map,o=new Map,h={},l=new Map;let c=0,u=0,f=0;for(let d=0;d<i.length;d++){const p=i[d];if(typeof p=="string"){l.set(p,u);continue}else if(!Array.isArray(p)){l.set(p.name,gh(u,p.at,c,l));continue}let[m,g,_={}]=p;_.at!==void 0&&(u=gh(u,_.at,c,l));let w=0;const b=(y,S,v,A=0,C=0)=>{const T=$y(y),{delay:P=0,times:M=rd(T),type:B="keyframes",repeat:F,repeatType:I,repeatDelay:E=0,...R}=S;let{ease:O=t.ease||"easeOut",duration:W}=S;const L=typeof P=="function"?P(A,C):P,H=T.length,Z=ho(B)?B:r==null?void 0:r[B||"keyframes"];if(H<=2&&Z){let G=100;if(H===2&&Ky(T)){const nt=T[1]-T[0];G=Math.abs(nt)}const gt={...R};W!==void 0&&(gt.duration=Me(W));const _t=nd(gt,G,Z);O=_t.ease,W=_t.duration}W??(W=n);const J=u+L;M.length===1&&M[0]===0&&(M[1]=1);const z=M.length-T.length;if(z>0&&id(M,z),T.length===1&&T.unshift(null),F){W=Dy(W,F);const G=[...T],gt=[...M];O=Array.isArray(O)?[...O]:[O];const _t=[...O];for(let nt=0;nt<F;nt++){T.push(...G);for(let lt=0;lt<G.length;lt++)M.push(gt[lt]+(nt+1)),O.push(lt===0?"linear":ed(_t,lt-1))}Uy(M,F)}const $=J+W;Ny(v,T,O,M,J,$),w=Math.max(L+W,w),f=Math.max($,f)};if(Nt(m)){const y=xh(m,o);b(g,_,yh("default",y))}else{const y=Ju(m,g,s,h),S=y.length;for(let v=0;v<S;v++){g=g,_=_;const A=y[v],C=xh(A,o);for(const T in g)b(g[T],jy(_,T),yh(T,C),v,S)}}c=u,u+=w}return o.forEach((d,p)=>{for(const m in d){const g=d[m];g.sort(Wy);const _=[],w=[],b=[];for(let S=0;S<g.length;S++){const{at:v,value:A,easing:C}=g[S];_.push(A),w.push(lo(0,f,v)),b.push(C||"easeOut")}w[0]!==0&&(w.unshift(0),_.unshift(_[0]),b.unshift(Gy)),w[w.length-1]!==1&&(w.push(1),_.push(null)),a.has(p)||a.set(p,{keyframes:{},transition:{}});const y=a.get(p);y.keyframes[m]=_,y.transition[m]={...t,duration:f,ease:b,times:w,...e}}}),a}function xh(i,t){return!t.has(i)&&t.set(i,{}),t.get(i)}function yh(i,t){return t[i]||(t[i]=[]),t[i]}function $y(i){return Array.isArray(i)?i:[i]}function jy(i,t){return i&&i[t]?{...i,...i[t]}:{...i}}const qy=i=>typeof i=="number",Ky=i=>i.every(qy),Oi=new WeakMap,Zy=i=>Array.isArray(i);function bh(i){const t=[{},{}];return i==null||i.values.forEach((e,s)=>{t[0][s]=e.get(),t[1][s]=e.getVelocity()}),t}function ad(i,t,e,s){if(typeof t=="function"){const[r,n]=bh(s);t=t(e!==void 0?e:i.custom,r,n)}if(typeof t=="string"&&(t=i.variants&&i.variants[t]),typeof t=="function"){const[r,n]=bh(s);t=t(e!==void 0?e:i.custom,r,n)}return t}function Qy(i,t,e){const s=i.getProps();return ad(s,t,s.custom,i)}const mr=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function Jy(i,t){let e=new Set,s=new Set,r=!1,n=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function h(c){a.has(c)&&(l.schedule(c),i()),c(o)}const l={schedule:(c,u=!1,f=!1)=>{const p=f&&r?e:s;return u&&a.add(c),p.has(c)||p.add(c),c},cancel:c=>{s.delete(c),a.delete(c)},process:c=>{if(o=c,r){n=!0;return}r=!0,[e,s]=[s,e],e.forEach(h),e.clear(),r=!1,n&&(n=!1,l.process(c))}};return l}const Xe={},tb=40;function eb(i,t){let e=!1,s=!0;const r={delta:0,timestamp:0,isProcessing:!1},n=()=>e=!0,a=mr.reduce((b,y)=>(b[y]=Jy(n),b),{}),{setup:o,read:h,resolveKeyframes:l,preUpdate:c,update:u,preRender:f,render:d,postRender:p}=a,m=()=>{const b=Xe.useManualTiming?r.timestamp:performance.now();e=!1,Xe.useManualTiming||(r.delta=s?1e3/60:Math.max(Math.min(b-r.timestamp,tb),1)),r.timestamp=b,r.isProcessing=!0,o.process(r),h.process(r),l.process(r),c.process(r),u.process(r),f.process(r),d.process(r),p.process(r),r.isProcessing=!1,e&&t&&(s=!1,i(m))},g=()=>{e=!0,s=!0,r.isProcessing||i(m)};return{schedule:mr.reduce((b,y)=>{const S=a[y];return b[y]=(v,A=!1,C=!1)=>(e||g(),S.schedule(v,A,C)),b},{}),cancel:b=>{for(let y=0;y<mr.length;y++)a[mr[y]].cancel(b)},state:r,steps:a}}const Ks=i=>i,{schedule:ze,cancel:va,state:Rr}=eb(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ks,!0);let vr;function sb(){vr=void 0}const ie={now:()=>(vr===void 0&&ie.set(Rr.isProcessing||Xe.useManualTiming?Rr.timestamp:performance.now()),vr),set:i=>{vr=i,queueMicrotask(sb)}};class od{constructor(){this.subscriptions=[]}add(t){return Xy(this.subscriptions,t),()=>sd(this.subscriptions,t)}notify(t,e,s){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](t,e,s);else for(let n=0;n<r;n++){const a=this.subscriptions[n];a&&a(t,e,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function ld(i,t){return t?i*(1e3/t):0}const _h=30,ib=i=>!isNaN(parseFloat(i));class rb{constructor(t,e={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=(s,r=!0)=>{var a,o;const n=ie.now();if(this.updatedAt!==n&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current),this.dependents))for(const h of this.dependents)h.dirty();r&&((o=this.events.renderRequest)==null||o.notify(this.current))},this.hasAnimated=!1,this.setCurrent(t),this.owner=e.owner}setCurrent(t){this.current=t,this.updatedAt=ie.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=ib(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,e){this.events[t]||(this.events[t]=new od);const s=this.events[t].add(e);return t==="change"?()=>{s(),ze.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,e){this.passiveEffect=t,this.stopPassiveEffect=e}set(t,e=!0){!e||!this.passiveEffect?this.updateAndNotify(t,e):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,e,s){this.set(e),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-s}jump(t,e=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,e&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=ie.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>_h)return 0;const e=Math.min(this.updatedAt-this.prevUpdatedAt,_h);return ld(parseFloat(this.current)-parseFloat(this.prevFrameValue),e)}start(t){return this.stop(),new Promise(e=>{this.hasAnimated=!0,this.animation=t(e),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,e;(t=this.dependents)==null||t.clear(),(e=this.events.destroy)==null||e.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Li(i,t){return new rb(i,t)}function nb(i,t,e){i.hasValue(t)?i.getValue(t).set(e):i.addValue(t,Li(e))}function ab(i){return Zy(i)?i[i.length-1]||0:i}function ob(i,t){const e=Qy(i,t);let{transitionEnd:s={},transition:r={},...n}=e||{};n={...n,...s};for(const a in n){const o=ab(n[a]);nb(i,a,o)}}function lb(i){return!!(Nt(i)&&i.add)}function hb(i,t){const e=i.getValue("willChange");if(lb(e))return e.add(t);if(!e&&Xe.WillChange){const s=new Xe.WillChange("auto");i.addValue("willChange",s),s.add(t)}}const fo=i=>i.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),cb="framerAppearId",ub="data-"+fo(cb);function db(i){return i.props[ub]}const fb=i=>i!==null;function pb(i,{repeat:t,repeatType:e="loop"},s){const r=i.filter(fb),n=t&&e!=="loop"&&t%2===1?0:r.length-1;return r[n]}const Zs=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Qs=new Set(Zs),mb={type:"spring",stiffness:500,damping:25,restSpeed:10},gb=i=>({type:"spring",stiffness:550,damping:i===0?2*Math.sqrt(550):30,restSpeed:10}),xb={type:"keyframes",duration:.8},yb={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},bb=(i,{keyframes:t})=>t.length>2?xb:Qs.has(i)?i.startsWith("scale")?gb(t[1]):mb:yb;function _b({when:i,delay:t,delayChildren:e,staggerChildren:s,staggerDirection:r,repeat:n,repeatType:a,repeatDelay:o,from:h,elapsed:l,...c}){return!!Object.keys(c).length}function hd(i,t){return(i==null?void 0:i[t])??(i==null?void 0:i.default)??i}const cd=i=>t=>typeof t=="string"&&t.startsWith(i),ud=cd("--"),wb=cd("var(--"),po=i=>wb(i)?vb.test(i.split("/*")[0].trim()):!1,vb=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,gs=(i,t,e)=>e>t?t:e<i?i:e,Js={test:i=>typeof i=="number",parse:parseFloat,transform:i=>i},Di={...Js,transform:i=>gs(0,1,i)},gr={...Js,default:1},Pi=i=>Math.round(i*1e5)/1e5,mo=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Sb(i){return i==null}const Ab=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,go=(i,t)=>e=>!!(typeof e=="string"&&Ab.test(e)&&e.startsWith(i)||t&&!Sb(e)&&Object.prototype.hasOwnProperty.call(e,t)),dd=(i,t,e)=>s=>{if(typeof s!="string")return s;const[r,n,a,o]=s.match(mo);return{[i]:parseFloat(r),[t]:parseFloat(n),[e]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},Cb=i=>gs(0,255,i),Gn={...Js,transform:i=>Math.round(Cb(i))},os={test:go("rgb","red"),parse:dd("red","green","blue"),transform:({red:i,green:t,blue:e,alpha:s=1})=>"rgba("+Gn.transform(i)+", "+Gn.transform(t)+", "+Gn.transform(e)+", "+Pi(Di.transform(s))+")"};function Tb(i){let t="",e="",s="",r="";return i.length>5?(t=i.substring(1,3),e=i.substring(3,5),s=i.substring(5,7),r=i.substring(7,9)):(t=i.substring(1,2),e=i.substring(2,3),s=i.substring(3,4),r=i.substring(4,5),t+=t,e+=e,s+=s,r+=r),{red:parseInt(t,16),green:parseInt(e,16),blue:parseInt(s,16),alpha:r?parseInt(r,16)/255:1}}const Sa={test:go("#"),parse:Tb,transform:os.transform},Ki=i=>({test:t=>typeof t=="string"&&t.endsWith(i)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${i}`}),Ge=Ki("deg"),Ds=Ki("%"),j=Ki("px"),Mb=Ki("vh"),Pb=Ki("vw"),wh={...Ds,parse:i=>Ds.parse(i)/100,transform:i=>Ds.transform(i*100)},ks={test:go("hsl","hue"),parse:dd("hue","saturation","lightness"),transform:({hue:i,saturation:t,lightness:e,alpha:s=1})=>"hsla("+Math.round(i)+", "+Ds.transform(Pi(t))+", "+Ds.transform(Pi(e))+", "+Pi(Di.transform(s))+")"},Pt={test:i=>os.test(i)||Sa.test(i)||ks.test(i),parse:i=>os.test(i)?os.parse(i):ks.test(i)?ks.parse(i):Sa.parse(i),transform:i=>typeof i=="string"?i:i.hasOwnProperty("red")?os.transform(i):ks.transform(i),getAnimatableNone:i=>{const t=Pt.parse(i);return t.alpha=0,Pt.transform(t)}},kb=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Ib(i){var t,e;return isNaN(i)&&typeof i=="string"&&(((t=i.match(mo))==null?void 0:t.length)||0)+(((e=i.match(kb))==null?void 0:e.length)||0)>0}const fd="number",pd="color",Fb="var",Eb="var(",vh="${}",Bb=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Yi(i){const t=i.toString(),e=[],s={color:[],number:[],var:[]},r=[];let n=0;const o=t.replace(Bb,h=>(Pt.test(h)?(s.color.push(n),r.push(pd),e.push(Pt.parse(h))):h.startsWith(Eb)?(s.var.push(n),r.push(Fb),e.push(h)):(s.number.push(n),r.push(fd),e.push(parseFloat(h))),++n,vh)).split(vh);return{values:e,split:o,indexes:s,types:r}}function md(i){return Yi(i).values}function gd(i){const{split:t,types:e}=Yi(i),s=t.length;return r=>{let n="";for(let a=0;a<s;a++)if(n+=t[a],r[a]!==void 0){const o=e[a];o===fd?n+=Pi(r[a]):o===pd?n+=Pt.transform(r[a]):n+=r[a]}return n}}const Rb=i=>typeof i=="number"?0:Pt.test(i)?Pt.getAnimatableNone(i):i;function Vb(i){const t=md(i);return gd(i)(t.map(Rb))}const ti={test:Ib,parse:md,createTransformer:gd,getAnimatableNone:Vb};function Hn(i,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?i+(t-i)*6*e:e<1/2?t:e<2/3?i+(t-i)*(2/3-e)*6:i}function Ob({hue:i,saturation:t,lightness:e,alpha:s}){i/=360,t/=100,e/=100;let r=0,n=0,a=0;if(!t)r=n=a=e;else{const o=e<.5?e*(1+t):e+t-e*t,h=2*e-o;r=Hn(h,o,i+1/3),n=Hn(h,o,i),a=Hn(h,o,i-1/3)}return{red:Math.round(r*255),green:Math.round(n*255),blue:Math.round(a*255),alpha:s}}function Vr(i,t){return e=>e>0?t:i}const $n=(i,t,e)=>{const s=i*i,r=e*(t*t-s)+s;return r<0?0:Math.sqrt(r)},Lb=[Sa,os,ks],Db=i=>Lb.find(t=>t.test(i));function Sh(i){const t=Db(i);if(!t)return!1;let e=t.parse(i);return t===ks&&(e=Ob(e)),e}const Ah=(i,t)=>{const e=Sh(i),s=Sh(t);if(!e||!s)return Vr(i,t);const r={...e};return n=>(r.red=$n(e.red,s.red,n),r.green=$n(e.green,s.green,n),r.blue=$n(e.blue,s.blue,n),r.alpha=qi(e.alpha,s.alpha,n),os.transform(r))},Aa=new Set(["none","hidden"]);function Yb(i,t){return Aa.has(i)?e=>e<=0?i:t:e=>e>=1?t:i}const Xb=(i,t)=>e=>t(i(e)),xo=(...i)=>i.reduce(Xb);function zb(i,t){return e=>qi(i,t,e)}function yo(i){return typeof i=="number"?zb:typeof i=="string"?po(i)?Vr:Pt.test(i)?Ah:Wb:Array.isArray(i)?xd:typeof i=="object"?Pt.test(i)?Ah:Nb:Vr}function xd(i,t){const e=[...i],s=e.length,r=i.map((n,a)=>yo(n)(n,t[a]));return n=>{for(let a=0;a<s;a++)e[a]=r[a](n);return e}}function Nb(i,t){const e={...i,...t},s={};for(const r in e)i[r]!==void 0&&t[r]!==void 0&&(s[r]=yo(i[r])(i[r],t[r]));return r=>{for(const n in s)e[n]=s[n](r);return e}}function Ub(i,t){const e=[],s={color:0,var:0,number:0};for(let r=0;r<t.values.length;r++){const n=t.types[r],a=i.indexes[n][s[n]],o=i.values[a]??0;e[r]=o,s[n]++}return e}const Wb=(i,t)=>{const e=ti.createTransformer(t),s=Yi(i),r=Yi(t);return s.indexes.var.length===r.indexes.var.length&&s.indexes.color.length===r.indexes.color.length&&s.indexes.number.length>=r.indexes.number.length?Aa.has(i)&&!r.values.length||Aa.has(t)&&!s.values.length?Yb(i,t):xo(xd(Ub(s,r),r.values),e):Vr(i,t)};function yd(i,t,e){return typeof i=="number"&&typeof t=="number"&&typeof e=="number"?qi(i,t,e):yo(i)(i,t)}const Gb=i=>{const t=({timestamp:e})=>i(e);return{start:(e=!0)=>ze.update(t,e),stop:()=>va(t),now:()=>Rr.isProcessing?Rr.timestamp:ie.now()}},bd=(i,t,e=10)=>{let s="";const r=Math.max(Math.round(t/e),2);for(let n=0;n<r;n++)s+=Math.round(i(n/(r-1))*1e4)/1e4+", ";return`linear(${s.substring(0,s.length-2)})`},Hb=5;function _d(i,t,e){const s=Math.max(t-Hb,0);return ld(e-i(s),t-s)}const vt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},jn=.001;function $b({duration:i=vt.duration,bounce:t=vt.bounce,velocity:e=vt.velocity,mass:s=vt.mass}){let r,n,a=1-t;a=gs(vt.minDamping,vt.maxDamping,a),i=gs(vt.minDuration,vt.maxDuration,Le(i)),a<1?(r=l=>{const c=l*a,u=c*i,f=c-e,d=Ca(l,a),p=Math.exp(-u);return jn-f/d*p},n=l=>{const u=l*a*i,f=u*e+e,d=Math.pow(a,2)*Math.pow(l,2)*i,p=Math.exp(-u),m=Ca(Math.pow(l,2),a);return(-r(l)+jn>0?-1:1)*((f-d)*p)/m}):(r=l=>{const c=Math.exp(-l*i),u=(l-e)*i+1;return-jn+c*u},n=l=>{const c=Math.exp(-l*i),u=(e-l)*(i*i);return c*u});const o=5/i,h=qb(r,n,o);if(i=Me(i),isNaN(h))return{stiffness:vt.stiffness,damping:vt.damping,duration:i};{const l=Math.pow(h,2)*s;return{stiffness:l,damping:a*2*Math.sqrt(s*l),duration:i}}}const jb=12;function qb(i,t,e){let s=e;for(let r=1;r<jb;r++)s=s-i(s)/t(s);return s}function Ca(i,t){return i*Math.sqrt(1-t*t)}const Kb=["duration","bounce"],Zb=["stiffness","damping","mass"];function Ch(i,t){return t.some(e=>i[e]!==void 0)}function Qb(i){let t={velocity:vt.velocity,stiffness:vt.stiffness,damping:vt.damping,mass:vt.mass,isResolvedFromDuration:!1,...i};if(!Ch(i,Zb)&&Ch(i,Kb))if(i.visualDuration){const e=i.visualDuration,s=2*Math.PI/(e*1.2),r=s*s,n=2*gs(.05,1,1-(i.bounce||0))*Math.sqrt(r);t={...t,mass:vt.mass,stiffness:r,damping:n}}else{const e=$b(i);t={...t,...e,mass:vt.mass},t.isResolvedFromDuration=!0}return t}function Xi(i=vt.visualDuration,t=vt.bounce){const e=typeof i!="object"?{visualDuration:i,keyframes:[0,1],bounce:t}:i;let{restSpeed:s,restDelta:r}=e;const n=e.keyframes[0],a=e.keyframes[e.keyframes.length-1],o={done:!1,value:n},{stiffness:h,damping:l,mass:c,duration:u,velocity:f,isResolvedFromDuration:d}=Qb({...e,velocity:-Le(e.velocity||0)}),p=f||0,m=l/(2*Math.sqrt(h*c)),g=a-n,_=Le(Math.sqrt(h/c)),w=Math.abs(g)<5;s||(s=w?vt.restSpeed.granular:vt.restSpeed.default),r||(r=w?vt.restDelta.granular:vt.restDelta.default);let b;if(m<1){const S=Ca(_,m);b=v=>{const A=Math.exp(-m*_*v);return a-A*((p+m*_*g)/S*Math.sin(S*v)+g*Math.cos(S*v))}}else if(m===1)b=S=>a-Math.exp(-_*S)*(g+(p+_*g)*S);else{const S=_*Math.sqrt(m*m-1);b=v=>{const A=Math.exp(-m*_*v),C=Math.min(S*v,300);return a-A*((p+m*_*g)*Math.sinh(C)+S*g*Math.cosh(C))/S}}const y={calculatedDuration:d&&u||null,next:S=>{const v=b(S);if(d)o.done=S>=u;else{let A=S===0?p:0;m<1&&(A=S===0?Me(p):_d(b,S,v));const C=Math.abs(A)<=s,T=Math.abs(a-v)<=r;o.done=C&&T}return o.value=o.done?a:v,o},toString:()=>{const S=Math.min(co(y),Br),v=bd(A=>y.next(S*A).value,S,30);return S+"ms "+v},toTransition:()=>{}};return y}Xi.applyToOptions=i=>{const t=nd(i,100,Xi);return i.ease=t.ease,i.duration=Me(t.duration),i.type="keyframes",i};function Ta({keyframes:i,velocity:t=0,power:e=.8,timeConstant:s=325,bounceDamping:r=10,bounceStiffness:n=500,modifyTarget:a,min:o,max:h,restDelta:l=.5,restSpeed:c}){const u=i[0],f={done:!1,value:u},d=C=>o!==void 0&&C<o||h!==void 0&&C>h,p=C=>o===void 0?h:h===void 0||Math.abs(o-C)<Math.abs(h-C)?o:h;let m=e*t;const g=u+m,_=a===void 0?g:a(g);_!==g&&(m=_-u);const w=C=>-m*Math.exp(-C/s),b=C=>_+w(C),y=C=>{const T=w(C),P=b(C);f.done=Math.abs(T)<=l,f.value=f.done?_:P};let S,v;const A=C=>{d(f.value)&&(S=C,v=Xi({keyframes:[f.value,p(f.value)],velocity:_d(b,C,f.value),damping:r,stiffness:n,restDelta:l,restSpeed:c}))};return A(0),{calculatedDuration:null,next:C=>{let T=!1;return!v&&S===void 0&&(T=!0,y(C),A(C)),S!==void 0&&C>=S?v.next(C-S):(!T&&y(C),f)}}}function Jb(i,t,e){const s=[],r=e||Xe.mix||yd,n=i.length-1;for(let a=0;a<n;a++){let o=r(i[a],i[a+1]);if(t){const h=Array.isArray(t)?t[a]||Ks:t;o=xo(h,o)}s.push(o)}return s}function t_(i,t,{clamp:e=!0,ease:s,mixer:r}={}){const n=i.length;if(uo(n===t.length),n===1)return()=>t[0];if(n===2&&t[0]===t[1])return()=>t[1];const a=i[0]===i[1];i[0]>i[n-1]&&(i=[...i].reverse(),t=[...t].reverse());const o=Jb(t,s,r),h=o.length,l=c=>{if(a&&c<i[0])return t[0];let u=0;if(h>1)for(;u<i.length-2&&!(c<i[u+1]);u++);const f=lo(i[u],i[u+1],c);return o[u](f)};return e?c=>l(gs(i[0],i[n-1],c)):l}function e_(i,t){return i.map(e=>e*t)}const wd=(i,t,e)=>(((1-3*e+3*t)*i+(3*e-6*t))*i+3*t)*i,s_=1e-7,i_=12;function r_(i,t,e,s,r){let n,a,o=0;do a=t+(e-t)/2,n=wd(a,s,r)-i,n>0?e=a:t=a;while(Math.abs(n)>s_&&++o<i_);return a}function Zi(i,t,e,s){if(i===t&&e===s)return Ks;const r=n=>r_(n,0,1,i,e);return n=>n===0||n===1?n:wd(r(n),t,s)}const n_=Zi(.42,0,1,1),a_=Zi(0,0,.58,1),vd=Zi(.42,0,.58,1),Sd=i=>t=>t<=.5?i(2*t)/2:(2-i(2*(1-t)))/2,Ad=i=>t=>1-i(1-t),Cd=Zi(.33,1.53,.69,.99),bo=Ad(Cd),Td=Sd(bo),Md=i=>(i*=2)<1?.5*bo(i):.5*(2-Math.pow(2,-10*(i-1))),_o=i=>1-Math.sin(Math.acos(i)),o_=Ad(_o),Pd=Sd(_o),kd=i=>Array.isArray(i)&&typeof i[0]=="number",l_={linear:Ks,easeIn:n_,easeInOut:vd,easeOut:a_,circIn:_o,circInOut:Pd,circOut:o_,backIn:bo,backInOut:Td,backOut:Cd,anticipate:Md},h_=i=>typeof i=="string",Th=i=>{if(kd(i)){uo(i.length===4);const[t,e,s,r]=i;return Zi(t,e,s,r)}else if(h_(i))return l_[i];return i};function c_(i,t){return i.map(()=>t||vd).splice(0,i.length-1)}function ki({duration:i=300,keyframes:t,times:e,ease:s="easeInOut"}){const r=td(s)?s.map(Th):Th(s),n={done:!1,value:t[0]},a=e_(e&&e.length===t.length?e:rd(t),i),o=t_(a,t,{ease:Array.isArray(r)?r:c_(t,r)});return{calculatedDuration:i,next:h=>(n.value=o(h),n.done=h>=i,n)}}const u_=i=>i!==null;function wo(i,{repeat:t,repeatType:e="loop"},s,r=1){const n=i.filter(u_),o=r<0||t&&e!=="loop"&&t%2===1?0:n.length-1;return!o||s===void 0?n[o]:s}const d_={decay:Ta,inertia:Ta,tween:ki,keyframes:ki,spring:Xi};function Id(i){typeof i.type=="string"&&(i.type=d_[i.type])}class vo{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,e){return this.finished.then(t,e)}}const f_=i=>i/100;class So extends vo{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var s,r;const{motionValue:e}=this.options;e&&e.updatedAt!==ie.now()&&this.tick(ie.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(r=(s=this.options).onStop)==null||r.call(s))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;Id(t);const{type:e=ki,repeat:s=0,repeatDelay:r=0,repeatType:n,velocity:a=0}=t;let{keyframes:o}=t;const h=e||ki;h!==ki&&typeof o[0]!="number"&&(this.mixKeyframes=xo(f_,yd(o[0],o[1])),o=[0,100]);const l=h({...t,keyframes:o});n==="mirror"&&(this.mirroredGenerator=h({...t,keyframes:[...o].reverse(),velocity:-a})),l.calculatedDuration===null&&(l.calculatedDuration=co(l));const{calculatedDuration:c}=l;this.calculatedDuration=c,this.resolvedDuration=c+r,this.totalDuration=this.resolvedDuration*(s+1)-r,this.generator=l}updateTime(t){const e=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=e}tick(t,e=!1){const{generator:s,totalDuration:r,mixKeyframes:n,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:h}=this;if(this.startTime===null)return s.next(0);const{delay:l=0,keyframes:c,repeat:u,repeatType:f,repeatDelay:d,type:p,onUpdate:m,finalKeyframe:g}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-r/this.speed,this.startTime)),e?this.currentTime=t:this.updateTime(t);const _=this.currentTime-l*(this.playbackSpeed>=0?1:-1),w=this.playbackSpeed>=0?_<0:_>r;this.currentTime=Math.max(_,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=r);let b=this.currentTime,y=s;if(u){const C=Math.min(this.currentTime,r)/o;let T=Math.floor(C),P=C%1;!P&&C>=1&&(P=1),P===1&&T--,T=Math.min(T,u+1),!!(T%2)&&(f==="reverse"?(P=1-P,d&&(P-=d/o)):f==="mirror"&&(y=a)),b=gs(0,1,P)*o}const S=w?{done:!1,value:c[0]}:y.next(b);n&&(S.value=n(S.value));let{done:v}=S;!w&&h!==null&&(v=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&v);return A&&p!==Ta&&(S.value=wo(c,this.options,g,this.speed)),m&&m(S.value),A&&this.finish(),S}then(t,e){return this.finished.then(t,e)}get duration(){return Le(this.calculatedDuration)}get time(){return Le(this.currentTime)}set time(t){var e;t=Me(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(e=this.driver)==null||e.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(ie.now());const e=this.playbackSpeed!==t;this.playbackSpeed=t,e&&(this.time=Le(this.currentTime))}play(){var r,n;if(this.isStopped)return;const{driver:t=Gb,startTime:e}=this.options;this.driver||(this.driver=t(a=>this.tick(a))),(n=(r=this.options).onPlay)==null||n.call(r);const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=e??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ie.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,e;this.notifyFinished(),this.teardown(),this.state="finished",(e=(t=this.options).onComplete)==null||e.call(t)}cancel(){var t,e;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(e=(t=this.options).onCancel)==null||e.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var e;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(e=this.driver)==null||e.stop(),t.observe(this)}}function p_(i){for(let t=1;t<i.length;t++)i[t]??(i[t]=i[t-1])}const ls=i=>i*180/Math.PI,Ma=i=>{const t=ls(Math.atan2(i[1],i[0]));return Pa(t)},m_={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:i=>(Math.abs(i[0])+Math.abs(i[3]))/2,rotate:Ma,rotateZ:Ma,skewX:i=>ls(Math.atan(i[1])),skewY:i=>ls(Math.atan(i[2])),skew:i=>(Math.abs(i[1])+Math.abs(i[2]))/2},Pa=i=>(i=i%360,i<0&&(i+=360),i),Mh=Ma,Ph=i=>Math.sqrt(i[0]*i[0]+i[1]*i[1]),kh=i=>Math.sqrt(i[4]*i[4]+i[5]*i[5]),g_={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Ph,scaleY:kh,scale:i=>(Ph(i)+kh(i))/2,rotateX:i=>Pa(ls(Math.atan2(i[6],i[5]))),rotateY:i=>Pa(ls(Math.atan2(-i[2],i[0]))),rotateZ:Mh,rotate:Mh,skewX:i=>ls(Math.atan(i[4])),skewY:i=>ls(Math.atan(i[1])),skew:i=>(Math.abs(i[1])+Math.abs(i[4]))/2};function ka(i){return i.includes("scale")?1:0}function Ia(i,t){if(!i||i==="none")return ka(t);const e=i.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let s,r;if(e)s=g_,r=e;else{const o=i.match(/^matrix\(([-\d.e\s,]+)\)$/u);s=m_,r=o}if(!r)return ka(t);const n=s[t],a=r[1].split(",").map(y_);return typeof n=="function"?n(a):a[n]}const x_=(i,t)=>{const{transform:e="none"}=getComputedStyle(i);return Ia(e,t)};function y_(i){return parseFloat(i.trim())}const Ih=i=>i===Js||i===j,b_=new Set(["x","y","z"]),__=Zs.filter(i=>!b_.has(i));function w_(i){const t=[];return __.forEach(e=>{const s=i.getValue(e);s!==void 0&&(t.push([e,s.get()]),s.set(e.startsWith("scale")?1:0))}),t}const hs={width:({x:i},{paddingLeft:t="0",paddingRight:e="0"})=>i.max-i.min-parseFloat(t)-parseFloat(e),height:({y:i},{paddingTop:t="0",paddingBottom:e="0"})=>i.max-i.min-parseFloat(t)-parseFloat(e),top:(i,{top:t})=>parseFloat(t),left:(i,{left:t})=>parseFloat(t),bottom:({y:i},{top:t})=>parseFloat(t)+(i.max-i.min),right:({x:i},{left:t})=>parseFloat(t)+(i.max-i.min),x:(i,{transform:t})=>Ia(t,"x"),y:(i,{transform:t})=>Ia(t,"y")};hs.translateX=hs.x;hs.translateY=hs.y;const cs=new Set;let Fa=!1,Ea=!1,Ba=!1;function Fd(){if(Ea){const i=Array.from(cs).filter(s=>s.needsMeasurement),t=new Set(i.map(s=>s.element)),e=new Map;t.forEach(s=>{const r=w_(s);r.length&&(e.set(s,r),s.render())}),i.forEach(s=>s.measureInitialState()),t.forEach(s=>{s.render();const r=e.get(s);r&&r.forEach(([n,a])=>{var o;(o=s.getValue(n))==null||o.set(a)})}),i.forEach(s=>s.measureEndState()),i.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}Ea=!1,Fa=!1,cs.forEach(i=>i.complete(Ba)),cs.clear()}function Ed(){cs.forEach(i=>{i.readKeyframes(),i.needsMeasurement&&(Ea=!0)})}function v_(){Ba=!0,Ed(),Fd(),Ba=!1}class Ao{constructor(t,e,s,r,n,a=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=e,this.name=s,this.motionValue=r,this.element=n,this.isAsync=a}scheduleResolve(){this.state="scheduled",this.isAsync?(cs.add(this),Fa||(Fa=!0,ze.read(Ed),ze.resolveKeyframes(Fd))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:e,element:s,motionValue:r}=this;if(t[0]===null){const n=r==null?void 0:r.get(),a=t[t.length-1];if(n!==void 0)t[0]=n;else if(s&&e){const o=s.readValue(e,a);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=a),r&&n===void 0&&r.set(t[0])}p_(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),cs.delete(this)}cancel(){this.state==="scheduled"&&(cs.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const S_=i=>i.startsWith("--");function A_(i,t,e){S_(t)?i.style.setProperty(t,e):i.style[t]=e}function Co(i){let t;return()=>(t===void 0&&(t=i()),t)}const C_=Co(()=>window.ScrollTimeline!==void 0),T_={};function M_(i,t){const e=Co(i);return()=>T_[t]??e()}const Bd=M_(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Si=([i,t,e,s])=>`cubic-bezier(${i}, ${t}, ${e}, ${s})`,Fh={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Si([0,.65,.55,1]),circOut:Si([.55,0,1,.45]),backIn:Si([.31,.01,.66,-.59]),backOut:Si([.33,1.53,.69,.99])};function Rd(i,t){if(i)return typeof i=="function"?Bd()?bd(i,t):"ease-out":kd(i)?Si(i):Array.isArray(i)?i.map(e=>Rd(e,t)||Fh.easeOut):Fh[i]}function P_(i,t,e,{delay:s=0,duration:r=300,repeat:n=0,repeatType:a="loop",ease:o="easeOut",times:h}={},l=void 0){const c={[t]:e};h&&(c.offset=h);const u=Rd(o,r);Array.isArray(u)&&(c.easing=u);const f={delay:s,duration:r,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:n+1,direction:a==="reverse"?"alternate":"normal"};return l&&(f.pseudoElement=l),i.animate(c,f)}function k_({type:i,...t}){return ho(i)&&Bd()?i.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class I_ extends vo{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:e,name:s,keyframes:r,pseudoElement:n,allowFlatten:a=!1,finalKeyframe:o,onComplete:h}=t;this.isPseudoElement=!!n,this.allowFlatten=a,this.options=t,uo(typeof t.type!="string");const l=k_(t);this.animation=P_(e,s,r,l,n),l.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!n){const c=wo(r,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(c):A_(e,s,c),this.animation.cancel()}h==null||h(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,e;(e=(t=this.animation).finish)==null||e.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,e;this.isPseudoElement||(e=(t=this.animation).commitStyles)==null||e.call(t)}get duration(){var e,s;const t=((s=(e=this.animation.effect)==null?void 0:e.getComputedTiming)==null?void 0:s.call(e).duration)||0;return Le(Number(t))}get time(){return Le(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Me(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:e}){var s;return this.allowFlatten&&((s=this.animation.effect)==null||s.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&C_()?(this.animation.timeline=t,Ks):e(this)}}const Vd={anticipate:Md,backInOut:Td,circInOut:Pd};function F_(i){return i in Vd}function E_(i){typeof i.ease=="string"&&F_(i.ease)&&(i.ease=Vd[i.ease])}const Eh=10;class B_ extends I_{constructor(t){E_(t),Id(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:e,onUpdate:s,onComplete:r,element:n,...a}=this.options;if(!e)return;if(t!==void 0){e.set(t);return}const o=new So({...a,autoplay:!1}),h=Me(this.finishedTime??this.time);e.setWithVelocity(o.sample(h-Eh).value,o.sample(h).value,Eh),o.stop()}}const Bh=(i,t)=>t==="zIndex"?!1:!!(typeof i=="number"||Array.isArray(i)||typeof i=="string"&&(ti.test(i)||i==="0")&&!i.startsWith("url("));function R_(i){const t=i[0];if(i.length===1)return!0;for(let e=0;e<i.length;e++)if(i[e]!==t)return!0}function V_(i,t,e,s){const r=i[0];if(r===null)return!1;if(t==="display"||t==="visibility")return!0;const n=i[i.length-1],a=Bh(r,t),o=Bh(n,t);return!a||!o?!1:R_(i)||(e==="spring"||ho(e))&&s}function Od(i){return typeof i=="object"&&i!==null}function O_(i){return Od(i)&&"offsetHeight"in i}const L_=new Set(["opacity","clipPath","filter","transform"]),D_=Co(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Y_(i){var l;const{motionValue:t,name:e,repeatDelay:s,repeatType:r,damping:n,type:a}=i;if(!O_((l=t==null?void 0:t.owner)==null?void 0:l.current))return!1;const{onUpdate:o,transformTemplate:h}=t.owner.getProps();return D_()&&e&&L_.has(e)&&(e!=="transform"||!h)&&!o&&!s&&r!=="mirror"&&n!==0&&a!=="inertia"}const X_=40;class z_ extends vo{constructor({autoplay:t=!0,delay:e=0,type:s="keyframes",repeat:r=0,repeatDelay:n=0,repeatType:a="loop",keyframes:o,name:h,motionValue:l,element:c,...u}){var p;super(),this.stop=()=>{var m,g;this._animation&&(this._animation.stop(),(m=this.stopTimeline)==null||m.call(this)),(g=this.keyframeResolver)==null||g.cancel()},this.createdAt=ie.now();const f={autoplay:t,delay:e,type:s,repeat:r,repeatDelay:n,repeatType:a,name:h,motionValue:l,element:c,...u},d=(c==null?void 0:c.KeyframeResolver)||Ao;this.keyframeResolver=new d(o,(m,g,_)=>this.onKeyframesResolved(m,g,f,!_),h,l,c),(p=this.keyframeResolver)==null||p.scheduleResolve()}onKeyframesResolved(t,e,s,r){this.keyframeResolver=void 0;const{name:n,type:a,velocity:o,delay:h,isHandoff:l,onUpdate:c}=s;this.resolvedAt=ie.now(),V_(t,n,a,o)||((Xe.instantAnimations||!h)&&(c==null||c(wo(t,s,e))),t[0]=t[t.length-1],s.duration=0,s.repeat=0);const f={startTime:r?this.resolvedAt?this.resolvedAt-this.createdAt>X_?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:e,...s,keyframes:t},d=!l&&Y_(f)?new B_({...f,element:f.motionValue.owner.current}):new So(f);d.finished.then(()=>this.notifyFinished()).catch(Ks),this.pendingTimeline&&(this.stopTimeline=d.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=d}get finished(){return this._animation?this.animation.finished:this._finished}then(t,e){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),v_()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}const Ld=(i,t,e,s={},r,n)=>a=>{const o=hd(s,i)||{},h=o.delay||s.delay||0;let{elapsed:l=0}=s;l=l-Me(h);const c={keyframes:Array.isArray(e)?e:[null,e],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-l,onUpdate:f=>{t.set(f),o.onUpdate&&o.onUpdate(f)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:i,motionValue:t,element:n?void 0:r};_b(o)||Object.assign(c,bb(i,c)),c.duration&&(c.duration=Me(c.duration)),c.repeatDelay&&(c.repeatDelay=Me(c.repeatDelay)),c.from!==void 0&&(c.keyframes[0]=c.from);let u=!1;if((c.type===!1||c.duration===0&&!c.repeatDelay)&&(c.duration=0,c.delay===0&&(u=!0)),(Xe.instantAnimations||Xe.skipAnimations)&&(u=!0,c.duration=0,c.delay=0),c.allowFlatten=!o.type&&!o.ease,u&&!n&&t.get()!==void 0){const f=pb(c.keyframes,o);if(f!==void 0){ze.update(()=>{c.onUpdate(f),c.onComplete()});return}}return o.isSync?new So(c):new z_(c)},Dd=new Set(["width","height","top","left","right","bottom",...Zs]);function N_({protectedKeys:i,needsAnimating:t},e){const s=i.hasOwnProperty(e)&&t[e]!==!0;return t[e]=!1,s}function U_(i,t,{delay:e=0,transitionOverride:s,type:r}={}){let{transition:n=i.getDefaultTransition(),transitionEnd:a,...o}=t;s&&(n=s);const h=[],l=r&&i.animationState&&i.animationState.getState()[r];for(const c in o){const u=i.getValue(c,i.latestValues[c]??null),f=o[c];if(f===void 0||l&&N_(l,c))continue;const d={delay:e,...hd(n||{},c)},p=u.get();if(p!==void 0&&!u.isAnimating&&!Array.isArray(f)&&f===p&&!d.velocity)continue;let m=!1;if(window.MotionHandoffAnimation){const _=db(i);if(_){const w=window.MotionHandoffAnimation(_,c,ze);w!==null&&(d.startTime=w,m=!0)}}hb(i,c),u.start(Ld(c,u,f,i.shouldReduceMotion&&Dd.has(c)?{type:!1}:d,i,m));const g=u.animation;g&&h.push(g)}return a&&Promise.all(h).then(()=>{ze.update(()=>{a&&ob(i,a)})}),h}function W_({top:i,left:t,right:e,bottom:s}){return{x:{min:t,max:e},y:{min:i,max:s}}}function G_(i,t){if(!t)return i;const e=t({x:i.left,y:i.top}),s=t({x:i.right,y:i.bottom});return{top:e.y,left:e.x,bottom:s.y,right:s.x}}function H_(i,t){return W_(G_(i.getBoundingClientRect(),t))}const Rh={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ra={};for(const i in Rh)Ra[i]={isEnabled:t=>Rh[i].some(e=>!!t[e])};const Vh=()=>({min:0,max:0}),To=()=>({x:Vh(),y:Vh()}),$_=typeof window<"u",Va={current:null},Yd={current:!1};function j_(){if(Yd.current=!0,!!$_)if(window.matchMedia){const i=window.matchMedia("(prefers-reduced-motion)"),t=()=>Va.current=i.matches;i.addListener(t),t()}else Va.current=!1}function q_(i){return i!==null&&typeof i=="object"&&typeof i.start=="function"}function K_(i){return typeof i=="string"||Array.isArray(i)}const Z_=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Q_=["initial",...Z_];function Xd(i){return q_(i.animate)||Q_.some(t=>K_(i[t]))}function J_(i){return!!(Xd(i)||i.variants)}function tw(i,t,e){for(const s in t){const r=t[s],n=e[s];if(Nt(r))i.addValue(s,r);else if(Nt(n))i.addValue(s,Li(r,{owner:i}));else if(n!==r)if(i.hasValue(s)){const a=i.getValue(s);a.liveStyle===!0?a.jump(r):a.hasAnimated||a.set(r)}else{const a=i.getStaticValue(s);i.addValue(s,Li(a!==void 0?a:r,{owner:i}))}}for(const s in e)t[s]===void 0&&i.removeValue(s);return t}const zd=i=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(i),Nd=i=>/^0[^.\s]+$/u.test(i),ew={test:i=>i==="auto",parse:i=>i},Ud=i=>t=>t.test(i),Wd=[Js,j,Ds,Ge,Pb,Mb,ew],Oh=i=>Wd.find(Ud(i)),sw=[...Wd,Pt,ti],iw=i=>sw.find(Ud(i)),rw=new Set(["brightness","contrast","saturate","opacity"]);function nw(i){const[t,e]=i.slice(0,-1).split("(");if(t==="drop-shadow")return i;const[s]=e.match(mo)||[];if(!s)return i;const r=e.replace(s,"");let n=rw.has(t)?1:0;return s!==e&&(n*=100),t+"("+n+r+")"}const aw=/\b([a-z-]*)\(.*?\)/gu,Oa={...ti,getAnimatableNone:i=>{const t=i.match(aw);return t?t.map(nw).join(" "):i}},Lh={...Js,transform:Math.round},ow={rotate:Ge,rotateX:Ge,rotateY:Ge,rotateZ:Ge,scale:gr,scaleX:gr,scaleY:gr,scaleZ:gr,skew:Ge,skewX:Ge,skewY:Ge,distance:j,translateX:j,translateY:j,translateZ:j,x:j,y:j,z:j,perspective:j,transformPerspective:j,opacity:Di,originX:wh,originY:wh,originZ:j},Mo={borderWidth:j,borderTopWidth:j,borderRightWidth:j,borderBottomWidth:j,borderLeftWidth:j,borderRadius:j,radius:j,borderTopLeftRadius:j,borderTopRightRadius:j,borderBottomRightRadius:j,borderBottomLeftRadius:j,width:j,maxWidth:j,height:j,maxHeight:j,top:j,right:j,bottom:j,left:j,padding:j,paddingTop:j,paddingRight:j,paddingBottom:j,paddingLeft:j,margin:j,marginTop:j,marginRight:j,marginBottom:j,marginLeft:j,backgroundPositionX:j,backgroundPositionY:j,...ow,zIndex:Lh,fillOpacity:Di,strokeOpacity:Di,numOctaves:Lh},lw={...Mo,color:Pt,backgroundColor:Pt,outlineColor:Pt,fill:Pt,stroke:Pt,borderColor:Pt,borderTopColor:Pt,borderRightColor:Pt,borderBottomColor:Pt,borderLeftColor:Pt,filter:Oa,WebkitFilter:Oa},Gd=i=>lw[i];function Hd(i,t){let e=Gd(i);return e!==Oa&&(e=ti),e.getAnimatableNone?e.getAnimatableNone(t):void 0}const Dh=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class $d{scrapeMotionValuesFromProps(t,e,s){return{}}constructor({parent:t,props:e,presenceContext:s,reducedMotionConfig:r,blockInitialAnimation:n,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Ao,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const f=ie.now();this.renderScheduledAt<f&&(this.renderScheduledAt=f,ze.render(this.render,!1,!0))};const{latestValues:h,renderState:l}=a;this.latestValues=h,this.baseTarget={...h},this.initialValues=e.initial?{...h}:{},this.renderState=l,this.parent=t,this.props=e,this.presenceContext=s,this.depth=t?t.depth+1:0,this.reducedMotionConfig=r,this.options=o,this.blockInitialAnimation=!!n,this.isControllingVariants=Xd(e),this.isVariantNode=J_(e),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:c,...u}=this.scrapeMotionValuesFromProps(e,{},this);for(const f in u){const d=u[f];h[f]!==void 0&&Nt(d)&&d.set(h[f],!1)}}mount(t){this.current=t,Oi.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,s)=>this.bindToMotionValue(s,e)),Yd.current||j_(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Va.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),va(this.notifyUpdate),va(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const e=this.features[t];e&&(e.unmount(),e.isMounted=!1)}this.current=null}bindToMotionValue(t,e){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const s=Qs.has(t);s&&this.onBindTransform&&this.onBindTransform();const r=e.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&ze.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0)}),n=e.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,e)),this.valueSubscriptions.set(t,()=>{r(),n(),a&&a(),e.owner&&e.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Ra){const e=Ra[t];if(!e)continue;const{isEnabled:s,Feature:r}=e;if(!this.features[t]&&r&&s(this.props)&&(this.features[t]=new r(this)),this.features[t]){const n=this.features[t];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):To()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,e){this.latestValues[t]=e}update(t,e){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=e;for(let s=0;s<Dh.length;s++){const r=Dh[s];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const n="on"+r,a=t[n];a&&(this.propEventSubscriptions[r]=this.on(r,a))}this.prevMotionValues=tw(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const e=this.getClosestVariantNode();if(e)return e.variantChildren&&e.variantChildren.add(t),()=>e.variantChildren.delete(t)}addValue(t,e){const s=this.values.get(t);e!==s&&(s&&this.removeValue(t),this.bindToMotionValue(t,e),this.values.set(t,e),this.latestValues[t]=e.get())}removeValue(t){this.values.delete(t);const e=this.valueSubscriptions.get(t);e&&(e(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,e){if(this.props.values&&this.props.values[t])return this.props.values[t];let s=this.values.get(t);return s===void 0&&e!==void 0&&(s=Li(e===null?void 0:e,{owner:this}),this.addValue(t,s)),s}readValue(t,e){let s=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return s!=null&&(typeof s=="string"&&(zd(s)||Nd(s))?s=parseFloat(s):!iw(s)&&ti.test(e)&&(s=Hd(t,e)),this.setBaseTarget(t,Nt(s)?s.get():s)),Nt(s)?s.get():s}setBaseTarget(t,e){this.baseTarget[t]=e}getBaseTarget(t){var n;const{initial:e}=this.props;let s;if(typeof e=="string"||typeof e=="object"){const a=ad(this.props,e,(n=this.presenceContext)==null?void 0:n.custom);a&&(s=a[t])}if(e&&s!==void 0)return s;const r=this.getBaseTargetFromProps(this.props,t);return r!==void 0&&!Nt(r)?r:this.initialValues[t]!==void 0&&s===void 0?void 0:this.baseTarget[t]}on(t,e){return this.events[t]||(this.events[t]=new od),this.events[t].add(e)}notify(t,...e){this.events[t]&&this.events[t].notify(...e)}}const hw=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function cw(i){const t=hw.exec(i);if(!t)return[,];const[,e,s,r]=t;return[`--${e??s}`,r]}function jd(i,t,e=1){const[s,r]=cw(i);if(!s)return;const n=window.getComputedStyle(t).getPropertyValue(s);if(n){const a=n.trim();return zd(a)?parseFloat(a):a}return po(r)?jd(r,t,e+1):r}function uw(i){return typeof i=="number"?i===0:i!==null?i==="none"||i==="0"||Nd(i):!0}const dw=new Set(["auto","none","0"]);function fw(i,t,e){let s=0,r;for(;s<i.length&&!r;){const n=i[s];typeof n=="string"&&!dw.has(n)&&Yi(n).values.length&&(r=i[s]),s++}if(r&&e)for(const n of t)i[n]=Hd(e,r)}class pw extends Ao{constructor(t,e,s,r,n){super(t,e,s,r,n,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:e,name:s}=this;if(!e||!e.current)return;super.readKeyframes();for(let h=0;h<t.length;h++){let l=t[h];if(typeof l=="string"&&(l=l.trim(),po(l))){const c=jd(l,e.current);c!==void 0&&(t[h]=c),h===t.length-1&&(this.finalKeyframe=l)}}if(this.resolveNoneKeyframes(),!Dd.has(s)||t.length!==2)return;const[r,n]=t,a=Oh(r),o=Oh(n);if(a!==o)if(Ih(a)&&Ih(o))for(let h=0;h<t.length;h++){const l=t[h];typeof l=="string"&&(t[h]=parseFloat(l))}else hs[s]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:e}=this,s=[];for(let r=0;r<t.length;r++)(t[r]===null||uw(t[r]))&&s.push(r);s.length&&fw(t,s,e)}measureInitialState(){const{element:t,unresolvedKeyframes:e,name:s}=this;if(!t||!t.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=hs[s](t.measureViewportBox(),window.getComputedStyle(t.current)),e[0]=this.measuredOrigin;const r=e[e.length-1];r!==void 0&&t.getValue(s,r).jump(r,!1)}measureEndState(){var o;const{element:t,name:e,unresolvedKeyframes:s}=this;if(!t||!t.current)return;const r=t.getValue(e);r&&r.jump(this.measuredOrigin,!1);const n=s.length-1,a=s[n];s[n]=hs[e](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([h,l])=>{t.getValue(h).set(l)}),this.resolveNoneKeyframes()}}class qd extends $d{constructor(){super(...arguments),this.KeyframeResolver=pw}sortInstanceNodePosition(t,e){return t.compareDocumentPosition(e)&2?1:-1}getBaseTargetFromProps(t,e){return t.style?t.style[e]:void 0}removeValueFromRenderState(t,{vars:e,style:s}){delete e[t],delete s[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Nt(t)&&(this.childSubscription=t.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}}const Kd=(i,t)=>t&&typeof i=="number"?t.transform(i):i,mw={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},gw=Zs.length;function xw(i,t,e){let s="",r=!0;for(let n=0;n<gw;n++){const a=Zs[n],o=i[a];if(o===void 0)continue;let h=!0;if(typeof o=="number"?h=o===(a.startsWith("scale")?1:0):h=parseFloat(o)===0,!h||e){const l=Kd(o,Mo[a]);if(!h){r=!1;const c=mw[a]||a;s+=`${c}(${l}) `}e&&(t[a]=l)}}return s=s.trim(),e?s=e(t,r?"":s):r&&(s="none"),s}function Zd(i,t,e){const{style:s,vars:r,transformOrigin:n}=i;let a=!1,o=!1;for(const h in t){const l=t[h];if(Qs.has(h)){a=!0;continue}else if(ud(h)){r[h]=l;continue}else{const c=Kd(l,Mo[h]);h.startsWith("origin")?(o=!0,n[h]=c):s[h]=c}}if(t.transform||(a||e?s.transform=xw(t,i.transform,e):s.transform&&(s.transform="none")),o){const{originX:h="50%",originY:l="50%",originZ:c=0}=n;s.transformOrigin=`${h} ${l} ${c}`}}function Qd(i,{style:t,vars:e},s,r){Object.assign(i.style,t,r&&r.getProjectionStyles(s));for(const n in e)i.style.setProperty(n,e[n])}const yw={};function bw(i,{layout:t,layoutId:e}){return Qs.has(i)||i.startsWith("origin")||(t||e!==void 0)&&(!!yw[i]||i==="opacity")}function Jd(i,t,e){var n;const{style:s}=i,r={};for(const a in s)(Nt(s[a])||t.style&&Nt(t.style[a])||bw(a,i)||((n=e==null?void 0:e.getValue(a))==null?void 0:n.liveStyle)!==void 0)&&(r[a]=s[a]);return r}function _w(i){return window.getComputedStyle(i)}class ww extends qd{constructor(){super(...arguments),this.type="html",this.renderInstance=Qd}readValueFromInstance(t,e){var s;if(Qs.has(e))return(s=this.projection)!=null&&s.isProjecting?ka(e):x_(t,e);{const r=_w(t),n=(ud(e)?r.getPropertyValue(e):r[e])||0;return typeof n=="string"?n.trim():n}}measureInstanceViewportBox(t,{transformPagePoint:e}){return H_(t,e)}build(t,e,s){Zd(t,e,s.transformTemplate)}scrapeMotionValuesFromProps(t,e,s){return Jd(t,e,s)}}function vw(i,t){return i in t}class Sw extends $d{constructor(){super(...arguments),this.type="object"}readValueFromInstance(t,e){if(vw(e,t)){const s=t[e];if(typeof s=="string"||typeof s=="number")return s}}getBaseTargetFromProps(){}removeValueFromRenderState(t,e){delete e.output[t]}measureInstanceViewportBox(){return To()}build(t,e){Object.assign(t.output,e)}renderInstance(t,{output:e}){Object.assign(t,e)}sortInstanceNodePosition(){return 0}}const Aw={offset:"stroke-dashoffset",array:"stroke-dasharray"},Cw={offset:"strokeDashoffset",array:"strokeDasharray"};function Tw(i,t,e=1,s=0,r=!0){i.pathLength=1;const n=r?Aw:Cw;i[n.offset]=j.transform(-s);const a=j.transform(t),o=j.transform(e);i[n.array]=`${a} ${o}`}function Mw(i,{attrX:t,attrY:e,attrScale:s,pathLength:r,pathSpacing:n=1,pathOffset:a=0,...o},h,l,c){if(Zd(i,o,l),h){i.style.viewBox&&(i.attrs.viewBox=i.style.viewBox);return}i.attrs=i.style,i.style={};const{attrs:u,style:f}=i;u.transform&&(f.transform=u.transform,delete u.transform),(f.transform||u.transformOrigin)&&(f.transformOrigin=u.transformOrigin??"50% 50%",delete u.transformOrigin),f.transform&&(f.transformBox=(c==null?void 0:c.transformBox)??"fill-box",delete u.transformBox),t!==void 0&&(u.x=t),e!==void 0&&(u.y=e),s!==void 0&&(u.scale=s),r!==void 0&&Tw(u,r,n,a,!1)}const tf=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),Pw=i=>typeof i=="string"&&i.toLowerCase()==="svg";function kw(i,t,e,s){Qd(i,t,void 0,s);for(const r in t.attrs)i.setAttribute(tf.has(r)?r:fo(r),t.attrs[r])}function Iw(i,t,e){const s=Jd(i,t,e);for(const r in i)if(Nt(i[r])||Nt(t[r])){const n=Zs.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;s[n]=i[r]}return s}class Fw extends qd{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=To}getBaseTargetFromProps(t,e){return t[e]}readValueFromInstance(t,e){if(Qs.has(e)){const s=Gd(e);return s&&s.default||0}return e=tf.has(e)?e:fo(e),t.getAttribute(e)}scrapeMotionValuesFromProps(t,e,s){return Iw(t,e,s)}build(t,e,s){Mw(t,e,this.isSVGTag,s.transformTemplate,s.style)}renderInstance(t,e,s,r){kw(t,e,s,r)}mount(t){this.isSVGTag=Pw(t.tagName),super.mount(t)}}function ef(i){return Od(i)&&"ownerSVGElement"in i}function Ew(i){return ef(i)&&i.tagName==="svg"}function Bw(i){const t={presenceContext:null,props:{},visualState:{renderState:{transform:{},transformOrigin:{},style:{},vars:{},attrs:{}},latestValues:{}}},e=ef(i)&&!Ew(i)?new Fw(t):new ww(t);e.mount(i),Oi.set(i,e)}function Rw(i){const t={presenceContext:null,props:{},visualState:{renderState:{output:{}},latestValues:{}}},e=new Sw(t);e.mount(i),Oi.set(i,e)}function Vw(i,t,e){const s=Nt(i)?i:Li(i);return s.start(Ld("",s,t,e)),s.animation}function Ow(i,t){return Nt(i)||typeof i=="number"||typeof i=="string"&&!oo(t)}function sf(i,t,e,s){const r=[];if(Ow(i,t))r.push(Vw(i,oo(t)&&t.default||t,e&&(e.default||e)));else{const n=Ju(i,t,s),a=n.length;for(let o=0;o<a;o++){const h=n[o],l=h instanceof Element?Bw:Rw;Oi.has(h)||l(h);const c=Oi.get(h),u={...e};"delay"in u&&typeof u.delay=="function"&&(u.delay=u.delay(o,a)),r.push(...U_(c,{...t,transition:u},{}))}}return r}function Lw(i,t,e){const s=[];return Hy(i,t,e,{spring:Xi}).forEach(({keyframes:n,transition:a},o)=>{s.push(...sf(o,n,a))}),s}class Dw{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>t.finished))}getAll(t){return this.animations[0][t]}setAll(t,e){for(let s=0;s<this.animations.length;s++)this.animations[s][t]=e}attachTimeline(t){const e=this.animations.map(s=>s.attachTimeline(t));return()=>{e.forEach((s,r)=>{s&&s(),this.animations[r].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get state(){return this.getAll("state")}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let e=0;e<this.animations.length;e++)t=Math.max(t,this.animations[e].duration);return t}runAll(t){this.animations.forEach(e=>e[t]())}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class Yw extends Dw{then(t,e){return this.finished.finally(t).then(()=>{})}}function Xw(i){return Array.isArray(i)&&i.some(Array.isArray)}function zw(i){function t(e,s,r){let n=[];return Xw(e)?n=Lw(e,s,i):n=sf(e,s,r,i),new Yw(n)}return t}const re=zw();class rf extends ot{constructor(){super();x(this,"pixiLogo");x(this,"progressBar");this.progressBar=new _y({backgroundColor:"#3d3d3d",fillColor:"#e72264",radius:100,lineWidth:15,value:20,backgroundAlpha:.5,fillAlpha:.8,cap:"round"}),this.progressBar.x+=this.progressBar.width/2,this.progressBar.y+=-this.progressBar.height/2,this.addChild(this.progressBar),this.pixiLogo=new Zt({texture:U.from("logo.svg"),anchor:.5,scale:.2}),this.addChild(this.pixiLogo)}onLoad(e){this.progressBar.progress=e}resize(e,s){this.pixiLogo.position.set(e*.5,s*.5),this.progressBar.position.set(e*.5,s*.5)}async show(){this.alpha=1}async hide(){await re(this,{alpha:0},{duration:.3,ease:"linear",delay:1})}}x(rf,"assetBundles",["preload"]);const Nw={fontFamily:"Arial Rounded MT Bold",align:"center"};class zi extends Er{constructor(t){const e={...Nw,...t==null?void 0:t.style};super({...t,style:e}),this.anchor.set(.5)}}const Uw={text:"",width:301,height:112,fontSize:28};class Or extends wa{constructor(t={}){const e={...Uw,...t};super({defaultView:"button.png",nineSliceSprite:[38,50,38,50],anchor:.5,text:new zi({text:e.text,style:{fill:4868682,align:"center",fontSize:e.fontSize}}),textOffset:{x:0,y:-13},defaultTextAnchor:.5,scale:.9,animations:{hover:{props:{scale:{x:1.03,y:1.03},y:0},duration:100},pressed:{props:{scale:{x:.97,y:.97},y:10},duration:100}}}),this.width=e.width,this.height=e.height,this.onDown.connect(this.handleDown.bind(this)),this.onHover.connect(this.handleHover.bind(this))}handleHover(){Ft().audio.sfx.play("main/sounds/sfx-hover.wav")}handleDown(){Ft().audio.sfx.play("main/sounds/sfx-press.wav")}}const Ww={color:16777215,width:350,height:600,shadow:!0,shadowColor:10526880,shadowOffset:22};class nf extends ot{constructor(e={}){super();x(this,"image");x(this,"shadow");const s={...Ww,...e};this.image=new Ke({texture:U.from("rounded-rectangle.png"),leftWidth:34,topHeight:34,rightWidth:34,bottomHeight:34,width:s.width,height:s.height,tint:s.color}),this.image.x=-this.image.width*.5,this.image.y=-this.image.height*.5,this.addChild(this.image),s.shadow&&(this.shadow=new Ke({texture:U.from("rounded-rectangle.png"),leftWidth:34,topHeight:34,rightWidth:34,bottomHeight:34,width:s.width,height:s.height,tint:s.shadowColor}),this.shadow.x=-this.shadow.width*.5,this.shadow.y=-this.shadow.height*.5+s.shadowOffset,this.addChildAt(this.shadow,0))}get boxWidth(){return this.image.width}get boxHeight(){return this.image.height}}class Yh extends ot{constructor(){super();x(this,"bg");x(this,"panel");x(this,"title");x(this,"doneButton");x(this,"panelBase");this.bg=new Zt(U.WHITE),this.bg.tint=0,this.bg.interactive=!0,this.addChild(this.bg),this.panel=new ot,this.addChild(this.panel),this.panelBase=new nf({height:300}),this.panel.addChild(this.panelBase),this.title=new zi({text:"Paused",style:{fill:15471969,fontSize:50}}),this.title.y=-80,this.panel.addChild(this.title),this.doneButton=new Or({text:"Resume"}),this.doneButton.y=70,this.doneButton.onPress.connect(()=>Ft().navigation.dismissPopup()),this.panel.addChild(this.doneButton)}resize(e,s){this.bg.width=e,this.bg.height=s,this.panel.x=e*.5,this.panel.y=s*.5}async show(){const e=Ft();e.navigation.currentScreen&&(e.navigation.currentScreen.filters=[new ao({strength:5})]),this.bg.alpha=0,this.panel.pivot.y=-400,re(this.bg,{alpha:.8},{duration:.2,ease:"linear"}),await re(this.panel.pivot,{y:0},{duration:.3,ease:"backOut"})}async hide(){const e=Ft();e.navigation.currentScreen&&(e.navigation.currentScreen.filters=[]),re(this.bg,{alpha:0},{duration:.2,ease:"linear"}),await re(this.panel.pivot,{y:-500},{duration:.3,ease:"backIn"})}}class qn extends Oy{constructor(e,s=-.1,r=100,n=100){const g=new Oe().roundRect(0,0,280,20,20).fill({color:15471969}).roundRect(4,4,272,12,20).fill({color:16777215}),_=new Oe().roundRect(0,0,280,20,20).fill({color:15471969}).roundRect(4,4,280-4*2,20-4*2,20).fill({color:15688340}),w=new Oe().circle(0,0,18).fill({color:15471969});super({bg:g,fill:_,slider:w,min:s,max:r});x(this,"messageLabel");this.value=n,this.messageLabel=new zi({text:e,style:{align:"left",fill:4868682,fontSize:18}}),this.messageLabel.anchor.x=0,this.messageLabel.x=10,this.messageLabel.y=-18,this.addChild(this.messageLabel)}}class Gw{getString(t){return localStorage.getItem(t)??void 0}setString(t,e){localStorage.setItem(t,e)}getNumber(t){const e=this.getString(t)??void 0,s=Number(e);return isNaN(s)?null:s}setNumber(t,e){this.setString(t,String(e))}getBool(t){const e=localStorage.getItem(t);return e?!!e.toLowerCase():void 0}setBool(t,e){localStorage.setItem(t,String(e))}getObject(t){const e=this.getString(t);if(e)try{return JSON.parse(e)}catch(s){console.warn(s);return}}setObject(t,e){this.setString(t,JSON.stringify(e))}}const Cs=new Gw,Xh="volume-master",zh="volume-bgm",Nh="volume-sfx";class Hw{init(){Ft().audio.setMasterVolume(this.getMasterVolume()),Ft().audio.bgm.setVolume(this.getBgmVolume()),Ft().audio.sfx.setVolume(this.getSfxVolume())}getMasterVolume(){return Cs.getNumber(Xh)??.5}setMasterVolume(t){Ft().audio.setMasterVolume(t),Cs.setNumber(Xh,t)}getBgmVolume(){return Cs.getNumber(zh)??1}setBgmVolume(t){Ft().audio.bgm.setVolume(t),Cs.setNumber(zh,t)}getSfxVolume(){return Cs.getNumber(Nh)??1}setSfxVolume(t){Ft().audio.sfx.setVolume(t),Cs.setNumber(Nh,t)}}const ns=new Hw;class $w extends ot{constructor(){super();x(this,"bg");x(this,"panel");x(this,"title");x(this,"doneButton");x(this,"panelBase");x(this,"versionLabel");x(this,"layout");x(this,"masterSlider");x(this,"bgmSlider");x(this,"sfxSlider");this.bg=new Zt(U.WHITE),this.bg.tint=0,this.bg.interactive=!0,this.addChild(this.bg),this.panel=new ot,this.addChild(this.panel),this.panelBase=new nf({height:425}),this.panel.addChild(this.panelBase),this.title=new zi({text:"Settings",style:{fill:15471969,fontSize:50}}),this.title.y=-this.panelBase.boxHeight*.5+60,this.panel.addChild(this.title),this.doneButton=new Or({text:"OK"}),this.doneButton.y=this.panelBase.boxHeight*.5-78,this.doneButton.onPress.connect(()=>Ft().navigation.dismissPopup()),this.panel.addChild(this.doneButton),this.versionLabel=new zi({text:"Version 0.0.0",style:{fill:16777215,fontSize:12}}),this.versionLabel.alpha=.5,this.versionLabel.y=this.panelBase.boxHeight*.5-15,this.panel.addChild(this.versionLabel),this.layout=new By({type:"vertical",elementsMargin:4}),this.layout.x=-140,this.layout.y=-80,this.panel.addChild(this.layout),this.masterSlider=new qn("Master Volume"),this.masterSlider.onUpdate.connect(e=>{ns.setMasterVolume(e/100)}),this.layout.addChild(this.masterSlider),this.bgmSlider=new qn("BGM Volume"),this.bgmSlider.onUpdate.connect(e=>{ns.setBgmVolume(e/100)}),this.layout.addChild(this.bgmSlider),this.sfxSlider=new qn("SFX Volume"),this.sfxSlider.onUpdate.connect(e=>{ns.setSfxVolume(e/100)}),this.layout.addChild(this.sfxSlider)}resize(e,s){this.bg.width=e,this.bg.height=s,this.panel.x=e*.5,this.panel.y=s*.5}prepare(){this.masterSlider.value=ns.getMasterVolume()*100,this.bgmSlider.value=ns.getBgmVolume()*100,this.sfxSlider.value=ns.getSfxVolume()*100}async show(){const e=Ft();e.navigation.currentScreen&&(e.navigation.currentScreen.filters=[new ao({strength:4})]),this.bg.alpha=0,this.panel.pivot.y=-400,re(this.bg,{alpha:.8},{duration:.2,ease:"linear"}),await re(this.panel.pivot,{y:0},{duration:.3,ease:"backOut"})}async hide(){const e=Ft();e.navigation.currentScreen&&(e.navigation.currentScreen.filters=[]),re(this.bg,{alpha:0},{duration:.2,ease:"linear"}),await re(this.panel.pivot,{y:-500},{duration:.3,ease:"backIn"})}}const jw=[{name:"back.png",speedDivider:4},{name:"middle.png",speedDivider:2},{name:"top.png",speedDivider:1}],qw={speed:1};class Kw extends ot{constructor(){super();x(this,"basicSpeed");x(this,"backTiles");x(this,"bgX");this.bgX=0,this.basicSpeed=qw.speed,this.backTiles=jw.map(e=>{const s=U.from(e.name),r=this.createTile(s,e);return r.anchor.set(.5),r})}createTile(e,s){const r=new Zw(e,2048,922,s);return r.position.set(0,0),this.addChild(r)}update(){this.bgX=this.bgX+this.basicSpeed,this.backTiles.forEach(e=>{e.tilePosition.x=-this.bgX/e.speedDivider})}}class Zw extends jx{constructor(e,s,r,n){super(e,s,r);x(this,"speedDivider");this.speedDivider=n.speedDivider}}if(typeof window<"u"&&window.PIXI){const i=window.require;window.require=t=>{if(i)return i(t);if(t.startsWith("@pixi/")||t.startsWith("pixi.js"))return window.PIXI}}class af{constructor(){x(this,"entries",{});x(this,"size",0)}add(t){let e=this.entries[t];return this.entries[t]=!0,e?!1:(this.size++,!0)}addAll(t){let e=this.size;for(var s=0,r=t.length;s<r;s++)this.add(t[s]);return e!=this.size}contains(t){return this.entries[t]}clear(){this.entries={},this.size=0}}const jt=class jt{constructor(t=0,e=0,s=0,r=0){x(this,"r");x(this,"g");x(this,"b");x(this,"a");this.r=t,this.g=e,this.b=s,this.a=r}set(t,e,s,r){return this.r=t,this.g=e,this.b=s,this.a=r,this.clamp()}setFromColor(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}setFromString(t){return t=t.charAt(0)=="#"?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=t.length!=8?1:parseInt(t.substr(6,2),16)/255,this}add(t,e,s,r){return this.r+=t,this.g+=e,this.b+=s,this.a+=r,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(t,e){t.r=((e&4278190080)>>>24)/255,t.g=((e&16711680)>>>16)/255,t.b=((e&65280)>>>8)/255,t.a=(e&255)/255}static rgb888ToColor(t,e){t.r=((e&16711680)>>>16)/255,t.g=((e&65280)>>>8)/255,t.b=(e&255)/255}toRgb888(){const t=e=>("0"+(e*255).toString(16)).slice(-2);return+("0x"+t(this.r)+t(this.g)+t(this.b))}static fromString(t,e=new jt){return e.setFromString(t)}};x(jt,"WHITE",new jt(1,1,1,1)),x(jt,"RED",new jt(1,0,0,1)),x(jt,"GREEN",new jt(0,1,0,1)),x(jt,"BLUE",new jt(0,0,1,1)),x(jt,"MAGENTA",new jt(1,0,1,1));let K=jt;const kt=class kt{static clamp(t,e,s){return t<e?e:t>s?s:t}static cosDeg(t){return Math.cos(t*kt.degRad)}static sinDeg(t){return Math.sin(t*kt.degRad)}static atan2Deg(t,e){return Math.atan2(t,e)*kt.degRad}static signum(t){return t>0?1:t<0?-1:0}static toInt(t){return t>0?Math.floor(t):Math.ceil(t)}static cbrt(t){let e=Math.pow(Math.abs(t),.3333333333333333);return t<0?-e:e}static randomTriangular(t,e){return kt.randomTriangularWith(t,e,(t+e)*.5)}static randomTriangularWith(t,e,s){let r=Math.random(),n=e-t;return r<=(s-t)/n?t+Math.sqrt(r*n*(s-t)):e-Math.sqrt((1-r)*n*(e-s))}static isPowerOfTwo(t){return t&&(t&t-1)===0}};x(kt,"PI",3.1415927),x(kt,"PI2",kt.PI*2),x(kt,"invPI2",1/kt.PI2),x(kt,"radiansToDegrees",180/kt.PI),x(kt,"radDeg",kt.radiansToDegrees),x(kt,"degreesToRadians",kt.PI/180),x(kt,"degRad",kt.degreesToRadians);let D=kt;const $e=class $e{static arrayCopy(t,e,s,r,n){for(let a=e,o=r;a<e+n;a++,o++)s[o]=t[a]}static arrayFill(t,e,s,r){for(let n=e;n<s;n++)t[n]=r}static setArraySize(t,e,s=0){let r=t.length;if(r==e)return t;if(t.length=e,r<e)for(let n=r;n<e;n++)t[n]=s;return t}static ensureArrayCapacity(t,e,s=0){return t.length>=e?t:$e.setArraySize(t,e,s)}static newArray(t,e){let s=new Array(t);for(let r=0;r<t;r++)s[r]=e;return s}static newFloatArray(t){if($e.SUPPORTS_TYPED_ARRAYS)return new Float32Array(t);{let e=new Array(t);for(let s=0;s<e.length;s++)e[s]=0;return e}}static newShortArray(t){if($e.SUPPORTS_TYPED_ARRAYS)return new Int16Array(t);{let e=new Array(t);for(let s=0;s<e.length;s++)e[s]=0;return e}}static toFloatArray(t){return $e.SUPPORTS_TYPED_ARRAYS?new Float32Array(t):t}static toSinglePrecision(t){return $e.SUPPORTS_TYPED_ARRAYS?Math.fround(t):t}static webkit602BugfixHelper(t,e){}static contains(t,e,s=!0){for(var r=0;r<t.length;r++)if(t[r]==e)return!0;return!1}static enumValue(t,e){return t[e[0].toUpperCase()+e.slice(1)]}};x($e,"SUPPORTS_TYPED_ARRAYS",typeof Float32Array<"u");let Y=$e;class Ni{constructor(t){x(this,"items",new Array);x(this,"instantiator");this.instantiator=t}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(t){t.reset&&t.reset(),this.items.push(t)}freeAll(t){for(let e=0;e<t.length;e++)this.free(t[e])}clear(){this.items.length=0}}class Lr{constructor(t=0,e=0){x(this,"x");x(this,"y");this.x=t,this.y=e}set(t,e){return this.x=t,this.y=e,this}length(){let t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}normalize(){let t=this.length();return t!=0&&(this.x/=t,this.y/=t),this}}class of{constructor(t){x(this,"name");if(!t)throw new Error("name cannot be null.");this.name=t}}const jr=class jr extends of{constructor(e){super(e);x(this,"id",jr.nextID++);x(this,"bones",null);x(this,"vertices",[]);x(this,"worldVerticesLength",0);x(this,"timelineAttachment",this)}computeWorldVertices(e,s,r,n,a,o){r=a+(r>>1)*o;let h=e.bone.skeleton,l=e.deform,c=this.vertices,u=this.bones;if(!u){l.length>0&&(c=l);let m=e.bone,g=m.worldX,_=m.worldY,w=m.a,b=m.b,y=m.c,S=m.d;for(let v=s,A=a;A<r;v+=2,A+=o){let C=c[v],T=c[v+1];n[A]=C*w+T*b+g,n[A+1]=C*y+T*S+_}return}let f=0,d=0;for(let m=0;m<s;m+=2){let g=u[f];f+=g+1,d+=g}let p=h.bones;if(l.length==0)for(let m=a,g=d*3;m<r;m+=o){let _=0,w=0,b=u[f++];for(b+=f;f<b;f++,g+=3){let y=p[u[f]],S=c[g],v=c[g+1],A=c[g+2];_+=(S*y.a+v*y.b+y.worldX)*A,w+=(S*y.c+v*y.d+y.worldY)*A}n[m]=_,n[m+1]=w}else{let m=l;for(let g=a,_=d*3,w=d<<1;g<r;g+=o){let b=0,y=0,S=u[f++];for(S+=f;f<S;f++,_+=3,w+=2){let v=p[u[f]],A=c[_]+m[w],C=c[_+1]+m[w+1],T=c[_+2];b+=(A*v.a+C*v.b+v.worldX)*T,y+=(A*v.c+C*v.d+v.worldY)*T}n[g]=b,n[g+1]=y}}}copyTo(e){this.bones?(e.bones=new Array(this.bones.length),Y.arrayCopy(this.bones,0,e.bones,0,this.bones.length)):e.bones=null,this.vertices&&(e.vertices=Y.newFloatArray(this.vertices.length),Y.arrayCopy(this.vertices,0,e.vertices,0,this.vertices.length)),e.worldVerticesLength=this.worldVerticesLength,e.timelineAttachment=this.timelineAttachment}};x(jr,"nextID",0);let me=jr;const Fs=class Fs{constructor(t){x(this,"id",Fs.nextID());x(this,"regions");x(this,"start",0);x(this,"digits",0);x(this,"setupIndex",0);this.regions=new Array(t)}copy(){let t=new Fs(this.regions.length);return Y.arrayCopy(this.regions,0,t.regions,0,this.regions.length),t.start=this.start,t.digits=this.digits,t.setupIndex=this.setupIndex,t}apply(t,e){let s=t.sequenceIndex;s==-1&&(s=this.setupIndex),s>=this.regions.length&&(s=this.regions.length-1);let r=this.regions[s];e.region!=r&&(e.region=r,e.updateRegion())}getPath(t,e){let s=t,r=(this.start+e).toString();for(let n=this.digits-r.length;n>0;n--)s+="0";return s+=r,s}static nextID(){return Fs._nextID++}};x(Fs,"_nextID",0);let Dr=Fs;var Rt;(function(i){i[i.hold=0]="hold",i[i.once=1]="once",i[i.loop=2]="loop",i[i.pingpong=3]="pingpong",i[i.onceReverse=4]="onceReverse",i[i.loopReverse=5]="loopReverse",i[i.pingpongReverse=6]="pingpongReverse"})(Rt||(Rt={}));const lf=[Rt.hold,Rt.once,Rt.loop,Rt.pingpong,Rt.onceReverse,Rt.loopReverse,Rt.pingpongReverse];class Po{constructor(t,e,s){x(this,"name");x(this,"timelines",[]);x(this,"timelineIds",new af);x(this,"duration");if(!t)throw new Error("name cannot be null.");this.name=t,this.setTimelines(e),this.duration=s}setTimelines(t){if(!t)throw new Error("timelines cannot be null.");this.timelines=t,this.timelineIds.clear();for(var e=0;e<t.length;e++)this.timelineIds.addAll(t[e].getPropertyIds())}hasTimeline(t){for(let e=0;e<t.length;e++)if(this.timelineIds.contains(t[e]))return!0;return!1}apply(t,e,s,r,n,a,o,h){if(!t)throw new Error("skeleton cannot be null.");r&&this.duration!=0&&(s%=this.duration,e>0&&(e%=this.duration));let l=this.timelines;for(let c=0,u=l.length;c<u;c++)l[c].apply(t,e,s,n,a,o,h)}}var V;(function(i){i[i.setup=0]="setup",i[i.first=1]="first",i[i.replace=2]="replace",i[i.add=3]="add"})(V||(V={}));var Lt;(function(i){i[i.mixIn=0]="mixIn",i[i.mixOut=1]="mixOut"})(Lt||(Lt={}));const Q={rotate:0,x:1,y:2,scaleX:3,scaleY:4,shearX:5,shearY:6,inherit:7,rgb:8,alpha:9,rgb2:10,attachment:11,deform:12,event:13,drawOrder:14,ikConstraint:15,transformConstraint:16,pathConstraintPosition:17,pathConstraintSpacing:18,pathConstraintMix:19,physicsConstraintInertia:20,physicsConstraintStrength:21,physicsConstraintDamping:22,physicsConstraintMass:23,physicsConstraintWind:24,physicsConstraintGravity:25,physicsConstraintMix:26,physicsConstraintReset:27,sequence:28};class dt{constructor(t,e){x(this,"propertyIds");x(this,"frames");this.propertyIds=e,this.frames=Y.newFloatArray(t*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(t,e){let s=t.length;for(let r=1;r<s;r++)if(t[r]>e)return r-1;return s-1}static search(t,e,s){let r=t.length;for(let n=s;n<r;n+=s)if(t[n]>e)return n-s;return r-s}}class Ie extends dt{constructor(e,s,r){super(e,r);x(this,"curves");this.curves=Y.newFloatArray(e+s*18),this.curves[e-1]=1}setLinear(e){this.curves[e]=0}setStepped(e){this.curves[e]=1}shrink(e){let s=this.getFrameCount()+e*18;if(this.curves.length>s){let r=Y.newFloatArray(s);Y.arrayCopy(this.curves,0,r,0,s),this.curves=r}}setBezier(e,s,r,n,a,o,h,l,c,u,f){let d=this.curves,p=this.getFrameCount()+e*18;r==0&&(d[s]=2+p);let m=(n-o*2+l)*.03,g=(a-h*2+c)*.03,_=((o-l)*3-n+u)*.006,w=((h-c)*3-a+f)*.006,b=m*2+_,y=g*2+w,S=(o-n)*.3+m+_*.16666667,v=(h-a)*.3+g+w*.16666667,A=n+S,C=a+v;for(let T=p+18;p<T;p+=2)d[p]=A,d[p+1]=C,S+=b,v+=y,b+=_,y+=w,A+=S,C+=v}getBezierValue(e,s,r,n){let a=this.curves;if(a[n]>e){let c=this.frames[s],u=this.frames[s+r];return u+(e-c)/(a[n]-c)*(a[n+1]-u)}let o=n+18;for(n+=2;n<o;n+=2)if(a[n]>=e){let c=a[n-2],u=a[n-1];return u+(e-c)/(a[n]-c)*(a[n+1]-u)}s+=this.getFrameEntries();let h=a[o-2],l=a[o-1];return l+(e-h)/(this.frames[s]-h)*(this.frames[s+r]-l)}}class xe extends Ie{constructor(t,e,s){super(t,e,[s])}getFrameEntries(){return 2}setFrame(t,e,s){t<<=1,this.frames[t]=e,this.frames[t+1]=s}getCurveValue(t){let e=this.frames,s=e.length-2;for(let n=2;n<=s;n+=2)if(e[n]>t){s=n-2;break}let r=this.curves[s>>1];switch(r){case 0:let n=e[s],a=e[s+1];return a+(t-n)/(e[s+2]-n)*(e[s+2+1]-a);case 1:return e[s+1]}return this.getBezierValue(t,s,1,r-2)}getRelativeValue(t,e,s,r,n){if(t<this.frames[0]){switch(s){case V.setup:return n;case V.first:return r+(n-r)*e}return r}let a=this.getCurveValue(t);switch(s){case V.setup:return n+a*e;case V.first:case V.replace:a+=n-r}return r+a*e}getAbsoluteValue(t,e,s,r,n){if(t<this.frames[0]){switch(s){case V.setup:return n;case V.first:return r+(n-r)*e}return r}let a=this.getCurveValue(t);return s==V.setup?n+(a-n)*e:r+(a-r)*e}getAbsoluteValue2(t,e,s,r,n,a){if(t<this.frames[0]){switch(s){case V.setup:return n;case V.first:return r+(n-r)*e}return r}return s==V.setup?n+(a-n)*e:r+(a-r)*e}getScaleValue(t,e,s,r,n,a){const o=this.frames;if(t<o[0]){switch(s){case V.setup:return a;case V.first:return n+(a-n)*e}return n}let h=this.getCurveValue(t)*a;if(e==1)return s==V.add?n+h-a:h;if(r==Lt.mixOut)switch(s){case V.setup:return a+(Math.abs(h)*D.signum(a)-a)*e;case V.first:case V.replace:return n+(Math.abs(h)*D.signum(n)-n)*e}else{let l=0;switch(s){case V.setup:return l=Math.abs(a)*D.signum(h),l+(h-l)*e;case V.first:case V.replace:return l=Math.abs(n)*D.signum(h),l+(h-l)*e}}return n+(h-a)*e}}class ko extends Ie{constructor(t,e,s,r){super(t,e,[s,r])}getFrameEntries(){return 3}setFrame(t,e,s,r){t*=3,this.frames[t]=e,this.frames[t+1]=s,this.frames[t+2]=r}}class Yr extends xe{constructor(e,s,r){super(e,s,Q.rotate+"|"+r);x(this,"boneIndex",0);this.boneIndex=r}apply(e,s,r,n,a,o,h){let l=e.bones[this.boneIndex];l.active&&(l.rotation=this.getRelativeValue(r,a,o,l.rotation,l.data.rotation))}}class hf extends ko{constructor(e,s,r){super(e,s,Q.x+"|"+r,Q.y+"|"+r);x(this,"boneIndex",0);this.boneIndex=r}apply(e,s,r,n,a,o,h){let l=e.bones[this.boneIndex];if(!l.active)return;let c=this.frames;if(r<c[0]){switch(o){case V.setup:l.x=l.data.x,l.y=l.data.y;return;case V.first:l.x+=(l.data.x-l.x)*a,l.y+=(l.data.y-l.y)*a}return}let u=0,f=0,d=dt.search(c,r,3),p=this.curves[d/3];switch(p){case 0:let m=c[d];u=c[d+1],f=c[d+2];let g=(r-m)/(c[d+3]-m);u+=(c[d+3+1]-u)*g,f+=(c[d+3+2]-f)*g;break;case 1:u=c[d+1],f=c[d+2];break;default:u=this.getBezierValue(r,d,1,p-2),f=this.getBezierValue(r,d,2,p+18-2)}switch(o){case V.setup:l.x=l.data.x+u*a,l.y=l.data.y+f*a;break;case V.first:case V.replace:l.x+=(l.data.x+u-l.x)*a,l.y+=(l.data.y+f-l.y)*a;break;case V.add:l.x+=u*a,l.y+=f*a}}}class cf extends xe{constructor(e,s,r){super(e,s,Q.x+"|"+r);x(this,"boneIndex",0);this.boneIndex=r}apply(e,s,r,n,a,o,h){let l=e.bones[this.boneIndex];l.active&&(l.x=this.getRelativeValue(r,a,o,l.x,l.data.x))}}class uf extends xe{constructor(e,s,r){super(e,s,Q.y+"|"+r);x(this,"boneIndex",0);this.boneIndex=r}apply(e,s,r,n,a,o,h){let l=e.bones[this.boneIndex];l.active&&(l.y=this.getRelativeValue(r,a,o,l.y,l.data.y))}}class df extends ko{constructor(e,s,r){super(e,s,Q.scaleX+"|"+r,Q.scaleY+"|"+r);x(this,"boneIndex",0);this.boneIndex=r}apply(e,s,r,n,a,o,h){let l=e.bones[this.boneIndex];if(!l.active)return;let c=this.frames;if(r<c[0]){switch(o){case V.setup:l.scaleX=l.data.scaleX,l.scaleY=l.data.scaleY;return;case V.first:l.scaleX+=(l.data.scaleX-l.scaleX)*a,l.scaleY+=(l.data.scaleY-l.scaleY)*a}return}let u,f,d=dt.search(c,r,3),p=this.curves[d/3];switch(p){case 0:let m=c[d];u=c[d+1],f=c[d+2];let g=(r-m)/(c[d+3]-m);u+=(c[d+3+1]-u)*g,f+=(c[d+3+2]-f)*g;break;case 1:u=c[d+1],f=c[d+2];break;default:u=this.getBezierValue(r,d,1,p-2),f=this.getBezierValue(r,d,2,p+18-2)}if(u*=l.data.scaleX,f*=l.data.scaleY,a==1)o==V.add?(l.scaleX+=u-l.data.scaleX,l.scaleY+=f-l.data.scaleY):(l.scaleX=u,l.scaleY=f);else{let m=0,g=0;if(h==Lt.mixOut)switch(o){case V.setup:m=l.data.scaleX,g=l.data.scaleY,l.scaleX=m+(Math.abs(u)*D.signum(m)-m)*a,l.scaleY=g+(Math.abs(f)*D.signum(g)-g)*a;break;case V.first:case V.replace:m=l.scaleX,g=l.scaleY,l.scaleX=m+(Math.abs(u)*D.signum(m)-m)*a,l.scaleY=g+(Math.abs(f)*D.signum(g)-g)*a;break;case V.add:l.scaleX+=(u-l.data.scaleX)*a,l.scaleY+=(f-l.data.scaleY)*a}else switch(o){case V.setup:m=Math.abs(l.data.scaleX)*D.signum(u),g=Math.abs(l.data.scaleY)*D.signum(f),l.scaleX=m+(u-m)*a,l.scaleY=g+(f-g)*a;break;case V.first:case V.replace:m=Math.abs(l.scaleX)*D.signum(u),g=Math.abs(l.scaleY)*D.signum(f),l.scaleX=m+(u-m)*a,l.scaleY=g+(f-g)*a;break;case V.add:l.scaleX+=(u-l.data.scaleX)*a,l.scaleY+=(f-l.data.scaleY)*a}}}}class ff extends xe{constructor(e,s,r){super(e,s,Q.scaleX+"|"+r);x(this,"boneIndex",0);this.boneIndex=r}apply(e,s,r,n,a,o,h){let l=e.bones[this.boneIndex];l.active&&(l.scaleX=this.getScaleValue(r,a,o,h,l.scaleX,l.data.scaleX))}}class pf extends xe{constructor(e,s,r){super(e,s,Q.scaleY+"|"+r);x(this,"boneIndex",0);this.boneIndex=r}apply(e,s,r,n,a,o,h){let l=e.bones[this.boneIndex];l.active&&(l.scaleY=this.getScaleValue(r,a,o,h,l.scaleY,l.data.scaleY))}}class mf extends ko{constructor(e,s,r){super(e,s,Q.shearX+"|"+r,Q.shearY+"|"+r);x(this,"boneIndex",0);this.boneIndex=r}apply(e,s,r,n,a,o,h){let l=e.bones[this.boneIndex];if(!l.active)return;let c=this.frames;if(r<c[0]){switch(o){case V.setup:l.shearX=l.data.shearX,l.shearY=l.data.shearY;return;case V.first:l.shearX+=(l.data.shearX-l.shearX)*a,l.shearY+=(l.data.shearY-l.shearY)*a}return}let u=0,f=0,d=dt.search(c,r,3),p=this.curves[d/3];switch(p){case 0:let m=c[d];u=c[d+1],f=c[d+2];let g=(r-m)/(c[d+3]-m);u+=(c[d+3+1]-u)*g,f+=(c[d+3+2]-f)*g;break;case 1:u=c[d+1],f=c[d+2];break;default:u=this.getBezierValue(r,d,1,p-2),f=this.getBezierValue(r,d,2,p+18-2)}switch(o){case V.setup:l.shearX=l.data.shearX+u*a,l.shearY=l.data.shearY+f*a;break;case V.first:case V.replace:l.shearX+=(l.data.shearX+u-l.shearX)*a,l.shearY+=(l.data.shearY+f-l.shearY)*a;break;case V.add:l.shearX+=u*a,l.shearY+=f*a}}}class gf extends xe{constructor(e,s,r){super(e,s,Q.shearX+"|"+r);x(this,"boneIndex",0);this.boneIndex=r}apply(e,s,r,n,a,o,h){let l=e.bones[this.boneIndex];l.active&&(l.shearX=this.getRelativeValue(r,a,o,l.shearX,l.data.shearX))}}class xf extends xe{constructor(e,s,r){super(e,s,Q.shearY+"|"+r);x(this,"boneIndex",0);this.boneIndex=r}apply(e,s,r,n,a,o,h){let l=e.bones[this.boneIndex];l.active&&(l.shearY=this.getRelativeValue(r,a,o,l.shearY,l.data.shearY))}}class yf extends dt{constructor(e,s){super(e,[Q.inherit+"|"+s]);x(this,"boneIndex",0);this.boneIndex=s}getFrameEntries(){return 2}setFrame(e,s,r){e*=2,this.frames[e]=s,this.frames[e+1]=r}apply(e,s,r,n,a,o,h){let l=e.bones[this.boneIndex];if(!l.active)return;if(h==Lt.mixOut){o==V.setup&&(l.inherit=l.data.inherit);return}let c=this.frames;if(r<c[0]){(o==V.setup||o==V.first)&&(l.inherit=l.data.inherit);return}l.inherit=this.frames[dt.search(c,r,2)+1]}}class bf extends Ie{constructor(e,s,r){super(e,s,[Q.rgb+"|"+r,Q.alpha+"|"+r]);x(this,"slotIndex",0);this.slotIndex=r}getFrameEntries(){return 5}setFrame(e,s,r,n,a,o){e*=5,this.frames[e]=s,this.frames[e+1]=r,this.frames[e+2]=n,this.frames[e+3]=a,this.frames[e+4]=o}apply(e,s,r,n,a,o,h){let l=e.slots[this.slotIndex];if(!l.bone.active)return;let c=this.frames,u=l.color;if(r<c[0]){let w=l.data.color;switch(o){case V.setup:u.setFromColor(w);return;case V.first:u.add((w.r-u.r)*a,(w.g-u.g)*a,(w.b-u.b)*a,(w.a-u.a)*a)}return}let f=0,d=0,p=0,m=0,g=dt.search(c,r,5),_=this.curves[g/5];switch(_){case 0:let w=c[g];f=c[g+1],d=c[g+2],p=c[g+3],m=c[g+4];let b=(r-w)/(c[g+5]-w);f+=(c[g+5+1]-f)*b,d+=(c[g+5+2]-d)*b,p+=(c[g+5+3]-p)*b,m+=(c[g+5+4]-m)*b;break;case 1:f=c[g+1],d=c[g+2],p=c[g+3],m=c[g+4];break;default:f=this.getBezierValue(r,g,1,_-2),d=this.getBezierValue(r,g,2,_+18-2),p=this.getBezierValue(r,g,3,_+18*2-2),m=this.getBezierValue(r,g,4,_+18*3-2)}a==1?u.set(f,d,p,m):(o==V.setup&&u.setFromColor(l.data.color),u.add((f-u.r)*a,(d-u.g)*a,(p-u.b)*a,(m-u.a)*a))}}class _f extends Ie{constructor(e,s,r){super(e,s,[Q.rgb+"|"+r]);x(this,"slotIndex",0);this.slotIndex=r}getFrameEntries(){return 4}setFrame(e,s,r,n,a){e<<=2,this.frames[e]=s,this.frames[e+1]=r,this.frames[e+2]=n,this.frames[e+3]=a}apply(e,s,r,n,a,o,h){let l=e.slots[this.slotIndex];if(!l.bone.active)return;let c=this.frames,u=l.color;if(r<c[0]){let _=l.data.color;switch(o){case V.setup:u.r=_.r,u.g=_.g,u.b=_.b;return;case V.first:u.r+=(_.r-u.r)*a,u.g+=(_.g-u.g)*a,u.b+=(_.b-u.b)*a}return}let f=0,d=0,p=0,m=dt.search(c,r,4),g=this.curves[m>>2];switch(g){case 0:let _=c[m];f=c[m+1],d=c[m+2],p=c[m+3];let w=(r-_)/(c[m+4]-_);f+=(c[m+4+1]-f)*w,d+=(c[m+4+2]-d)*w,p+=(c[m+4+3]-p)*w;break;case 1:f=c[m+1],d=c[m+2],p=c[m+3];break;default:f=this.getBezierValue(r,m,1,g-2),d=this.getBezierValue(r,m,2,g+18-2),p=this.getBezierValue(r,m,3,g+18*2-2)}if(a==1)u.r=f,u.g=d,u.b=p;else{if(o==V.setup){let _=l.data.color;u.r=_.r,u.g=_.g,u.b=_.b}u.r+=(f-u.r)*a,u.g+=(d-u.g)*a,u.b+=(p-u.b)*a}}}class wf extends xe{constructor(e,s,r){super(e,s,Q.alpha+"|"+r);x(this,"slotIndex",0);this.slotIndex=r}apply(e,s,r,n,a,o,h){let l=e.slots[this.slotIndex];if(!l.bone.active)return;let c=l.color;if(r<this.frames[0]){let f=l.data.color;switch(o){case V.setup:c.a=f.a;return;case V.first:c.a+=(f.a-c.a)*a}return}let u=this.getCurveValue(r);a==1?c.a=u:(o==V.setup&&(c.a=l.data.color.a),c.a+=(u-c.a)*a)}}class vf extends Ie{constructor(e,s,r){super(e,s,[Q.rgb+"|"+r,Q.alpha+"|"+r,Q.rgb2+"|"+r]);x(this,"slotIndex",0);this.slotIndex=r}getFrameEntries(){return 8}setFrame(e,s,r,n,a,o,h,l,c){e<<=3,this.frames[e]=s,this.frames[e+1]=r,this.frames[e+2]=n,this.frames[e+3]=a,this.frames[e+4]=o,this.frames[e+5]=h,this.frames[e+6]=l,this.frames[e+7]=c}apply(e,s,r,n,a,o,h){let l=e.slots[this.slotIndex];if(!l.bone.active)return;let c=this.frames,u=l.color,f=l.darkColor;if(r<c[0]){let v=l.data.color,A=l.data.darkColor;switch(o){case V.setup:u.setFromColor(v),f.r=A.r,f.g=A.g,f.b=A.b;return;case V.first:u.add((v.r-u.r)*a,(v.g-u.g)*a,(v.b-u.b)*a,(v.a-u.a)*a),f.r+=(A.r-f.r)*a,f.g+=(A.g-f.g)*a,f.b+=(A.b-f.b)*a}return}let d=0,p=0,m=0,g=0,_=0,w=0,b=0,y=dt.search(c,r,8),S=this.curves[y>>3];switch(S){case 0:let v=c[y];d=c[y+1],p=c[y+2],m=c[y+3],g=c[y+4],_=c[y+5],w=c[y+6],b=c[y+7];let A=(r-v)/(c[y+8]-v);d+=(c[y+8+1]-d)*A,p+=(c[y+8+2]-p)*A,m+=(c[y+8+3]-m)*A,g+=(c[y+8+4]-g)*A,_+=(c[y+8+5]-_)*A,w+=(c[y+8+6]-w)*A,b+=(c[y+8+7]-b)*A;break;case 1:d=c[y+1],p=c[y+2],m=c[y+3],g=c[y+4],_=c[y+5],w=c[y+6],b=c[y+7];break;default:d=this.getBezierValue(r,y,1,S-2),p=this.getBezierValue(r,y,2,S+18-2),m=this.getBezierValue(r,y,3,S+18*2-2),g=this.getBezierValue(r,y,4,S+18*3-2),_=this.getBezierValue(r,y,5,S+18*4-2),w=this.getBezierValue(r,y,6,S+18*5-2),b=this.getBezierValue(r,y,7,S+18*6-2)}if(a==1)u.set(d,p,m,g),f.r=_,f.g=w,f.b=b;else{if(o==V.setup){u.setFromColor(l.data.color);let v=l.data.darkColor;f.r=v.r,f.g=v.g,f.b=v.b}u.add((d-u.r)*a,(p-u.g)*a,(m-u.b)*a,(g-u.a)*a),f.r+=(_-f.r)*a,f.g+=(w-f.g)*a,f.b+=(b-f.b)*a}}}class Sf extends Ie{constructor(e,s,r){super(e,s,[Q.rgb+"|"+r,Q.rgb2+"|"+r]);x(this,"slotIndex",0);this.slotIndex=r}getFrameEntries(){return 7}setFrame(e,s,r,n,a,o,h,l){e*=7,this.frames[e]=s,this.frames[e+1]=r,this.frames[e+2]=n,this.frames[e+3]=a,this.frames[e+4]=o,this.frames[e+5]=h,this.frames[e+6]=l}apply(e,s,r,n,a,o,h){let l=e.slots[this.slotIndex];if(!l.bone.active)return;let c=this.frames,u=l.color,f=l.darkColor;if(r<c[0]){let S=l.data.color,v=l.data.darkColor;switch(o){case V.setup:u.r=S.r,u.g=S.g,u.b=S.b,f.r=v.r,f.g=v.g,f.b=v.b;return;case V.first:u.r+=(S.r-u.r)*a,u.g+=(S.g-u.g)*a,u.b+=(S.b-u.b)*a,f.r+=(v.r-f.r)*a,f.g+=(v.g-f.g)*a,f.b+=(v.b-f.b)*a}return}let d=0,p=0,m=0,g=0,_=0,w=0,b=dt.search(c,r,7),y=this.curves[b/7];switch(y){case 0:let S=c[b];d=c[b+1],p=c[b+2],m=c[b+3],g=c[b+4],_=c[b+5],w=c[b+6];let v=(r-S)/(c[b+7]-S);d+=(c[b+7+1]-d)*v,p+=(c[b+7+2]-p)*v,m+=(c[b+7+3]-m)*v,g+=(c[b+7+4]-g)*v,_+=(c[b+7+5]-_)*v,w+=(c[b+7+6]-w)*v;break;case 1:d=c[b+1],p=c[b+2],m=c[b+3],g=c[b+4],_=c[b+5],w=c[b+6];break;default:d=this.getBezierValue(r,b,1,y-2),p=this.getBezierValue(r,b,2,y+18-2),m=this.getBezierValue(r,b,3,y+18*2-2),g=this.getBezierValue(r,b,4,y+18*3-2),_=this.getBezierValue(r,b,5,y+18*4-2),w=this.getBezierValue(r,b,6,y+18*5-2)}if(a==1)u.r=d,u.g=p,u.b=m,f.r=g,f.g=_,f.b=w;else{if(o==V.setup){let S=l.data.color,v=l.data.darkColor;u.r=S.r,u.g=S.g,u.b=S.b,f.r=v.r,f.g=v.g,f.b=v.b}u.r+=(d-u.r)*a,u.g+=(p-u.g)*a,u.b+=(m-u.b)*a,f.r+=(g-f.r)*a,f.g+=(_-f.g)*a,f.b+=(w-f.b)*a}}}class Is extends dt{constructor(e,s){super(e,[Q.attachment+"|"+s]);x(this,"slotIndex",0);x(this,"attachmentNames");this.slotIndex=s,this.attachmentNames=new Array(e)}getFrameCount(){return this.frames.length}setFrame(e,s,r){this.frames[e]=s,this.attachmentNames[e]=r}apply(e,s,r,n,a,o,h){let l=e.slots[this.slotIndex];if(l.bone.active){if(h==Lt.mixOut){o==V.setup&&this.setAttachment(e,l,l.data.attachmentName);return}if(r<this.frames[0]){(o==V.setup||o==V.first)&&this.setAttachment(e,l,l.data.attachmentName);return}this.setAttachment(e,l,this.attachmentNames[dt.search1(this.frames,r)])}}setAttachment(e,s,r){s.setAttachment(r?e.getAttachment(this.slotIndex,r):null)}}class Af extends Ie{constructor(e,s,r,n){super(e,s,[Q.deform+"|"+r+"|"+n.id]);x(this,"slotIndex",0);x(this,"attachment");x(this,"vertices");this.slotIndex=r,this.attachment=n,this.vertices=new Array(e)}getFrameCount(){return this.frames.length}setFrame(e,s,r){this.frames[e]=s,this.vertices[e]=r}setBezier(e,s,r,n,a,o,h,l,c,u,f){let d=this.curves,p=this.getFrameCount()+e*18;r==0&&(d[s]=2+p);let m=(n-o*2+l)*.03,g=c*.03-h*.06,_=((o-l)*3-n+u)*.006,w=(h-c+.33333333)*.018,b=m*2+_,y=g*2+w,S=(o-n)*.3+m+_*.16666667,v=h*.3+g+w*.16666667,A=n+S,C=v;for(let T=p+18;p<T;p+=2)d[p]=A,d[p+1]=C,S+=b,v+=y,b+=_,y+=w,A+=S,C+=v}getCurvePercent(e,s){let r=this.curves,n=r[s];switch(n){case 0:let l=this.frames[s];return(e-l)/(this.frames[s+this.getFrameEntries()]-l);case 1:return 0}if(n-=2,r[n]>e){let l=this.frames[s];return r[n+1]*(e-l)/(r[n]-l)}let a=n+18;for(n+=2;n<a;n+=2)if(r[n]>=e){let l=r[n-2],c=r[n-1];return c+(e-l)/(r[n]-l)*(r[n+1]-c)}let o=r[a-2],h=r[a-1];return h+(1-h)*(e-o)/(this.frames[s+this.getFrameEntries()]-o)}apply(e,s,r,n,a,o,h){let l=e.slots[this.slotIndex];if(!l.bone.active)return;let c=l.getAttachment();if(!c||!(c instanceof me)||c.timelineAttachment!=this.attachment)return;let u=l.deform;u.length==0&&(o=V.setup);let f=this.vertices,d=f[0].length,p=this.frames;if(r<p[0]){switch(o){case V.setup:u.length=0;return;case V.first:if(a==1){u.length=0;return}u.length=d;let y=c;if(y.bones){a=1-a;for(var m=0;m<d;m++)u[m]*=a}else{let S=y.vertices;for(var m=0;m<d;m++)u[m]+=(S[m]-u[m])*a}}return}if(u.length=d,r>=p[p.length-1]){let y=f[p.length-1];if(a==1)if(o==V.add){let S=c;if(S.bones)for(let v=0;v<d;v++)u[v]+=y[v];else{let v=S.vertices;for(let A=0;A<d;A++)u[A]+=y[A]-v[A]}}else Y.arrayCopy(y,0,u,0,d);else switch(o){case V.setup:{let v=c;if(v.bones)for(let A=0;A<d;A++)u[A]=y[A]*a;else{let A=v.vertices;for(let C=0;C<d;C++){let T=A[C];u[C]=T+(y[C]-T)*a}}break}case V.first:case V.replace:for(let v=0;v<d;v++)u[v]+=(y[v]-u[v])*a;break;case V.add:let S=c;if(S.bones)for(let v=0;v<d;v++)u[v]+=y[v]*a;else{let v=S.vertices;for(let A=0;A<d;A++)u[A]+=(y[A]-v[A])*a}}return}let g=dt.search1(p,r),_=this.getCurvePercent(r,g),w=f[g],b=f[g+1];if(a==1)if(o==V.add){let y=c;if(y.bones)for(let S=0;S<d;S++){let v=w[S];u[S]+=v+(b[S]-v)*_}else{let S=y.vertices;for(let v=0;v<d;v++){let A=w[v];u[v]+=A+(b[v]-A)*_-S[v]}}}else for(let y=0;y<d;y++){let S=w[y];u[y]=S+(b[y]-S)*_}else switch(o){case V.setup:{let S=c;if(S.bones)for(let v=0;v<d;v++){let A=w[v];u[v]=(A+(b[v]-A)*_)*a}else{let v=S.vertices;for(let A=0;A<d;A++){let C=w[A],T=v[A];u[A]=T+(C+(b[A]-C)*_-T)*a}}break}case V.first:case V.replace:for(let S=0;S<d;S++){let v=w[S];u[S]+=(v+(b[S]-v)*_-u[S])*a}break;case V.add:let y=c;if(y.bones)for(let S=0;S<d;S++){let v=w[S];u[S]+=(v+(b[S]-v)*_)*a}else{let S=y.vertices;for(let v=0;v<d;v++){let A=w[v];u[v]+=(A+(b[v]-A)*_-S[v])*a}}}}}const qr=class qr extends dt{constructor(e){super(e,qr.propertyIds);x(this,"events");this.events=new Array(e)}getFrameCount(){return this.frames.length}setFrame(e,s){this.frames[e]=s.time,this.events[e]=s}apply(e,s,r,n,a,o,h){if(!n)return;let l=this.frames,c=this.frames.length;if(s>r)this.apply(e,s,Number.MAX_VALUE,n,a,o,h),s=-1;else if(s>=l[c-1])return;if(r<l[0])return;let u=0;if(s<l[0])u=0;else{u=dt.search1(l,s)+1;let f=l[u];for(;u>0&&l[u-1]==f;)u--}for(;u<c&&r>=l[u];u++)n.push(this.events[u])}};x(qr,"propertyIds",[""+Q.event]);let Ui=qr;const Kr=class Kr extends dt{constructor(e){super(e,Kr.propertyIds);x(this,"drawOrders");this.drawOrders=new Array(e)}getFrameCount(){return this.frames.length}setFrame(e,s,r){this.frames[e]=s,this.drawOrders[e]=r}apply(e,s,r,n,a,o,h){if(h==Lt.mixOut){o==V.setup&&Y.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);return}if(r<this.frames[0]){(o==V.setup||o==V.first)&&Y.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);return}let l=dt.search1(this.frames,r),c=this.drawOrders[l];if(!c)Y.arrayCopy(e.slots,0,e.drawOrder,0,e.slots.length);else{let u=e.drawOrder,f=e.slots;for(let d=0,p=c.length;d<p;d++)u[d]=f[c[d]]}}};x(Kr,"propertyIds",[""+Q.drawOrder]);let us=Kr;class Cf extends Ie{constructor(e,s,r){super(e,s,[Q.ikConstraint+"|"+r]);x(this,"constraintIndex",0);this.constraintIndex=r}getFrameEntries(){return 6}setFrame(e,s,r,n,a,o,h){e*=6,this.frames[e]=s,this.frames[e+1]=r,this.frames[e+2]=n,this.frames[e+3]=a,this.frames[e+4]=o?1:0,this.frames[e+5]=h?1:0}apply(e,s,r,n,a,o,h){let l=e.ikConstraints[this.constraintIndex];if(!l.active)return;let c=this.frames;if(r<c[0]){switch(o){case V.setup:l.mix=l.data.mix,l.softness=l.data.softness,l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch;return;case V.first:l.mix+=(l.data.mix-l.mix)*a,l.softness+=(l.data.softness-l.softness)*a,l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch}return}let u=0,f=0,d=dt.search(c,r,6),p=this.curves[d/6];switch(p){case 0:let m=c[d];u=c[d+1],f=c[d+2];let g=(r-m)/(c[d+6]-m);u+=(c[d+6+1]-u)*g,f+=(c[d+6+2]-f)*g;break;case 1:u=c[d+1],f=c[d+2];break;default:u=this.getBezierValue(r,d,1,p-2),f=this.getBezierValue(r,d,2,p+18-2)}o==V.setup?(l.mix=l.data.mix+(u-l.data.mix)*a,l.softness=l.data.softness+(f-l.data.softness)*a,h==Lt.mixOut?(l.bendDirection=l.data.bendDirection,l.compress=l.data.compress,l.stretch=l.data.stretch):(l.bendDirection=c[d+3],l.compress=c[d+4]!=0,l.stretch=c[d+5]!=0)):(l.mix+=(u-l.mix)*a,l.softness+=(f-l.softness)*a,h==Lt.mixIn&&(l.bendDirection=c[d+3],l.compress=c[d+4]!=0,l.stretch=c[d+5]!=0))}}class Tf extends Ie{constructor(e,s,r){super(e,s,[Q.transformConstraint+"|"+r]);x(this,"constraintIndex",0);this.constraintIndex=r}getFrameEntries(){return 7}setFrame(e,s,r,n,a,o,h,l){let c=this.frames;e*=7,c[e]=s,c[e+1]=r,c[e+2]=n,c[e+3]=a,c[e+4]=o,c[e+5]=h,c[e+6]=l}apply(e,s,r,n,a,o,h){let l=e.transformConstraints[this.constraintIndex];if(!l.active)return;let c=this.frames;if(r<c[0]){let b=l.data;switch(o){case V.setup:l.mixRotate=b.mixRotate,l.mixX=b.mixX,l.mixY=b.mixY,l.mixScaleX=b.mixScaleX,l.mixScaleY=b.mixScaleY,l.mixShearY=b.mixShearY;return;case V.first:l.mixRotate+=(b.mixRotate-l.mixRotate)*a,l.mixX+=(b.mixX-l.mixX)*a,l.mixY+=(b.mixY-l.mixY)*a,l.mixScaleX+=(b.mixScaleX-l.mixScaleX)*a,l.mixScaleY+=(b.mixScaleY-l.mixScaleY)*a,l.mixShearY+=(b.mixShearY-l.mixShearY)*a}return}let u,f,d,p,m,g,_=dt.search(c,r,7),w=this.curves[_/7];switch(w){case 0:let b=c[_];u=c[_+1],f=c[_+2],d=c[_+3],p=c[_+4],m=c[_+5],g=c[_+6];let y=(r-b)/(c[_+7]-b);u+=(c[_+7+1]-u)*y,f+=(c[_+7+2]-f)*y,d+=(c[_+7+3]-d)*y,p+=(c[_+7+4]-p)*y,m+=(c[_+7+5]-m)*y,g+=(c[_+7+6]-g)*y;break;case 1:u=c[_+1],f=c[_+2],d=c[_+3],p=c[_+4],m=c[_+5],g=c[_+6];break;default:u=this.getBezierValue(r,_,1,w-2),f=this.getBezierValue(r,_,2,w+18-2),d=this.getBezierValue(r,_,3,w+18*2-2),p=this.getBezierValue(r,_,4,w+18*3-2),m=this.getBezierValue(r,_,5,w+18*4-2),g=this.getBezierValue(r,_,6,w+18*5-2)}if(o==V.setup){let b=l.data;l.mixRotate=b.mixRotate+(u-b.mixRotate)*a,l.mixX=b.mixX+(f-b.mixX)*a,l.mixY=b.mixY+(d-b.mixY)*a,l.mixScaleX=b.mixScaleX+(p-b.mixScaleX)*a,l.mixScaleY=b.mixScaleY+(m-b.mixScaleY)*a,l.mixShearY=b.mixShearY+(g-b.mixShearY)*a}else l.mixRotate+=(u-l.mixRotate)*a,l.mixX+=(f-l.mixX)*a,l.mixY+=(d-l.mixY)*a,l.mixScaleX+=(p-l.mixScaleX)*a,l.mixScaleY+=(m-l.mixScaleY)*a,l.mixShearY+=(g-l.mixShearY)*a}}class Mf extends xe{constructor(e,s,r){super(e,s,Q.pathConstraintPosition+"|"+r);x(this,"constraintIndex",0);this.constraintIndex=r}apply(e,s,r,n,a,o,h){let l=e.pathConstraints[this.constraintIndex];l.active&&(l.position=this.getAbsoluteValue(r,a,o,l.position,l.data.position))}}class Pf extends xe{constructor(e,s,r){super(e,s,Q.pathConstraintSpacing+"|"+r);x(this,"constraintIndex",0);this.constraintIndex=r}apply(e,s,r,n,a,o,h){let l=e.pathConstraints[this.constraintIndex];l.active&&(l.spacing=this.getAbsoluteValue(r,a,o,l.spacing,l.data.spacing))}}class kf extends Ie{constructor(e,s,r){super(e,s,[Q.pathConstraintMix+"|"+r]);x(this,"constraintIndex",0);this.constraintIndex=r}getFrameEntries(){return 4}setFrame(e,s,r,n,a){let o=this.frames;e<<=2,o[e]=s,o[e+1]=r,o[e+2]=n,o[e+3]=a}apply(e,s,r,n,a,o,h){let l=e.pathConstraints[this.constraintIndex];if(!l.active)return;let c=this.frames;if(r<c[0]){switch(o){case V.setup:l.mixRotate=l.data.mixRotate,l.mixX=l.data.mixX,l.mixY=l.data.mixY;return;case V.first:l.mixRotate+=(l.data.mixRotate-l.mixRotate)*a,l.mixX+=(l.data.mixX-l.mixX)*a,l.mixY+=(l.data.mixY-l.mixY)*a}return}let u,f,d,p=dt.search(c,r,4),m=this.curves[p>>2];switch(m){case 0:let g=c[p];u=c[p+1],f=c[p+2],d=c[p+3];let _=(r-g)/(c[p+4]-g);u+=(c[p+4+1]-u)*_,f+=(c[p+4+2]-f)*_,d+=(c[p+4+3]-d)*_;break;case 1:u=c[p+1],f=c[p+2],d=c[p+3];break;default:u=this.getBezierValue(r,p,1,m-2),f=this.getBezierValue(r,p,2,m+18-2),d=this.getBezierValue(r,p,3,m+18*2-2)}if(o==V.setup){let g=l.data;l.mixRotate=g.mixRotate+(u-g.mixRotate)*a,l.mixX=g.mixX+(f-g.mixX)*a,l.mixY=g.mixY+(d-g.mixY)*a}else l.mixRotate+=(u-l.mixRotate)*a,l.mixX+=(f-l.mixX)*a,l.mixY+=(d-l.mixY)*a}}class ys extends xe{constructor(e,s,r,n){super(e,s,n+"|"+r);x(this,"constraintIndex",0);this.constraintIndex=r}apply(e,s,r,n,a,o,h){let l;if(this.constraintIndex==-1){const c=r>=this.frames[0]?this.getCurveValue(r):0;for(const u of e.physicsConstraints)u.active&&this.global(u.data)&&this.set(u,this.getAbsoluteValue2(r,a,o,this.get(u),this.setup(u),c))}else l=e.physicsConstraints[this.constraintIndex],l.active&&this.set(l,this.getAbsoluteValue(r,a,o,this.get(l),this.setup(l)))}}class If extends ys{constructor(t,e,s){super(t,e,s,Q.physicsConstraintInertia)}setup(t){return t.data.inertia}get(t){return t.inertia}set(t,e){t.inertia=e}global(t){return t.inertiaGlobal}}class Ff extends ys{constructor(t,e,s){super(t,e,s,Q.physicsConstraintStrength)}setup(t){return t.data.strength}get(t){return t.strength}set(t,e){t.strength=e}global(t){return t.strengthGlobal}}class Ef extends ys{constructor(t,e,s){super(t,e,s,Q.physicsConstraintDamping)}setup(t){return t.data.damping}get(t){return t.damping}set(t,e){t.damping=e}global(t){return t.dampingGlobal}}class Bf extends ys{constructor(t,e,s){super(t,e,s,Q.physicsConstraintMass)}setup(t){return 1/t.data.massInverse}get(t){return 1/t.massInverse}set(t,e){t.massInverse=1/e}global(t){return t.massGlobal}}class Rf extends ys{constructor(t,e,s){super(t,e,s,Q.physicsConstraintWind)}setup(t){return t.data.wind}get(t){return t.wind}set(t,e){t.wind=e}global(t){return t.windGlobal}}class Vf extends ys{constructor(t,e,s){super(t,e,s,Q.physicsConstraintGravity)}setup(t){return t.data.gravity}get(t){return t.gravity}set(t,e){t.gravity=e}global(t){return t.gravityGlobal}}class Of extends ys{constructor(t,e,s){super(t,e,s,Q.physicsConstraintMix)}setup(t){return t.data.mix}get(t){return t.mix}set(t,e){t.mix=e}global(t){return t.mixGlobal}}const Zr=class Zr extends dt{constructor(e,s){super(e,Zr.propertyIds);x(this,"constraintIndex");this.constraintIndex=s}getFrameCount(){return this.frames.length}setFrame(e,s){this.frames[e]=s}apply(e,s,r,n,a,o,h){let l;if(this.constraintIndex!=-1&&(l=e.physicsConstraints[this.constraintIndex],!l.active))return;const c=this.frames;if(s>r)this.apply(e,s,Number.MAX_VALUE,[],a,o,h),s=-1;else if(s>=c[c.length-1])return;if(!(r<c[0])&&(s<c[0]||r>=c[dt.search1(c,s)+1]))if(l!=null)l.reset();else for(const u of e.physicsConstraints)u.active&&u.reset()}};x(Zr,"propertyIds",[Q.physicsConstraintReset.toString()]);let Xr=Zr;const te=class te extends dt{constructor(e,s,r){super(e,[Q.sequence+"|"+s+"|"+r.sequence.id]);x(this,"slotIndex");x(this,"attachment");this.slotIndex=s,this.attachment=r}getFrameEntries(){return te.ENTRIES}getSlotIndex(){return this.slotIndex}getAttachment(){return this.attachment}setFrame(e,s,r,n,a){let o=this.frames;e*=te.ENTRIES,o[e]=s,o[e+te.MODE]=r|n<<4,o[e+te.DELAY]=a}apply(e,s,r,n,a,o,h){let l=e.slots[this.slotIndex];if(!l.bone.active)return;let c=l.attachment,u=this.attachment;if(c!=u&&(!(c instanceof me)||c.timelineAttachment!=u))return;if(h==Lt.mixOut){o==V.setup&&(l.sequenceIndex=-1);return}let f=this.frames;if(r<f[0]){(o==V.setup||o==V.first)&&(l.sequenceIndex=-1);return}let d=dt.search(f,r,te.ENTRIES),p=f[d],m=f[d+te.MODE],g=f[d+te.DELAY];if(!this.attachment.sequence)return;let _=m>>4,w=this.attachment.sequence.regions.length,b=lf[m&15];if(b!=Rt.hold)switch(_+=(r-p)/g+1e-5|0,b){case Rt.once:_=Math.min(w-1,_);break;case Rt.loop:_%=w;break;case Rt.pingpong:{let y=(w<<1)-2;_=y==0?0:_%y,_>=w&&(_=y-_);break}case Rt.onceReverse:_=Math.max(w-1-_,0);break;case Rt.loopReverse:_=w-1-_%w;break;case Rt.pingpongReverse:{let y=(w<<1)-2;_=y==0?0:(_+w-1)%y,_>=w&&(_=y-_)}}l.sequenceIndex=_}};x(te,"ENTRIES",3),x(te,"MODE",1),x(te,"DELAY",2);let zr=te;const Es=class Es{constructor(t){x(this,"data");x(this,"tracks",new Array);x(this,"timeScale",1);x(this,"unkeyedState",0);x(this,"events",new Array);x(this,"listeners",new Array);x(this,"queue",new Jw(this));x(this,"propertyIDs",new af);x(this,"animationsChanged",!1);x(this,"trackEntryPool",new Ni(()=>new Qw));this.data=t}static emptyAnimation(){return Es._emptyAnimation}update(t){t*=this.timeScale;let e=this.tracks;for(let s=0,r=e.length;s<r;s++){let n=e[s];if(!n)continue;n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast;let a=t*n.timeScale;if(n.delay>0){if(n.delay-=a,n.delay>0)continue;a=-n.delay,n.delay=0}let o=n.next;if(o){let h=n.trackLast-o.delay;if(h>=0){for(o.delay=0,o.trackTime+=n.timeScale==0?0:(h/n.timeScale+t)*o.timeScale,n.trackTime+=a,this.setCurrent(s,o,!0);o.mixingFrom;)o.mixTime+=t,o=o.mixingFrom;continue}}else if(n.trackLast>=n.trackEnd&&!n.mixingFrom){e[s]=null,this.queue.end(n),this.clearNext(n);continue}if(n.mixingFrom&&this.updateMixingFrom(n,t)){let h=n.mixingFrom;for(n.mixingFrom=null,h&&(h.mixingTo=null);h;)this.queue.end(h),h=h.mixingFrom}n.trackTime+=a}this.queue.drain()}updateMixingFrom(t,e){let s=t.mixingFrom;if(!s)return!0;let r=this.updateMixingFrom(s,e);return s.animationLast=s.nextAnimationLast,s.trackLast=s.nextTrackLast,t.nextTrackLast!=-1&&t.mixTime>=t.mixDuration?((s.totalAlpha==0||t.mixDuration==0)&&(t.mixingFrom=s.mixingFrom,s.mixingFrom!=null&&(s.mixingFrom.mixingTo=t),t.interruptAlpha=s.interruptAlpha,this.queue.end(s)),r):(s.trackTime+=e*s.timeScale,t.mixTime+=e,!1)}apply(t){if(!t)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let e=this.events,s=this.tracks,r=!1;for(let f=0,d=s.length;f<d;f++){let p=s[f];if(!p||p.delay>0)continue;r=!0;let m=f==0?V.first:p.mixBlend,g=p.alpha;p.mixingFrom?g*=this.applyMixingFrom(p,t,m):p.trackTime>=p.trackEnd&&!p.next&&(g=0);let _=g>=p.alphaAttachmentThreshold,w=p.animationLast,b=p.getAnimationTime(),y=b,S=e;p.reverse&&(y=p.animation.duration-y,S=null);let v=p.animation.timelines,A=v.length;if(f==0&&g==1||m==V.add){f==0&&(_=!0);for(let C=0;C<A;C++){var n=v[C];n instanceof Is?this.applyAttachmentTimeline(n,t,y,m,_):n.apply(t,w,y,S,g,m,Lt.mixIn)}}else{let C=p.timelineMode,T=p.shortestRotation,P=!T&&p.timelinesRotation.length!=A<<1;P&&(p.timelinesRotation.length=A<<1);for(let M=0;M<A;M++){let B=v[M],F=C[M]==Kn?m:V.setup;!T&&B instanceof Yr?this.applyRotateTimeline(B,t,y,g,F,p.timelinesRotation,M<<1,P):B instanceof Is?this.applyAttachmentTimeline(B,t,y,m,_):B.apply(t,w,y,S,g,F,Lt.mixIn)}}this.queueEvents(p,b),e.length=0,p.nextAnimationLast=b,p.nextTrackLast=p.trackTime}for(var a=this.unkeyedState+Gh,o=t.slots,h=0,l=t.slots.length;h<l;h++){var c=o[h];if(c.attachmentState==a){var u=c.data.attachmentName;c.setAttachment(u?t.getAttachment(c.data.index,u):null)}}return this.unkeyedState+=2,this.queue.drain(),r}applyMixingFrom(t,e,s){let r=t.mixingFrom;r.mixingFrom&&this.applyMixingFrom(r,e,s);let n=0;t.mixDuration==0?(n=1,s==V.first&&(s=V.setup)):(n=t.mixTime/t.mixDuration,n>1&&(n=1),s!=V.first&&(s=r.mixBlend));let a=n<r.mixAttachmentThreshold,o=n<r.mixDrawOrderThreshold,h=r.animation.timelines,l=h.length,c=r.alpha*t.interruptAlpha,u=c*(1-n),f=r.animationLast,d=r.getAnimationTime(),p=d,m=null;if(r.reverse?p=r.animation.duration-p:n<r.eventThreshold&&(m=this.events),s==V.add)for(let g=0;g<l;g++)h[g].apply(e,f,p,m,u,s,Lt.mixOut);else{let g=r.timelineMode,_=r.timelineHoldMix,w=r.shortestRotation,b=!w&&r.timelinesRotation.length!=l<<1;b&&(r.timelinesRotation.length=l<<1),r.totalAlpha=0;for(let y=0;y<l;y++){let S=h[y],v=Lt.mixOut,A,C=0;switch(g[y]){case Kn:if(!o&&S instanceof us)continue;A=s,C=u;break;case Uh:A=V.setup,C=u;break;case Wh:A=s,C=c;break;case Zn:A=V.setup,C=c;break;default:A=V.setup;let T=_[y];C=c*Math.max(0,1-T.mixTime/T.mixDuration);break}r.totalAlpha+=C,!w&&S instanceof Yr?this.applyRotateTimeline(S,e,p,C,A,r.timelinesRotation,y<<1,b):S instanceof Is?this.applyAttachmentTimeline(S,e,p,A,a&&C>=r.alphaAttachmentThreshold):(o&&S instanceof us&&A==V.setup&&(v=Lt.mixIn),S.apply(e,f,p,m,C,A,v))}}return t.mixDuration>0&&this.queueEvents(r,d),this.events.length=0,r.nextAnimationLast=d,r.nextTrackLast=r.trackTime,n}applyAttachmentTimeline(t,e,s,r,n){var a=e.slots[t.slotIndex];a.bone.active&&(s<t.frames[0]?(r==V.setup||r==V.first)&&this.setAttachment(e,a,a.data.attachmentName,n):this.setAttachment(e,a,t.attachmentNames[dt.search1(t.frames,s)],n),a.attachmentState<=this.unkeyedState&&(a.attachmentState=this.unkeyedState+Gh))}setAttachment(t,e,s,r){e.setAttachment(s?t.getAttachment(e.data.index,s):null),r&&(e.attachmentState=this.unkeyedState+e1)}applyRotateTimeline(t,e,s,r,n,a,o,h){if(h&&(a[o]=0),r==1){t.apply(e,0,s,null,1,n,Lt.mixIn);return}let l=e.bones[t.boneIndex];if(!l.active)return;let c=t.frames,u=0,f=0;if(s<c[0])switch(n){case V.setup:l.rotation=l.data.rotation;default:return;case V.first:u=l.rotation,f=l.data.rotation}else u=n==V.setup?l.data.rotation:l.rotation,f=l.data.rotation+t.getCurveValue(s);let d=0,p=f-u;if(p-=Math.ceil(p/360-.5)*360,p==0)d=a[o];else{let m=0,g=0;h?(m=0,g=p):(m=a[o],g=a[o+1]);let _=m-m%360;d=p+_;let w=p>=0,b=m>=0;Math.abs(g)<=90&&D.signum(g)!=D.signum(p)&&(Math.abs(m-_)>180?(d+=360*D.signum(m),b=w):_!=0?d-=360*D.signum(m):b=w),b!=w&&(d+=360*D.signum(m)),a[o]=d}a[o+1]=p,l.rotation=u+d*r}queueEvents(t,e){let s=t.animationStart,r=t.animationEnd,n=r-s,a=t.trackLast%n,o=this.events,h=0,l=o.length;for(;h<l;h++){let u=o[h];if(u.time<a)break;u.time>r||this.queue.event(t,u)}let c=!1;if(t.loop)if(n==0)c=!0;else{const u=Math.floor(t.trackTime/n);c=u>0&&u>Math.floor(t.trackLast/n)}else c=e>=r&&t.animationLast<r;for(c&&this.queue.complete(t);h<l;h++){let u=o[h];u.time<s||this.queue.event(t,u)}}clearTracks(){let t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let e=0,s=this.tracks.length;e<s;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}clearTrack(t){if(t>=this.tracks.length)return;let e=this.tracks[t];if(!e)return;this.queue.end(e),this.clearNext(e);let s=e;for(;;){let r=s.mixingFrom;if(!r)break;this.queue.end(r),s.mixingFrom=null,s.mixingTo=null,s=r}this.tracks[e.trackIndex]=null,this.queue.drain()}setCurrent(t,e,s){let r=this.expandToIndex(t);this.tracks[t]=e,e.previous=null,r&&(s&&this.queue.interrupt(r),e.mixingFrom=r,r.mixingTo=e,e.mixTime=0,r.mixingFrom&&r.mixDuration>0&&(e.interruptAlpha*=Math.min(1,r.mixTime/r.mixDuration)),r.timelinesRotation.length=0),this.queue.start(e)}setAnimation(t,e,s=!1){let r=this.data.skeletonData.findAnimation(e);if(!r)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,r,s)}setAnimationWith(t,e,s=!1){if(!e)throw new Error("animation cannot be null.");let r=!0,n=this.expandToIndex(t);n&&(n.nextTrackLast==-1?(this.tracks[t]=n.mixingFrom,this.queue.interrupt(n),this.queue.end(n),this.clearNext(n),n=n.mixingFrom,r=!1):this.clearNext(n));let a=this.trackEntry(t,e,s,n);return this.setCurrent(t,a,r),this.queue.drain(),a}addAnimation(t,e,s=!1,r=0){let n=this.data.skeletonData.findAnimation(e);if(!n)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,n,s,r)}addAnimationWith(t,e,s=!1,r=0){if(!e)throw new Error("animation cannot be null.");let n=this.expandToIndex(t);if(n)for(;n.next;)n=n.next;let a=this.trackEntry(t,e,s,n);return n?(n.next=a,a.previous=n,r<=0&&(r=Math.max(r+n.getTrackComplete()-a.mixDuration,0))):(this.setCurrent(t,a,!0),this.queue.drain(),r<0&&(r=0)),a.delay=r,a}setEmptyAnimation(t,e=0){let s=this.setAnimationWith(t,Es.emptyAnimation(),!1);return s.mixDuration=e,s.trackEnd=e,s}addEmptyAnimation(t,e=0,s=0){let r=this.addAnimationWith(t,Es.emptyAnimation(),!1,s);return s<=0&&(r.delay=Math.max(r.delay+r.mixDuration-e,0)),r.mixDuration=e,r.trackEnd=e,r}setEmptyAnimations(t=0){let e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let s=0,r=this.tracks.length;s<r;s++){let n=this.tracks[s];n&&this.setEmptyAnimation(n.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}expandToIndex(t){return t<this.tracks.length?this.tracks[t]:(Y.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)}trackEntry(t,e,s,r){let n=this.trackEntryPool.obtain();return n.reset(),n.trackIndex=t,n.animation=e,n.loop=s,n.holdPrevious=!1,n.reverse=!1,n.shortestRotation=!1,n.eventThreshold=0,n.alphaAttachmentThreshold=0,n.mixAttachmentThreshold=0,n.mixDrawOrderThreshold=0,n.animationStart=0,n.animationEnd=e.duration,n.animationLast=-1,n.nextAnimationLast=-1,n.delay=0,n.trackTime=0,n.trackLast=-1,n.nextTrackLast=-1,n.trackEnd=Number.MAX_VALUE,n.timeScale=1,n.alpha=1,n.mixTime=0,n.mixDuration=r?this.data.getMix(r.animation,e):0,n.interruptAlpha=1,n.totalAlpha=0,n.mixBlend=V.replace,n}clearNext(t){let e=t.next;for(;e;)this.queue.dispose(e),e=e.next;t.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();let t=this.tracks;for(let e=0,s=t.length;e<s;e++){let r=t[e];if(r){for(;r.mixingFrom;)r=r.mixingFrom;do(!r.mixingTo||r.mixBlend!=V.add)&&this.computeHold(r),r=r.mixingTo;while(r)}}}computeHold(t){let e=t.mixingTo,s=t.animation.timelines,r=t.animation.timelines.length,n=t.timelineMode;n.length=r;let a=t.timelineHoldMix;a.length=0;let o=this.propertyIDs;if(e&&e.holdPrevious){for(let h=0;h<r;h++)n[h]=o.addAll(s[h].getPropertyIds())?Zn:Wh;return}t:for(let h=0;h<r;h++){let l=s[h],c=l.getPropertyIds();if(!o.addAll(c))n[h]=Kn;else if(!e||l instanceof Is||l instanceof us||l instanceof Ui||!e.animation.hasTimeline(c))n[h]=Uh;else{for(let u=e.mixingTo;u;u=u.mixingTo)if(!u.animation.hasTimeline(c)){if(t.mixDuration>0){n[h]=t1,a[h]=u;continue t}break}n[h]=Zn}}}getCurrent(t){return t>=this.tracks.length?null:this.tracks[t]}addListener(t){if(!t)throw new Error("listener cannot be null.");this.listeners.push(t)}removeListener(t){let e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}};x(Es,"_emptyAnimation",new Po("<empty>",[],0));let La=Es;class Qw{constructor(){x(this,"animation",null);x(this,"previous",null);x(this,"next",null);x(this,"mixingFrom",null);x(this,"mixingTo",null);x(this,"listener",null);x(this,"trackIndex",0);x(this,"loop",!1);x(this,"holdPrevious",!1);x(this,"reverse",!1);x(this,"shortestRotation",!1);x(this,"eventThreshold",0);x(this,"mixAttachmentThreshold",0);x(this,"alphaAttachmentThreshold",0);x(this,"mixDrawOrderThreshold",0);x(this,"animationStart",0);x(this,"animationEnd",0);x(this,"animationLast",0);x(this,"nextAnimationLast",0);x(this,"delay",0);x(this,"trackTime",0);x(this,"trackLast",0);x(this,"nextTrackLast",0);x(this,"trackEnd",0);x(this,"timeScale",0);x(this,"alpha",0);x(this,"mixTime",0);x(this,"_mixDuration",0);x(this,"interruptAlpha",0);x(this,"totalAlpha",0);x(this,"mixBlend",V.replace);x(this,"timelineMode",new Array);x(this,"timelineHoldMix",new Array);x(this,"timelinesRotation",new Array)}get mixDuration(){return this._mixDuration}set mixDuration(t){this._mixDuration=t}setMixDurationWithDelay(t,e){this._mixDuration=t,e<=0&&(this.previous!=null?e=Math.max(e+this.previous.getTrackComplete()-t,0):e=0),this.delay=e}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let t=this.animationEnd-this.animationStart;return t==0?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(t){this.animationLast=t,this.nextAnimationLast=t}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){let t=this.animationEnd-this.animationStart;if(t!=0){if(this.loop)return t*(1+(this.trackTime/t|0));if(this.trackTime<t)return t}return this.trackTime}wasApplied(){return this.nextTrackLast!=-1}isNextReady(){return this.next!=null&&this.nextTrackLast-this.next.delay>=0}}class Jw{constructor(t){x(this,"objects",[]);x(this,"drainDisabled",!1);x(this,"animState");this.animState=t}start(t){this.objects.push(Wt.start),this.objects.push(t),this.animState.animationsChanged=!0}interrupt(t){this.objects.push(Wt.interrupt),this.objects.push(t)}end(t){this.objects.push(Wt.end),this.objects.push(t),this.animState.animationsChanged=!0}dispose(t){this.objects.push(Wt.dispose),this.objects.push(t)}complete(t){this.objects.push(Wt.complete),this.objects.push(t)}event(t,e){this.objects.push(Wt.event),this.objects.push(t),this.objects.push(e)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let t=this.objects,e=this.animState.listeners;for(let s=0;s<t.length;s+=2){let r=t[s],n=t[s+1];switch(r){case Wt.start:n.listener&&n.listener.start&&n.listener.start(n);for(let o=0;o<e.length;o++){let h=e[o];h.start&&h.start(n)}break;case Wt.interrupt:n.listener&&n.listener.interrupt&&n.listener.interrupt(n);for(let o=0;o<e.length;o++){let h=e[o];h.interrupt&&h.interrupt(n)}break;case Wt.end:n.listener&&n.listener.end&&n.listener.end(n);for(let o=0;o<e.length;o++){let h=e[o];h.end&&h.end(n)}case Wt.dispose:n.listener&&n.listener.dispose&&n.listener.dispose(n);for(let o=0;o<e.length;o++){let h=e[o];h.dispose&&h.dispose(n)}this.animState.trackEntryPool.free(n);break;case Wt.complete:n.listener&&n.listener.complete&&n.listener.complete(n);for(let o=0;o<e.length;o++){let h=e[o];h.complete&&h.complete(n)}break;case Wt.event:let a=t[s+++2];n.listener&&n.listener.event&&n.listener.event(n,a);for(let o=0;o<e.length;o++){let h=e[o];h.event&&h.event(n,a)}break}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}var Wt;(function(i){i[i.start=0]="start",i[i.interrupt=1]="interrupt",i[i.end=2]="end",i[i.dispose=3]="dispose",i[i.complete=4]="complete",i[i.event=5]="event"})(Wt||(Wt={}));const Kn=0,Uh=1,Wh=2,Zn=3,t1=4,Gh=1,e1=2;class s1{constructor(t){x(this,"skeletonData");x(this,"animationToMixTime",{});x(this,"defaultMix",0);if(!t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}setMix(t,e,s){let r=this.skeletonData.findAnimation(t);if(!r)throw new Error("Animation not found: "+t);let n=this.skeletonData.findAnimation(e);if(!n)throw new Error("Animation not found: "+e);this.setMixWith(r,n,s)}setMixWith(t,e,s){if(!t)throw new Error("from cannot be null.");if(!e)throw new Error("to cannot be null.");let r=t.name+"."+e.name;this.animationToMixTime[r]=s}getMix(t,e){let s=t.name+"."+e.name,r=this.animationToMixTime[s];return r===void 0?this.defaultMix:r}}class rn extends me{constructor(e){super(e);x(this,"color",new K(1,1,1,1))}copy(){let e=new rn(this.name);return this.copyTo(e),e.color.setFromColor(this.color),e}}class ds extends me{constructor(e){super(e);x(this,"endSlot",null);x(this,"color",new K(.2275,.2275,.8078,1))}copy(){let e=new ds(this.name);return this.copyTo(e),e.endSlot=this.endSlot,e.color.setFromColor(this.color),e}}class i1{constructor(t){x(this,"_image");this._image=t}getImage(){return this._image}}var Et;(function(i){i[i.Nearest=9728]="Nearest",i[i.Linear=9729]="Linear",i[i.MipMap=9987]="MipMap",i[i.MipMapNearestNearest=9984]="MipMapNearestNearest",i[i.MipMapLinearNearest=9985]="MipMapLinearNearest",i[i.MipMapNearestLinear=9986]="MipMapNearestLinear",i[i.MipMapLinearLinear=9987]="MipMapLinearLinear"})(Et||(Et={}));var De;(function(i){i[i.MirroredRepeat=33648]="MirroredRepeat",i[i.ClampToEdge=33071]="ClampToEdge",i[i.Repeat=10497]="Repeat"})(De||(De={}));class r1{constructor(){x(this,"texture");x(this,"u",0);x(this,"v",0);x(this,"u2",0);x(this,"v2",0);x(this,"width",0);x(this,"height",0);x(this,"degrees",0);x(this,"offsetX",0);x(this,"offsetY",0);x(this,"originalWidth",0);x(this,"originalHeight",0)}}class n1{constructor(t){x(this,"pages",new Array);x(this,"regions",new Array);let e=new a1(t),s=new Array(4),r={};r.size=c=>{c.width=parseInt(s[1]),c.height=parseInt(s[2])},r.format=()=>{},r.filter=c=>{c.minFilter=Y.enumValue(Et,s[1]),c.magFilter=Y.enumValue(Et,s[2])},r.repeat=c=>{s[1].indexOf("x")!=-1&&(c.uWrap=De.Repeat),s[1].indexOf("y")!=-1&&(c.vWrap=De.Repeat)},r.pma=c=>{c.pma=s[1]=="true"};var n={};n.xy=c=>{c.x=parseInt(s[1]),c.y=parseInt(s[2])},n.size=c=>{c.width=parseInt(s[1]),c.height=parseInt(s[2])},n.bounds=c=>{c.x=parseInt(s[1]),c.y=parseInt(s[2]),c.width=parseInt(s[3]),c.height=parseInt(s[4])},n.offset=c=>{c.offsetX=parseInt(s[1]),c.offsetY=parseInt(s[2])},n.orig=c=>{c.originalWidth=parseInt(s[1]),c.originalHeight=parseInt(s[2])},n.offsets=c=>{c.offsetX=parseInt(s[1]),c.offsetY=parseInt(s[2]),c.originalWidth=parseInt(s[3]),c.originalHeight=parseInt(s[4])},n.rotate=c=>{let u=s[1];u=="true"?c.degrees=90:u!="false"&&(c.degrees=parseInt(u))},n.index=c=>{c.index=parseInt(s[1])};let a=e.readLine();for(;a&&a.trim().length==0;)a=e.readLine();for(;!(!a||a.trim().length==0||e.readEntry(s,a)==0);)a=e.readLine();let o=null,h=null,l=null;for(;a!==null;)if(a.trim().length==0)o=null,a=e.readLine();else if(o){let c=new Lf(o,a);for(;;){let u=e.readEntry(s,a=e.readLine());if(u==0)break;let f=n[s[0]];if(f)f(c);else{h||(h=[]),l||(l=[]),h.push(s[0]);let d=[];for(let p=0;p<u;p++)d.push(parseInt(s[p+1]));l.push(d)}}c.originalWidth==0&&c.originalHeight==0&&(c.originalWidth=c.width,c.originalHeight=c.height),h&&h.length>0&&l&&l.length>0&&(c.names=h,c.values=l,h=null,l=null),c.u=c.x/o.width,c.v=c.y/o.height,c.degrees==90?(c.u2=(c.x+c.height)/o.width,c.v2=(c.y+c.width)/o.height):(c.u2=(c.x+c.width)/o.width,c.v2=(c.y+c.height)/o.height),this.regions.push(c)}else{for(o=new o1(a.trim());e.readEntry(s,a=e.readLine())!=0;){let c=r[s[0]];c&&c(o)}this.pages.push(o)}}findRegion(t){for(let e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null}setTextures(t,e=""){for(let s of this.pages)s.setTexture(t.get(e+s.name))}dispose(){var t;for(let e=0;e<this.pages.length;e++)(t=this.pages[e].texture)==null||t.dispose()}}class a1{constructor(t){x(this,"lines");x(this,"index",0);this.lines=t.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(t,e){if(!e||(e=e.trim(),e.length==0))return 0;let s=e.indexOf(":");if(s==-1)return 0;t[0]=e.substr(0,s).trim();for(let r=1,n=s+1;;r++){let a=e.indexOf(",",n);if(a==-1)return t[r]=e.substr(n).trim(),r;if(t[r]=e.substr(n,a-n).trim(),n=a+1,r==4)return 4}}}class o1{constructor(t){x(this,"name");x(this,"minFilter",Et.Nearest);x(this,"magFilter",Et.Nearest);x(this,"uWrap",De.ClampToEdge);x(this,"vWrap",De.ClampToEdge);x(this,"texture",null);x(this,"width",0);x(this,"height",0);x(this,"pma",!1);x(this,"regions",new Array);this.name=t}setTexture(t){this.texture=t,t.setFilters(this.minFilter,this.magFilter),t.setWraps(this.uWrap,this.vWrap);for(let e of this.regions)e.texture=t}}class Lf extends r1{constructor(e,s){super();x(this,"page");x(this,"name");x(this,"x",0);x(this,"y",0);x(this,"offsetX",0);x(this,"offsetY",0);x(this,"originalWidth",0);x(this,"originalHeight",0);x(this,"index",0);x(this,"degrees",0);x(this,"names",null);x(this,"values",null);this.page=e,this.name=s,e.regions.push(this)}}class fe extends me{constructor(e,s){super(e);x(this,"region",null);x(this,"path");x(this,"regionUVs",[]);x(this,"uvs",[]);x(this,"triangles",[]);x(this,"color",new K(1,1,1,1));x(this,"width",0);x(this,"height",0);x(this,"hullLength",0);x(this,"edges",[]);x(this,"parentMesh",null);x(this,"sequence",null);x(this,"tempColor",new K(0,0,0,0));this.path=s}updateRegion(){if(!this.region)throw new Error("Region not set.");let e=this.regionUVs;(!this.uvs||this.uvs.length!=e.length)&&(this.uvs=Y.newFloatArray(e.length));let s=this.uvs,r=this.uvs.length,n=this.region.u,a=this.region.v,o=0,h=0;if(this.region instanceof Lf){let l=this.region,c=l.page,u=c.width,f=c.height;switch(l.degrees){case 90:n-=(l.originalHeight-l.offsetY-l.height)/u,a-=(l.originalWidth-l.offsetX-l.width)/f,o=l.originalHeight/u,h=l.originalWidth/f;for(let d=0;d<r;d+=2)s[d]=n+e[d+1]*o,s[d+1]=a+(1-e[d])*h;return;case 180:n-=(l.originalWidth-l.offsetX-l.width)/u,a-=l.offsetY/f,o=l.originalWidth/u,h=l.originalHeight/f;for(let d=0;d<r;d+=2)s[d]=n+(1-e[d])*o,s[d+1]=a+(1-e[d+1])*h;return;case 270:n-=l.offsetY/u,a-=l.offsetX/f,o=l.originalHeight/u,h=l.originalWidth/f;for(let d=0;d<r;d+=2)s[d]=n+(1-e[d+1])*o,s[d+1]=a+e[d]*h;return}n-=l.offsetX/u,a-=(l.originalHeight-l.offsetY-l.height)/f,o=l.originalWidth/u,h=l.originalHeight/f}else this.region?(o=this.region.u2-n,h=this.region.v2-a):(n=a=0,o=h=1);for(let l=0;l<r;l+=2)s[l]=n+e[l]*o,s[l+1]=a+e[l+1]*h}getParentMesh(){return this.parentMesh}setParentMesh(e){this.parentMesh=e,e&&(this.bones=e.bones,this.vertices=e.vertices,this.worldVerticesLength=e.worldVerticesLength,this.regionUVs=e.regionUVs,this.triangles=e.triangles,this.hullLength=e.hullLength,this.worldVerticesLength=e.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();let e=new fe(this.name,this.path);return e.region=this.region,e.color.setFromColor(this.color),this.copyTo(e),e.regionUVs=new Array(this.regionUVs.length),Y.arrayCopy(this.regionUVs,0,e.regionUVs,0,this.regionUVs.length),e.uvs=new Array(this.uvs.length),Y.arrayCopy(this.uvs,0,e.uvs,0,this.uvs.length),e.triangles=new Array(this.triangles.length),Y.arrayCopy(this.triangles,0,e.triangles,0,this.triangles.length),e.hullLength=this.hullLength,e.sequence=this.sequence!=null?this.sequence.copy():null,this.edges&&(e.edges=new Array(this.edges.length),Y.arrayCopy(this.edges,0,e.edges,0,this.edges.length)),e.width=this.width,e.height=this.height,e}computeWorldVertices(e,s,r,n,a,o){this.sequence!=null&&this.sequence.apply(e,this),super.computeWorldVertices(e,s,r,n,a,o)}newLinkedMesh(){let e=new fe(this.name,this.path);return e.region=this.region,e.color.setFromColor(this.color),e.timelineAttachment=this.timelineAttachment,e.setParentMesh(this.parentMesh?this.parentMesh:this),e.region!=null&&e.updateRegion(),e}}class Gs extends me{constructor(e){super(e);x(this,"lengths",[]);x(this,"closed",!1);x(this,"constantSpeed",!1);x(this,"color",new K(1,1,1,1))}copy(){let e=new Gs(this.name);return this.copyTo(e),e.lengths=new Array(this.lengths.length),Y.arrayCopy(this.lengths,0,e.lengths,0,this.lengths.length),e.closed=closed,e.constantSpeed=this.constantSpeed,e.color.setFromColor(this.color),e}}class Io extends me{constructor(e){super(e);x(this,"x",0);x(this,"y",0);x(this,"rotation",0);x(this,"color",new K(.38,.94,0,1))}computeWorldPosition(e,s){return s.x=this.x*e.a+this.y*e.b+e.worldX,s.y=this.x*e.c+this.y*e.d+e.worldY,s}computeWorldRotation(e){const s=this.rotation*D.degRad,r=Math.cos(s),n=Math.sin(s),a=r*e.a+n*e.b,o=r*e.c+n*e.d;return D.atan2Deg(o,a)}copy(){let e=new Io(this.name);return e.x=this.x,e.y=this.y,e.rotation=this.rotation,e.color.setFromColor(this.color),e}}const st=class st extends of{constructor(e,s){super(e);x(this,"x",0);x(this,"y",0);x(this,"scaleX",1);x(this,"scaleY",1);x(this,"rotation",0);x(this,"width",0);x(this,"height",0);x(this,"color",new K(1,1,1,1));x(this,"path");x(this,"region",null);x(this,"sequence",null);x(this,"offset",Y.newFloatArray(8));x(this,"uvs",Y.newFloatArray(8));x(this,"tempColor",new K(1,1,1,1));this.path=s}updateRegion(){if(!this.region)throw new Error("Region not set.");let e=this.region,s=this.uvs;if(e==null){s[0]=0,s[1]=0,s[2]=0,s[3]=1,s[4]=1,s[5]=1,s[6]=1,s[7]=0;return}let r=this.width/this.region.originalWidth*this.scaleX,n=this.height/this.region.originalHeight*this.scaleY,a=-this.width/2*this.scaleX+this.region.offsetX*r,o=-this.height/2*this.scaleY+this.region.offsetY*n,h=a+this.region.width*r,l=o+this.region.height*n,c=this.rotation*D.degRad,u=Math.cos(c),f=Math.sin(c),d=this.x,p=this.y,m=a*u+d,g=a*f,_=o*u+p,w=o*f,b=h*u+d,y=h*f,S=l*u+p,v=l*f,A=this.offset;A[0]=m-w,A[1]=_+g,A[2]=m-v,A[3]=S+g,A[4]=b-v,A[5]=S+y,A[6]=b-w,A[7]=_+y,e.degrees==90?(s[0]=e.u2,s[1]=e.v2,s[2]=e.u,s[3]=e.v2,s[4]=e.u,s[5]=e.v,s[6]=e.u2,s[7]=e.v):(s[0]=e.u,s[1]=e.v2,s[2]=e.u,s[3]=e.v,s[4]=e.u2,s[5]=e.v,s[6]=e.u2,s[7]=e.v2)}computeWorldVertices(e,s,r,n){this.sequence!=null&&this.sequence.apply(e,this);let a=e.bone,o=this.offset,h=a.worldX,l=a.worldY,c=a.a,u=a.b,f=a.c,d=a.d,p=0,m=0;p=o[0],m=o[1],s[r]=p*c+m*u+h,s[r+1]=p*f+m*d+l,r+=n,p=o[2],m=o[3],s[r]=p*c+m*u+h,s[r+1]=p*f+m*d+l,r+=n,p=o[4],m=o[5],s[r]=p*c+m*u+h,s[r+1]=p*f+m*d+l,r+=n,p=o[6],m=o[7],s[r]=p*c+m*u+h,s[r+1]=p*f+m*d+l}copy(){let e=new st(this.name,this.path);return e.region=this.region,e.x=this.x,e.y=this.y,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e.rotation=this.rotation,e.width=this.width,e.height=this.height,Y.arrayCopy(this.uvs,0,e.uvs,0,8),Y.arrayCopy(this.offset,0,e.offset,0,8),e.color.setFromColor(this.color),e.sequence=this.sequence!=null?this.sequence.copy():null,e}};x(st,"X1",0),x(st,"Y1",1),x(st,"C1R",2),x(st,"C1G",3),x(st,"C1B",4),x(st,"C1A",5),x(st,"U1",6),x(st,"V1",7),x(st,"X2",8),x(st,"Y2",9),x(st,"C2R",10),x(st,"C2G",11),x(st,"C2B",12),x(st,"C2A",13),x(st,"U2",14),x(st,"V2",15),x(st,"X3",16),x(st,"Y3",17),x(st,"C3R",18),x(st,"C3G",19),x(st,"C3B",20),x(st,"C3A",21),x(st,"U3",22),x(st,"V3",23),x(st,"X4",24),x(st,"Y4",25),x(st,"C4R",26),x(st,"C4G",27),x(st,"C4B",28),x(st,"C4A",29),x(st,"U4",30),x(st,"V4",31);let de=st;class l1{constructor(t){x(this,"atlas");this.atlas=t}loadSequence(t,e,s){let r=s.regions;for(let n=0,a=r.length;n<a;n++){let o=s.getPath(e,n),h=this.atlas.findRegion(o);if(h==null)throw new Error("Region not found in atlas: "+o+" (sequence: "+t+")");r[n]=h}}newRegionAttachment(t,e,s,r){let n=new de(e,s);if(r!=null)this.loadSequence(e,s,r);else{let a=this.atlas.findRegion(s);if(!a)throw new Error("Region not found in atlas: "+s+" (region attachment: "+e+")");n.region=a}return n}newMeshAttachment(t,e,s,r){let n=new fe(e,s);if(r!=null)this.loadSequence(e,s,r);else{let a=this.atlas.findRegion(s);if(!a)throw new Error("Region not found in atlas: "+s+" (mesh attachment: "+e+")");n.region=a}return n}newBoundingBoxAttachment(t,e){return new rn(e)}newPathAttachment(t,e){return new Gs(e)}newPointAttachment(t,e){return new Io(e)}newClippingAttachment(t,e){return new ds(e)}}class Df{constructor(t,e,s){x(this,"index",0);x(this,"name");x(this,"parent",null);x(this,"length",0);x(this,"x",0);x(this,"y",0);x(this,"rotation",0);x(this,"scaleX",1);x(this,"scaleY",1);x(this,"shearX",0);x(this,"shearY",0);x(this,"inherit",yt.Normal);x(this,"skinRequired",!1);x(this,"color",new K);x(this,"icon");x(this,"visible",!1);if(t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");this.index=t,this.name=e,this.parent=s}}var yt;(function(i){i[i.Normal=0]="Normal",i[i.OnlyTranslation=1]="OnlyTranslation",i[i.NoRotationOrReflection=2]="NoRotationOrReflection",i[i.NoScale=3]="NoScale",i[i.NoScaleOrReflection=4]="NoScaleOrReflection"})(yt||(yt={}));class Hh{constructor(t,e,s){x(this,"data");x(this,"skeleton");x(this,"parent",null);x(this,"children",new Array);x(this,"x",0);x(this,"y",0);x(this,"rotation",0);x(this,"scaleX",0);x(this,"scaleY",0);x(this,"shearX",0);x(this,"shearY",0);x(this,"ax",0);x(this,"ay",0);x(this,"arotation",0);x(this,"ascaleX",0);x(this,"ascaleY",0);x(this,"ashearX",0);x(this,"ashearY",0);x(this,"a",0);x(this,"b",0);x(this,"c",0);x(this,"d",0);x(this,"worldY",0);x(this,"worldX",0);x(this,"inherit",yt.Normal);x(this,"sorted",!1);x(this,"active",!1);if(!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=s,this.setToSetupPose()}isActive(){return this.active}update(t){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(t,e,s,r,n,a,o){this.ax=t,this.ay=e,this.arotation=s,this.ascaleX=r,this.ascaleY=n,this.ashearX=a,this.ashearY=o;let h=this.parent;if(!h){let d=this.skeleton;const p=d.scaleX,m=d.scaleY,g=(s+a)*D.degRad,_=(s+90+o)*D.degRad;this.a=Math.cos(g)*r*p,this.b=Math.cos(_)*n*p,this.c=Math.sin(g)*r*m,this.d=Math.sin(_)*n*m,this.worldX=t*p+d.x,this.worldY=e*m+d.y;return}let l=h.a,c=h.b,u=h.c,f=h.d;switch(this.worldX=l*t+c*e+h.worldX,this.worldY=u*t+f*e+h.worldY,this.inherit){case yt.Normal:{const d=(s+a)*D.degRad,p=(s+90+o)*D.degRad,m=Math.cos(d)*r,g=Math.cos(p)*n,_=Math.sin(d)*r,w=Math.sin(p)*n;this.a=l*m+c*_,this.b=l*g+c*w,this.c=u*m+f*_,this.d=u*g+f*w;return}case yt.OnlyTranslation:{const d=(s+a)*D.degRad,p=(s+90+o)*D.degRad;this.a=Math.cos(d)*r,this.b=Math.cos(p)*n,this.c=Math.sin(d)*r,this.d=Math.sin(p)*n;break}case yt.NoRotationOrReflection:{let d=1/this.skeleton.scaleX,p=1/this.skeleton.scaleY;l*=d,u*=p;let m=l*l+u*u,g=0;m>1e-4?(m=Math.abs(l*f*p-c*d*u)/m,c=u*m,f=l*m,g=Math.atan2(u,l)*D.radDeg):(l=0,u=0,g=90-Math.atan2(f,c)*D.radDeg);const _=(s+a-g)*D.degRad,w=(s+o-g+90)*D.degRad,b=Math.cos(_)*r,y=Math.cos(w)*n,S=Math.sin(_)*r,v=Math.sin(w)*n;this.a=l*b-c*S,this.b=l*y-c*v,this.c=u*b+f*S,this.d=u*y+f*v;break}case yt.NoScale:case yt.NoScaleOrReflection:{s*=D.degRad;const d=Math.cos(s),p=Math.sin(s);let m=(l*d+c*p)/this.skeleton.scaleX,g=(u*d+f*p)/this.skeleton.scaleY,_=Math.sqrt(m*m+g*g);_>1e-5&&(_=1/_),m*=_,g*=_,_=Math.sqrt(m*m+g*g),this.inherit==yt.NoScale&&l*f-c*u<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(_=-_),s=Math.PI/2+Math.atan2(g,m);const w=Math.cos(s)*_,b=Math.sin(s)*_;a*=D.degRad,o=(90+o)*D.degRad;const y=Math.cos(a)*r,S=Math.cos(o)*n,v=Math.sin(a)*r,A=Math.sin(o)*n;this.a=m*y+w*v,this.b=m*S+w*A,this.c=g*y+b*v,this.d=g*S+b*A;break}}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY}setToSetupPose(){let t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY,this.inherit=t.inherit}updateAppliedTransform(){let t=this.parent;if(!t){this.ax=this.worldX-this.skeleton.x,this.ay=this.worldY-this.skeleton.y,this.arotation=Math.atan2(this.c,this.a)*D.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*D.radDeg;return}let e=t.a,s=t.b,r=t.c,n=t.d,a=1/(e*n-s*r),o=n*a,h=s*a,l=r*a,c=e*a,u=this.worldX-t.worldX,f=this.worldY-t.worldY;this.ax=u*o-f*h,this.ay=f*c-u*l;let d,p,m,g;if(this.inherit==yt.OnlyTranslation)d=this.a,p=this.b,m=this.c,g=this.d;else{switch(this.inherit){case yt.NoRotationOrReflection:{let S=Math.abs(e*n-s*r)/(e*e+r*r);s=-r*this.skeleton.scaleX*S/this.skeleton.scaleY,n=e*this.skeleton.scaleY*S/this.skeleton.scaleX,a=1/(e*n-s*r),o=n*a,h=s*a;break}case yt.NoScale:case yt.NoScaleOrReflection:let _=D.cosDeg(this.rotation),w=D.sinDeg(this.rotation);e=(e*_+s*w)/this.skeleton.scaleX,r=(r*_+n*w)/this.skeleton.scaleY;let b=Math.sqrt(e*e+r*r);b>1e-5&&(b=1/b),e*=b,r*=b,b=Math.sqrt(e*e+r*r),this.inherit==yt.NoScale&&a<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(b=-b);let y=D.PI/2+Math.atan2(r,e);s=Math.cos(y)*b,n=Math.sin(y)*b,a=1/(e*n-s*r),o=n*a,h=s*a,l=r*a,c=e*a}d=o*this.a-h*this.c,p=o*this.b-h*this.d,m=c*this.c-l*this.a,g=c*this.d-l*this.b}if(this.ashearX=0,this.ascaleX=Math.sqrt(d*d+m*m),this.ascaleX>1e-4){let _=d*g-p*m;this.ascaleY=_/this.ascaleX,this.ashearY=-Math.atan2(d*p+m*g,_)*D.radDeg,this.arotation=Math.atan2(m,d)*D.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(p*p+g*g),this.ashearY=0,this.arotation=90-Math.atan2(g,p)*D.radDeg}getWorldRotationX(){return Math.atan2(this.c,this.a)*D.radDeg}getWorldRotationY(){return Math.atan2(this.d,this.b)*D.radDeg}getWorldScaleX(){return Math.sqrt(this.a*this.a+this.c*this.c)}getWorldScaleY(){return Math.sqrt(this.b*this.b+this.d*this.d)}worldToLocal(t){let e=1/(this.a*this.d-this.b*this.c),s=t.x-this.worldX,r=t.y-this.worldY;return t.x=s*this.d*e-r*this.b*e,t.y=r*this.a*e-s*this.c*e,t}localToWorld(t){let e=t.x,s=t.y;return t.x=e*this.a+s*this.b+this.worldX,t.y=e*this.c+s*this.d+this.worldY,t}worldToParent(t){if(t==null)throw new Error("world cannot be null.");return this.parent==null?t:this.parent.worldToLocal(t)}parentToWorld(t){if(t==null)throw new Error("world cannot be null.");return this.parent==null?t:this.parent.localToWorld(t)}worldToLocalRotation(t){let e=D.sinDeg(t),s=D.cosDeg(t);return Math.atan2(this.a*e-this.c*s,this.d*s-this.b*e)*D.radDeg+this.rotation-this.shearX}localToWorldRotation(t){t-=this.rotation-this.shearX;let e=D.sinDeg(t),s=D.cosDeg(t);return Math.atan2(s*this.c+e*this.d,s*this.a+e*this.b)*D.radDeg}rotateWorld(t){t*=D.degRad;const e=Math.sin(t),s=Math.cos(t),r=this.a,n=this.b;this.a=s*r-e*this.c,this.b=s*n-e*this.d,this.c=e*r+s*this.c,this.d=e*n+s*this.d}}class nn{constructor(t,e,s){x(this,"name");x(this,"order");x(this,"skinRequired");this.name=t,this.order=e,this.skinRequired=s}}let Yf=class{constructor(t,e){x(this,"data");x(this,"intValue",0);x(this,"floatValue",0);x(this,"stringValue",null);x(this,"time",0);x(this,"volume",0);x(this,"balance",0);if(!e)throw new Error("data cannot be null.");this.time=t,this.data=e}};class Xf{constructor(t){x(this,"name");x(this,"intValue",0);x(this,"floatValue",0);x(this,"stringValue",null);x(this,"audioPath",null);x(this,"volume",0);x(this,"balance",0);this.name=t}}class h1{constructor(t,e){x(this,"data");x(this,"bones");x(this,"target");x(this,"bendDirection",0);x(this,"compress",!1);x(this,"stretch",!1);x(this,"mix",1);x(this,"softness",0);x(this,"active",!1);if(!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let r=0;r<t.bones.length;r++){let n=e.findBone(t.bones[r].name);if(!n)throw new Error(`Couldn't find bone ${t.bones[r].name}`);this.bones.push(n)}let s=e.findBone(t.target.name);if(!s)throw new Error(`Couldn't find bone ${t.target.name}`);this.target=s,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch}isActive(){return this.active}setToSetupPose(){const t=this.data;this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch}update(t){if(this.mix==0)return;let e=this.target,s=this.bones;switch(s.length){case 1:this.apply1(s[0],e.worldX,e.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(s[0],s[1],e.worldX,e.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix);break}}apply1(t,e,s,r,n,a,o){let h=t.parent;if(!h)throw new Error("IK bone must have parent.");let l=h.a,c=h.b,u=h.c,f=h.d,d=-t.ashearX-t.arotation,p=0,m=0;switch(t.inherit){case yt.OnlyTranslation:p=(e-t.worldX)*D.signum(t.skeleton.scaleX),m=(s-t.worldY)*D.signum(t.skeleton.scaleY);break;case yt.NoRotationOrReflection:let w=Math.abs(l*f-c*u)/Math.max(1e-4,l*l+u*u),b=l/t.skeleton.scaleX,y=u/t.skeleton.scaleY;c=-y*w*t.skeleton.scaleX,f=b*w*t.skeleton.scaleY,d+=Math.atan2(y,b)*D.radDeg;default:let S=e-h.worldX,v=s-h.worldY,A=l*f-c*u;Math.abs(A)<=1e-4?(p=0,m=0):(p=(S*f-v*c)/A-t.ax,m=(v*l-S*u)/A-t.ay)}d+=Math.atan2(m,p)*D.radDeg,t.ascaleX<0&&(d+=180),d>180?d-=360:d<-180&&(d+=360);let g=t.ascaleX,_=t.ascaleY;if(r||n){switch(t.inherit){case yt.NoScale:case yt.NoScaleOrReflection:p=e-t.worldX,m=s-t.worldY}const w=t.data.length*g;if(w>1e-4){const b=p*p+m*m;if(r&&b<w*w||n&&b>w*w){const y=(Math.sqrt(b)/w-1)*o+1;g*=y,a&&(_*=y)}}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+d*o,g,_,t.ashearX,t.ashearY)}apply2(t,e,s,r,n,a,o,h,l){if(t.inherit!=yt.Normal||e.inherit!=yt.Normal)return;let c=t.ax,u=t.ay,f=t.ascaleX,d=t.ascaleY,p=f,m=d,g=e.ascaleX,_=0,w=0,b=0;f<0?(f=-f,_=180,b=-1):(_=0,b=1),d<0&&(d=-d,b=-b),g<0?(g=-g,w=180):w=0;let y=e.ax,S=0,v=0,A=0,C=t.a,T=t.b,P=t.c,M=t.d,B=Math.abs(f-d)<=1e-4;!B||a?(S=0,v=C*y+t.worldX,A=P*y+t.worldY):(S=e.ay,v=C*y+T*S+t.worldX,A=P*y+M*S+t.worldY);let F=t.parent;if(!F)throw new Error("IK parent must itself have a parent.");C=F.a,T=F.b,P=F.c,M=F.d;let I=C*M-T*P,E=v-F.worldX,R=A-F.worldY;I=Math.abs(I)<=1e-4?0:1/I;let O=(E*M-R*T)*I-c,W=(R*C-E*P)*I-u,L=Math.sqrt(O*O+W*W),H=e.data.length*g,Z,J;if(L<1e-4){this.apply1(t,s,r,!1,a,!1,l),e.updateWorldTransformWith(y,S,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);return}E=s-F.worldX,R=r-F.worldY;let z=(E*M-R*T)*I-c,$=(R*C-E*P)*I-u,G=z*z+$*$;if(h!=0){h*=f*(g+1)*.5;let nt=Math.sqrt(G),lt=nt-L-H*f+h;if(lt>0){let At=Math.min(1,lt/(h*2))-1;At=(lt-h*(1-At*At))/nt,z-=At*z,$-=At*$,G=z*z+$*$}}t:if(B){H*=f;let nt=(G-L*L-H*H)/(2*L*H);nt<-1?(nt=-1,J=Math.PI*n):nt>1?(nt=1,J=0,a&&(C=(Math.sqrt(G)/(L+H)-1)*l+1,p*=C,o&&(m*=C))):J=Math.acos(nt)*n,C=L+H*nt,T=H*Math.sin(J),Z=Math.atan2($*C-z*T,z*C+$*T)}else{C=f*H,T=d*H;let nt=C*C,lt=T*T,At=Math.atan2($,z);P=lt*L*L+nt*G-nt*lt;let Qt=-2*lt*L,Ht=lt-nt;if(M=Qt*Qt-4*Ht*P,M>=0){let _s=Math.sqrt(M);Qt<0&&(_s=-_s),_s=-(Qt+_s)*.5;let si=_s/Ht,Eo=P/_s,tr=Math.abs(si)<Math.abs(Eo)?si:Eo;if(si=G-tr*tr,si>=0){R=Math.sqrt(si)*n,Z=At-Math.atan2(R,tr),J=Math.atan2(R/d,(tr-L)/f);break t}}let ye=D.PI,Jt=L-C,ae=Jt*Jt,Qi=0,ei=0,bs=L+C,Ji=bs*bs,Fo=0;P=-C*L/(nt-lt),P>=-1&&P<=1&&(P=Math.acos(P),E=C*Math.cos(P)+L,R=T*Math.sin(P),M=E*E+R*R,M<ae&&(ye=P,ae=M,Jt=E,Qi=R),M>Ji&&(ei=P,Ji=M,bs=E,Fo=R)),G<=(ae+Ji)*.5?(Z=At-Math.atan2(Qi*n,Jt),J=ye*n):(Z=At-Math.atan2(Fo*n,bs),J=ei*n)}let gt=Math.atan2(S,y)*b,_t=t.arotation;Z=(Z-gt)*D.radDeg+_-_t,Z>180?Z-=360:Z<-180&&(Z+=360),t.updateWorldTransformWith(c,u,_t+Z*l,p,m,0,0),_t=e.arotation,J=((J+gt)*D.radDeg-e.ashearX)*b+w-_t,J>180?J-=360:J<-180&&(J+=360),e.updateWorldTransformWith(y,S,_t+J*l,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}}class zf extends nn{constructor(e){super(e,0,!1);x(this,"bones",new Array);x(this,"_target",null);x(this,"bendDirection",0);x(this,"compress",!1);x(this,"stretch",!1);x(this,"uniform",!1);x(this,"mix",0);x(this,"softness",0)}set target(e){this._target=e}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class Nf extends nn{constructor(e){super(e,0,!1);x(this,"bones",new Array);x(this,"_target",null);x(this,"positionMode",Pe.Fixed);x(this,"spacingMode",It.Fixed);x(this,"rotateMode",fs.Chain);x(this,"offsetRotation",0);x(this,"position",0);x(this,"spacing",0);x(this,"mixRotate",0);x(this,"mixX",0);x(this,"mixY",0)}set target(e){this._target=e}get target(){if(this._target)return this._target;throw new Error("SlotData not set.")}}var Pe;(function(i){i[i.Fixed=0]="Fixed",i[i.Percent=1]="Percent"})(Pe||(Pe={}));var It;(function(i){i[i.Length=0]="Length",i[i.Fixed=1]="Fixed",i[i.Percent=2]="Percent",i[i.Proportional=3]="Proportional"})(It||(It={}));var fs;(function(i){i[i.Tangent=0]="Tangent",i[i.Chain=1]="Chain",i[i.ChainScale=2]="ChainScale"})(fs||(fs={}));const qt=class qt{constructor(t,e){x(this,"data");x(this,"bones");x(this,"target");x(this,"position",0);x(this,"spacing",0);x(this,"mixRotate",0);x(this,"mixX",0);x(this,"mixY",0);x(this,"spaces",new Array);x(this,"positions",new Array);x(this,"world",new Array);x(this,"curves",new Array);x(this,"lengths",new Array);x(this,"segments",new Array);x(this,"active",!1);if(!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let r=0,n=t.bones.length;r<n;r++){let a=e.findBone(t.bones[r].name);if(!a)throw new Error(`Couldn't find bone ${t.bones[r].name}.`);this.bones.push(a)}let s=e.findSlot(t.target.name);if(!s)throw new Error(`Couldn't find target bone ${t.target.name}`);this.target=s,this.position=t.position,this.spacing=t.spacing,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY}isActive(){return this.active}setToSetupPose(){const t=this.data;this.position=t.position,this.spacing=t.spacing,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY}update(t){let e=this.target.getAttachment();if(!(e instanceof Gs))return;let s=this.mixRotate,r=this.mixX,n=this.mixY;if(s==0&&r==0&&n==0)return;let a=this.data,o=a.rotateMode==fs.Tangent,h=a.rotateMode==fs.ChainScale,l=this.bones,c=l.length,u=o?c:c+1,f=Y.setArraySize(this.spaces,u),d=h?this.lengths=Y.setArraySize(this.lengths,c):[],p=this.spacing;switch(a.spacingMode){case It.Percent:if(h)for(let v=0,A=u-1;v<A;v++){let C=l[v],T=C.data.length,P=T*C.a,M=T*C.c;d[v]=Math.sqrt(P*P+M*M)}Y.arrayFill(f,1,u,p);break;case It.Proportional:let y=0;for(let v=0,A=u-1;v<A;){let C=l[v],T=C.data.length;if(T<qt.epsilon)h&&(d[v]=0),f[++v]=p;else{let P=T*C.a,M=T*C.c,B=Math.sqrt(P*P+M*M);h&&(d[v]=B),f[++v]=B,y+=B}}if(y>0){y=u/y*p;for(let v=1;v<u;v++)f[v]*=y}break;default:let S=a.spacingMode==It.Length;for(let v=0,A=u-1;v<A;){let C=l[v],T=C.data.length;if(T<qt.epsilon)h&&(d[v]=0),f[++v]=p;else{let P=T*C.a,M=T*C.c,B=Math.sqrt(P*P+M*M);h&&(d[v]=B),f[++v]=(S?T+p:p)*B/T}}}let m=this.computeWorldPositions(e,u,o),g=m[0],_=m[1],w=a.offsetRotation,b=!1;if(w==0)b=a.rotateMode==fs.Chain;else{b=!1;let y=this.target.bone;w*=y.a*y.d-y.b*y.c>0?D.degRad:-.01745329277777778}for(let y=0,S=3;y<c;y++,S+=3){let v=l[y];v.worldX+=(g-v.worldX)*r,v.worldY+=(_-v.worldY)*n;let A=m[S],C=m[S+1],T=A-g,P=C-_;if(h){let M=d[y];if(M!=0){let B=(Math.sqrt(T*T+P*P)/M-1)*s+1;v.a*=B,v.c*=B}}if(g=A,_=C,s>0){let M=v.a,B=v.b,F=v.c,I=v.d,E=0,R=0,O=0;if(o?E=m[S-1]:f[y+1]==0?E=m[S+2]:E=Math.atan2(P,T),E-=Math.atan2(F,M),b){R=Math.cos(E),O=Math.sin(E);let W=v.data.length;g+=(W*(R*M-O*F)-T)*s,_+=(W*(O*M+R*F)-P)*s}else E+=w;E>D.PI?E-=D.PI2:E<-3.1415927&&(E+=D.PI2),E*=s,R=Math.cos(E),O=Math.sin(E),v.a=R*M-O*F,v.b=R*B-O*I,v.c=O*M+R*F,v.d=O*B+R*I}v.updateAppliedTransform()}}computeWorldPositions(t,e,s){let r=this.target,n=this.position,a=this.spaces,o=Y.setArraySize(this.positions,e*3+2),h=this.world,l=t.closed,c=t.worldVerticesLength,u=c/6,f=qt.NONE;if(!t.constantSpeed){let W=t.lengths;u-=l?1:2;let L=W[u];this.data.positionMode==Pe.Percent&&(n*=L);let H;switch(this.data.spacingMode){case It.Percent:H=L;break;case It.Proportional:H=L/e;break;default:H=1}h=Y.setArraySize(this.world,8);for(let Z=0,J=0,z=0;Z<e;Z++,J+=3){let $=a[Z]*H;n+=$;let G=n;if(l)G%=L,G<0&&(G+=L),z=0;else if(G<0){f!=qt.BEFORE&&(f=qt.BEFORE,t.computeWorldVertices(r,2,4,h,0,2)),this.addBeforePosition(G,h,0,o,J);continue}else if(G>L){f!=qt.AFTER&&(f=qt.AFTER,t.computeWorldVertices(r,c-6,4,h,0,2)),this.addAfterPosition(G-L,h,0,o,J);continue}for(;;z++){let gt=W[z];if(!(G>gt)){if(z==0)G/=gt;else{let _t=W[z-1];G=(G-_t)/(gt-_t)}break}}z!=f&&(f=z,l&&z==u?(t.computeWorldVertices(r,c-4,4,h,0,2),t.computeWorldVertices(r,0,4,h,4,2)):t.computeWorldVertices(r,z*6+2,8,h,0,2)),this.addCurvePosition(G,h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],o,J,s||Z>0&&$==0)}return o}l?(c+=2,h=Y.setArraySize(this.world,c),t.computeWorldVertices(r,2,c-4,h,0,2),t.computeWorldVertices(r,0,2,h,c-4,2),h[c-2]=h[0],h[c-1]=h[1]):(u--,c-=4,h=Y.setArraySize(this.world,c),t.computeWorldVertices(r,2,c,h,0,2));let d=Y.setArraySize(this.curves,u),p=0,m=h[0],g=h[1],_=0,w=0,b=0,y=0,S=0,v=0,A=0,C=0,T=0,P=0,M=0,B=0,F=0,I=0;for(let W=0,L=2;W<u;W++,L+=6)_=h[L],w=h[L+1],b=h[L+2],y=h[L+3],S=h[L+4],v=h[L+5],A=(m-_*2+b)*.1875,C=(g-w*2+y)*.1875,T=((_-b)*3-m+S)*.09375,P=((w-y)*3-g+v)*.09375,M=A*2+T,B=C*2+P,F=(_-m)*.75+A+T*.16666667,I=(w-g)*.75+C+P*.16666667,p+=Math.sqrt(F*F+I*I),F+=M,I+=B,M+=T,B+=P,p+=Math.sqrt(F*F+I*I),F+=M,I+=B,p+=Math.sqrt(F*F+I*I),F+=M+T,I+=B+P,p+=Math.sqrt(F*F+I*I),d[W]=p,m=S,g=v;this.data.positionMode==Pe.Percent&&(n*=p);let E;switch(this.data.spacingMode){case It.Percent:E=p;break;case It.Proportional:E=p/e;break;default:E=1}let R=this.segments,O=0;for(let W=0,L=0,H=0,Z=0;W<e;W++,L+=3){let J=a[W]*E;n+=J;let z=n;if(l)z%=p,z<0&&(z+=p),H=0;else if(z<0){this.addBeforePosition(z,h,0,o,L);continue}else if(z>p){this.addAfterPosition(z-p,h,c-4,o,L);continue}for(;;H++){let $=d[H];if(!(z>$)){if(H==0)z/=$;else{let G=d[H-1];z=(z-G)/($-G)}break}}if(H!=f){f=H;let $=H*6;for(m=h[$],g=h[$+1],_=h[$+2],w=h[$+3],b=h[$+4],y=h[$+5],S=h[$+6],v=h[$+7],A=(m-_*2+b)*.03,C=(g-w*2+y)*.03,T=((_-b)*3-m+S)*.006,P=((w-y)*3-g+v)*.006,M=A*2+T,B=C*2+P,F=(_-m)*.3+A+T*.16666667,I=(w-g)*.3+C+P*.16666667,O=Math.sqrt(F*F+I*I),R[0]=O,$=1;$<8;$++)F+=M,I+=B,M+=T,B+=P,O+=Math.sqrt(F*F+I*I),R[$]=O;F+=M,I+=B,O+=Math.sqrt(F*F+I*I),R[8]=O,F+=M+T,I+=B+P,O+=Math.sqrt(F*F+I*I),R[9]=O,Z=0}for(z*=O;;Z++){let $=R[Z];if(!(z>$)){if(Z==0)z/=$;else{let G=R[Z-1];z=Z+(z-G)/($-G)}break}}this.addCurvePosition(z*.1,m,g,_,w,b,y,S,v,o,L,s||W>0&&J==0)}return o}addBeforePosition(t,e,s,r,n){let a=e[s],o=e[s+1],h=e[s+2]-a,l=e[s+3]-o,c=Math.atan2(l,h);r[n]=a+t*Math.cos(c),r[n+1]=o+t*Math.sin(c),r[n+2]=c}addAfterPosition(t,e,s,r,n){let a=e[s+2],o=e[s+3],h=a-e[s],l=o-e[s+1],c=Math.atan2(l,h);r[n]=a+t*Math.cos(c),r[n+1]=o+t*Math.sin(c),r[n+2]=c}addCurvePosition(t,e,s,r,n,a,o,h,l,c,u,f){if(t==0||isNaN(t)){c[u]=e,c[u+1]=s,c[u+2]=Math.atan2(n-s,r-e);return}let d=t*t,p=d*t,m=1-t,g=m*m,_=g*m,w=m*t,b=w*3,y=m*b,S=b*t,v=e*_+r*y+a*S+h*p,A=s*_+n*y+o*S+l*p;c[u]=v,c[u+1]=A,f&&(t<.001?c[u+2]=Math.atan2(n-s,r-e):c[u+2]=Math.atan2(A-(s*g+n*w*2+o*d),v-(e*g+r*w*2+a*d)))}};x(qt,"NONE",-1),x(qt,"BEFORE",-2),x(qt,"AFTER",-3),x(qt,"epsilon",1e-5);let Da=qt;class c1{constructor(t,e){x(this,"data");x(this,"_bone",null);x(this,"inertia",0);x(this,"strength",0);x(this,"damping",0);x(this,"massInverse",0);x(this,"wind",0);x(this,"gravity",0);x(this,"mix",0);x(this,"_reset",!0);x(this,"ux",0);x(this,"uy",0);x(this,"cx",0);x(this,"cy",0);x(this,"tx",0);x(this,"ty",0);x(this,"xOffset",0);x(this,"xVelocity",0);x(this,"yOffset",0);x(this,"yVelocity",0);x(this,"rotateOffset",0);x(this,"rotateVelocity",0);x(this,"scaleOffset",0);x(this,"scaleVelocity",0);x(this,"active",!1);x(this,"skeleton");x(this,"remaining",0);x(this,"lastTime",0);this.data=t,this.skeleton=e,this.bone=e.bones[t.bone.index],this.inertia=t.inertia,this.strength=t.strength,this.damping=t.damping,this.massInverse=t.massInverse,this.wind=t.wind,this.gravity=t.gravity,this.mix=t.mix}set bone(t){this._bone=t}get bone(){if(this._bone)return this._bone;throw new Error("Bone not set.")}reset(){this.remaining=0,this.lastTime=this.skeleton.time,this._reset=!0,this.xOffset=0,this.xVelocity=0,this.yOffset=0,this.yVelocity=0,this.rotateOffset=0,this.rotateVelocity=0,this.scaleOffset=0,this.scaleVelocity=0}setToSetupPose(){const t=this.data;this.inertia=t.inertia,this.strength=t.strength,this.damping=t.damping,this.massInverse=t.massInverse,this.wind=t.wind,this.gravity=t.gravity,this.mix=t.mix}isActive(){return this.active}update(t){const e=this.mix;if(e==0)return;const s=this.data.x>0,r=this.data.y>0,n=this.data.rotate>0||this.data.shearX>0,a=this.data.scaleX>0,o=this.bone,h=o.data.length;switch(t){case je.none:return;case je.reset:this.reset();case je.update:const l=this.skeleton,c=Math.max(this.skeleton.time-this.lastTime,0);this.remaining+=c,this.lastTime=l.time;const u=o.worldX,f=o.worldY;if(this._reset)this._reset=!1,this.ux=u,this.uy=f;else{let d=this.remaining,p=this.inertia,m=this.data.step,g=this.skeleton.data.referenceScale,_=-1,w=this.data.limit*c,b=w*Math.abs(l.scaleY);if(w*=Math.abs(l.scaleX),s||r){if(s){const y=(this.ux-u)*p;this.xOffset+=y>w?w:y<-w?-w:y,this.ux=u}if(r){const y=(this.uy-f)*p;this.yOffset+=y>b?b:y<-b?-b:y,this.uy=f}if(d>=m){_=Math.pow(this.damping,60*m);const y=this.massInverse*m,S=this.strength,v=this.wind*g*l.scaleX,A=this.gravity*g*l.scaleY;do s&&(this.xVelocity+=(v-this.xOffset*S)*y,this.xOffset+=this.xVelocity*m,this.xVelocity*=_),r&&(this.yVelocity-=(A+this.yOffset*S)*y,this.yOffset+=this.yVelocity*m,this.yVelocity*=_),d-=m;while(d>=m)}s&&(o.worldX+=this.xOffset*e*this.data.x),r&&(o.worldY+=this.yOffset*e*this.data.y)}if(n||a){let y=Math.atan2(o.c,o.a),S=0,v=0,A=0,C=this.cx-o.worldX,T=this.cy-o.worldY;if(C>w?C=w:C<-w&&(C=-w),T>b?T=b:T<-b&&(T=-b),n){A=(this.data.rotate+this.data.shearX)*e;let P=Math.atan2(T+this.ty,C+this.tx)-y-this.rotateOffset*A;this.rotateOffset+=(P-Math.ceil(P*D.invPI2-.5)*D.PI2)*p,P=this.rotateOffset*A+y,S=Math.cos(P),v=Math.sin(P),a&&(P=h*o.getWorldScaleX(),P>0&&(this.scaleOffset+=(C*S+T*v)*p/P))}else{S=Math.cos(y),v=Math.sin(y);const P=h*o.getWorldScaleX();P>0&&(this.scaleOffset+=(C*S+T*v)*p/P)}if(d=this.remaining,d>=m){_==-1&&(_=Math.pow(this.damping,60*m));const P=this.massInverse*m,M=this.strength,B=this.wind,F=Wi.yDown?-this.gravity:this.gravity,I=h/g;for(;;)if(d-=m,a&&(this.scaleVelocity+=(B*S-F*v-this.scaleOffset*M)*P,this.scaleOffset+=this.scaleVelocity*m,this.scaleVelocity*=_),n){if(this.rotateVelocity-=((B*v+F*S)*I+this.rotateOffset*M)*P,this.rotateOffset+=this.rotateVelocity*m,this.rotateVelocity*=_,d<m)break;const E=this.rotateOffset*A+y;S=Math.cos(E),v=Math.sin(E)}else if(d<m)break}}this.remaining=d}this.cx=o.worldX,this.cy=o.worldY;break;case je.pose:s&&(o.worldX+=this.xOffset*e*this.data.x),r&&(o.worldY+=this.yOffset*e*this.data.y)}if(n){let l=this.rotateOffset*e,c=0,u=0,f=0;if(this.data.shearX>0){let d=0;this.data.rotate>0&&(d=l*this.data.rotate,c=Math.sin(d),u=Math.cos(d),f=o.b,o.b=u*f-c*o.d,o.d=c*f+u*o.d),d+=l*this.data.shearX,c=Math.sin(d),u=Math.cos(d),f=o.a,o.a=u*f-c*o.c,o.c=c*f+u*o.c}else l*=this.data.rotate,c=Math.sin(l),u=Math.cos(l),f=o.a,o.a=u*f-c*o.c,o.c=c*f+u*o.c,f=o.b,o.b=u*f-c*o.d,o.d=c*f+u*o.d}if(a){const l=1+this.scaleOffset*e*this.data.scaleX;o.a*=l,o.c*=l}t!=je.pose&&(this.tx=h*o.a,this.ty=h*o.c),o.updateAppliedTransform()}translate(t,e){this.ux-=t,this.uy-=e,this.cx-=t,this.cy-=e}rotate(t,e,s){const r=s*D.degRad,n=Math.cos(r),a=Math.sin(r),o=this.cx-t,h=this.cy-e;this.translate(o*n-h*a-o,o*a+h*n-h)}}class u1{constructor(t,e){x(this,"data");x(this,"bone");x(this,"color");x(this,"darkColor",null);x(this,"attachment",null);x(this,"attachmentState",0);x(this,"sequenceIndex",-1);x(this,"deform",new Array);if(!t)throw new Error("data cannot be null.");if(!e)throw new Error("bone cannot be null.");this.data=t,this.bone=e,this.color=new K,this.darkColor=t.darkColor?new K:null,this.setToSetupPose()}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(t){this.attachment!=t&&((!(t instanceof me)||!(this.attachment instanceof me)||t.timelineAttachment!=this.attachment.timelineAttachment)&&(this.deform.length=0),this.attachment=t,this.sequenceIndex=-1)}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class d1{constructor(t,e){x(this,"data");x(this,"bones");x(this,"target");x(this,"mixRotate",0);x(this,"mixX",0);x(this,"mixY",0);x(this,"mixScaleX",0);x(this,"mixScaleY",0);x(this,"mixShearY",0);x(this,"temp",new Lr);x(this,"active",!1);if(!t)throw new Error("data cannot be null.");if(!e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(let r=0;r<t.bones.length;r++){let n=e.findBone(t.bones[r].name);if(!n)throw new Error(`Couldn't find bone ${t.bones[r].name}.`);this.bones.push(n)}let s=e.findBone(t.target.name);if(!s)throw new Error(`Couldn't find target bone ${t.target.name}.`);this.target=s,this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY}isActive(){return this.active}setToSetupPose(){const t=this.data;this.mixRotate=t.mixRotate,this.mixX=t.mixX,this.mixY=t.mixY,this.mixScaleX=t.mixScaleX,this.mixScaleY=t.mixScaleY,this.mixShearY=t.mixShearY}update(t){this.mixRotate==0&&this.mixX==0&&this.mixY==0&&this.mixScaleX==0&&this.mixScaleY==0&&this.mixShearY==0||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){let t=this.mixRotate,e=this.mixX,s=this.mixY,r=this.mixScaleX,n=this.mixScaleY,a=this.mixShearY,o=e!=0||s!=0,h=this.target,l=h.a,c=h.b,u=h.c,f=h.d,d=l*f-c*u>0?D.degRad:-.01745329277777778,p=this.data.offsetRotation*d,m=this.data.offsetShearY*d,g=this.bones;for(let _=0,w=g.length;_<w;_++){let b=g[_];if(t!=0){let y=b.a,S=b.b,v=b.c,A=b.d,C=Math.atan2(u,l)-Math.atan2(v,y)+p;C>D.PI?C-=D.PI2:C<-3.1415927&&(C+=D.PI2),C*=t;let T=Math.cos(C),P=Math.sin(C);b.a=T*y-P*v,b.b=T*S-P*A,b.c=P*y+T*v,b.d=P*S+T*A}if(o){let y=this.temp;h.localToWorld(y.set(this.data.offsetX,this.data.offsetY)),b.worldX+=(y.x-b.worldX)*e,b.worldY+=(y.y-b.worldY)*s}if(r!=0){let y=Math.sqrt(b.a*b.a+b.c*b.c);y!=0&&(y=(y+(Math.sqrt(l*l+u*u)-y+this.data.offsetScaleX)*r)/y),b.a*=y,b.c*=y}if(n!=0){let y=Math.sqrt(b.b*b.b+b.d*b.d);y!=0&&(y=(y+(Math.sqrt(c*c+f*f)-y+this.data.offsetScaleY)*n)/y),b.b*=y,b.d*=y}if(a>0){let y=b.b,S=b.d,v=Math.atan2(S,y),A=Math.atan2(f,c)-Math.atan2(u,l)-(v-Math.atan2(b.c,b.a));A>D.PI?A-=D.PI2:A<-3.1415927&&(A+=D.PI2),A=v+(A+m)*a;let C=Math.sqrt(y*y+S*S);b.b=Math.cos(A)*C,b.d=Math.sin(A)*C}b.updateAppliedTransform()}}applyRelativeWorld(){let t=this.mixRotate,e=this.mixX,s=this.mixY,r=this.mixScaleX,n=this.mixScaleY,a=this.mixShearY,o=e!=0||s!=0,h=this.target,l=h.a,c=h.b,u=h.c,f=h.d,d=l*f-c*u>0?D.degRad:-.01745329277777778,p=this.data.offsetRotation*d,m=this.data.offsetShearY*d,g=this.bones;for(let _=0,w=g.length;_<w;_++){let b=g[_];if(t!=0){let y=b.a,S=b.b,v=b.c,A=b.d,C=Math.atan2(u,l)+p;C>D.PI?C-=D.PI2:C<-3.1415927&&(C+=D.PI2),C*=t;let T=Math.cos(C),P=Math.sin(C);b.a=T*y-P*v,b.b=T*S-P*A,b.c=P*y+T*v,b.d=P*S+T*A}if(o){let y=this.temp;h.localToWorld(y.set(this.data.offsetX,this.data.offsetY)),b.worldX+=y.x*e,b.worldY+=y.y*s}if(r!=0){let y=(Math.sqrt(l*l+u*u)-1+this.data.offsetScaleX)*r+1;b.a*=y,b.c*=y}if(n!=0){let y=(Math.sqrt(c*c+f*f)-1+this.data.offsetScaleY)*n+1;b.b*=y,b.d*=y}if(a>0){let y=Math.atan2(f,c)-Math.atan2(u,l);y>D.PI?y-=D.PI2:y<-3.1415927&&(y+=D.PI2);let S=b.b,v=b.d;y=Math.atan2(v,S)+(y-D.PI/2+m)*a;let A=Math.sqrt(S*S+v*v);b.b=Math.cos(y)*A,b.d=Math.sin(y)*A}b.updateAppliedTransform()}}applyAbsoluteLocal(){let t=this.mixRotate,e=this.mixX,s=this.mixY,r=this.mixScaleX,n=this.mixScaleY,a=this.mixShearY,o=this.target,h=this.bones;for(let l=0,c=h.length;l<c;l++){let u=h[l],f=u.arotation;t!=0&&(f+=(o.arotation-f+this.data.offsetRotation)*t);let d=u.ax,p=u.ay;d+=(o.ax-d+this.data.offsetX)*e,p+=(o.ay-p+this.data.offsetY)*s;let m=u.ascaleX,g=u.ascaleY;r!=0&&m!=0&&(m=(m+(o.ascaleX-m+this.data.offsetScaleX)*r)/m),n!=0&&g!=0&&(g=(g+(o.ascaleY-g+this.data.offsetScaleY)*n)/g);let _=u.ashearY;a!=0&&(_+=(o.ashearY-_+this.data.offsetShearY)*a),u.updateWorldTransformWith(d,p,f,m,g,u.ashearX,_)}}applyRelativeLocal(){let t=this.mixRotate,e=this.mixX,s=this.mixY,r=this.mixScaleX,n=this.mixScaleY,a=this.mixShearY,o=this.target,h=this.bones;for(let l=0,c=h.length;l<c;l++){let u=h[l],f=u.arotation+(o.arotation+this.data.offsetRotation)*t,d=u.ax+(o.ax+this.data.offsetX)*e,p=u.ay+(o.ay+this.data.offsetY)*s,m=u.ascaleX*((o.ascaleX-1+this.data.offsetScaleX)*r+1),g=u.ascaleY*((o.ascaleY-1+this.data.offsetScaleY)*n+1),_=u.ashearY+(o.ashearY+this.data.offsetShearY)*a;u.updateWorldTransformWith(d,p,f,m,g,u.ashearX,_)}}}const Bs=class Bs{constructor(t){x(this,"data");x(this,"bones");x(this,"slots");x(this,"drawOrder");x(this,"ikConstraints");x(this,"transformConstraints");x(this,"pathConstraints");x(this,"physicsConstraints");x(this,"_updateCache",new Array);x(this,"skin",null);x(this,"color");x(this,"scaleX",1);x(this,"_scaleY",1);x(this,"x",0);x(this,"y",0);x(this,"time",0);if(!t)throw new Error("data cannot be null.");this.data=t,this.bones=new Array;for(let e=0;e<t.bones.length;e++){let s=t.bones[e],r;if(!s.parent)r=new Hh(s,this,null);else{let n=this.bones[s.parent.index];r=new Hh(s,this,n),n.children.push(r)}this.bones.push(r)}this.slots=new Array,this.drawOrder=new Array;for(let e=0;e<t.slots.length;e++){let s=t.slots[e],r=this.bones[s.boneData.index],n=new u1(s,r);this.slots.push(n),this.drawOrder.push(n)}this.ikConstraints=new Array;for(let e=0;e<t.ikConstraints.length;e++){let s=t.ikConstraints[e];this.ikConstraints.push(new h1(s,this))}this.transformConstraints=new Array;for(let e=0;e<t.transformConstraints.length;e++){let s=t.transformConstraints[e];this.transformConstraints.push(new d1(s,this))}this.pathConstraints=new Array;for(let e=0;e<t.pathConstraints.length;e++){let s=t.pathConstraints[e];this.pathConstraints.push(new Da(s,this))}this.physicsConstraints=new Array;for(let e=0;e<t.physicsConstraints.length;e++){let s=t.physicsConstraints[e];this.physicsConstraints.push(new c1(s,this))}this.color=new K(1,1,1,1),this.updateCache()}get scaleY(){return Bs.yDown?-this._scaleY:this._scaleY}set scaleY(t){this._scaleY=t}updateCache(){let t=this._updateCache;t.length=0;let e=this.bones;for(let f=0,d=e.length;f<d;f++){let p=e[f];p.sorted=p.data.skinRequired,p.active=!p.sorted}if(this.skin){let f=this.skin.bones;for(let d=0,p=this.skin.bones.length;d<p;d++){let m=this.bones[f[d].index];do m.sorted=!1,m.active=!0,m=m.parent;while(m)}}let s=this.ikConstraints,r=this.transformConstraints,n=this.pathConstraints,a=this.physicsConstraints,o=s.length,h=r.length,l=n.length,c=this.physicsConstraints.length,u=o+h+l+c;t:for(let f=0;f<u;f++){for(let d=0;d<o;d++){let p=s[d];if(p.data.order==f){this.sortIkConstraint(p);continue t}}for(let d=0;d<h;d++){let p=r[d];if(p.data.order==f){this.sortTransformConstraint(p);continue t}}for(let d=0;d<l;d++){let p=n[d];if(p.data.order==f){this.sortPathConstraint(p);continue t}}for(let d=0;d<c;d++){const p=a[d];if(p.data.order==f){this.sortPhysicsConstraint(p);continue t}}}for(let f=0,d=e.length;f<d;f++)this.sortBone(e[f])}sortIkConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&Y.contains(this.skin.constraints,t.data,!0)),!t.active)return;let e=t.target;this.sortBone(e);let s=t.bones,r=s[0];if(this.sortBone(r),s.length==1)this._updateCache.push(t),this.sortReset(r.children);else{let n=s[s.length-1];this.sortBone(n),this._updateCache.push(t),this.sortReset(r.children),n.sorted=!0}}sortPathConstraint(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||this.skin&&Y.contains(this.skin.constraints,t.data,!0)),!t.active)return;let e=t.target,s=e.data.index,r=e.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,s,r),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,s,r);for(let h=0,l=this.data.skins.length;h<l;h++)this.sortPathConstraintAttachment(this.data.skins[h],s,r);let n=e.getAttachment();n instanceof Gs&&this.sortPathConstraintAttachmentWith(n,r);let a=t.bones,o=a.length;for(let h=0;h<o;h++)this.sortBone(a[h]);this._updateCache.push(t);for(let h=0;h<o;h++)this.sortReset(a[h].children);for(let h=0;h<o;h++)a[h].sorted=!0}sortTransformConstraint(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||this.skin&&Y.contains(this.skin.constraints,t.data,!0)),!t.active)return;this.sortBone(t.target);let e=t.bones,s=e.length;if(t.data.local)for(let r=0;r<s;r++){let n=e[r];this.sortBone(n.parent),this.sortBone(n)}else for(let r=0;r<s;r++)this.sortBone(e[r]);this._updateCache.push(t);for(let r=0;r<s;r++)this.sortReset(e[r].children);for(let r=0;r<s;r++)e[r].sorted=!0}sortPathConstraintAttachment(t,e,s){let r=t.attachments[e];if(r)for(let n in r)this.sortPathConstraintAttachmentWith(r[n],s)}sortPathConstraintAttachmentWith(t,e){if(!(t instanceof Gs))return;let s=t.bones;if(!s)this.sortBone(e);else{let r=this.bones;for(let n=0,a=s.length;n<a;){let o=s[n++];for(o+=n;n<o;)this.sortBone(r[s[n++]])}}}sortPhysicsConstraint(t){const e=t.bone;t.active=e.active&&(!t.data.skinRequired||this.skin!=null&&Y.contains(this.skin.constraints,t.data,!0)),t.active&&(this.sortBone(e),this._updateCache.push(t),this.sortReset(e.children),e.sorted=!0)}sortBone(t){if(!t||t.sorted)return;let e=t.parent;e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}sortReset(t){for(let e=0,s=t.length;e<s;e++){let r=t[e];r.active&&(r.sorted&&this.sortReset(r.children),r.sorted=!1)}}updateWorldTransform(t){if(t==null)throw new Error("physics is undefined");let e=this.bones;for(let r=0,n=e.length;r<n;r++){let a=e[r];a.ax=a.x,a.ay=a.y,a.arotation=a.rotation,a.ascaleX=a.scaleX,a.ascaleY=a.scaleY,a.ashearX=a.shearX,a.ashearY=a.shearY}let s=this._updateCache;for(let r=0,n=s.length;r<n;r++)s[r].update(t)}updateWorldTransformWith(t,e){if(!e)throw new Error("parent cannot be null.");let s=this.bones;for(let g=1,_=s.length;g<_;g++){let w=s[g];w.ax=w.x,w.ay=w.y,w.arotation=w.rotation,w.ascaleX=w.scaleX,w.ascaleY=w.scaleY,w.ashearX=w.shearX,w.ashearY=w.shearY}let r=this.getRootBone();if(!r)throw new Error("Root bone must not be null.");let n=e.a,a=e.b,o=e.c,h=e.d;r.worldX=n*this.x+a*this.y+e.worldX,r.worldY=o*this.x+h*this.y+e.worldY;const l=(r.rotation+r.shearX)*D.degRad,c=(r.rotation+90+r.shearY)*D.degRad,u=Math.cos(l)*r.scaleX,f=Math.cos(c)*r.scaleY,d=Math.sin(l)*r.scaleX,p=Math.sin(c)*r.scaleY;r.a=(n*u+a*d)*this.scaleX,r.b=(n*f+a*p)*this.scaleX,r.c=(o*u+h*d)*this.scaleY,r.d=(o*f+h*p)*this.scaleY;let m=this._updateCache;for(let g=0,_=m.length;g<_;g++){let w=m[g];w!=r&&w.update(t)}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){for(const t of this.bones)t.setToSetupPose();for(const t of this.ikConstraints)t.setToSetupPose();for(const t of this.transformConstraints)t.setToSetupPose();for(const t of this.pathConstraints)t.setToSetupPose();for(const t of this.physicsConstraints)t.setToSetupPose()}setSlotsToSetupPose(){let t=this.slots;Y.arrayCopy(t,0,this.drawOrder,0,t.length);for(let e=0,s=t.length;e<s;e++)t[e].setToSetupPose()}getRootBone(){return this.bones.length==0?null:this.bones[0]}findBone(t){if(!t)throw new Error("boneName cannot be null.");let e=this.bones;for(let s=0,r=e.length;s<r;s++){let n=e[s];if(n.data.name==t)return n}return null}findSlot(t){if(!t)throw new Error("slotName cannot be null.");let e=this.slots;for(let s=0,r=e.length;s<r;s++){let n=e[s];if(n.data.name==t)return n}return null}setSkinByName(t){let e=this.data.findSkin(t);if(!e)throw new Error("Skin not found: "+t);this.setSkin(e)}setSkin(t){if(t!=this.skin){if(t)if(this.skin)t.attachAll(this,this.skin);else{let e=this.slots;for(let s=0,r=e.length;s<r;s++){let n=e[s],a=n.data.attachmentName;if(a){let o=t.getAttachment(s,a);o&&n.setAttachment(o)}}}this.skin=t,this.updateCache()}}getAttachmentByName(t,e){let s=this.data.findSlot(t);if(!s)throw new Error(`Can't find slot with name ${t}`);return this.getAttachment(s.index,e)}getAttachment(t,e){if(!e)throw new Error("attachmentName cannot be null.");if(this.skin){let s=this.skin.getAttachment(t,e);if(s)return s}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null}setAttachment(t,e){if(!t)throw new Error("slotName cannot be null.");let s=this.slots;for(let r=0,n=s.length;r<n;r++){let a=s[r];if(a.data.name==t){let o=null;if(e&&(o=this.getAttachment(r,e),!o))throw new Error("Attachment not found: "+e+", for slot: "+t);a.setAttachment(o);return}}throw new Error("Slot not found: "+t)}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");return this.ikConstraints.find(e=>e.data.name==t)??null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");return this.transformConstraints.find(e=>e.data.name==t)??null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");return this.pathConstraints.find(e=>e.data.name==t)??null}findPhysicsConstraint(t){if(t==null)throw new Error("constraintName cannot be null.");return this.physicsConstraints.find(e=>e.data.name==t)??null}getBoundsRect(t){let e=new Lr,s=new Lr;return this.getBounds(e,s,void 0,t),{x:e.x,y:e.y,width:s.x,height:s.y}}getBounds(t,e,s=new Array(2),r=null){if(!t)throw new Error("offset cannot be null.");if(!e)throw new Error("size cannot be null.");let n=this.drawOrder,a=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;for(let c=0,u=n.length;c<u;c++){let f=n[c];if(!f.bone.active)continue;let d=0,p=null,m=null,g=f.getAttachment();if(g instanceof de)d=8,p=Y.setArraySize(s,d,0),g.computeWorldVertices(f,p,0,2),m=Bs.quadTriangles;else if(g instanceof fe){let _=g;d=_.worldVerticesLength,p=Y.setArraySize(s,d,0),_.computeWorldVertices(f,0,d,p,0,2),m=_.triangles}else if(g instanceof ds&&r!=null){r.clipStart(f,g);continue}if(p&&m){r!=null&&r.isClipping()&&(r.clipTriangles(p,m,m.length),p=r.clippedVertices,d=r.clippedVertices.length);for(let _=0,w=p.length;_<w;_+=2){let b=p[_],y=p[_+1];a=Math.min(a,b),o=Math.min(o,y),h=Math.max(h,b),l=Math.max(l,y)}}r!=null&&r.clipEndWithSlot(f)}r!=null&&r.clipEnd(),t.set(a,o),e.set(h-a,l-o)}update(t){this.time+=t}physicsTranslate(t,e){const s=this.physicsConstraints;for(let r=0,n=s.length;r<n;r++)s[r].translate(t,e)}physicsRotate(t,e,s){const r=this.physicsConstraints;for(let n=0,a=r.length;n<a;n++)r[n].rotate(t,e,s)}};x(Bs,"quadTriangles",[0,1,2,2,3,0]),x(Bs,"yDown",!1);let Wi=Bs;var je;(function(i){i[i.none=0]="none",i[i.reset=1]="reset",i[i.update=2]="update",i[i.pose=3]="pose"})(je||(je={}));class Uf extends nn{constructor(e){super(e,0,!1);x(this,"_bone",null);x(this,"x",0);x(this,"y",0);x(this,"rotate",0);x(this,"scaleX",0);x(this,"shearX",0);x(this,"limit",0);x(this,"step",0);x(this,"inertia",0);x(this,"strength",0);x(this,"damping",0);x(this,"massInverse",0);x(this,"wind",0);x(this,"gravity",0);x(this,"mix",0);x(this,"inertiaGlobal",!1);x(this,"strengthGlobal",!1);x(this,"dampingGlobal",!1);x(this,"massGlobal",!1);x(this,"windGlobal",!1);x(this,"gravityGlobal",!1);x(this,"mixGlobal",!1)}set bone(e){this._bone=e}get bone(){if(this._bone)return this._bone;throw new Error("BoneData not set.")}}class Nr{constructor(){x(this,"name",null);x(this,"bones",new Array);x(this,"slots",new Array);x(this,"skins",new Array);x(this,"defaultSkin",null);x(this,"events",new Array);x(this,"animations",new Array);x(this,"ikConstraints",new Array);x(this,"transformConstraints",new Array);x(this,"pathConstraints",new Array);x(this,"physicsConstraints",new Array);x(this,"x",0);x(this,"y",0);x(this,"width",0);x(this,"height",0);x(this,"referenceScale",100);x(this,"version",null);x(this,"hash",null);x(this,"fps",0);x(this,"imagesPath",null);x(this,"audioPath",null)}findBone(t){if(!t)throw new Error("boneName cannot be null.");let e=this.bones;for(let s=0,r=e.length;s<r;s++){let n=e[s];if(n.name==t)return n}return null}findSlot(t){if(!t)throw new Error("slotName cannot be null.");let e=this.slots;for(let s=0,r=e.length;s<r;s++){let n=e[s];if(n.name==t)return n}return null}findSkin(t){if(!t)throw new Error("skinName cannot be null.");let e=this.skins;for(let s=0,r=e.length;s<r;s++){let n=e[s];if(n.name==t)return n}return null}findEvent(t){if(!t)throw new Error("eventDataName cannot be null.");let e=this.events;for(let s=0,r=e.length;s<r;s++){let n=e[s];if(n.name==t)return n}return null}findAnimation(t){if(!t)throw new Error("animationName cannot be null.");let e=this.animations;for(let s=0,r=e.length;s<r;s++){let n=e[s];if(n.name==t)return n}return null}findIkConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.ikConstraints;for(let s=0,r=e.length;s<r;s++){const n=e[s];if(n.name==t)return n}return null}findTransformConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.transformConstraints;for(let s=0,r=e.length;s<r;s++){const n=e[s];if(n.name==t)return n}return null}findPathConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.pathConstraints;for(let s=0,r=e.length;s<r;s++){const n=e[s];if(n.name==t)return n}return null}findPhysicsConstraint(t){if(!t)throw new Error("constraintName cannot be null.");const e=this.physicsConstraints;for(let s=0,r=e.length;s<r;s++){const n=e[s];if(n.name==t)return n}return null}}class $h{constructor(t=0,e,s){x(this,"slotIndex");x(this,"name");x(this,"attachment");this.slotIndex=t,this.name=e,this.attachment=s}}class Ya{constructor(t){x(this,"name");x(this,"attachments",new Array);x(this,"bones",Array());x(this,"constraints",new Array);x(this,"color",new K(.99607843,.61960787,.30980393,1));if(!t)throw new Error("name cannot be null.");this.name=t}setAttachment(t,e,s){if(!s)throw new Error("attachment cannot be null.");let r=this.attachments;t>=r.length&&(r.length=t+1),r[t]||(r[t]={}),r[t][e]=s}addSkin(t){for(let r=0;r<t.bones.length;r++){let n=t.bones[r],a=!1;for(let o=0;o<this.bones.length;o++)if(this.bones[o]==n){a=!0;break}a||this.bones.push(n)}for(let r=0;r<t.constraints.length;r++){let n=t.constraints[r],a=!1;for(let o=0;o<this.constraints.length;o++)if(this.constraints[o]==n){a=!0;break}a||this.constraints.push(n)}let e=t.getAttachments();for(let r=0;r<e.length;r++){var s=e[r];this.setAttachment(s.slotIndex,s.name,s.attachment)}}copySkin(t){for(let r=0;r<t.bones.length;r++){let n=t.bones[r],a=!1;for(let o=0;o<this.bones.length;o++)if(this.bones[o]==n){a=!0;break}a||this.bones.push(n)}for(let r=0;r<t.constraints.length;r++){let n=t.constraints[r],a=!1;for(let o=0;o<this.constraints.length;o++)if(this.constraints[o]==n){a=!0;break}a||this.constraints.push(n)}let e=t.getAttachments();for(let r=0;r<e.length;r++){var s=e[r];s.attachment&&(s.attachment instanceof fe?(s.attachment=s.attachment.newLinkedMesh(),this.setAttachment(s.slotIndex,s.name,s.attachment)):(s.attachment=s.attachment.copy(),this.setAttachment(s.slotIndex,s.name,s.attachment)))}}getAttachment(t,e){let s=this.attachments[t];return s?s[e]:null}removeAttachment(t,e){let s=this.attachments[t];s&&delete s[e]}getAttachments(){let t=new Array;for(var e=0;e<this.attachments.length;e++){let s=this.attachments[e];if(s)for(let r in s){let n=s[r];n&&t.push(new $h(e,r,n))}}return t}getAttachmentsForSlot(t,e){let s=this.attachments[t];if(s)for(let r in s){let n=s[r];n&&e.push(new $h(t,r,n))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(t,e){let s=0;for(let r=0;r<t.slots.length;r++){let n=t.slots[r],a=n.getAttachment();if(a&&s<e.attachments.length){let o=e.attachments[s];for(let h in o){let l=o[h];if(a==l){let c=this.getAttachment(s,h);c&&n.setAttachment(c);break}}}s++}}}class Wf{constructor(t,e,s){x(this,"index",0);x(this,"name");x(this,"boneData");x(this,"color",new K(1,1,1,1));x(this,"darkColor",null);x(this,"attachmentName",null);x(this,"blendMode",Ze.Normal);x(this,"visible",!0);if(t<0)throw new Error("index must be >= 0.");if(!e)throw new Error("name cannot be null.");if(!s)throw new Error("boneData cannot be null.");this.index=t,this.name=e,this.boneData=s}}var Ze;(function(i){i[i.Normal=0]="Normal",i[i.Additive=1]="Additive",i[i.Multiply=2]="Multiply",i[i.Screen=3]="Screen"})(Ze||(Ze={}));class Gf extends nn{constructor(e){super(e,0,!1);x(this,"bones",new Array);x(this,"_target",null);x(this,"mixRotate",0);x(this,"mixX",0);x(this,"mixY",0);x(this,"mixScaleX",0);x(this,"mixScaleY",0);x(this,"mixShearY",0);x(this,"offsetRotation",0);x(this,"offsetX",0);x(this,"offsetY",0);x(this,"offsetScaleX",0);x(this,"offsetScaleY",0);x(this,"offsetShearY",0);x(this,"relative",!1);x(this,"local",!1)}set target(e){this._target=e}get target(){if(this._target)return this._target;throw new Error("BoneData not set.")}}class f1{constructor(t){x(this,"scale",1);x(this,"attachmentLoader");x(this,"linkedMeshes",new Array);this.attachmentLoader=t}readSkeletonData(t){let e=this.scale,s=new Nr;s.name="";let r=new p1(t),n=r.readInt32(),a=r.readInt32();s.hash=a==0&&n==0?null:a.toString(16)+n.toString(16),s.version=r.readString(),s.x=r.readFloat(),s.y=r.readFloat(),s.width=r.readFloat(),s.height=r.readFloat(),s.referenceScale=r.readFloat()*e;let o=r.readBoolean();o&&(s.fps=r.readFloat(),s.imagesPath=r.readString(),s.audioPath=r.readString());let h=0;h=r.readInt(!0);for(let c=0;c<h;c++){let u=r.readString();if(!u)throw new Error("String in string table must not be null.");r.strings.push(u)}h=r.readInt(!0);for(let c=0;c<h;c++){let u=r.readString();if(!u)throw new Error("Bone name must not be null.");let f=c==0?null:s.bones[r.readInt(!0)],d=new Df(c,u,f);d.rotation=r.readFloat(),d.x=r.readFloat()*e,d.y=r.readFloat()*e,d.scaleX=r.readFloat(),d.scaleY=r.readFloat(),d.shearX=r.readFloat(),d.shearY=r.readFloat(),d.length=r.readFloat()*e,d.inherit=r.readByte(),d.skinRequired=r.readBoolean(),o&&(K.rgba8888ToColor(d.color,r.readInt32()),d.icon=r.readString()??void 0,d.visible=r.readBoolean()),s.bones.push(d)}h=r.readInt(!0);for(let c=0;c<h;c++){let u=r.readString();if(!u)throw new Error("Slot name must not be null.");let f=s.bones[r.readInt(!0)],d=new Wf(c,u,f);K.rgba8888ToColor(d.color,r.readInt32());let p=r.readInt32();p!=-1&&K.rgb888ToColor(d.darkColor=new K,p),d.attachmentName=r.readStringRef(),d.blendMode=r.readInt(!0),o&&(d.visible=r.readBoolean()),s.slots.push(d)}h=r.readInt(!0);for(let c=0,u;c<h;c++){let f=r.readString();if(!f)throw new Error("IK constraint data name must not be null.");let d=new zf(f);d.order=r.readInt(!0),u=r.readInt(!0);for(let m=0;m<u;m++)d.bones.push(s.bones[r.readInt(!0)]);d.target=s.bones[r.readInt(!0)];let p=r.readByte();d.skinRequired=(p&1)!=0,d.bendDirection=(p&2)!=0?1:-1,d.compress=(p&4)!=0,d.stretch=(p&8)!=0,d.uniform=(p&16)!=0,(p&32)!=0&&(d.mix=(p&64)!=0?r.readFloat():1),(p&128)!=0&&(d.softness=r.readFloat()*e),s.ikConstraints.push(d)}h=r.readInt(!0);for(let c=0,u;c<h;c++){let f=r.readString();if(!f)throw new Error("Transform constraint data name must not be null.");let d=new Gf(f);d.order=r.readInt(!0),u=r.readInt(!0);for(let m=0;m<u;m++)d.bones.push(s.bones[r.readInt(!0)]);d.target=s.bones[r.readInt(!0)];let p=r.readByte();d.skinRequired=(p&1)!=0,d.local=(p&2)!=0,d.relative=(p&4)!=0,(p&8)!=0&&(d.offsetRotation=r.readFloat()),(p&16)!=0&&(d.offsetX=r.readFloat()*e),(p&32)!=0&&(d.offsetY=r.readFloat()*e),(p&64)!=0&&(d.offsetScaleX=r.readFloat()),(p&128)!=0&&(d.offsetScaleY=r.readFloat()),p=r.readByte(),(p&1)!=0&&(d.offsetShearY=r.readFloat()),(p&2)!=0&&(d.mixRotate=r.readFloat()),(p&4)!=0&&(d.mixX=r.readFloat()),(p&8)!=0&&(d.mixY=r.readFloat()),(p&16)!=0&&(d.mixScaleX=r.readFloat()),(p&32)!=0&&(d.mixScaleY=r.readFloat()),(p&64)!=0&&(d.mixShearY=r.readFloat()),s.transformConstraints.push(d)}h=r.readInt(!0);for(let c=0,u;c<h;c++){let f=r.readString();if(!f)throw new Error("Path constraint data name must not be null.");let d=new Nf(f);d.order=r.readInt(!0),d.skinRequired=r.readBoolean(),u=r.readInt(!0);for(let m=0;m<u;m++)d.bones.push(s.bones[r.readInt(!0)]);d.target=s.slots[r.readInt(!0)];const p=r.readByte();d.positionMode=p&1,d.spacingMode=p>>1&3,d.rotateMode=p>>3&3,(p&128)!=0&&(d.offsetRotation=r.readFloat()),d.position=r.readFloat(),d.positionMode==Pe.Fixed&&(d.position*=e),d.spacing=r.readFloat(),(d.spacingMode==It.Length||d.spacingMode==It.Fixed)&&(d.spacing*=e),d.mixRotate=r.readFloat(),d.mixX=r.readFloat(),d.mixY=r.readFloat(),s.pathConstraints.push(d)}h=r.readInt(!0);for(let c=0,u;c<h;c++){const f=r.readString();if(!f)throw new Error("Physics constraint data name must not be null.");const d=new Uf(f);d.order=r.readInt(!0),d.bone=s.bones[r.readInt(!0)];let p=r.readByte();d.skinRequired=(p&1)!=0,(p&2)!=0&&(d.x=r.readFloat()),(p&4)!=0&&(d.y=r.readFloat()),(p&8)!=0&&(d.rotate=r.readFloat()),(p&16)!=0&&(d.scaleX=r.readFloat()),(p&32)!=0&&(d.shearX=r.readFloat()),d.limit=((p&64)!=0?r.readFloat():5e3)*e,d.step=1/r.readUnsignedByte(),d.inertia=r.readFloat(),d.strength=r.readFloat(),d.damping=r.readFloat(),d.massInverse=(p&128)!=0?r.readFloat():1,d.wind=r.readFloat(),d.gravity=r.readFloat(),p=r.readByte(),(p&1)!=0&&(d.inertiaGlobal=!0),(p&2)!=0&&(d.strengthGlobal=!0),(p&4)!=0&&(d.dampingGlobal=!0),(p&8)!=0&&(d.massGlobal=!0),(p&16)!=0&&(d.windGlobal=!0),(p&32)!=0&&(d.gravityGlobal=!0),(p&64)!=0&&(d.mixGlobal=!0),d.mix=(p&128)!=0?r.readFloat():1,s.physicsConstraints.push(d)}let l=this.readSkin(r,s,!0,o);l&&(s.defaultSkin=l,s.skins.push(l));{let c=s.skins.length;for(Y.setArraySize(s.skins,h=c+r.readInt(!0));c<h;c++){let u=this.readSkin(r,s,!1,o);if(!u)throw new Error("readSkin() should not have returned null.");s.skins[c]=u}}h=this.linkedMeshes.length;for(let c=0;c<h;c++){let u=this.linkedMeshes[c];const f=s.skins[u.skinIndex];if(!u.parent)throw new Error("Linked mesh parent must not be null");let d=f.getAttachment(u.slotIndex,u.parent);if(!d)throw new Error(`Parent mesh not found: ${u.parent}`);u.mesh.timelineAttachment=u.inheritTimeline?d:u.mesh,u.mesh.setParentMesh(d),u.mesh.region!=null&&u.mesh.updateRegion()}this.linkedMeshes.length=0,h=r.readInt(!0);for(let c=0;c<h;c++){let u=r.readString();if(!u)throw new Error("Event data name must not be null");let f=new Xf(u);f.intValue=r.readInt(!1),f.floatValue=r.readFloat(),f.stringValue=r.readString(),f.audioPath=r.readString(),f.audioPath&&(f.volume=r.readFloat(),f.balance=r.readFloat()),s.events.push(f)}h=r.readInt(!0);for(let c=0;c<h;c++){let u=r.readString();if(!u)throw new Error("Animatio name must not be null.");s.animations.push(this.readAnimation(r,u,s))}return s}readSkin(t,e,s,r){let n=null,a=0;if(s){if(a=t.readInt(!0),a==0)return null;n=new Ya("default")}else{let o=t.readString();if(!o)throw new Error("Skin name must not be null.");n=new Ya(o),r&&K.rgba8888ToColor(n.color,t.readInt32()),n.bones.length=t.readInt(!0);for(let h=0,l=n.bones.length;h<l;h++)n.bones[h]=e.bones[t.readInt(!0)];for(let h=0,l=t.readInt(!0);h<l;h++)n.constraints.push(e.ikConstraints[t.readInt(!0)]);for(let h=0,l=t.readInt(!0);h<l;h++)n.constraints.push(e.transformConstraints[t.readInt(!0)]);for(let h=0,l=t.readInt(!0);h<l;h++)n.constraints.push(e.pathConstraints[t.readInt(!0)]);for(let h=0,l=t.readInt(!0);h<l;h++)n.constraints.push(e.physicsConstraints[t.readInt(!0)]);a=t.readInt(!0)}for(let o=0;o<a;o++){let h=t.readInt(!0);for(let l=0,c=t.readInt(!0);l<c;l++){let u=t.readStringRef();if(!u)throw new Error("Attachment name must not be null");let f=this.readAttachment(t,e,n,h,u,r);f&&n.setAttachment(h,u,f)}}return n}readAttachment(t,e,s,r,n,a){let o=this.scale,h=t.readByte();const l=(h&8)!=0?t.readStringRef():n;if(!l)throw new Error("Attachment name must not be null");switch(h&7){case Be.Region:{let c=(h&16)!=0?t.readStringRef():null;const u=(h&32)!=0?t.readInt32():4294967295,f=(h&64)!=0?this.readSequence(t):null;let d=(h&128)!=0?t.readFloat():0,p=t.readFloat(),m=t.readFloat(),g=t.readFloat(),_=t.readFloat(),w=t.readFloat(),b=t.readFloat();c||(c=l);let y=this.attachmentLoader.newRegionAttachment(s,l,c,f);return y?(y.path=c,y.x=p*o,y.y=m*o,y.scaleX=g,y.scaleY=_,y.rotation=d,y.width=w*o,y.height=b*o,K.rgba8888ToColor(y.color,u),y.sequence=f,f==null&&y.updateRegion(),y):null}case Be.BoundingBox:{let c=this.readVertices(t,(h&16)!=0),u=a?t.readInt32():0,f=this.attachmentLoader.newBoundingBoxAttachment(s,l);return f?(f.worldVerticesLength=c.length,f.vertices=c.vertices,f.bones=c.bones,a&&K.rgba8888ToColor(f.color,u),f):null}case Be.Mesh:{let c=(h&16)!=0?t.readStringRef():l;const u=(h&32)!=0?t.readInt32():4294967295,f=(h&64)!=0?this.readSequence(t):null,d=t.readInt(!0),p=this.readVertices(t,(h&128)!=0),m=this.readFloatArray(t,p.length,1),g=this.readShortArray(t,(p.length-d-2)*3);let _=[],w=0,b=0;a&&(_=this.readShortArray(t,t.readInt(!0)),w=t.readFloat(),b=t.readFloat()),c||(c=l);let y=this.attachmentLoader.newMeshAttachment(s,l,c,f);return y?(y.path=c,K.rgba8888ToColor(y.color,u),y.bones=p.bones,y.vertices=p.vertices,y.worldVerticesLength=p.length,y.triangles=g,y.regionUVs=m,f==null&&y.updateRegion(),y.hullLength=d<<1,y.sequence=f,a&&(y.edges=_,y.width=w*o,y.height=b*o),y):null}case Be.LinkedMesh:{const c=(h&16)!=0?t.readStringRef():l;if(c==null)throw new Error("Path of linked mesh must not be null");const u=(h&32)!=0?t.readInt32():4294967295,f=(h&64)!=0?this.readSequence(t):null,d=(h&128)!=0,p=t.readInt(!0),m=t.readStringRef();let g=0,_=0;a&&(g=t.readFloat(),_=t.readFloat());let w=this.attachmentLoader.newMeshAttachment(s,l,c,f);return w?(w.path=c,K.rgba8888ToColor(w.color,u),w.sequence=f,a&&(w.width=g*o,w.height=_*o),this.linkedMeshes.push(new m1(w,p,r,m,d)),w):null}case Be.Path:{const c=(h&16)!=0,u=(h&32)!=0,f=this.readVertices(t,(h&64)!=0),d=Y.newArray(f.length/6,0);for(let g=0,_=d.length;g<_;g++)d[g]=t.readFloat()*o;const p=a?t.readInt32():0,m=this.attachmentLoader.newPathAttachment(s,l);return m?(m.closed=c,m.constantSpeed=u,m.worldVerticesLength=f.length,m.vertices=f.vertices,m.bones=f.bones,m.lengths=d,a&&K.rgba8888ToColor(m.color,p),m):null}case Be.Point:{const c=t.readFloat(),u=t.readFloat(),f=t.readFloat(),d=a?t.readInt32():0,p=this.attachmentLoader.newPointAttachment(s,l);return p?(p.x=u*o,p.y=f*o,p.rotation=c,a&&K.rgba8888ToColor(p.color,d),p):null}case Be.Clipping:{const c=t.readInt(!0),u=this.readVertices(t,(h&16)!=0);let f=a?t.readInt32():0,d=this.attachmentLoader.newClippingAttachment(s,l);return d?(d.endSlot=e.slots[c],d.worldVerticesLength=u.length,d.vertices=u.vertices,d.bones=u.bones,a&&K.rgba8888ToColor(d.color,f),d):null}}return null}readSequence(t){let e=new Dr(t.readInt(!0));return e.start=t.readInt(!0),e.digits=t.readInt(!0),e.setupIndex=t.readInt(!0),e}readVertices(t,e){const s=this.scale,r=t.readInt(!0),n=new g1;if(n.length=r<<1,!e)return n.vertices=this.readFloatArray(t,n.length,s),n;let a=new Array,o=new Array;for(let h=0;h<r;h++){let l=t.readInt(!0);o.push(l);for(let c=0;c<l;c++)o.push(t.readInt(!0)),a.push(t.readFloat()*s),a.push(t.readFloat()*s),a.push(t.readFloat())}return n.vertices=Y.toFloatArray(a),n.bones=o,n}readFloatArray(t,e,s){let r=new Array(e);if(s==1)for(let n=0;n<e;n++)r[n]=t.readFloat();else for(let n=0;n<e;n++)r[n]=t.readFloat()*s;return r}readShortArray(t,e){let s=new Array(e);for(let r=0;r<e;r++)s[r]=t.readInt(!0);return s}readAnimation(t,e,s){t.readInt(!0);let r=new Array,n=this.scale;for(let l=0,c=t.readInt(!0);l<c;l++){let u=t.readInt(!0);for(let f=0,d=t.readInt(!0);f<d;f++){let p=t.readByte(),m=t.readInt(!0),g=m-1;switch(p){case P1:{let _=new Is(m,u);for(let w=0;w<m;w++)_.setFrame(w,t.readFloat(),t.readStringRef());r.push(_);break}case k1:{let _=t.readInt(!0),w=new bf(m,_,u),b=t.readFloat(),y=t.readUnsignedByte()/255,S=t.readUnsignedByte()/255,v=t.readUnsignedByte()/255,A=t.readUnsignedByte()/255;for(let C=0,T=0;w.setFrame(C,b,y,S,v,A),C!=g;C++){let P=t.readFloat(),M=t.readUnsignedByte()/255,B=t.readUnsignedByte()/255,F=t.readUnsignedByte()/255,I=t.readUnsignedByte()/255;switch(t.readByte()){case we:w.setStepped(C);break;case ve:tt(t,w,T++,C,0,b,P,y,M,1),tt(t,w,T++,C,1,b,P,S,B,1),tt(t,w,T++,C,2,b,P,v,F,1),tt(t,w,T++,C,3,b,P,A,I,1)}b=P,y=M,S=B,v=F,A=I}r.push(w);break}case I1:{let _=t.readInt(!0),w=new _f(m,_,u),b=t.readFloat(),y=t.readUnsignedByte()/255,S=t.readUnsignedByte()/255,v=t.readUnsignedByte()/255;for(let A=0,C=0;w.setFrame(A,b,y,S,v),A!=g;A++){let T=t.readFloat(),P=t.readUnsignedByte()/255,M=t.readUnsignedByte()/255,B=t.readUnsignedByte()/255;switch(t.readByte()){case we:w.setStepped(A);break;case ve:tt(t,w,C++,A,0,b,T,y,P,1),tt(t,w,C++,A,1,b,T,S,M,1),tt(t,w,C++,A,2,b,T,v,B,1)}b=T,y=P,S=M,v=B}r.push(w);break}case F1:{let _=t.readInt(!0),w=new vf(m,_,u),b=t.readFloat(),y=t.readUnsignedByte()/255,S=t.readUnsignedByte()/255,v=t.readUnsignedByte()/255,A=t.readUnsignedByte()/255,C=t.readUnsignedByte()/255,T=t.readUnsignedByte()/255,P=t.readUnsignedByte()/255;for(let M=0,B=0;w.setFrame(M,b,y,S,v,A,C,T,P),M!=g;M++){let F=t.readFloat(),I=t.readUnsignedByte()/255,E=t.readUnsignedByte()/255,R=t.readUnsignedByte()/255,O=t.readUnsignedByte()/255,W=t.readUnsignedByte()/255,L=t.readUnsignedByte()/255,H=t.readUnsignedByte()/255;switch(t.readByte()){case we:w.setStepped(M);break;case ve:tt(t,w,B++,M,0,b,F,y,I,1),tt(t,w,B++,M,1,b,F,S,E,1),tt(t,w,B++,M,2,b,F,v,R,1),tt(t,w,B++,M,3,b,F,A,O,1),tt(t,w,B++,M,4,b,F,C,W,1),tt(t,w,B++,M,5,b,F,T,L,1),tt(t,w,B++,M,6,b,F,P,H,1)}b=F,y=I,S=E,v=R,A=O,C=W,T=L,P=H}r.push(w);break}case E1:{let _=t.readInt(!0),w=new Sf(m,_,u),b=t.readFloat(),y=t.readUnsignedByte()/255,S=t.readUnsignedByte()/255,v=t.readUnsignedByte()/255,A=t.readUnsignedByte()/255,C=t.readUnsignedByte()/255,T=t.readUnsignedByte()/255;for(let P=0,M=0;w.setFrame(P,b,y,S,v,A,C,T),P!=g;P++){let B=t.readFloat(),F=t.readUnsignedByte()/255,I=t.readUnsignedByte()/255,E=t.readUnsignedByte()/255,R=t.readUnsignedByte()/255,O=t.readUnsignedByte()/255,W=t.readUnsignedByte()/255;switch(t.readByte()){case we:w.setStepped(P);break;case ve:tt(t,w,M++,P,0,b,B,y,F,1),tt(t,w,M++,P,1,b,B,S,I,1),tt(t,w,M++,P,2,b,B,v,E,1),tt(t,w,M++,P,3,b,B,A,R,1),tt(t,w,M++,P,4,b,B,C,O,1),tt(t,w,M++,P,5,b,B,T,W,1)}b=B,y=F,S=I,v=E,A=R,C=O,T=W}r.push(w);break}case B1:{let _=new wf(m,t.readInt(!0),u),w=t.readFloat(),b=t.readUnsignedByte()/255;for(let y=0,S=0;_.setFrame(y,w,b),y!=g;y++){let v=t.readFloat(),A=t.readUnsignedByte()/255;switch(t.readByte()){case we:_.setStepped(y);break;case ve:tt(t,_,S++,y,0,w,v,b,A,1)}w=v,b=A}r.push(_)}}}}for(let l=0,c=t.readInt(!0);l<c;l++){let u=t.readInt(!0);for(let f=0,d=t.readInt(!0);f<d;f++){let p=t.readByte(),m=t.readInt(!0);if(p==M1){let _=new yf(m,u);for(let w=0;w<m;w++)_.setFrame(w,t.readFloat(),t.readByte());r.push(_);continue}let g=t.readInt(!0);switch(p){case x1:r.push(Ot(t,new Yr(m,g,u),1));break;case y1:r.push(Qn(t,new hf(m,g,u),n));break;case b1:r.push(Ot(t,new cf(m,g,u),n));break;case _1:r.push(Ot(t,new uf(m,g,u),n));break;case w1:r.push(Qn(t,new df(m,g,u),1));break;case v1:r.push(Ot(t,new ff(m,g,u),1));break;case S1:r.push(Ot(t,new pf(m,g,u),1));break;case A1:r.push(Qn(t,new mf(m,g,u),1));break;case C1:r.push(Ot(t,new gf(m,g,u),1));break;case T1:r.push(Ot(t,new xf(m,g,u),1))}}}for(let l=0,c=t.readInt(!0);l<c;l++){let u=t.readInt(!0),f=t.readInt(!0),d=f-1,p=new Cf(f,t.readInt(!0),u),m=t.readByte(),g=t.readFloat(),_=(m&1)!=0?(m&2)!=0?t.readFloat():1:0,w=(m&4)!=0?t.readFloat()*n:0;for(let b=0,y=0;p.setFrame(b,g,_,w,(m&8)!=0?1:-1,(m&16)!=0,(m&32)!=0),b!=d;b++){m=t.readByte();const S=t.readFloat(),v=(m&1)!=0?(m&2)!=0?t.readFloat():1:0,A=(m&4)!=0?t.readFloat()*n:0;(m&64)!=0?p.setStepped(b):(m&128)!=0&&(tt(t,p,y++,b,0,g,S,_,v,1),tt(t,p,y++,b,1,g,S,w,A,n)),g=S,_=v,w=A}r.push(p)}for(let l=0,c=t.readInt(!0);l<c;l++){let u=t.readInt(!0),f=t.readInt(!0),d=f-1,p=new Tf(f,t.readInt(!0),u),m=t.readFloat(),g=t.readFloat(),_=t.readFloat(),w=t.readFloat(),b=t.readFloat(),y=t.readFloat(),S=t.readFloat();for(let v=0,A=0;p.setFrame(v,m,g,_,w,b,y,S),v!=d;v++){let C=t.readFloat(),T=t.readFloat(),P=t.readFloat(),M=t.readFloat(),B=t.readFloat(),F=t.readFloat(),I=t.readFloat();switch(t.readByte()){case we:p.setStepped(v);break;case ve:tt(t,p,A++,v,0,m,C,g,T,1),tt(t,p,A++,v,1,m,C,_,P,1),tt(t,p,A++,v,2,m,C,w,M,1),tt(t,p,A++,v,3,m,C,b,B,1),tt(t,p,A++,v,4,m,C,y,F,1),tt(t,p,A++,v,5,m,C,S,I,1)}m=C,g=T,_=P,w=M,b=B,y=F,S=I}r.push(p)}for(let l=0,c=t.readInt(!0);l<c;l++){let u=t.readInt(!0),f=s.pathConstraints[u];for(let d=0,p=t.readInt(!0);d<p;d++){const m=t.readByte(),g=t.readInt(!0),_=t.readInt(!0);switch(m){case O1:r.push(Ot(t,new Mf(g,_,u),f.positionMode==Pe.Fixed?n:1));break;case L1:r.push(Ot(t,new Pf(g,_,u),f.spacingMode==It.Length||f.spacingMode==It.Fixed?n:1));break;case D1:let w=new kf(g,_,u),b=t.readFloat(),y=t.readFloat(),S=t.readFloat(),v=t.readFloat();for(let A=0,C=0,T=w.getFrameCount()-1;w.setFrame(A,b,y,S,v),A!=T;A++){let P=t.readFloat(),M=t.readFloat(),B=t.readFloat(),F=t.readFloat();switch(t.readByte()){case we:w.setStepped(A);break;case ve:tt(t,w,C++,A,0,b,P,y,M,1),tt(t,w,C++,A,1,b,P,S,B,1),tt(t,w,C++,A,2,b,P,v,F,1)}b=P,y=M,S=B,v=F}r.push(w)}}}for(let l=0,c=t.readInt(!0);l<c;l++){const u=t.readInt(!0)-1;for(let f=0,d=t.readInt(!0);f<d;f++){const p=t.readByte(),m=t.readInt(!0);if(p==H1){const _=new Xr(m,u);for(let w=0;w<m;w++)_.setFrame(w,t.readFloat());r.push(_);continue}const g=t.readInt(!0);switch(p){case Y1:r.push(Ot(t,new If(m,g,u),1));break;case X1:r.push(Ot(t,new Ff(m,g,u),1));break;case z1:r.push(Ot(t,new Ef(m,g,u),1));break;case N1:r.push(Ot(t,new Bf(m,g,u),1));break;case U1:r.push(Ot(t,new Rf(m,g,u),1));break;case W1:r.push(Ot(t,new Vf(m,g,u),1));break;case G1:r.push(Ot(t,new Of(m,g,u),1))}}}for(let l=0,c=t.readInt(!0);l<c;l++){let u=s.skins[t.readInt(!0)];for(let f=0,d=t.readInt(!0);f<d;f++){let p=t.readInt(!0);for(let m=0,g=t.readInt(!0);m<g;m++){let _=t.readStringRef();if(!_)throw new Error("attachmentName must not be null.");let w=u.getAttachment(p,_),b=t.readByte(),y=t.readInt(!0),S=y-1;switch(b){case R1:{let v=w,A=v.bones,C=v.vertices,T=A?C.length/3*2:C.length,P=t.readInt(!0),M=new Af(y,P,p,v),B=t.readFloat();for(let F=0,I=0;;F++){let E,R=t.readInt(!0);if(R==0)E=A?Y.newFloatArray(T):C;else{E=Y.newFloatArray(T);let W=t.readInt(!0);if(R+=W,n==1)for(let L=W;L<R;L++)E[L]=t.readFloat();else for(let L=W;L<R;L++)E[L]=t.readFloat()*n;if(!A)for(let L=0,H=E.length;L<H;L++)E[L]+=C[L]}if(M.setFrame(F,B,E),F==S)break;let O=t.readFloat();switch(t.readByte()){case we:M.setStepped(F);break;case ve:tt(t,M,I++,F,0,B,O,0,1,1)}B=O}r.push(M);break}case V1:{let v=new zr(y,p,w);for(let A=0;A<y;A++){let C=t.readFloat(),T=t.readInt32();v.setFrame(A,C,lf[T&15],T>>4,t.readFloat())}r.push(v);break}}}}}let a=t.readInt(!0);if(a>0){let l=new us(a),c=s.slots.length;for(let u=0;u<a;u++){let f=t.readFloat(),d=t.readInt(!0),p=Y.newArray(c,0);for(let w=c-1;w>=0;w--)p[w]=-1;let m=Y.newArray(c-d,0),g=0,_=0;for(let w=0;w<d;w++){let b=t.readInt(!0);for(;g!=b;)m[_++]=g++;p[g+t.readInt(!0)]=g++}for(;g<c;)m[_++]=g++;for(let w=c-1;w>=0;w--)p[w]==-1&&(p[w]=m[--_]);l.setFrame(u,f,p)}r.push(l)}let o=t.readInt(!0);if(o>0){let l=new Ui(o);for(let c=0;c<o;c++){let u=t.readFloat(),f=s.events[t.readInt(!0)],d=new Yf(u,f);d.intValue=t.readInt(!1),d.floatValue=t.readFloat(),d.stringValue=t.readString(),d.stringValue==null&&(d.stringValue=f.stringValue),d.data.audioPath&&(d.volume=t.readFloat(),d.balance=t.readFloat()),l.setFrame(c,d)}r.push(l)}let h=0;for(let l=0,c=r.length;l<c;l++)h=Math.max(h,r[l].getDuration());return new Po(e,r,h)}}class p1{constructor(t,e=new Array,s=0,r=new DataView(t instanceof ArrayBuffer?t:t.buffer)){x(this,"strings");x(this,"index");x(this,"buffer");this.strings=e,this.index=s,this.buffer=r}readByte(){return this.buffer.getInt8(this.index++)}readUnsignedByte(){return this.buffer.getUint8(this.index++)}readShort(){let t=this.buffer.getInt16(this.index);return this.index+=2,t}readInt32(){let t=this.buffer.getInt32(this.index);return this.index+=4,t}readInt(t){let e=this.readByte(),s=e&127;return(e&128)!=0&&(e=this.readByte(),s|=(e&127)<<7,(e&128)!=0&&(e=this.readByte(),s|=(e&127)<<14,(e&128)!=0&&(e=this.readByte(),s|=(e&127)<<21,(e&128)!=0&&(e=this.readByte(),s|=(e&127)<<28)))),t?s:s>>>1^-(s&1)}readStringRef(){let t=this.readInt(!0);return t==0?null:this.strings[t-1]}readString(){let t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;let e="";for(let s=0;s<t;){let r=this.readUnsignedByte();switch(r>>4){case 12:case 13:e+=String.fromCharCode((r&31)<<6|this.readByte()&63),s+=2;break;case 14:e+=String.fromCharCode((r&15)<<12|(this.readByte()&63)<<6|this.readByte()&63),s+=3;break;default:e+=String.fromCharCode(r),s++}}return e}readFloat(){let t=this.buffer.getFloat32(this.index);return this.index+=4,t}readBoolean(){return this.readByte()!=0}}let m1=class{constructor(t,e,s,r,n){x(this,"parent");x(this,"skinIndex");x(this,"slotIndex");x(this,"mesh");x(this,"inheritTimeline");this.mesh=t,this.skinIndex=e,this.slotIndex=s,this.parent=r,this.inheritTimeline=n}};class g1{constructor(t=null,e=null,s=0){x(this,"bones");x(this,"vertices");x(this,"length");this.bones=t,this.vertices=e,this.length=s}}var Be;(function(i){i[i.Region=0]="Region",i[i.BoundingBox=1]="BoundingBox",i[i.Mesh=2]="Mesh",i[i.LinkedMesh=3]="LinkedMesh",i[i.Path=4]="Path",i[i.Point=5]="Point",i[i.Clipping=6]="Clipping"})(Be||(Be={}));function Ot(i,t,e){let s=i.readFloat(),r=i.readFloat()*e;for(let n=0,a=0,o=t.getFrameCount()-1;t.setFrame(n,s,r),n!=o;n++){let h=i.readFloat(),l=i.readFloat()*e;switch(i.readByte()){case we:t.setStepped(n);break;case ve:tt(i,t,a++,n,0,s,h,r,l,e)}s=h,r=l}return t}function Qn(i,t,e){let s=i.readFloat(),r=i.readFloat()*e,n=i.readFloat()*e;for(let a=0,o=0,h=t.getFrameCount()-1;t.setFrame(a,s,r,n),a!=h;a++){let l=i.readFloat(),c=i.readFloat()*e,u=i.readFloat()*e;switch(i.readByte()){case we:t.setStepped(a);break;case ve:tt(i,t,o++,a,0,s,l,r,c,e),tt(i,t,o++,a,1,s,l,n,u,e)}s=l,r=c,n=u}return t}function tt(i,t,e,s,r,n,a,o,h,l){t.setBezier(e,s,r,n,o,i.readFloat(),i.readFloat()*l,i.readFloat(),i.readFloat()*l,a,h)}const x1=0,y1=1,b1=2,_1=3,w1=4,v1=5,S1=6,A1=7,C1=8,T1=9,M1=10,P1=0,k1=1,I1=2,F1=3,E1=4,B1=5,R1=0,V1=1,O1=0,L1=1,D1=2,Y1=0,X1=1,z1=2,N1=4,U1=5,W1=6,G1=7,H1=8,we=1,ve=2;class $1{constructor(){x(this,"minX",0);x(this,"minY",0);x(this,"maxX",0);x(this,"maxY",0);x(this,"boundingBoxes",new Array);x(this,"polygons",new Array);x(this,"polygonPool",new Ni(()=>Y.newFloatArray(16)))}update(t,e){if(!t)throw new Error("skeleton cannot be null.");let s=this.boundingBoxes,r=this.polygons,n=this.polygonPool,a=t.slots,o=a.length;s.length=0,n.freeAll(r),r.length=0;for(let h=0;h<o;h++){let l=a[h];if(!l.bone.active)continue;let c=l.getAttachment();if(c instanceof rn){let u=c;s.push(u);let f=n.obtain();f.length!=u.worldVerticesLength&&(f=Y.newFloatArray(u.worldVerticesLength)),r.push(f),u.computeWorldVertices(l,0,u.worldVerticesLength,f,0,2)}}e?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)}aabbCompute(){let t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY,n=this.polygons;for(let a=0,o=n.length;a<o;a++){let h=n[a],l=h;for(let c=0,u=h.length;c<u;c+=2){let f=l[c],d=l[c+1];t=Math.min(t,f),e=Math.min(e,d),s=Math.max(s,f),r=Math.max(r,d)}}this.minX=t,this.minY=e,this.maxX=s,this.maxY=r}aabbContainsPoint(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY}aabbIntersectsSegment(t,e,s,r){let n=this.minX,a=this.minY,o=this.maxX,h=this.maxY;if(t<=n&&s<=n||e<=a&&r<=a||t>=o&&s>=o||e>=h&&r>=h)return!1;let l=(r-e)/(s-t),c=l*(n-t)+e;if(c>a&&c<h||(c=l*(o-t)+e,c>a&&c<h))return!0;let u=(a-e)/l+t;return u>n&&u<o||(u=(h-e)/l+t,u>n&&u<o)}aabbIntersectsSkeleton(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY}containsPoint(t,e){let s=this.polygons;for(let r=0,n=s.length;r<n;r++)if(this.containsPointPolygon(s[r],t,e))return this.boundingBoxes[r];return null}containsPointPolygon(t,e,s){let r=t,n=t.length,a=n-2,o=!1;for(let h=0;h<n;h+=2){let l=r[h+1],c=r[a+1];if(l<s&&c>=s||c<s&&l>=s){let u=r[h];u+(s-l)/(c-l)*(r[a]-u)<e&&(o=!o)}a=h}return o}intersectsSegment(t,e,s,r){let n=this.polygons;for(let a=0,o=n.length;a<o;a++)if(this.intersectsSegmentPolygon(n[a],t,e,s,r))return this.boundingBoxes[a];return null}intersectsSegmentPolygon(t,e,s,r,n){let a=t,o=t.length,h=e-r,l=s-n,c=e*n-s*r,u=a[o-2],f=a[o-1];for(let d=0;d<o;d+=2){let p=a[d],m=a[d+1],g=u*m-f*p,_=u-p,w=f-m,b=h*w-l*_,y=(c*_-h*g)/b;if((y>=u&&y<=p||y>=p&&y<=u)&&(y>=e&&y<=r||y>=r&&y<=e)){let S=(c*w-l*g)/b;if((S>=f&&S<=m||S>=m&&S<=f)&&(S>=s&&S<=n||S>=n&&S<=s))return!0}u=p,f=m}return!1}getPolygon(t){if(!t)throw new Error("boundingBox cannot be null.");let e=this.boundingBoxes.indexOf(t);return e==-1?null:this.polygons[e]}getWidth(){return this.maxX-this.minX}getHeight(){return this.maxY-this.minY}}class Gt{constructor(){x(this,"convexPolygons",new Array);x(this,"convexPolygonsIndices",new Array);x(this,"indicesArray",new Array);x(this,"isConcaveArray",new Array);x(this,"triangles",new Array);x(this,"polygonPool",new Ni(()=>new Array));x(this,"polygonIndicesPool",new Ni(()=>new Array))}triangulate(t){let e=t,s=t.length>>1,r=this.indicesArray;r.length=0;for(let o=0;o<s;o++)r[o]=o;let n=this.isConcaveArray;n.length=0;for(let o=0,h=s;o<h;++o)n[o]=Gt.isConcave(o,s,e,r);let a=this.triangles;for(a.length=0;s>3;){let o=s-1,h=0,l=1;for(;;){t:if(!n[h]){let f=r[o]<<1,d=r[h]<<1,p=r[l]<<1,m=e[f],g=e[f+1],_=e[d],w=e[d+1],b=e[p],y=e[p+1];for(let S=(l+1)%s;S!=o;S=(S+1)%s){if(!n[S])continue;let v=r[S]<<1,A=e[v],C=e[v+1];if(Gt.positiveArea(b,y,m,g,A,C)&&Gt.positiveArea(m,g,_,w,A,C)&&Gt.positiveArea(_,w,b,y,A,C))break t}break}if(l==0){do{if(!n[h])break;h--}while(h>0);break}o=h,h=l,l=(l+1)%s}a.push(r[(s+h-1)%s]),a.push(r[h]),a.push(r[(h+1)%s]),r.splice(h,1),n.splice(h,1),s--;let c=(s+h-1)%s,u=h==s?0:h;n[c]=Gt.isConcave(c,s,e,r),n[u]=Gt.isConcave(u,s,e,r)}return s==3&&(a.push(r[2]),a.push(r[0]),a.push(r[1])),a}decompose(t,e){let s=t,r=this.convexPolygons;this.polygonPool.freeAll(r),r.length=0;let n=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(n),n.length=0;let a=this.polygonIndicesPool.obtain();a.length=0;let o=this.polygonPool.obtain();o.length=0;let h=-1,l=0;for(let c=0,u=e.length;c<u;c+=3){let f=e[c]<<1,d=e[c+1]<<1,p=e[c+2]<<1,m=s[f],g=s[f+1],_=s[d],w=s[d+1],b=s[p],y=s[p+1],S=!1;if(h==f){let v=o.length-4,A=Gt.winding(o[v],o[v+1],o[v+2],o[v+3],b,y),C=Gt.winding(b,y,o[0],o[1],o[2],o[3]);A==l&&C==l&&(o.push(b),o.push(y),a.push(p),S=!0)}S||(o.length>0?(r.push(o),n.push(a)):(this.polygonPool.free(o),this.polygonIndicesPool.free(a)),o=this.polygonPool.obtain(),o.length=0,o.push(m),o.push(g),o.push(_),o.push(w),o.push(b),o.push(y),a=this.polygonIndicesPool.obtain(),a.length=0,a.push(f),a.push(d),a.push(p),l=Gt.winding(m,g,_,w,b,y),h=f)}o.length>0&&(r.push(o),n.push(a));for(let c=0,u=r.length;c<u;c++){if(a=n[c],a.length==0)continue;let f=a[0],d=a[a.length-1];o=r[c];let p=o.length-4,m=o[p],g=o[p+1],_=o[p+2],w=o[p+3],b=o[0],y=o[1],S=o[2],v=o[3],A=Gt.winding(m,g,_,w,b,y);for(let C=0;C<u;C++){if(C==c)continue;let T=n[C];if(T.length!=3)continue;let P=T[0],M=T[1],B=T[2],F=r[C],I=F[F.length-2],E=F[F.length-1];if(P!=f||M!=d)continue;let R=Gt.winding(m,g,_,w,I,E),O=Gt.winding(I,E,b,y,S,v);R==A&&O==A&&(F.length=0,T.length=0,o.push(I),o.push(E),a.push(B),m=_,g=w,_=I,w=E,C=0)}}for(let c=r.length-1;c>=0;c--)o=r[c],o.length==0&&(r.splice(c,1),this.polygonPool.free(o),a=n[c],n.splice(c,1),this.polygonIndicesPool.free(a));return r}static isConcave(t,e,s,r){let n=r[(e+t-1)%e]<<1,a=r[t]<<1,o=r[(t+1)%e]<<1;return!this.positiveArea(s[n],s[n+1],s[a],s[a+1],s[o],s[o+1])}static positiveArea(t,e,s,r,n,a){return t*(a-r)+s*(e-a)+n*(r-e)>=0}static winding(t,e,s,r,n,a){let o=s-t,h=r-e;return n*h-a*o+o*e-t*h>=0?1:-1}}class Ur{constructor(){x(this,"triangulator",new Gt);x(this,"clippingPolygon",new Array);x(this,"clipOutput",new Array);x(this,"clippedVertices",new Array);x(this,"clippedUVs",new Array);x(this,"clippedTriangles",new Array);x(this,"scratch",new Array);x(this,"clipAttachment",null);x(this,"clippingPolygons",null)}clipStart(t,e){if(this.clipAttachment)return 0;this.clipAttachment=e;let s=e.worldVerticesLength,r=Y.setArraySize(this.clippingPolygon,s);e.computeWorldVertices(t,0,s,r,0,2);let n=this.clippingPolygon;Ur.makeClockwise(n);let a=this.clippingPolygons=this.triangulator.decompose(n,this.triangulator.triangulate(n));for(let o=0,h=a.length;o<h;o++){let l=a[o];Ur.makeClockwise(l),l.push(l[0]),l.push(l[1])}return a.length}clipEndWithSlot(t){this.clipAttachment&&this.clipAttachment.endSlot==t.data&&this.clipEnd()}clipEnd(){this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)}isClipping(){return this.clipAttachment!=null}clipTriangles(t,e,s,r,n,a,o,h){let l,c,u,f,d,p;typeof e=="number"?(l=s,c=r,u=n,f=a,d=o,p=h):(l=e,c=s,u=r,f=n,d=a,p=o),u&&f&&d&&typeof p=="boolean"?this.clipTrianglesRender(t,l,c,u,f,d,p):this.clipTrianglesNoRender(t,l,c)}clipTrianglesNoRender(t,e,s){let r=this.clipOutput,n=this.clippedVertices,a=this.clippedTriangles,o=this.clippingPolygons,h=o.length,l=0;n.length=0,a.length=0;for(let c=0;c<s;c+=3){let u=e[c]<<1,f=t[u],d=t[u+1];u=e[c+1]<<1;let p=t[u],m=t[u+1];u=e[c+2]<<1;let g=t[u],_=t[u+1];for(let w=0;w<h;w++){let b=n.length;if(this.clip(f,d,p,m,g,_,o[w],r)){let y=r.length;if(y==0)continue;let S=y>>1,v=this.clipOutput,A=Y.setArraySize(n,b+S*2);for(let T=0;T<y;T+=2,b+=2){let P=v[T],M=v[T+1];A[b]=P,A[b+1]=M}b=a.length;let C=Y.setArraySize(a,b+3*(S-2));S--;for(let T=1;T<S;T++,b+=3)C[b]=l,C[b+1]=l+T,C[b+2]=l+T+1;l+=S+1}else{let y=Y.setArraySize(n,b+6);y[b]=f,y[b+1]=d,y[b+2]=p,y[b+3]=m,y[b+4]=g,y[b+5]=_,b=a.length;let S=Y.setArraySize(a,b+3);S[b]=l,S[b+1]=l+1,S[b+2]=l+2,l+=3;break}}}}clipTrianglesRender(t,e,s,r,n,a,o){let h=this.clipOutput,l=this.clippedVertices,c=this.clippedTriangles,u=this.clippingPolygons,f=u.length,d=o?12:8,p=0;l.length=0,c.length=0;for(let m=0;m<s;m+=3){let g=e[m]<<1,_=t[g],w=t[g+1],b=r[g],y=r[g+1];g=e[m+1]<<1;let S=t[g],v=t[g+1],A=r[g],C=r[g+1];g=e[m+2]<<1;let T=t[g],P=t[g+1],M=r[g],B=r[g+1];for(let F=0;F<f;F++){let I=l.length;if(this.clip(_,w,S,v,T,P,u[F],h)){let E=h.length;if(E==0)continue;let R=v-P,O=T-S,W=_-T,L=P-w,H=1/(R*W+O*(w-P)),Z=E>>1,J=this.clipOutput,z=Y.setArraySize(l,I+Z*d);for(let G=0;G<E;G+=2,I+=d){let gt=J[G],_t=J[G+1];z[I]=gt,z[I+1]=_t,z[I+2]=n.r,z[I+3]=n.g,z[I+4]=n.b,z[I+5]=n.a;let nt=gt-T,lt=_t-P,At=(R*nt+O*lt)*H,Qt=(L*nt+W*lt)*H,Ht=1-At-Qt;z[I+6]=b*At+A*Qt+M*Ht,z[I+7]=y*At+C*Qt+B*Ht,o&&(z[I+8]=a.r,z[I+9]=a.g,z[I+10]=a.b,z[I+11]=a.a)}I=c.length;let $=Y.setArraySize(c,I+3*(Z-2));Z--;for(let G=1;G<Z;G++,I+=3)$[I]=p,$[I+1]=p+G,$[I+2]=p+G+1;p+=Z+1}else{let E=Y.setArraySize(l,I+3*d);E[I]=_,E[I+1]=w,E[I+2]=n.r,E[I+3]=n.g,E[I+4]=n.b,E[I+5]=n.a,o?(E[I+6]=b,E[I+7]=y,E[I+8]=a.r,E[I+9]=a.g,E[I+10]=a.b,E[I+11]=a.a,E[I+12]=S,E[I+13]=v,E[I+14]=n.r,E[I+15]=n.g,E[I+16]=n.b,E[I+17]=n.a,E[I+18]=A,E[I+19]=C,E[I+20]=a.r,E[I+21]=a.g,E[I+22]=a.b,E[I+23]=a.a,E[I+24]=T,E[I+25]=P,E[I+26]=n.r,E[I+27]=n.g,E[I+28]=n.b,E[I+29]=n.a,E[I+30]=M,E[I+31]=B,E[I+32]=a.r,E[I+33]=a.g,E[I+34]=a.b,E[I+35]=a.a):(E[I+6]=b,E[I+7]=y,E[I+8]=S,E[I+9]=v,E[I+10]=n.r,E[I+11]=n.g,E[I+12]=n.b,E[I+13]=n.a,E[I+14]=A,E[I+15]=C,E[I+16]=T,E[I+17]=P,E[I+18]=n.r,E[I+19]=n.g,E[I+20]=n.b,E[I+21]=n.a,E[I+22]=M,E[I+23]=B),I=c.length;let R=Y.setArraySize(c,I+3);R[I]=p,R[I+1]=p+1,R[I+2]=p+2,p+=3;break}}}}clipTrianglesUnpacked(t,e,s,r){let n=this.clipOutput,a=this.clippedVertices,o=this.clippedUVs,h=this.clippedTriangles,l=this.clippingPolygons,c=l.length,u=0;a.length=0,o.length=0,h.length=0;for(let f=0;f<s;f+=3){let d=e[f]<<1,p=t[d],m=t[d+1],g=r[d],_=r[d+1];d=e[f+1]<<1;let w=t[d],b=t[d+1],y=r[d],S=r[d+1];d=e[f+2]<<1;let v=t[d],A=t[d+1],C=r[d],T=r[d+1];for(let P=0;P<c;P++){let M=a.length;if(this.clip(p,m,w,b,v,A,l[P],n)){let B=n.length;if(B==0)continue;let F=b-A,I=v-w,E=p-v,R=A-m,O=1/(F*E+I*(m-A)),W=B>>1,L=this.clipOutput,H=Y.setArraySize(a,M+W*2),Z=Y.setArraySize(o,M+W*2);for(let z=0;z<B;z+=2,M+=2){let $=L[z],G=L[z+1];H[M]=$,H[M+1]=G;let gt=$-v,_t=G-A,nt=(F*gt+I*_t)*O,lt=(R*gt+E*_t)*O,At=1-nt-lt;Z[M]=g*nt+y*lt+C*At,Z[M+1]=_*nt+S*lt+T*At}M=h.length;let J=Y.setArraySize(h,M+3*(W-2));W--;for(let z=1;z<W;z++,M+=3)J[M]=u,J[M+1]=u+z,J[M+2]=u+z+1;u+=W+1}else{let B=Y.setArraySize(a,M+6);B[M]=p,B[M+1]=m,B[M+2]=w,B[M+3]=b,B[M+4]=v,B[M+5]=A;let F=Y.setArraySize(o,M+3*2);F[M]=g,F[M+1]=_,F[M+2]=y,F[M+3]=S,F[M+4]=C,F[M+5]=T,M=h.length;let I=Y.setArraySize(h,M+3);I[M]=u,I[M+1]=u+1,I[M+2]=u+2,u+=3;break}}}}clip(t,e,s,r,n,a,o,h){let l=h,c=!1,u;o.length%4>=2?(u=h,h=this.scratch):u=this.scratch,u.length=0,u.push(t),u.push(e),u.push(s),u.push(r),u.push(n),u.push(a),u.push(t),u.push(e),h.length=0;let f=o.length-4,d=o;for(let p=0;;p+=2){let m=d[p],g=d[p+1],_=m-d[p+2],w=g-d[p+3],b=h.length,y=u;for(let v=0,A=u.length-2;v<A;){let C=y[v],T=y[v+1];v+=2;let P=y[v],M=y[v+1],B=w*(m-P)>_*(g-M),F=w*(m-C)-_*(g-T);if(F>0){if(B){h.push(P),h.push(M);continue}let I=P-C,E=M-T,R=F/(I*w-E*_);if(R>=0&&R<=1)h.push(C+I*R),h.push(T+E*R);else{h.push(P),h.push(M);continue}}else if(B){let I=P-C,E=M-T,R=F/(I*w-E*_);if(R>=0&&R<=1)h.push(C+I*R),h.push(T+E*R),h.push(P),h.push(M);else{h.push(P),h.push(M);continue}}c=!0}if(b==h.length)return l.length=0,!0;if(h.push(h[0]),h.push(h[1]),p==f)break;let S=h;h=u,h.length=0,u=S}if(l!=h){l.length=0;for(let p=0,m=h.length-2;p<m;p++)l[p]=h[p]}else l.length=l.length-2;return c}static makeClockwise(t){let e=t,s=t.length,r=e[s-2]*e[1]-e[0]*e[s-1],n=0,a=0,o=0,h=0;for(let l=0,c=s-3;l<c;l+=2)n=e[l],a=e[l+1],o=e[l+2],h=e[l+3],r+=n*h-o*a;if(!(r<0))for(let l=0,c=s-2,u=s>>1;l<u;l+=2){let f=e[l],d=e[l+1],p=c-l;e[l]=e[p],e[l+1]=e[p+1],e[p]=f,e[p+1]=d}}}class j1{constructor(t){x(this,"attachmentLoader");x(this,"scale",1);x(this,"linkedMeshes",new Array);this.attachmentLoader=t}readSkeletonData(t){let e=this.scale,s=new Nr,r=typeof t=="string"?JSON.parse(t):t,n=r.skeleton;if(n&&(s.hash=n.hash,s.version=n.spine,s.x=n.x,s.y=n.y,s.width=n.width,s.height=n.height,s.referenceScale=k(n,"referenceScale",100)*e,s.fps=n.fps,s.imagesPath=n.images??null,s.audioPath=n.audio??null),r.bones)for(let a=0;a<r.bones.length;a++){let o=r.bones[a],h=null,l=k(o,"parent",null);l&&(h=s.findBone(l));let c=new Df(s.bones.length,o.name,h);c.length=k(o,"length",0)*e,c.x=k(o,"x",0)*e,c.y=k(o,"y",0)*e,c.rotation=k(o,"rotation",0),c.scaleX=k(o,"scaleX",1),c.scaleY=k(o,"scaleY",1),c.shearX=k(o,"shearX",0),c.shearY=k(o,"shearY",0),c.inherit=Y.enumValue(yt,k(o,"inherit","Normal")),c.skinRequired=k(o,"skin",!1);let u=k(o,"color",null);u&&c.color.setFromString(u),s.bones.push(c)}if(r.slots)for(let a=0;a<r.slots.length;a++){let o=r.slots[a],h=o.name,l=s.findBone(o.bone);if(!l)throw new Error(`Couldn't find bone ${o.bone} for slot ${h}`);let c=new Wf(s.slots.length,h,l),u=k(o,"color",null);u&&c.color.setFromString(u);let f=k(o,"dark",null);f&&(c.darkColor=K.fromString(f)),c.attachmentName=k(o,"attachment",null),c.blendMode=Y.enumValue(Ze,k(o,"blend","normal")),c.visible=k(o,"visible",!0),s.slots.push(c)}if(r.ik)for(let a=0;a<r.ik.length;a++){let o=r.ik[a],h=new zf(o.name);h.order=k(o,"order",0),h.skinRequired=k(o,"skin",!1);for(let c=0;c<o.bones.length;c++){let u=s.findBone(o.bones[c]);if(!u)throw new Error(`Couldn't find bone ${o.bones[c]} for IK constraint ${o.name}.`);h.bones.push(u)}let l=s.findBone(o.target);if(!l)throw new Error(`Couldn't find target bone ${o.target} for IK constraint ${o.name}.`);h.target=l,h.mix=k(o,"mix",1),h.softness=k(o,"softness",0)*e,h.bendDirection=k(o,"bendPositive",!0)?1:-1,h.compress=k(o,"compress",!1),h.stretch=k(o,"stretch",!1),h.uniform=k(o,"uniform",!1),s.ikConstraints.push(h)}if(r.transform)for(let a=0;a<r.transform.length;a++){let o=r.transform[a],h=new Gf(o.name);h.order=k(o,"order",0),h.skinRequired=k(o,"skin",!1);for(let u=0;u<o.bones.length;u++){let f=o.bones[u],d=s.findBone(f);if(!d)throw new Error(`Couldn't find bone ${f} for transform constraint ${o.name}.`);h.bones.push(d)}let l=o.target,c=s.findBone(l);if(!c)throw new Error(`Couldn't find target bone ${l} for transform constraint ${o.name}.`);h.target=c,h.local=k(o,"local",!1),h.relative=k(o,"relative",!1),h.offsetRotation=k(o,"rotation",0),h.offsetX=k(o,"x",0)*e,h.offsetY=k(o,"y",0)*e,h.offsetScaleX=k(o,"scaleX",0),h.offsetScaleY=k(o,"scaleY",0),h.offsetShearY=k(o,"shearY",0),h.mixRotate=k(o,"mixRotate",1),h.mixX=k(o,"mixX",1),h.mixY=k(o,"mixY",h.mixX),h.mixScaleX=k(o,"mixScaleX",1),h.mixScaleY=k(o,"mixScaleY",h.mixScaleX),h.mixShearY=k(o,"mixShearY",1),s.transformConstraints.push(h)}if(r.path)for(let a=0;a<r.path.length;a++){let o=r.path[a],h=new Nf(o.name);h.order=k(o,"order",0),h.skinRequired=k(o,"skin",!1);for(let u=0;u<o.bones.length;u++){let f=o.bones[u],d=s.findBone(f);if(!d)throw new Error(`Couldn't find bone ${f} for path constraint ${o.name}.`);h.bones.push(d)}let l=o.target,c=s.findSlot(l);if(!c)throw new Error(`Couldn't find target slot ${l} for path constraint ${o.name}.`);h.target=c,h.positionMode=Y.enumValue(Pe,k(o,"positionMode","Percent")),h.spacingMode=Y.enumValue(It,k(o,"spacingMode","Length")),h.rotateMode=Y.enumValue(fs,k(o,"rotateMode","Tangent")),h.offsetRotation=k(o,"rotation",0),h.position=k(o,"position",0),h.positionMode==Pe.Fixed&&(h.position*=e),h.spacing=k(o,"spacing",0),(h.spacingMode==It.Length||h.spacingMode==It.Fixed)&&(h.spacing*=e),h.mixRotate=k(o,"mixRotate",1),h.mixX=k(o,"mixX",1),h.mixY=k(o,"mixY",h.mixX),s.pathConstraints.push(h)}if(r.physics)for(let a=0;a<r.physics.length;a++){const o=r.physics[a],h=new Uf(o.name);h.order=k(o,"order",0),h.skinRequired=k(o,"skin",!1);const l=o.bone,c=s.findBone(l);if(c==null)throw new Error("Physics bone not found: "+l);h.bone=c,h.x=k(o,"x",0),h.y=k(o,"y",0),h.rotate=k(o,"rotate",0),h.scaleX=k(o,"scaleX",0),h.shearX=k(o,"shearX",0),h.limit=k(o,"limit",5e3)*e,h.step=1/k(o,"fps",60),h.inertia=k(o,"inertia",1),h.strength=k(o,"strength",100),h.damping=k(o,"damping",1),h.massInverse=1/k(o,"mass",1),h.wind=k(o,"wind",0),h.gravity=k(o,"gravity",0),h.mix=k(o,"mix",1),h.inertiaGlobal=k(o,"inertiaGlobal",!1),h.strengthGlobal=k(o,"strengthGlobal",!1),h.dampingGlobal=k(o,"dampingGlobal",!1),h.massGlobal=k(o,"massGlobal",!1),h.windGlobal=k(o,"windGlobal",!1),h.gravityGlobal=k(o,"gravityGlobal",!1),h.mixGlobal=k(o,"mixGlobal",!1),s.physicsConstraints.push(h)}if(r.skins)for(let a=0;a<r.skins.length;a++){let o=r.skins[a],h=new Ya(o.name);if(o.bones)for(let l=0;l<o.bones.length;l++){let c=o.bones[l],u=s.findBone(c);if(!u)throw new Error(`Couldn't find bone ${c} for skin ${o.name}.`);h.bones.push(u)}if(o.ik)for(let l=0;l<o.ik.length;l++){let c=o.ik[l],u=s.findIkConstraint(c);if(!u)throw new Error(`Couldn't find IK constraint ${c} for skin ${o.name}.`);h.constraints.push(u)}if(o.transform)for(let l=0;l<o.transform.length;l++){let c=o.transform[l],u=s.findTransformConstraint(c);if(!u)throw new Error(`Couldn't find transform constraint ${c} for skin ${o.name}.`);h.constraints.push(u)}if(o.path)for(let l=0;l<o.path.length;l++){let c=o.path[l],u=s.findPathConstraint(c);if(!u)throw new Error(`Couldn't find path constraint ${c} for skin ${o.name}.`);h.constraints.push(u)}if(o.physics)for(let l=0;l<o.physics.length;l++){let c=o.physics[l],u=s.findPhysicsConstraint(c);if(!u)throw new Error(`Couldn't find physics constraint ${c} for skin ${o.name}.`);h.constraints.push(u)}for(let l in o.attachments){let c=s.findSlot(l);if(!c)throw new Error(`Couldn't find slot ${l} for skin ${o.name}.`);let u=o.attachments[l];for(let f in u){let d=this.readAttachment(u[f],h,c.index,f,s);d&&h.setAttachment(c.index,f,d)}}s.skins.push(h),h.name=="default"&&(s.defaultSkin=h)}for(let a=0,o=this.linkedMeshes.length;a<o;a++){let h=this.linkedMeshes[a],l=h.skin?s.findSkin(h.skin):s.defaultSkin;if(!l)throw new Error(`Skin not found: ${h.skin}`);let c=l.getAttachment(h.slotIndex,h.parent);if(!c)throw new Error(`Parent mesh not found: ${h.parent}`);h.mesh.timelineAttachment=h.inheritTimeline?c:h.mesh,h.mesh.setParentMesh(c),h.mesh.region!=null&&h.mesh.updateRegion()}if(this.linkedMeshes.length=0,r.events)for(let a in r.events){let o=r.events[a],h=new Xf(a);h.intValue=k(o,"int",0),h.floatValue=k(o,"float",0),h.stringValue=k(o,"string",""),h.audioPath=k(o,"audio",null),h.audioPath&&(h.volume=k(o,"volume",1),h.balance=k(o,"balance",0)),s.events.push(h)}if(r.animations)for(let a in r.animations){let o=r.animations[a];this.readAnimation(o,a,s)}return s}readAttachment(t,e,s,r,n){let a=this.scale;switch(r=k(t,"name",r),k(t,"type","region")){case"region":{let o=k(t,"path",r),h=this.readSequence(k(t,"sequence",null)),l=this.attachmentLoader.newRegionAttachment(e,r,o,h);if(!l)return null;l.path=o,l.x=k(t,"x",0)*a,l.y=k(t,"y",0)*a,l.scaleX=k(t,"scaleX",1),l.scaleY=k(t,"scaleY",1),l.rotation=k(t,"rotation",0),l.width=t.width*a,l.height=t.height*a,l.sequence=h;let c=k(t,"color",null);return c&&l.color.setFromString(c),l.region!=null&&l.updateRegion(),l}case"boundingbox":{let o=this.attachmentLoader.newBoundingBoxAttachment(e,r);if(!o)return null;this.readVertices(t,o,t.vertexCount<<1);let h=k(t,"color",null);return h&&o.color.setFromString(h),o}case"mesh":case"linkedmesh":{let o=k(t,"path",r),h=this.readSequence(k(t,"sequence",null)),l=this.attachmentLoader.newMeshAttachment(e,r,o,h);if(!l)return null;l.path=o;let c=k(t,"color",null);c&&l.color.setFromString(c),l.width=k(t,"width",0)*a,l.height=k(t,"height",0)*a,l.sequence=h;let u=k(t,"parent",null);if(u)return this.linkedMeshes.push(new q1(l,k(t,"skin",null),s,u,k(t,"timelines",!0))),l;let f=t.uvs;return this.readVertices(t,l,f.length),l.triangles=t.triangles,l.regionUVs=f,l.region!=null&&l.updateRegion(),l.edges=k(t,"edges",null),l.hullLength=k(t,"hull",0)*2,l}case"path":{let o=this.attachmentLoader.newPathAttachment(e,r);if(!o)return null;o.closed=k(t,"closed",!1),o.constantSpeed=k(t,"constantSpeed",!0);let h=t.vertexCount;this.readVertices(t,o,h<<1);let l=Y.newArray(h/3,0);for(let u=0;u<t.lengths.length;u++)l[u]=t.lengths[u]*a;o.lengths=l;let c=k(t,"color",null);return c&&o.color.setFromString(c),o}case"point":{let o=this.attachmentLoader.newPointAttachment(e,r);if(!o)return null;o.x=k(t,"x",0)*a,o.y=k(t,"y",0)*a,o.rotation=k(t,"rotation",0);let h=k(t,"color",null);return h&&o.color.setFromString(h),o}case"clipping":{let o=this.attachmentLoader.newClippingAttachment(e,r);if(!o)return null;let h=k(t,"end",null);h&&(o.endSlot=n.findSlot(h));let l=t.vertexCount;this.readVertices(t,o,l<<1);let c=k(t,"color",null);return c&&o.color.setFromString(c),o}}return null}readSequence(t){if(t==null)return null;let e=new Dr(k(t,"count",0));return e.start=k(t,"start",1),e.digits=k(t,"digits",0),e.setupIndex=k(t,"setup",0),e}readVertices(t,e,s){let r=this.scale;e.worldVerticesLength=s;let n=t.vertices;if(s==n.length){let h=Y.toFloatArray(n);if(r!=1)for(let l=0,c=n.length;l<c;l++)h[l]*=r;e.vertices=h;return}let a=new Array,o=new Array;for(let h=0,l=n.length;h<l;){let c=n[h++];o.push(c);for(let u=h+c*4;h<u;h+=4)o.push(n[h]),a.push(n[h+1]*r),a.push(n[h+2]*r),a.push(n[h+3])}e.bones=o,e.vertices=Y.toFloatArray(a)}readAnimation(t,e,s){let r=this.scale,n=new Array;if(t.slots)for(let o in t.slots){let h=t.slots[o],l=s.findSlot(o);if(!l)throw new Error("Slot not found: "+o);let c=l.index;for(let u in h){let f=h[u];if(!f)continue;let d=f.length;if(u=="attachment"){let p=new Is(d,c);for(let m=0;m<d;m++){let g=f[m];p.setFrame(m,k(g,"time",0),k(g,"name",null))}n.push(p)}else if(u=="rgba"){let p=new bf(d,d<<2,c),m=f[0],g=k(m,"time",0),_=K.fromString(m.color);for(let w=0,b=0;;w++){p.setFrame(w,g,_.r,_.g,_.b,_.a);let y=f[w+1];if(!y){p.shrink(b);break}let S=k(y,"time",0),v=K.fromString(y.color),A=m.curve;A&&(b=it(A,p,b,w,0,g,S,_.r,v.r,1),b=it(A,p,b,w,1,g,S,_.g,v.g,1),b=it(A,p,b,w,2,g,S,_.b,v.b,1),b=it(A,p,b,w,3,g,S,_.a,v.a,1)),g=S,_=v,m=y}n.push(p)}else if(u=="rgb"){let p=new _f(d,d*3,c),m=f[0],g=k(m,"time",0),_=K.fromString(m.color);for(let w=0,b=0;;w++){p.setFrame(w,g,_.r,_.g,_.b);let y=f[w+1];if(!y){p.shrink(b);break}let S=k(y,"time",0),v=K.fromString(y.color),A=m.curve;A&&(b=it(A,p,b,w,0,g,S,_.r,v.r,1),b=it(A,p,b,w,1,g,S,_.g,v.g,1),b=it(A,p,b,w,2,g,S,_.b,v.b,1)),g=S,_=v,m=y}n.push(p)}else if(u=="alpha")n.push(le(f,new wf(d,d,c),0,1));else if(u=="rgba2"){let p=new vf(d,d*7,c),m=f[0],g=k(m,"time",0),_=K.fromString(m.light),w=K.fromString(m.dark);for(let b=0,y=0;;b++){p.setFrame(b,g,_.r,_.g,_.b,_.a,w.r,w.g,w.b);let S=f[b+1];if(!S){p.shrink(y);break}let v=k(S,"time",0),A=K.fromString(S.light),C=K.fromString(S.dark),T=m.curve;T&&(y=it(T,p,y,b,0,g,v,_.r,A.r,1),y=it(T,p,y,b,1,g,v,_.g,A.g,1),y=it(T,p,y,b,2,g,v,_.b,A.b,1),y=it(T,p,y,b,3,g,v,_.a,A.a,1),y=it(T,p,y,b,4,g,v,w.r,C.r,1),y=it(T,p,y,b,5,g,v,w.g,C.g,1),y=it(T,p,y,b,6,g,v,w.b,C.b,1)),g=v,_=A,w=C,m=S}n.push(p)}else if(u=="rgb2"){let p=new Sf(d,d*6,c),m=f[0],g=k(m,"time",0),_=K.fromString(m.light),w=K.fromString(m.dark);for(let b=0,y=0;;b++){p.setFrame(b,g,_.r,_.g,_.b,w.r,w.g,w.b);let S=f[b+1];if(!S){p.shrink(y);break}let v=k(S,"time",0),A=K.fromString(S.light),C=K.fromString(S.dark),T=m.curve;T&&(y=it(T,p,y,b,0,g,v,_.r,A.r,1),y=it(T,p,y,b,1,g,v,_.g,A.g,1),y=it(T,p,y,b,2,g,v,_.b,A.b,1),y=it(T,p,y,b,3,g,v,w.r,C.r,1),y=it(T,p,y,b,4,g,v,w.g,C.g,1),y=it(T,p,y,b,5,g,v,w.b,C.b,1)),g=v,_=A,w=C,m=S}n.push(p)}}}if(t.bones)for(let o in t.bones){let h=t.bones[o],l=s.findBone(o);if(!l)throw new Error("Bone not found: "+o);let c=l.index;for(let u in h){let f=h[u],d=f.length;if(d!=0){if(u==="rotate")n.push(le(f,new Yr(d,d,c),0,1));else if(u==="translate"){let p=new hf(d,d<<1,c);n.push(Jn(f,p,"x","y",0,r))}else if(u==="translatex"){let p=new cf(d,d,c);n.push(le(f,p,0,r))}else if(u==="translatey"){let p=new uf(d,d,c);n.push(le(f,p,0,r))}else if(u==="scale"){let p=new df(d,d<<1,c);n.push(Jn(f,p,"x","y",1,1))}else if(u==="scalex"){let p=new ff(d,d,c);n.push(le(f,p,1,1))}else if(u==="scaley"){let p=new pf(d,d,c);n.push(le(f,p,1,1))}else if(u==="shear"){let p=new mf(d,d<<1,c);n.push(Jn(f,p,"x","y",0,1))}else if(u==="shearx"){let p=new gf(d,d,c);n.push(le(f,p,0,1))}else if(u==="sheary"){let p=new xf(d,d,c);n.push(le(f,p,0,1))}else if(u==="inherit"){let p=new yf(d,l.index);for(let m=0;m<f.length;m++){let g=f[m];p.setFrame(m,k(g,"time",0),Y.enumValue(yt,k(g,"inherit","Normal")))}n.push(p)}}}}if(t.ik)for(let o in t.ik){let h=t.ik[o],l=h[0];if(!l)continue;let c=s.findIkConstraint(o);if(!c)throw new Error("IK Constraint not found: "+o);let u=s.ikConstraints.indexOf(c),f=new Cf(h.length,h.length<<1,u),d=k(l,"time",0),p=k(l,"mix",1),m=k(l,"softness",0)*r;for(let g=0,_=0;;g++){f.setFrame(g,d,p,m,k(l,"bendPositive",!0)?1:-1,k(l,"compress",!1),k(l,"stretch",!1));let w=h[g+1];if(!w){f.shrink(_);break}let b=k(w,"time",0),y=k(w,"mix",1),S=k(w,"softness",0)*r,v=l.curve;v&&(_=it(v,f,_,g,0,d,b,p,y,1),_=it(v,f,_,g,1,d,b,m,S,r)),d=b,p=y,m=S,l=w}n.push(f)}if(t.transform)for(let o in t.transform){let h=t.transform[o],l=h[0];if(!l)continue;let c=s.findTransformConstraint(o);if(!c)throw new Error("Transform constraint not found: "+o);let u=s.transformConstraints.indexOf(c),f=new Tf(h.length,h.length*6,u),d=k(l,"time",0),p=k(l,"mixRotate",1),m=k(l,"mixX",1),g=k(l,"mixY",m),_=k(l,"mixScaleX",1),w=k(l,"mixScaleY",_),b=k(l,"mixShearY",1);for(let y=0,S=0;;y++){f.setFrame(y,d,p,m,g,_,w,b);let v=h[y+1];if(!v){f.shrink(S);break}let A=k(v,"time",0),C=k(v,"mixRotate",1),T=k(v,"mixX",1),P=k(v,"mixY",T),M=k(v,"mixScaleX",1),B=k(v,"mixScaleY",M),F=k(v,"mixShearY",1),I=l.curve;I&&(S=it(I,f,S,y,0,d,A,p,C,1),S=it(I,f,S,y,1,d,A,m,T,1),S=it(I,f,S,y,2,d,A,g,P,1),S=it(I,f,S,y,3,d,A,_,M,1),S=it(I,f,S,y,4,d,A,w,B,1),S=it(I,f,S,y,5,d,A,b,F,1)),d=A,p=C,m=T,g=P,_=M,w=B,_=M,l=v}n.push(f)}if(t.path)for(let o in t.path){let h=t.path[o],l=s.findPathConstraint(o);if(!l)throw new Error("Path constraint not found: "+o);let c=s.pathConstraints.indexOf(l);for(let u in h){let f=h[u],d=f[0];if(!d)continue;let p=f.length;if(u==="position"){let m=new Mf(p,p,c);n.push(le(f,m,0,l.positionMode==Pe.Fixed?r:1))}else if(u==="spacing"){let m=new Pf(p,p,c);n.push(le(f,m,0,l.spacingMode==It.Length||l.spacingMode==It.Fixed?r:1))}else if(u==="mix"){let m=new kf(p,p*3,c),g=k(d,"time",0),_=k(d,"mixRotate",1),w=k(d,"mixX",1),b=k(d,"mixY",w);for(let y=0,S=0;;y++){m.setFrame(y,g,_,w,b);let v=f[y+1];if(!v){m.shrink(S);break}let A=k(v,"time",0),C=k(v,"mixRotate",1),T=k(v,"mixX",1),P=k(v,"mixY",T),M=d.curve;M&&(S=it(M,m,S,y,0,g,A,_,C,1),S=it(M,m,S,y,1,g,A,w,T,1),S=it(M,m,S,y,2,g,A,b,P,1)),g=A,_=C,w=T,b=P,d=v}n.push(m)}}}if(t.physics)for(let o in t.physics){let h=t.physics[o],l=-1;if(o.length>0){let c=s.findPhysicsConstraint(o);if(!c)throw new Error("Physics constraint not found: "+o);l=s.physicsConstraints.indexOf(c)}for(let c in h){let u=h[c],f=u[0];if(!f)continue;let d=u.length;if(c=="reset"){const m=new Xr(d,l);for(let g=0;f!=null;f=u[g+1],g++)m.setFrame(g,k(f,"time",0));n.push(m);continue}let p;if(c=="inertia")p=new If(d,d,l);else if(c=="strength")p=new Ff(d,d,l);else if(c=="damping")p=new Ef(d,d,l);else if(c=="mass")p=new Bf(d,d,l);else if(c=="wind")p=new Rf(d,d,l);else if(c=="gravity")p=new Vf(d,d,l);else if(c=="mix")p=new Of(d,d,l);else continue;n.push(le(u,p,0,1))}}if(t.attachments)for(let o in t.attachments){let h=t.attachments[o],l=s.findSkin(o);if(!l)throw new Error("Skin not found: "+o);for(let c in h){let u=h[c],f=s.findSlot(c);if(!f)throw new Error("Slot not found: "+c);let d=f.index;for(let p in u){let m=u[p],g=l.getAttachment(d,p);for(let _ in m){let w=m[_],b=w[0];if(b){if(_=="deform"){let y=g.bones,S=g.vertices,v=y?S.length/3*2:S.length,A=new Af(w.length,w.length,d,g),C=k(b,"time",0);for(let T=0,P=0;;T++){let M,B=k(b,"vertices",null);if(!B)M=y?Y.newFloatArray(v):S;else{M=Y.newFloatArray(v);let R=k(b,"offset",0);if(Y.arrayCopy(B,0,M,R,B.length),r!=1)for(let O=R,W=O+B.length;O<W;O++)M[O]*=r;if(!y)for(let O=0;O<v;O++)M[O]+=S[O]}A.setFrame(T,C,M);let F=w[T+1];if(!F){A.shrink(P);break}let I=k(F,"time",0),E=b.curve;E&&(P=it(E,A,P,T,0,C,I,0,1,1)),C=I,b=F}n.push(A)}else if(_=="sequence"){let y=new zr(w.length,d,g),S=0;for(let v=0;v<w.length;v++){let A=k(b,"delay",S),C=k(b,"time",0),T=Rt[k(b,"mode","hold")],P=k(b,"index",0);y.setFrame(v,C,T,P,A),S=A,b=w[v+1]}n.push(y)}}}}}}if(t.drawOrder){let o=new us(t.drawOrder.length),h=s.slots.length,l=0;for(let c=0;c<t.drawOrder.length;c++,l++){let u=t.drawOrder[c],f=null,d=k(u,"offsets",null);if(d){f=Y.newArray(h,-1);let p=Y.newArray(h-d.length,0),m=0,g=0;for(let _=0;_<d.length;_++){let w=d[_],b=s.findSlot(w.slot);if(!b)throw new Error("Slot not found: "+b);let y=b.index;for(;m!=y;)p[g++]=m++;f[m+w.offset]=m++}for(;m<h;)p[g++]=m++;for(let _=h-1;_>=0;_--)f[_]==-1&&(f[_]=p[--g])}o.setFrame(l,k(u,"time",0),f)}n.push(o)}if(t.events){let o=new Ui(t.events.length),h=0;for(let l=0;l<t.events.length;l++,h++){let c=t.events[l],u=s.findEvent(c.name);if(!u)throw new Error("Event not found: "+c.name);let f=new Yf(Y.toSinglePrecision(k(c,"time",0)),u);f.intValue=k(c,"int",u.intValue),f.floatValue=k(c,"float",u.floatValue),f.stringValue=k(c,"string",u.stringValue),f.data.audioPath&&(f.volume=k(c,"volume",1),f.balance=k(c,"balance",0)),o.setFrame(h,f)}n.push(o)}let a=0;for(let o=0,h=n.length;o<h;o++)a=Math.max(a,n[o].getDuration());s.animations.push(new Po(e,n,a))}}class q1{constructor(t,e,s,r,n){x(this,"parent");x(this,"skin");x(this,"slotIndex");x(this,"mesh");x(this,"inheritTimeline");this.mesh=t,this.skin=e,this.slotIndex=s,this.parent=r,this.inheritTimeline=n}}function le(i,t,e,s){let r=i[0],n=k(r,"time",0),a=k(r,"value",e)*s,o=0;for(let h=0;;h++){t.setFrame(h,n,a);let l=i[h+1];if(!l)return t.shrink(o),t;let c=k(l,"time",0),u=k(l,"value",e)*s;r.curve&&(o=it(r.curve,t,o,h,0,n,c,a,u,s)),n=c,a=u,r=l}}function Jn(i,t,e,s,r,n){let a=i[0],o=k(a,"time",0),h=k(a,e,r)*n,l=k(a,s,r)*n,c=0;for(let u=0;;u++){t.setFrame(u,o,h,l);let f=i[u+1];if(!f)return t.shrink(c),t;let d=k(f,"time",0),p=k(f,e,r)*n,m=k(f,s,r)*n,g=a.curve;g&&(c=it(g,t,c,u,0,o,d,h,p,n),c=it(g,t,c,u,1,o,d,l,m,n)),o=d,h=p,l=m,a=f}}function it(i,t,e,s,r,n,a,o,h,l){if(i=="stepped")return t.setStepped(s),e;let c=r<<2,u=i[c],f=i[c+1]*l,d=i[c+2],p=i[c+3]*l;return t.setBezier(e,s,r,n,o,u,f,d,p,a,h),e+1}function k(i,t,e){return i[t]!==void 0?i[t]:e}typeof Math.fround>"u"&&(Math.fround=function(i){return function(t){return i[0]=t,i[0]}}(new Float32Array(1)));const he=class he extends i1{constructor(e){super(e.resource);x(this,"texture");this.texture=U.from(e)}static from(e){return he.textureMap.has(e)?he.textureMap.get(e):new he(e)}setFilters(e,s){const r=this.texture.source.style;r.minFilter=he.toPixiTextureFilter(e),r.magFilter=he.toPixiTextureFilter(s),this.texture.source.autoGenerateMipmaps=he.toPixiMipMap(e),this.texture.source.updateMipmaps()}setWraps(e,s){const r=this.texture.source.style;r.addressModeU=he.toPixiTextureWrap(e),r.addressModeV=he.toPixiTextureWrap(s)}dispose(){this.texture.destroy()}static toPixiMipMap(e){switch(e){case Et.Nearest:case Et.Linear:return!1;case Et.MipMapNearestLinear:case Et.MipMapNearestNearest:case Et.MipMapLinearLinear:case Et.MipMapLinearNearest:return!0;default:throw new Error(`Unknown texture filter: ${String(e)}`)}}static toPixiTextureFilter(e){switch(e){case Et.Nearest:case Et.MipMapNearestLinear:case Et.MipMapNearestNearest:return"nearest";case Et.Linear:case Et.MipMapLinearLinear:case Et.MipMapLinearNearest:return"linear";default:throw new Error(`Unknown texture filter: ${String(e)}`)}}static toPixiTextureWrap(e){switch(e){case De.ClampToEdge:return"clamp-to-edge";case De.MirroredRepeat:return"mirror-repeat";case De.Repeat:return"repeat";default:throw new Error(`Unknown texture wrap: ${String(e)}`)}}static toPixiBlending(e){switch(e){case Ze.Normal:return"normal";case Ze.Additive:return"add";case Ze.Multiply:return"multiply";case Ze.Screen:return"screen";default:throw new Error(`Unknown blendMode: ${String(e)}`)}}};x(he,"textureMap",new Map);let Wr=he;const K1={extension:X.Asset,resolver:{test:i=>ne(i,".atlas"),parse:i=>{var e,s;const t=i.split(".");return{resolution:parseFloat(((s=(e=xs.RETINA_PREFIX)==null?void 0:e.exec(i))==null?void 0:s[1])??"1"),format:t[t.length-2],src:i}}},loader:{extension:{type:X.LoadParser,priority:ge.Normal,name:"spineTextureAtlasLoader"},test(i){return ne(i,".atlas")},async load(i){return await(await ut.get().fetch(i)).text()},testParse(i,t){const e=ne(t.src,".atlas"),s=typeof i=="string";return Promise.resolve(e&&s)},unload(i){i.dispose()},async parse(i,t,e){const s=t.data||{};let r=Mt.dirname(t.src);r&&r.lastIndexOf("/")!==r.length-1&&(r+="/");const n=new n1(i);if(s.images instanceof Kt||typeof s.images=="string"){const o=s.images;s.images={},s.images[n.pages[0].name]=o}const a=[];for(const o of n.pages){const h=o.name,l=s!=null&&s.images?s.images[h]:void 0;if(l instanceof Kt)o.setTexture(Wr.from(l));else{const c=l??Mt.normalize([...r.split(Mt.sep),h].join(Mt.sep)),u={src:Mr(c,t.src),data:{...s.imageMetadata,alphaMode:o.pma?"premultiplied-alpha":"premultiply-alpha-on-upload"}},f=e.load(u).then(d=>{o.setTexture(Wr.from(d.source))});a.push(f)}}return await Promise.all(a),n}}};at.add(K1);function Z1(i){return Object.prototype.hasOwnProperty.call(i,"bones")}function Q1(i){return i instanceof Uint8Array}const J1={extension:X.Asset,loader:{extension:{type:X.LoadParser,priority:ge.Normal,name:"spineSkeletonLoader"},test(i){return ne(i,".skel")},async load(i){const t=await ut.get().fetch(i);return new Uint8Array(await t.arrayBuffer())},testParse(i,t){const e=ne(t.src,".json")&&Z1(i),s=ne(t.src,".skel")&&Q1(i);return Promise.resolve(e||s)}}};at.add(J1);const tv=new Float32Array(1),ev=new Uint32Array(1);class sv extends Ja{constructor(){const e=new Te({data:tv,label:"attribute-batch-buffer",usage:ft.VERTEX|ft.COPY_DST,shrinkToFit:!1}),s=new Te({data:ev,label:"index-batch-buffer",usage:ft.INDEX|ft.COPY_DST,shrinkToFit:!1}),r=7*4;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:r,offset:0},aUV:{buffer:e,format:"float32x2",stride:r,offset:2*4},aColor:{buffer:e,format:"unorm8x4",stride:r,offset:4*4},aDarkColor:{buffer:e,format:"unorm8x4",stride:r,offset:5*4},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:r,offset:6*4}},indexBuffer:s})}}const iv={name:"color-bit",vertex:{header:`
            @in aDarkColor: vec4<f32>;
            @out vDarkColor: vec4<f32>;
        `,main:`
        vDarkColor = aDarkColor;
        `},fragment:{header:`
            @in vDarkColor: vec4<f32>;
        `,end:`

        let alpha = outColor.a * vColor.a;
        let rgb = ((outColor.a - 1.0) * vDarkColor.a + 1.0 - outColor.rgb) * vDarkColor.rgb + outColor.rgb * vColor.rgb;

        finalColor = vec4<f32>(rgb, alpha);

        `}},rv={name:"color-bit",vertex:{header:`
            in vec4 aDarkColor;
            out vec4 vDarkColor;
        `,main:`
            vDarkColor = aDarkColor;
        `},fragment:{header:`
            in vec4 vDarkColor;
        `,end:`

        finalColor.a = outColor.a * vColor.a;
        finalColor.rgb = ((outColor.a - 1.0) * vDarkColor.a + 1.0 - outColor.rgb) * vDarkColor.rgb + outColor.rgb * vColor.rgb;
        `}};class nv extends $i{constructor(t){const e=hu({name:"dark-tint-batch",bits:[uu,rv,fu(t),mu]}),s=lu({name:"dark-tint-batch",bits:[cu,iv,du(t),pu]});super({glProgram:e,gpuProgram:s,resources:{batchSamplers:gu(t)}})}}let jh=null;const Qr=class Qr extends ru{constructor(){super(...arguments);x(this,"geometry",new sv);x(this,"shader",jh||(jh=new nv(this.maxTextures)));x(this,"name",Qr.extension.name);x(this,"vertexSize",7)}packAttributes(e,s,r,n,a){const o=a<<16|e.roundPixels&65535,h=e.transform,l=h.a,c=h.b,u=h.c,f=h.d,d=h.tx,p=h.ty,{positions:m,uvs:g}=e,_=e.color,w=(_>>24&255)/255,b=St.shared.setValue(e.darkColor).premultiply(w,!0).toPremultiplied(1,!1),y=e.attributeOffset,S=y+e.attributeSize;for(let v=y;v<S;v++){const A=v*2,C=m[A],T=m[A+1];s[n++]=l*C+u*T+d,s[n++]=f*T+c*C+p,s[n++]=g[A],s[n++]=g[A+1],r[n++]=_,r[n++]=b,r[n++]=o}}packQuadAttributes(e,s,r,n,a){const o=e.texture,h=e.transform,l=h.a,c=h.b,u=h.c,f=h.d,d=h.tx,p=h.ty,m=e.bounds,g=m.maxX,_=m.minX,w=m.maxY,b=m.minY,y=o.uvs,S=e.color,v=e.darkColor,A=a<<16|e.roundPixels&65535;s[n+0]=l*_+u*b+d,s[n+1]=f*b+c*_+p,s[n+2]=y.x0,s[n+3]=y.y0,r[n+4]=S,r[n+5]=v,r[n+6]=A,s[n+7]=l*g+u*b+d,s[n+8]=f*b+c*g+p,s[n+9]=y.x1,s[n+10]=y.y1,r[n+11]=S,r[n+12]=v,r[n+13]=A,s[n+14]=l*g+u*w+d,s[n+15]=f*w+c*g+p,s[n+16]=y.x2,s[n+17]=y.y2,r[n+18]=S,r[n+19]=v,r[n+20]=A,s[n+21]=l*_+u*w+d,s[n+22]=f*w+c*_+p,s[n+23]=y.x3,s[n+24]=y.y3,r[n+25]=S,r[n+26]=v,r[n+27]=A}};x(Qr,"extension",{type:[X.Batcher],name:"darkTint"});let Xa=Qr;at.add(Xa);class av{constructor(){x(this,"indexOffset",0);x(this,"attributeOffset",0);x(this,"indexSize");x(this,"attributeSize");x(this,"batcherName","darkTint");x(this,"topology","triangle-list");x(this,"packAsQuad",!1);x(this,"renderable");x(this,"positions");x(this,"indices");x(this,"uvs");x(this,"roundPixels");x(this,"data");x(this,"blendMode");x(this,"darkTint");x(this,"texture");x(this,"transform");x(this,"_textureId");x(this,"_attributeStart");x(this,"_indexStart");x(this,"_batcher");x(this,"_batch")}get color(){const t=this.data.color,e=this.renderable.groupColor,s=this.renderable.groupAlpha;let r;const n=t.a*s*255;if(e!==16777215){const a=e>>16&255,o=e>>8&255,h=e&255,l=t.r*h,c=t.g*o,u=t.b*a;r=n<<24|u<<16|c<<8|l}else r=n<<24|t.b*255<<16|t.g*255<<8|t.r*255;return r}get darkColor(){const t=this.data.darkColor;return t.b*255<<16|t.g*255<<8|t.r*255}get groupTransform(){return this.renderable.groupTransform}setData(t,e,s,r){if(this.renderable=t,this.transform=t.groupTransform,this.data=e,e.clipped){const n=e.clippedData;this.indexSize=n.indicesCount,this.attributeSize=n.vertexCount,this.positions=n.vertices,this.indices=n.indices,this.uvs=n.uvs}else this.indexSize=e.indices.length,this.attributeSize=e.vertices.length/2,this.positions=e.vertices,this.indices=e.indices,this.uvs=e.uvs;this.texture=e.texture,this.roundPixels=r,this.blendMode=s,this.batcherName=e.darkTint?"darkTint":"default"}}const ov={0:"normal",1:"add",2:"multiply",3:"screen"};class Hf{constructor(t){x(this,"renderer");x(this,"gpuSpineData",{});x(this,"_destroyRenderableBound",this.destroyRenderable.bind(this));this.renderer=t}validateRenderable(t){if(t._validateAndTransformAttachments(),t.spineAttachmentsDirty)return!0;if(t.spineTexturesDirty){const e=t.skeleton.drawOrder,s=this.gpuSpineData[t.uid];for(let r=0,n=e.length;r<n;r++){const a=e[r],o=a.getAttachment();if(o instanceof de||o instanceof fe){const h=t._getCachedData(a,o),l=s.slotBatches[h.id],c=h.texture;if(c!==l.texture&&!l._batcher.checkAndUpdateTexture(l,c))return!0}}}return!1}addRenderable(t,e){var o,h;const s=this._getSpineData(t),r=this.renderer.renderPipes.batch,n=t.skeleton.drawOrder,a=this.renderer._roundPixels|t._roundPixels;t._validateAndTransformAttachments(),t.spineAttachmentsDirty=!1,t.spineTexturesDirty=!1;for(let l=0,c=n.length;l<c;l++){const u=n[l],f=u.getAttachment(),d=ov[u.data.blendMode];if(f instanceof de||f instanceof fe){const m=t._getCachedData(u,f),g=(o=s.slotBatches)[h=m.id]||(o[h]=new av);g.setData(t,m,d,a),m.skipRender||r.addToBatch(g,e)}const p=t._slotsObject[u.data.name];if(p){const m=p.container;m.includeInBuild=!0,ty(m,e,this.renderer),m.includeInBuild=!1}}}updateRenderable(t){var r;const e=this.gpuSpineData[t.uid];t._validateAndTransformAttachments(),t.spineAttachmentsDirty=!1,t.spineTexturesDirty=!1;const s=t.skeleton.drawOrder;for(let n=0,a=s.length;n<a;n++){const o=s[n],h=o.getAttachment();if((h instanceof de||h instanceof fe)&&!t._getCachedData(o,h).skipRender){const c=e.slotBatches[t._getCachedData(o,h).id];(r=c._batcher)==null||r.updateElement(c)}}}destroyRenderable(t){this.gpuSpineData[t.uid]=null,t.off("destroyed",this._destroyRenderableBound)}destroy(){this.gpuSpineData=null,this.renderer=null}_getSpineData(t){return this.gpuSpineData[t.uid]||this._initMeshData(t)}_initMeshData(t){return this.gpuSpineData[t.uid]={slotBatches:{}},t.on("destroyed",this._destroyRenderableBound),this.gpuSpineData[t.uid]}}x(Hf,"extension",{type:[X.WebGLPipes,X.WebGPUPipes,X.CanvasPipes],name:"spine"});at.add(Hf);const xr=new Lr;Wi.yDown=!0;const Ts=new Ur,qh=new Ni(()=>new Oe);class Hs extends $s{constructor(e){e instanceof Nr&&(e={skeletonData:e});super({});x(this,"batched",!0);x(this,"buildId",0);x(this,"renderPipeId","spine");x(this,"_didSpineUpdate",!1);x(this,"beforeUpdateWorldTransforms",()=>{});x(this,"afterUpdateWorldTransforms",()=>{});x(this,"skeleton");x(this,"state");x(this,"skeletonBounds");x(this,"darkTint",!1);x(this,"_debug");x(this,"_slotsObject",Object.create(null));x(this,"clippingSlotToPixiMasks",Object.create(null));x(this,"spineAttachmentsDirty",!0);x(this,"spineTexturesDirty",!0);x(this,"_lastAttachments",[]);x(this,"_stateChanged",!0);x(this,"attachmentCacheData",[]);x(this,"_autoUpdate",!0);x(this,"_boundsProvider");x(this,"hasNeverUpdated",!0);x(this,"currentClippingSlot");this.allowChildren=!0;const s=e instanceof Nr?e:e.skeletonData;this.skeleton=new Wi(s),this.state=new La(new s1(s)),this.autoUpdate=(e==null?void 0:e.autoUpdate)??!0,this.darkTint=(e==null?void 0:e.darkTint)===void 0?this.skeleton.slots.some(n=>!!n.data.darkColor):e==null?void 0:e.darkTint;const r=this.skeleton.slots;for(let n=0;n<r.length;n++)this.attachmentCacheData[n]=Object.create(null);this._boundsProvider=e.boundsProvider}getSlotFromRef(e){let s;if(typeof e=="number"?s=this.skeleton.slots[e]:typeof e=="string"?s=this.skeleton.findSlot(e):s=e,!s)throw new Error(`No slot found with the given slot reference: ${e}`);return s}get debug(){return this._debug}set debug(e){this._debug&&this._debug.unregisterSpine(this),e&&e.registerSpine(this),this._debug=e}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e?Yt.shared.add(this.internalUpdate,this):Yt.shared.remove(this.internalUpdate,this),this._autoUpdate=e}get boundsProvider(){return this._boundsProvider}set boundsProvider(e){this._boundsProvider=e,e&&(this._boundsDirty=!1),this.updateBounds()}update(e){this.internalUpdate(0,e)}internalUpdate(e,s){this._updateAndApplyState(s??Yt.shared.deltaMS/1e3)}get bounds(){return this._boundsDirty&&this.updateBounds(),this._bounds}setBonePosition(e,s){const r=e;if(typeof e=="string"&&(e=this.skeleton.findBone(e)),!e)throw Error(`Cant set bone position, bone ${String(r)} not found`);if(xr.set(s.x,s.y),e.parent){const n=e.parent.worldToLocal(xr);e.x=n.x,e.y=-n.y}else e.x=xr.x,e.y=xr.y}getBonePosition(e,s){const r=e;return typeof e=="string"&&(e=this.skeleton.findBone(e)),e?(s||(s={x:0,y:0}),s.x=e.worldX,s.y=e.worldY,s):(console.error(`Cant set bone position! Bone ${String(r)} not found`),s)}_updateAndApplyState(e){this.hasNeverUpdated=!1,this.state.update(e),this.skeleton.update(e);const{skeleton:s}=this;this.state.apply(s),this.beforeUpdateWorldTransforms(this),s.updateWorldTransform(je.update),this.afterUpdateWorldTransforms(this),this.updateSlotObjects(),this._stateChanged=!0,this.onViewUpdate()}_validateAndTransformAttachments(){this._stateChanged&&(this._stateChanged=!1,this.validateAttachments(),this.transformAttachments())}validateAttachments(){const e=this.skeleton.drawOrder,s=this._lastAttachments;let r=0,n=!1;for(let a=0;a<e.length;a++){const h=e[a].getAttachment();h&&(h!==s[r]&&(n=!0,s[r]=h),r++)}r!==s.length&&(n=!0,s.length=r),this.spineAttachmentsDirty||(this.spineAttachmentsDirty=n)}updateAndSetPixiMask(e,s){var o,h;const r=e.attachment;if(r&&r instanceof ds){const l=(o=this.clippingSlotToPixiMasks)[h=e.data.name]||(o[h]={slot:e,vertices:new Array});l.maskComputed=!1,this.currentClippingSlot=l;return}let n=this.currentClippingSlot,a=this._slotsObject[e.data.name];if(n&&a){let l=n.mask;if(l||(l=qh.obtain(),n.mask=l,this.addChild(l)),!n.maskComputed){let c=n.slot,u=c.attachment;n.maskComputed=!0;const f=u.worldVerticesLength,d=n.vertices;u.computeWorldVertices(c,0,f,d,0,2),l.clear().poly(d).stroke({width:0}).fill({alpha:.25})}a.container.mask=l}else a!=null&&a.container.mask&&(a.container.mask=null);if(n&&n.slot.attachment.endSlot==e.data&&(this.currentClippingSlot=void 0),s){for(const l in this.clippingSlotToPixiMasks){const c=this.clippingSlotToPixiMasks[l];(!(c.slot.attachment instanceof ds)||!c.maskComputed)&&c.mask&&(this.removeChild(c.mask),qh.free(c.mask),c.mask=void 0)}this.currentClippingSlot=void 0}}transformAttachments(){var s;const e=this.skeleton.drawOrder;for(let r=0;r<e.length;r++){const n=e[r];this.updateAndSetPixiMask(n,r===e.length-1);const a=n.getAttachment();if(a){if(a instanceof fe||a instanceof de){const o=this._getCachedData(n,a);a instanceof de?a.computeWorldVertices(n,o.vertices,0,2):a.computeWorldVertices(n,0,a.worldVerticesLength,o.vertices,0,2),o.uvs.length<a.uvs.length&&(o.uvs=new Float32Array(a.uvs.length)),ma(a.uvs.buffer,o.uvs.buffer);const l=n.bone.skeleton.color,c=n.color,u=a.color;o.color.set(l.r*c.r*u.r,l.g*c.g*u.g,l.b*c.b*u.b,l.a*c.a*u.a),n.darkColor&&o.darkColor.setFromColor(n.darkColor),o.skipRender=o.clipped=!1;const f=((s=a.region)==null?void 0:s.texture.texture)||U.EMPTY;o.texture!==f&&(o.texture=f,this.spineTexturesDirty=!0),Ts.isClipping()&&this.updateClippingData(o)}else if(a instanceof ds){Ts.clipStart(n,a);continue}}Ts.clipEndWithSlot(n)}Ts.clipEnd()}updateClippingData(e){e.clipped=!0,Ts.clipTrianglesUnpacked(e.vertices,e.indices,e.indices.length,e.uvs);const{clippedVertices:s,clippedUVs:r,clippedTriangles:n}=Ts,a=s.length/2,o=n.length;e.clippedData||(e.clippedData={vertices:new Float32Array(a*2),uvs:new Float32Array(a*2),vertexCount:a,indices:new Uint16Array(o),indicesCount:o},this.spineAttachmentsDirty=!0);const h=e.clippedData,l=h.vertexCount!==a||o!==h.indicesCount;e.skipRender=a===0,l&&(this.spineAttachmentsDirty=!0,h.vertexCount<a&&(h.vertices=new Float32Array(a*2),h.uvs=new Float32Array(a*2)),h.indices.length<o&&(h.indices=new Uint16Array(o)));const{vertices:c,uvs:u,indices:f}=h;for(let d=0;d<a;d++)c[d*2]=s[d*2],c[d*2+1]=s[d*2+1],u[d*2]=r[d*2],u[d*2+1]=r[d*2+1];h.vertexCount=a;for(let d=0;d<o;d++)f[d]!==n[d]&&(this.spineAttachmentsDirty=!0,f[d]=n[d]);h.indicesCount=o}updateSlotObjects(){for(const e in this._slotsObject){const s=this._slotsObject[e];s&&this.updateSlotObject(s)}}updateSlotObject(e){const{slot:s,container:r}=e,n=e.followAttachmentTimeline?!!s.attachment:!0;if(r.visible=this.skeleton.drawOrder.includes(s)&&n,r.visible){let a=s.bone;r.position.set(a.worldX,a.worldY),r.angle=a.getWorldRotationX();let o=1,h=1;for(;a;)o*=a.scaleX,h*=a.scaleY,a=a.parent;o<0&&(r.angle-=180),r.scale.set(s.bone.getWorldScaleX()*Math.sign(o),s.bone.getWorldScaleY()*Math.sign(h)),r.alpha=this.skeleton.color.a*s.color.a}}_getCachedData(e,s){return this.attachmentCacheData[e.data.index][s.name]||this.initCachedData(e,s)}initCachedData(e,s){var n,a;let r;return s instanceof de?(r=new Float32Array(8),this.attachmentCacheData[e.data.index][s.name]={id:`${e.data.index}-${s.name}`,vertices:r,clipped:!1,indices:[0,1,2,0,2,3],uvs:new Float32Array(s.uvs.length),color:new K(1,1,1,1),darkColor:new K(0,0,0,0),darkTint:this.darkTint,skipRender:!1,texture:(n=s.region)==null?void 0:n.texture.texture}):(r=new Float32Array(s.worldVerticesLength),this.attachmentCacheData[e.data.index][s.name]={id:`${e.data.index}-${s.name}`,vertices:r,clipped:!1,indices:s.triangles,uvs:new Float32Array(s.uvs.length),color:new K(1,1,1,1),darkColor:new K(0,0,0,0),darkTint:this.darkTint,skipRender:!1,texture:(a=s.region)==null?void 0:a.texture.texture}),this.attachmentCacheData[e.data.index][s.name]}onViewUpdate(){var s;if(this._didViewChangeTick++,this._boundsProvider||(this._boundsDirty=!0),this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this),(s=this.debug)==null||s.renderDebug(this)}addSlotObject(e,s,r){var a;e=this.getSlotFromRef(e);for(const o in this._slotsObject)((a=this._slotsObject[o])==null?void 0:a.container)===s&&this.removeSlotObject(this._slotsObject[o].slot);this.removeSlotObject(e),s.includeInBuild=!1,this.addChild(s);const n={container:s,slot:e,followAttachmentTimeline:(r==null?void 0:r.followAttachmentTimeline)||!1};this._slotsObject[e.data.name]=n,this.updateSlotObject(n)}removeSlotObject(e){var r,n;let s;if(e instanceof ot){for(const a in this._slotsObject)if(((r=this._slotsObject[a])==null?void 0:r.container)===e){this._slotsObject[a]=null,s=e;break}}else{const a=this.getSlotFromRef(e);s=(n=this._slotsObject[a.data.name])==null?void 0:n.container,this._slotsObject[a.data.name]=null}s&&(this.removeChild(s),s.includeInBuild=!0)}removeSlotObjects(){Object.entries(this._slotsObject).forEach(([e,s])=>{s&&s.container.removeFromParent(),delete this._slotsObject[e]})}getSlotObject(e){var s;return e=this.getSlotFromRef(e),(s=this._slotsObject[e.data.name])==null?void 0:s.container}updateBounds(){this._boundsDirty=!1,this.skeletonBounds||(this.skeletonBounds=new $1);const e=this.skeletonBounds;if(e.update(this.skeleton,!0),this._boundsProvider){const s=this._boundsProvider.calculateBounds(this),r=this._bounds;r.clear(),r.x=s.x,r.y=s.y,r.width=s.width,r.height=s.height}else if(e.minX===1/0){this.hasNeverUpdated&&(this._updateAndApplyState(0),this._boundsDirty=!1),this._validateAndTransformAttachments();const s=this.skeleton.drawOrder,r=this._bounds;r.clear();for(let n=0;n<s.length;n++){const a=s[n],o=a.getAttachment();if(o&&(o instanceof de||o instanceof fe)){const h=this._getCachedData(a,o);r.addVertexData(h.vertices,0,h.vertices.length)}}}else this._bounds.minX=e.minX,this._bounds.minY=e.minY,this._bounds.maxX=e.maxX,this._bounds.maxY=e.maxY}addBounds(e){e.addBounds(this.bounds)}destroy(e=!1){super.destroy(e),Yt.shared.remove(this.internalUpdate,this),this.state.clearListeners(),this.debug=void 0,this.skeleton=null,this.state=null,this._slotsObject=null,this._lastAttachments.length=0,this.attachmentCacheData=null}skeletonToPixiWorldCoordinates(e){this.worldTransform.apply(e,e)}pixiWorldCoordinatesToSkeleton(e){this.worldTransform.applyInverse(e,e)}pixiWorldCoordinatesToBone(e,s){this.pixiWorldCoordinatesToSkeleton(e),s.parent?s.parent.worldToLocal(e):s.worldToLocal(e)}static from({skeleton:e,atlas:s,scale:r=1,darkTint:n,autoUpdate:a=!0,boundsProvider:o}){const h=`${e}-${s}-${r}`;if(ht.has(h))return new Hs({skeletonData:ht.get(h),darkTint:n,autoUpdate:a,boundsProvider:o});const l=Ae.get(e),c=Ae.get(s),u=new l1(c),f=l instanceof Uint8Array?new f1(u):new j1(u);f.scale=r;const d=f.readSkeletonData(l);return ht.set(h,d),new Hs({skeletonData:d,darkTint:n,autoUpdate:a,boundsProvider:o})}}class lv{constructor(t){x(this,"spine_");x(this,"container_");x(this,"state");x(this,"keysToListen");this.container_=new ot,this.spine_=Hs.from(t),this.container_.addChild(this.spine_),this.state=2,this.keysToListen=["ArrowLeft","ArrowRight"],this.setupInteraction()}get container(){return this.container_}start(){this.spine_.state.setAnimation(0,"idle",!0)}setupInteraction(){document.addEventListener("keydown",t=>{switch(t.code){case"ArrowLeft":this.state=1;break;case"ArrowRight":this.state=0;break}}),document.addEventListener("keyup",t=>{this.keysToListen.includes(t.code)&&(this.state=2)})}update(){this.state===1?this.container.position.x-=1:this.state===0&&(this.container.position.x+=1)}}class hv{constructor({spineConfig:t,boomSpineConfig:e,dropPoint:s,parent:r}){x(this,"spine_");x(this,"boomSpine_");x(this,"container_");x(this,"dropPosition_");x(this,"parent_");x(this,"state");this.parent_=r,this.container_=new ot,this.spine_=Hs.from(t),this.boomSpine_=Hs.from(e),this.dropPosition_=s,this.state=2,this.setupInteraction()}setupInteraction(){document.addEventListener("keyup",t=>{t.code==="Space"&&this.state===2&&this.drop()})}get container(){return this.container_}start(){this.spine_.state.setAnimation(0,"idle",!0)}stop(){this.spine_.state.clearTracks(),this.spine_.skeleton.setToSetupPose()}drop(){const{x:t,y:e}=this.dropPosition_;this.state=0,this.parent_.addChild(this.container_),this.container.position.set(t,e),this.start(),this.container_.addChild(this.spine_)}boom(){return this.state=1,this.container_.addChild(this.boomSpine_),new Promise(t=>{this.boomSpine_.state.addListener({complete:t}),this.boomSpine_.state.setAnimation(0,"boom",!1)})}async hit(){this.stop(),this.container.removeChild(this.spine_),await this.boom(),this.state=2,this.boomSpine_.state.clearListeners()}update(){this.state===0&&(this.container_.position.y+=2,this.container_.position.y===320&&this.hit())}}class $f extends ot{constructor(){super();x(this,"mainContainer");x(this,"pauseButton");x(this,"settingsButton");x(this,"addButton");x(this,"removeButton");x(this,"bomber");x(this,"ammo");x(this,"background");x(this,"paused",!1);this.mainContainer=new ot,this.addChild(this.mainContainer),this.background=new Kw,this.mainContainer.addChild(this.background),this.bomber=new lv({skeleton:"drone.spine.json",atlas:"nemesis.atlas",scale:.5}),this.mainContainer.addChild(this.bomber.container),this.bomber.start(),this.ammo=new hv({spineConfig:{skeleton:"amu.spine.json",atlas:"nemesis.atlas",scale:.5},boomSpineConfig:{skeleton:"boom.spine.json",atlas:"nemesis.atlas",scale:.5},dropPoint:this.bomber.container.position,parent:this.mainContainer});const e={hover:{props:{scale:{x:1.1,y:1.1}},duration:100},pressed:{props:{scale:{x:.9,y:.9}},duration:100}};this.pauseButton=new wa({defaultView:"icon-pause.png",anchor:.5,animations:e}),this.pauseButton.onPress.connect(()=>Ft().navigation.presentPopup(Yh)),this.addChild(this.pauseButton),this.settingsButton=new wa({defaultView:"icon-settings.png",anchor:.5,animations:e}),this.settingsButton.onPress.connect(()=>Ft().navigation.presentPopup($w)),this.addChild(this.settingsButton),this.addButton=new Or({text:"Дабавіть Сірьожу",width:275,height:110}),this.addChild(this.addButton),this.removeButton=new Or({text:"Убрать Сірьожу",width:275,height:110}),this.addChild(this.removeButton)}prepare(){}update(e){this.paused||(this.background.update(),this.ammo.update(),this.bomber.update())}async pause(){this.mainContainer.interactiveChildren=!1,this.paused=!0}async resume(){this.mainContainer.interactiveChildren=!0,this.paused=!1}reset(){}resize(e,s){const r=e*.5,n=s*.5;this.mainContainer.x=r,this.mainContainer.y=n,this.pauseButton.x=30,this.pauseButton.y=30,this.settingsButton.x=e-30,this.settingsButton.y=30,this.removeButton.x=e/2-200,this.removeButton.y=s-75,this.addButton.x=e/2+200,this.addButton.y=s-75}async show(){Ft().audio.bgm.play("main/sounds/bgm-main.mp3",{volume:.5});const e=[this.pauseButton,this.settingsButton,this.addButton,this.removeButton];let s;for(const r of e)r.alpha=0,s=re(r,{alpha:1},{duration:.3,delay:.75,ease:"backOut"});await s}async hide(){}blur(){Ft().navigation.currentPopup||Ft().navigation.presentPopup(Yh)}}x($f,"assetBundles",["main"]);let jf;function cv(i){return jf=i,i}function Gi(){return jf}class za{static setParamValue(t,e){if(t.setValueAtTime){const s=Gi().context;t.setValueAtTime(e,s.audioContext.currentTime)}else t.value=e;return e}}class uv extends Xt{constructor(){super(...arguments),this.speed=1,this.muted=!1,this.volume=1,this.paused=!1}refresh(){this.emit("refresh")}refreshPaused(){this.emit("refreshPaused")}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(t){console.warn("HTML Audio does not support filters")}get audioContext(){return console.warn("HTML Audio does not support audioContext"),null}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this.paused}destroy(){this.removeAllListeners()}}let dv=0;const Na=class extends Xt{constructor(i){super(),this.id=dv++,this.init(i)}set(i,t){if(this[i]===void 0)throw new Error(`Property with name ${i} does not exist.`);switch(i){case"speed":this.speed=t;break;case"volume":this.volume=t;break;case"paused":this.paused=t;break;case"loop":this.loop=t;break;case"muted":this.muted=t;break}return this}get progress(){const{currentTime:i}=this._source;return i/this._duration}get paused(){return this._paused}set paused(i){this._paused=i,this.refreshPaused()}_onPlay(){this._playing=!0}_onPause(){this._playing=!1}init(i){this._playing=!1,this._duration=i.source.duration;const t=this._source=i.source.cloneNode(!1);t.src=i.parent.url,t.onplay=this._onPlay.bind(this),t.onpause=this._onPause.bind(this),i.context.on("refresh",this.refresh,this),i.context.on("refreshPaused",this.refreshPaused,this),this._media=i}_internalStop(){this._source&&this._playing&&(this._source.onended=null,this._source.pause())}stop(){this._internalStop(),this._source&&this.emit("stop")}get speed(){return this._speed}set speed(i){this._speed=i,this.refresh()}get volume(){return this._volume}set volume(i){this._volume=i,this.refresh()}get loop(){return this._loop}set loop(i){this._loop=i,this.refresh()}get muted(){return this._muted}set muted(i){this._muted=i,this.refresh()}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(i){console.warn("HTML Audio does not support filters")}refresh(){const i=this._media.context,t=this._media.parent;this._source.loop=this._loop||t.loop;const e=i.volume*(i.muted?0:1),s=t.volume*(t.muted?0:1),r=this._volume*(this._muted?0:1);this._source.volume=r*e*s,this._source.playbackRate=this._speed*i.speed*t.speed}refreshPaused(){const i=this._media.context,t=this._media.parent,e=this._paused||t.paused||i.paused;e!==this._pausedReal&&(this._pausedReal=e,e?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._source.currentTime,end:this._end,volume:this._volume,speed:this._speed,loop:this._loop})),this.emit("pause",e))}play(i){const{start:t,end:e,speed:s,loop:r,volume:n,muted:a}=i;e&&console.assert(e>t,"End time is before start time"),this._speed=s,this._volume=n,this._loop=!!r,this._muted=a,this.refresh(),this.loop&&e!==null&&(console.warn('Looping not support when specifying an "end" time'),this.loop=!1),this._start=t,this._end=e||this._duration,this._start=Math.max(0,this._start-Na.PADDING),this._end=Math.min(this._end+Na.PADDING,this._duration),this._source.onloadedmetadata=()=>{this._source&&(this._source.currentTime=t,this._source.onloadedmetadata=null,this.emit("progress",t/this._duration,this._duration),Yt.shared.add(this._onUpdate,this))},this._source.onended=this._onComplete.bind(this),this._source.play(),this.emit("start")}_onUpdate(){this.emit("progress",this.progress,this._duration),this._source.currentTime>=this._end&&!this._source.loop&&this._onComplete()}_onComplete(){Yt.shared.remove(this._onUpdate,this),this._internalStop(),this.emit("progress",1,this._duration),this.emit("end",this)}destroy(){Yt.shared.remove(this._onUpdate,this),this.removeAllListeners();const i=this._source;i&&(i.onended=null,i.onplay=null,i.onpause=null,this._internalStop()),this._source=null,this._speed=1,this._volume=1,this._loop=!1,this._end=null,this._start=0,this._duration=0,this._playing=!1,this._pausedReal=!1,this._paused=!1,this._muted=!1,this._media&&(this._media.context.off("refresh",this.refresh,this),this._media.context.off("refreshPaused",this.refreshPaused,this),this._media=null)}toString(){return`[HTMLAudioInstance id=${this.id}]`}};let qf=Na;qf.PADDING=.1;class fv extends Xt{init(t){this.parent=t,this._source=t.options.source||new Audio,t.url&&(this._source.src=t.url)}create(){return new qf(this)}get isPlayable(){return!!this._source&&this._source.readyState===4}get duration(){return this._source.duration}get context(){return this.parent.context}get filters(){return null}set filters(t){console.warn("HTML Audio does not support filters")}destroy(){this.removeAllListeners(),this.parent=null,this._source&&(this._source.src="",this._source.load(),this._source=null)}get source(){return this._source}load(t){const e=this._source,s=this.parent;if(e.readyState===4){s.isLoaded=!0;const h=s.autoPlayStart();t&&setTimeout(()=>{t(null,s,h)},0);return}if(!s.url){t(new Error("sound.url or sound.source must be set"));return}e.src=s.url;const r=()=>{o(),s.isLoaded=!0;const h=s.autoPlayStart();t&&t(null,s,h)},n=()=>{o(),t&&t(new Error("Sound loading has been aborted"))},a=()=>{o();const h=`Failed to load audio element (code: ${e.error.code})`;t?t(new Error(h)):console.error(h)},o=()=>{e.removeEventListener("canplaythrough",r),e.removeEventListener("load",r),e.removeEventListener("abort",n),e.removeEventListener("error",a)};e.addEventListener("canplaythrough",r,!1),e.addEventListener("load",r,!1),e.addEventListener("abort",n,!1),e.addEventListener("error",a,!1),e.load()}}class pv{constructor(t,e){this.parent=t,Object.assign(this,e),this.duration=this.end-this.start,console.assert(this.duration>0,"End time must be after start time")}play(t){return this.parent.play({complete:t,speed:this.speed||this.parent.speed,end:this.end,start:this.start,loop:this.loop})}destroy(){this.parent=null}}const Gr=["ogg","oga","opus","m4a","mp3","mpeg","wav","aiff","wma","mid","caf"],mv=["audio/mpeg","audio/ogg"],Hr={};function gv(i){const t={m4a:"audio/mp4",oga:"audio/ogg",opus:'audio/ogg; codecs="opus"',caf:'audio/x-caf; codecs="opus"'},e=document.createElement("audio"),s={},r=/^no$/;Gr.forEach(n=>{const a=e.canPlayType(`audio/${n}`).replace(r,""),o=t[n]?e.canPlayType(t[n]).replace(r,""):"";s[n]=!!a||!!o}),Object.assign(Hr,s)}gv();let xv=0;class yv extends Xt{constructor(t){super(),this.id=xv++,this._media=null,this._paused=!1,this._muted=!1,this._elapsed=0,this.init(t)}set(t,e){if(this[t]===void 0)throw new Error(`Property with name ${t} does not exist.`);switch(t){case"speed":this.speed=e;break;case"volume":this.volume=e;break;case"muted":this.muted=e;break;case"loop":this.loop=e;break;case"paused":this.paused=e;break}return this}stop(){this._source&&(this._internalStop(),this.emit("stop"))}get speed(){return this._speed}set speed(t){this._speed=t,this.refresh(),this._update(!0)}get volume(){return this._volume}set volume(t){this._volume=t,this.refresh()}get muted(){return this._muted}set muted(t){this._muted=t,this.refresh()}get loop(){return this._loop}set loop(t){this._loop=t,this.refresh()}get filters(){return this._filters}set filters(t){var e;this._filters&&((e=this._filters)==null||e.filter(s=>s).forEach(s=>s.disconnect()),this._filters=null,this._source.connect(this._gain)),this._filters=t!=null&&t.length?t.slice(0):null,this.refresh()}refresh(){if(!this._source)return;const t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;const s=t.volume*(t.muted?0:1),r=e.volume*(e.muted?0:1),n=this._volume*(this._muted?0:1);za.setParamValue(this._gain.gain,n*r*s),za.setParamValue(this._source.playbackRate,this._speed*e.speed*t.speed),this.applyFilters()}applyFilters(){var t;if((t=this._filters)!=null&&t.length){this._source.disconnect();let e=this._source;this._filters.forEach(s=>{e.connect(s.destination),e=s}),e.connect(this._gain)}}refreshPaused(){const t=this._media.context,e=this._media.parent,s=this._paused||e.paused||t.paused;s!==this._pausedReal&&(this._pausedReal=s,s?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._elapsed%this._duration,end:this._end,speed:this._speed,loop:this._loop,volume:this._volume})),this.emit("pause",s))}play(t){const{start:e,end:s,speed:r,loop:n,volume:a,muted:o,filters:h}=t;s&&console.assert(s>e,"End time is before start time"),this._paused=!1;const{source:l,gain:c}=this._media.nodes.cloneBufferSource();this._source=l,this._gain=c,this._speed=r,this._volume=a,this._loop=!!n,this._muted=o,this._filters=h,this.refresh();const u=this._source.buffer.duration;this._duration=u,this._end=s,this._lastUpdate=this._now(),this._elapsed=e,this._source.onended=this._onComplete.bind(this),this._loop?(this._source.loopEnd=s,this._source.loopStart=e,this._source.start(0,e)):s?this._source.start(0,e,s-e):this._source.start(0,e),this.emit("start"),this._update(!0),this.enableTicker(!0)}enableTicker(t){Yt.shared.remove(this._updateListener,this),t&&Yt.shared.add(this._updateListener,this)}get progress(){return this._progress}get paused(){return this._paused}set paused(t){this._paused=t,this.refreshPaused()}destroy(){var t;this.removeAllListeners(),this._internalStop(),this._gain&&(this._gain.disconnect(),this._gain=null),this._media&&(this._media.context.events.off("refresh",this.refresh,this),this._media.context.events.off("refreshPaused",this.refreshPaused,this),this._media=null),(t=this._filters)==null||t.forEach(e=>e.disconnect()),this._filters=null,this._end=null,this._speed=1,this._volume=1,this._loop=!1,this._elapsed=0,this._duration=0,this._paused=!1,this._muted=!1,this._pausedReal=!1}toString(){return`[WebAudioInstance id=${this.id}]`}_now(){return this._media.context.audioContext.currentTime}_updateListener(){this._update()}_update(t=!1){if(this._source){const e=this._now(),s=e-this._lastUpdate;if(s>0||t){const r=this._source.playbackRate.value;this._elapsed+=s*r,this._lastUpdate=e;const n=this._duration;let a;if(this._source.loopStart){const o=this._source.loopEnd-this._source.loopStart;a=(this._source.loopStart+this._elapsed%o)/n}else a=this._elapsed%n/n;this._progress=a,this.emit("progress",this._progress,n)}}}init(t){this._media=t,t.context.events.on("refresh",this.refresh,this),t.context.events.on("refreshPaused",this.refreshPaused,this)}_internalStop(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.stop(0),this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null}}_onComplete(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}}this._source=null,this._progress=1,this.emit("progress",1,this._duration),this.emit("end",this)}}class Kf{constructor(t,e){this._output=e,this._input=t}get destination(){return this._input}get filters(){return this._filters}set filters(t){if(this._filters&&(this._filters.forEach(e=>{e&&e.disconnect()}),this._filters=null,this._input.connect(this._output)),t&&t.length){this._filters=t.slice(0),this._input.disconnect();let e=null;t.forEach(s=>{e===null?this._input.connect(s.destination):e.connect(s.destination),e=s}),e.connect(this._output)}}destroy(){this.filters=null,this._input=null,this._output=null}}const Zf=class extends Kf{constructor(i){const t=i.audioContext,e=t.createBufferSource(),s=t.createGain(),r=t.createAnalyser();e.connect(r),r.connect(s),s.connect(i.destination),super(r,s),this.context=i,this.bufferSource=e,this.gain=s,this.analyser=r}get script(){return this._script||(this._script=this.context.audioContext.createScriptProcessor(Zf.BUFFER_SIZE),this._script.connect(this.context.destination)),this._script}destroy(){super.destroy(),this.bufferSource.disconnect(),this._script&&this._script.disconnect(),this.gain.disconnect(),this.analyser.disconnect(),this.bufferSource=null,this._script=null,this.gain=null,this.analyser=null,this.context=null}cloneBufferSource(){const i=this.bufferSource,t=this.context.audioContext.createBufferSource();t.buffer=i.buffer,za.setParamValue(t.playbackRate,i.playbackRate.value),t.loop=i.loop;const e=this.context.audioContext.createGain();return t.connect(e),e.connect(this.destination),{source:t,gain:e}}get bufferSize(){return this.script.bufferSize}};let Qf=Zf;Qf.BUFFER_SIZE=0;class bv{init(t){this.parent=t,this._nodes=new Qf(this.context),this._source=this._nodes.bufferSource,this.source=t.options.source}destroy(){this.parent=null,this._nodes.destroy(),this._nodes=null;try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null,this.source=null}create(){return new yv(this)}get context(){return this.parent.context}get isPlayable(){return!!this._source&&!!this._source.buffer}get filters(){return this._nodes.filters}set filters(t){this._nodes.filters=t}get duration(){return console.assert(this.isPlayable,"Sound not yet playable, no duration"),this._source.buffer.duration}get buffer(){return this._source.buffer}set buffer(t){this._source.buffer=t}get nodes(){return this._nodes}load(t){this.source?this._decode(this.source,t):this.parent.url?this._loadUrl(t):t?t(new Error("sound.url or sound.source must be set")):console.error("sound.url or sound.source must be set")}async _loadUrl(t){const e=this.parent.url,s=await ut.get().fetch(e);this._decode(await s.arrayBuffer(),t)}_decode(t,e){const s=(r,n)=>{if(r)e&&e(r);else{this.parent.isLoaded=!0,this.buffer=n;const a=this.parent.autoPlayStart();e&&e(null,this.parent,a)}};t instanceof AudioBuffer?s(null,t):this.parent.context.decode(t,s)}}const Ps=class{static from(i){let t={};typeof i=="string"?t.url=i:i instanceof ArrayBuffer||i instanceof AudioBuffer||i instanceof HTMLAudioElement?t.source=i:Array.isArray(i)?t.url=i:t=i,t={autoPlay:!1,singleInstance:!1,url:null,source:null,preload:!1,volume:1,speed:1,complete:null,loaded:null,loop:!1,...t},Object.freeze(t);const e=Gi().useLegacy?new fv:new bv;return new Ps(e,t)}constructor(i,t){this.media=i,this.options=t,this._instances=[],this._sprites={},this.media.init(this);const e=t.complete;this._autoPlayOptions=e?{complete:e}:null,this.isLoaded=!1,this._preloadQueue=null,this.isPlaying=!1,this.autoPlay=t.autoPlay,this.singleInstance=t.singleInstance,this.preload=t.preload||this.autoPlay,this.url=Array.isArray(t.url)?this.preferUrl(t.url):t.url,this.speed=t.speed,this.volume=t.volume,this.loop=t.loop,t.sprites&&this.addSprites(t.sprites),this.preload&&this._preload(t.loaded)}preferUrl(i){const[t]=i.map(e=>({url:e,ext:Mt.extname(e).slice(1)})).filter(({ext:e})=>Hr[e]).sort((e,s)=>Gr.indexOf(e.ext)-Gr.indexOf(s.ext));if(!t)throw new Error("No supported file type found");return t.url}get context(){return Gi().context}pause(){return this.isPlaying=!1,this.paused=!0,this}resume(){return this.isPlaying=this._instances.length>0,this.paused=!1,this}get paused(){return this._paused}set paused(i){this._paused=i,this.refreshPaused()}get speed(){return this._speed}set speed(i){this._speed=i,this.refresh()}get filters(){return this.media.filters}set filters(i){this.media.filters=i}addSprites(i,t){if(typeof i=="object"){const s={};for(const r in i)s[r]=this.addSprites(r,i[r]);return s}console.assert(!this._sprites[i],`Alias ${i} is already taken`);const e=new pv(this,t);return this._sprites[i]=e,e}destroy(){this._removeInstances(),this.removeSprites(),this.media.destroy(),this.media=null,this._sprites=null,this._instances=null}removeSprites(i){if(i){const t=this._sprites[i];t!==void 0&&(t.destroy(),delete this._sprites[i])}else for(const t in this._sprites)this.removeSprites(t);return this}get isPlayable(){return this.isLoaded&&this.media&&this.media.isPlayable}stop(){if(!this.isPlayable)return this.autoPlay=!1,this._autoPlayOptions=null,this;this.isPlaying=!1;for(let i=this._instances.length-1;i>=0;i--)this._instances[i].stop();return this}play(i,t){let e;if(typeof i=="string"?e={sprite:i,loop:this.loop,complete:t}:typeof i=="function"?(e={},e.complete=i):e=i,e={complete:null,loaded:null,sprite:null,end:null,start:0,volume:1,speed:1,muted:!1,loop:!1,...e||{}},e.sprite){const r=e.sprite;console.assert(!!this._sprites[r],`Alias ${r} is not available`);const n=this._sprites[r];e.start=n.start+(e.start||0),e.end=n.end,e.speed=n.speed||1,e.loop=n.loop||e.loop,delete e.sprite}if(e.offset&&(e.start=e.offset),!this.isLoaded)return this._preloadQueue?new Promise(r=>{this._preloadQueue.push(()=>{r(this.play(e))})}):(this._preloadQueue=[],this.autoPlay=!0,this._autoPlayOptions=e,new Promise((r,n)=>{this._preload((a,o,h)=>{this._preloadQueue.forEach(l=>l()),this._preloadQueue=null,a?n(a):(e.loaded&&e.loaded(a,o,h),r(h))})}));(this.singleInstance||e.singleInstance)&&this._removeInstances();const s=this._createInstance();return this._instances.push(s),this.isPlaying=!0,s.once("end",()=>{e.complete&&e.complete(this),this._onComplete(s)}),s.once("stop",()=>{this._onComplete(s)}),s.play(e),s}refresh(){const i=this._instances.length;for(let t=0;t<i;t++)this._instances[t].refresh()}refreshPaused(){const i=this._instances.length;for(let t=0;t<i;t++)this._instances[t].refreshPaused()}get volume(){return this._volume}set volume(i){this._volume=i,this.refresh()}get muted(){return this._muted}set muted(i){this._muted=i,this.refresh()}get loop(){return this._loop}set loop(i){this._loop=i,this.refresh()}_preload(i){this.media.load(i)}get instances(){return this._instances}get sprites(){return this._sprites}get duration(){return this.media.duration}autoPlayStart(){let i;return this.autoPlay&&(i=this.play(this._autoPlayOptions)),i}_removeInstances(){for(let i=this._instances.length-1;i>=0;i--)this._poolInstance(this._instances[i]);this._instances.length=0}_onComplete(i){if(this._instances){const t=this._instances.indexOf(i);t>-1&&this._instances.splice(t,1),this.isPlaying=this._instances.length>0}this._poolInstance(i)}_createInstance(){if(Ps._pool.length>0){const i=Ps._pool.pop();return i.init(this.media),i}return this.media.create()}_poolInstance(i){i.destroy(),Ps._pool.indexOf(i)<0&&Ps._pool.push(i)}};let $r=Ps;$r._pool=[];class Hi extends Kf{constructor(){const t=window,e=new Hi.AudioContext,s=e.createDynamicsCompressor(),r=e.createAnalyser();r.connect(s),s.connect(e.destination),super(r,s),this.autoPause=!0,this._ctx=e,this._offlineCtx=new Hi.OfflineAudioContext(1,2,t.OfflineAudioContext?Math.max(8e3,Math.min(96e3,e.sampleRate)):44100),this.compressor=s,this.analyser=r,this.events=new Xt,this.volume=1,this.speed=1,this.muted=!1,this.paused=!1,this._locked=e.state==="suspended"&&("ontouchstart"in globalThis||"onclick"in globalThis),this._locked&&(this._unlock(),this._unlock=this._unlock.bind(this),document.addEventListener("mousedown",this._unlock,!0),document.addEventListener("touchstart",this._unlock,!0),document.addEventListener("touchend",this._unlock,!0)),this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this),globalThis.addEventListener("focus",this.onFocus),globalThis.addEventListener("blur",this.onBlur)}onFocus(){if(!this.autoPause)return;const t=this._ctx.state;(t==="suspended"||t==="interrupted"||!this._locked)&&(this.paused=this._pausedOnBlur,this.refreshPaused())}onBlur(){this.autoPause&&(this._locked||(this._pausedOnBlur=this._paused,this.paused=!0,this.refreshPaused()))}_unlock(){this._locked&&(this.playEmptySound(),this._ctx.state==="running"&&(document.removeEventListener("mousedown",this._unlock,!0),document.removeEventListener("touchend",this._unlock,!0),document.removeEventListener("touchstart",this._unlock,!0),this._locked=!1))}playEmptySound(){const t=this._ctx.createBufferSource();t.buffer=this._ctx.createBuffer(1,1,22050),t.connect(this._ctx.destination),t.start(0,0,0),t.context.state==="suspended"&&t.context.resume()}static get AudioContext(){const t=window;return t.AudioContext||t.webkitAudioContext||null}static get OfflineAudioContext(){const t=window;return t.OfflineAudioContext||t.webkitOfflineAudioContext||null}destroy(){super.destroy();const t=this._ctx;typeof t.close<"u"&&t.close(),globalThis.removeEventListener("focus",this.onFocus),globalThis.removeEventListener("blur",this.onBlur),this.events.removeAllListeners(),this.analyser.disconnect(),this.compressor.disconnect(),this.analyser=null,this.compressor=null,this.events=null,this._offlineCtx=null,this._ctx=null}get audioContext(){return this._ctx}get offlineContext(){return this._offlineCtx}set paused(t){t&&this._ctx.state==="running"?this._ctx.suspend():!t&&this._ctx.state==="suspended"&&this._ctx.resume(),this._paused=t}get paused(){return this._paused}refresh(){this.events.emit("refresh")}refreshPaused(){this.events.emit("refreshPaused")}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this._paused}decode(t,e){const s=n=>{e(new Error((n==null?void 0:n.message)||"Unable to decode file"))},r=this._offlineCtx.decodeAudioData(t,n=>{e(null,n)},s);r&&r.catch(s)}}class _v{constructor(){this.init()}init(){return this.supported&&(this._webAudioContext=new Hi),this._htmlAudioContext=new uv,this._sounds={},this.useLegacy=!this.supported,this}get context(){return this._context}get filtersAll(){return this.useLegacy?[]:this._context.filters}set filtersAll(t){this.useLegacy||(this._context.filters=t)}get supported(){return Hi.AudioContext!==null}add(t,e){if(typeof t=="object"){const n={};for(const a in t){const o=this._getOptions(t[a],e);n[a]=this.add(a,o)}return n}if(console.assert(!this._sounds[t],`Sound with alias ${t} already exists.`),e instanceof $r)return this._sounds[t]=e,e;const s=this._getOptions(e),r=$r.from(s);return this._sounds[t]=r,r}_getOptions(t,e){let s;return typeof t=="string"?s={url:t}:Array.isArray(t)?s={url:t}:t instanceof ArrayBuffer||t instanceof AudioBuffer||t instanceof HTMLAudioElement?s={source:t}:s=t,s={...s,...e||{}},s}get useLegacy(){return this._useLegacy}set useLegacy(t){this._useLegacy=t,this._context=!t&&this.supported?this._webAudioContext:this._htmlAudioContext}get disableAutoPause(){return!this._webAudioContext.autoPause}set disableAutoPause(t){this._webAudioContext.autoPause=!t}remove(t){return this.exists(t,!0),this._sounds[t].destroy(),delete this._sounds[t],this}get volumeAll(){return this._context.volume}set volumeAll(t){this._context.volume=t,this._context.refresh()}get speedAll(){return this._context.speed}set speedAll(t){this._context.speed=t,this._context.refresh()}togglePauseAll(){return this._context.togglePause()}pauseAll(){return this._context.paused=!0,this._context.refreshPaused(),this}resumeAll(){return this._context.paused=!1,this._context.refreshPaused(),this}toggleMuteAll(){return this._context.toggleMute()}muteAll(){return this._context.muted=!0,this._context.refresh(),this}unmuteAll(){return this._context.muted=!1,this._context.refresh(),this}removeAll(){for(const t in this._sounds)this._sounds[t].destroy(),delete this._sounds[t];return this}stopAll(){for(const t in this._sounds)this._sounds[t].stop();return this}exists(t,e=!1){const s=!!this._sounds[t];return e&&console.assert(s,`No sound matching alias '${t}'.`),s}isPlaying(){for(const t in this._sounds)if(this._sounds[t].isPlaying)return!0;return!1}find(t){return this.exists(t,!0),this._sounds[t]}play(t,e){return this.find(t).play(e)}stop(t){return this.find(t).stop()}pause(t){return this.find(t).pause()}resume(t){return this.find(t).resume()}volume(t,e){const s=this.find(t);return e!==void 0&&(s.volume=e),s.volume}speed(t,e){const s=this.find(t);return e!==void 0&&(s.speed=e),s.speed}duration(t){return this.find(t).duration}close(){return this.removeAll(),this._sounds=null,this._webAudioContext&&(this._webAudioContext.destroy(),this._webAudioContext=null),this._htmlAudioContext&&(this._htmlAudioContext.destroy(),this._htmlAudioContext=null),this._context=null,this}}const Kh=i=>{var s;const t=i.src;let e=(s=i==null?void 0:i.alias)==null?void 0:s[0];return(!e||i.src===e)&&(e=Mt.basename(t,Mt.extname(t))),e},wv={extension:X.Asset,detection:{test:async()=>!0,add:async i=>[...i,...Gr.filter(t=>Hr[t])],remove:async i=>i.filter(t=>i.includes(t))},loader:{name:"sound",extension:{type:[X.LoadParser],priority:ge.High},test(i){const t=Mt.extname(i).slice(1);return!!Hr[t]||mv.some(e=>i.startsWith(`data:${e}`))},async load(i,t){const e=await new Promise((s,r)=>$r.from({...t.data,url:i,preload:!0,loaded(n,a){var o,h;n?r(n):s(a),(h=(o=t.data)==null?void 0:o.loaded)==null||h.call(o,n,a)}}));return Gi().add(Kh(t),e),e},async unload(i,t){Gi().remove(Kh(t))}}};at.add(wv);const Qe=cv(new _v);at.add(ja);at.add(Qc);const vv=[{name:"default",assets:[]},{name:"main",assets:[{alias:["main/background/back.png","back.png"],src:["main/background/back@0.5x.webp","main/background/back@0.5x.png","main/background/back.webp","main/background/back.png"],data:{tags:{m:!0}}},{alias:["main/background/middle.png","middle.png"],src:["main/background/middle@0.5x.webp","main/background/middle@0.5x.png","main/background/middle.webp","main/background/middle.png"],data:{tags:{m:!0}}},{alias:["main/background/top.png","top.png"],src:["main/background/top@0.5x.webp","main/background/top@0.5x.png","main/background/top.webp","main/background/top.png"],data:{tags:{m:!0}}},{alias:["main/chi.png","chi.png"],src:["main/chi@0.5x.webp","main/chi@0.5x.png","main/chi.webp","main/chi.png"],data:{tags:{m:!0}}},{alias:["main/cho.png","cho.png"],src:["main/cho@0.5x.webp","main/cho@0.5x.png","main/cho.webp","main/cho.png"],data:{tags:{m:!0}}},{alias:["main/sounds/bgm-main.mp3","bgm-main.mp3"],src:["main/sounds/bgm-main.ogg","main/sounds/bgm-main.mp3"],data:{tags:{m:!0}}},{alias:["main/sounds/sfx-hover.wav","sfx-hover.wav"],src:["main/sounds/sfx-hover.ogg","main/sounds/sfx-hover.mp3"],data:{tags:{m:!0}}},{alias:["main/sounds/sfx-press.wav","sfx-press.wav"],src:["main/sounds/sfx-press.ogg","main/sounds/sfx-press.mp3"],data:{tags:{m:!0}}},{alias:["main/spine/amu.spine.json","amu.spine.json"],src:["main/spine/amu.spine.json"],data:{tags:{m:!0}}},{alias:["main/spine/boom.spine.json","boom.spine.json"],src:["main/spine/boom.spine.json"],data:{tags:{m:!0}}},{alias:["main/spine/drone.spine.json","drone.spine.json"],src:["main/spine/drone.spine.json"],data:{tags:{m:!0}}},{alias:["main/spine/nemesis.atlas","nemesis.atlas"],src:["main/spine/nemesis@0.5x.webp.webp@0.5x.atlas","main/spine/nemesis@0.5x.webp.webp.atlas","main/spine/nemesis@0.5x.webp.png@0.5x.atlas","main/spine/nemesis@0.5x.webp.png.atlas","main/spine/nemesis@0.5x.png.webp@0.5x.atlas","main/spine/nemesis@0.5x.png.webp.atlas","main/spine/nemesis@0.5x.png.png@0.5x.atlas","main/spine/nemesis@0.5x.png.png.atlas","main/spine/nemesis.webp.webp@0.5x.atlas","main/spine/nemesis.webp.webp.atlas","main/spine/nemesis.webp.png@0.5x.atlas","main/spine/nemesis.webp.png.atlas","main/spine/nemesis.png.webp@0.5x.atlas","main/spine/nemesis.png.webp.atlas","main/spine/nemesis.png.png@0.5x.atlas","main/spine/nemesis.png.png.atlas"],data:{tags:{m:!0}}},{alias:["main/ui","ui"],src:["main/ui@0.5x.webp.json","main/ui@0.5x.png.json","main/ui.webp.json","main/ui.png.json"],data:{tags:{m:!0,tps:!0}}}]},{name:"preload",assets:[{alias:["preload/logo.svg","logo.svg"],src:["preload/logo.svg"],data:{tags:{m:!0}}}]}],Zh={bundles:vv};class Sv{constructor(){x(this,"currentAlias");x(this,"current");x(this,"volume",1)}async play(t,e){if(this.currentAlias!==t){if(this.current){const s=this.current;re(s,{volume:0},{duration:1,ease:"linear"}).then(()=>{s.stop()})}this.current=Qe.find(t),this.currentAlias=t,this.current.play({loop:!0,...e}),this.current.volume=0,re(this.current,{volume:this.volume},{duration:1,ease:"linear"})}}getVolume(){return this.volume}setVolume(t){this.volume=t,this.current&&(this.current.volume=this.volume)}}class Av{constructor(){x(this,"volume",1)}play(t,e){const s=this.volume*((e==null?void 0:e.volume)??1);Qe.play(t,{...e,volume:s})}getVolume(){return this.volume}setVolume(t){this.volume=t}}class Jf{static init(){const t=this;t.audio={bgm:new Sv,sfx:new Av,getMasterVolume:()=>Qe.volumeAll,setMasterVolume:e=>{Qe.volumeAll=e,e?Qe.unmuteAll():Qe.muteAll()}}}static destroy(){const t=this;t.audio=null}}x(Jf,"extension",X.Application);class Cv{constructor(){x(this,"app");x(this,"container",new ot);x(this,"width",0);x(this,"height",0);x(this,"background");x(this,"currentScreen");x(this,"currentPopup")}init(t){this.app=t}setBackground(t){this.background=new t,this.addAndShowScreen(this.background)}async addAndShowScreen(t){this.container.parent||this.app.stage.addChild(this.container),this.container.addChild(t),t.prepare&&t.prepare(),t.resize&&t.resize(this.width,this.height),t.update&&this.app.ticker.add(t.update,t),t.show&&(t.interactiveChildren=!1,await t.show(),t.interactiveChildren=!0)}async hideAndRemoveScreen(t){t.interactiveChildren=!1,t.hide&&await t.hide(),t.update&&this.app.ticker.remove(t.update,t),t.parent&&t.parent.removeChild(t),t.reset&&t.reset()}async showScreen(t){var e;this.currentScreen&&(this.currentScreen.interactiveChildren=!1),t.assetBundles&&await Ae.loadBundle(t.assetBundles,s=>{var r;(r=this.currentScreen)!=null&&r.onLoad&&this.currentScreen.onLoad(s*100)}),(e=this.currentScreen)!=null&&e.onLoad&&this.currentScreen.onLoad(100),this.currentScreen&&await this.hideAndRemoveScreen(this.currentScreen),this.currentScreen=Ce.get(t),await this.addAndShowScreen(this.currentScreen)}resize(t,e){var s,r,n,a,o,h;this.width=t,this.height=e,(r=(s=this.currentScreen)==null?void 0:s.resize)==null||r.call(s,t,e),(a=(n=this.currentPopup)==null?void 0:n.resize)==null||a.call(n,t,e),(h=(o=this.background)==null?void 0:o.resize)==null||h.call(o,t,e)}async presentPopup(t){var e,s;this.currentScreen&&(this.currentScreen.interactiveChildren=!1,await((s=(e=this.currentScreen).pause)==null?void 0:s.call(e))),this.currentPopup&&await this.hideAndRemoveScreen(this.currentPopup),this.currentPopup=new t,await this.addAndShowScreen(this.currentPopup)}async dismissPopup(){var e,s;if(!this.currentPopup)return;const t=this.currentPopup;this.currentPopup=void 0,await this.hideAndRemoveScreen(t),this.currentScreen&&(this.currentScreen.interactiveChildren=!0,(s=(e=this.currentScreen).resume)==null||s.call(e))}blur(){var t,e,s,r,n,a;(e=(t=this.currentScreen)==null?void 0:t.blur)==null||e.call(t),(r=(s=this.currentPopup)==null?void 0:s.blur)==null||r.call(s),(a=(n=this.background)==null?void 0:n.blur)==null||a.call(n)}focus(){var t,e,s,r,n,a;(e=(t=this.currentScreen)==null?void 0:t.focus)==null||e.call(t),(r=(s=this.currentPopup)==null?void 0:s.focus)==null||r.call(s),(a=(n=this.background)==null?void 0:n.focus)==null||a.call(n)}}class Ua{static init(){const t=this;t.navigation=new Cv,t.navigation.init(t),this._onResize=()=>t.navigation.resize(t.renderer.width,t.renderer.height),t.renderer.on("resize",this._onResize),t.resize()}static destroy(){const t=this;t.navigation=null}}x(Ua,"extension",X.Application),x(Ua,"_onResize");function Tv(i,t,e,s,r){const n=e/s;let a=i,o=t;r&&(e<s?(o=window.innerHeight,a=Math.min(window.innerWidth,e,o*n)):(a=window.innerWidth,o=Math.min(window.innerHeight,s,a/n)));const h=a<e?e/a:1,l=o<s?s/o:1,c=h>l?h:l,u=Math.floor(a*c),f=Math.floor(o*c);return{width:u,height:f}}class Ai{static init(t){const e=this;Object.defineProperty(e,"resizeTo",{set(s){globalThis.removeEventListener("resize",e.queueResize),this._resizeTo=s,s&&(globalThis.addEventListener("resize",e.queueResize),e.resize())},get(){return this._resizeTo}}),e.queueResize=()=>{this._resizeTo&&(this._cancelResize(),this._resizeId=requestAnimationFrame(()=>e.resize()))},e.resize=()=>{if(!this._resizeTo)return;this._cancelResize();let s,r;if(this._resizeTo===globalThis.window)s=globalThis.innerWidth,r=globalThis.innerHeight;else{const{clientWidth:o,clientHeight:h}=this._resizeTo;s=o,r=h}const{width:n,height:a}=Tv(s,r,e.resizeOptions.minWidth,e.resizeOptions.minHeight,e.resizeOptions.letterbox);e.renderer.canvas.style.width=`${s}px`,e.renderer.canvas.style.height=`${r}px`,window.scrollTo(0,0),e.renderer.resize(n,a)},this._cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this._resizeId=null,this._resizeTo=null,e.resizeOptions={minWidth:768,minHeight:1024,letterbox:!0,...t.resizeOptions},e.resizeTo=t.resizeTo||null}static destroy(){const t=this;globalThis.removeEventListener("resize",t.queueResize),this._cancelResize(),this._cancelResize=null,t.queueResize=null,t.resizeTo=null,t.resize=null}}x(Ai,"extension",X.Application),x(Ai,"_resizeId"),x(Ai,"_resizeTo"),x(Ai,"_cancelResize");function Mv(){let i=Math.max(window.devicePixelRatio,2);return i%1!==0&&(i=2),i}at.remove(ja);at.add(Ai);at.add(Jf);at.add(Ua);class Pv extends Zc{constructor(){super(...arguments);x(this,"visibilityChange",()=>{document.hidden?(Qe.pauseAll(),this.navigation.blur()):(Qe.resumeAll(),this.navigation.focus())})}async init(e){e.resizeTo??(e.resizeTo=window),e.resolution??(e.resolution=Mv()),await super.init(e),document.getElementById("pixi-container").appendChild(this.canvas),document.addEventListener("visibilitychange",this.visibilityChange),await Ae.init({manifest:Zh,basePath:"assets"}),await Ae.loadBundle("preload");const s=Zh.bundles.map(r=>r.name);Ae.backgroundLoadBundle(s)}destroy(e=!1,s=!1){document.removeEventListener("visibilitychange",this.visibilityChange),super.destroy(e,s)}}const Sr=new Pv;sp(Sr);(async()=>(await Sr.init({background:"#1E1E1E",resizeOptions:{minWidth:768,minHeight:1024,letterbox:!1}}),ns.init(),await Sr.navigation.showScreen(rf),await Sr.navigation.showScreen($f)))();export{St as $,$c as A,ft as B,ot as C,ut as D,X as E,Yc as F,js as G,cc as H,pe as I,Ii as J,$o as K,Zt as L,et as M,ym as N,km as O,Dt as P,Tt as Q,Fi as R,Mm as S,Yt as T,Cr as U,pt as V,$m as W,qo as X,mn as Y,Ko as Z,qp as _,Xt as a,fc as a0,jc as a1,q as a2,rt as a3,Qm as a4,Ja as a5,pg as a6,hu as a7,uu as a8,fu as a9,mu as aa,gu as ab,Ws as ac,_u as ad,Sl as ae,vl as af,Xs as ag,As as ah,Hx as ai,jl as aj,Se as ak,N0 as al,ht as am,Oe as an,xp as ao,rh as ap,Su as aq,ug as b,Te as c,_r as d,at as e,ma as f,lg as g,$a as h,Rs as i,Wc as j,Sc as k,Kt as l,Oc as m,Ir as n,lu as o,cu as p,du as q,Ip as r,pu as s,$i as t,U as u,gp as v,mt as w,tn as x,zg as y,Ce as z};
